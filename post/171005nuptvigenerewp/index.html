<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>南邮CTF平台 Vigenere writeup | 闲言语</title><meta name=keywords content><meta name=description content="题目挺不错的，实打实，没脑洞，也锻炼了使用python的能力。"><meta name=author content><link rel=canonical href=https://ret2neo.cn/post/171005nuptvigenerewp/><link crossorigin=anonymous href=/assets/css/stylesheet.42b1e004fb78db2fc933d33c9db659598f62453f0de6f9db50c85e5936c0d8c3.css integrity="sha256-QrHgBPt42y/JM9M8nbZZWY9iRT8N5vnbUMheWTbA2MM=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://ret2neo.cn/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://ret2neo.cn/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://ret2neo.cn/favicon-32x32.png><link rel=apple-touch-icon href=https://ret2neo.cn/apple-touch-icon.png><link rel=mask-icon href=https://ret2neo.cn/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="南邮CTF平台 Vigenere writeup"><meta property="og:description" content="题目挺不错的，实打实，没脑洞，也锻炼了使用python的能力。"><meta property="og:type" content="article"><meta property="og:url" content="https://ret2neo.cn/post/171005nuptvigenerewp/"><meta property="article:section" content="post"><meta property="article:published_time" content="2017-10-05T19:40:09+08:00"><meta property="article:modified_time" content="2017-10-05T19:40:09+08:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="南邮CTF平台 Vigenere writeup"><meta name=twitter:description content="题目挺不错的，实打实，没脑洞，也锻炼了使用python的能力。"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://ret2neo.cn/post/"},{"@type":"ListItem","position":2,"name":"南邮CTF平台 Vigenere writeup","item":"https://ret2neo.cn/post/171005nuptvigenerewp/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"南邮CTF平台 Vigenere writeup","name":"南邮CTF平台 Vigenere writeup","description":"题目挺不错的，实打实，没脑洞，也锻炼了使用python的能力。","keywords":[],"articleBody":"题目 It is said that Vigenere cipher does not achieve the perfect secrecy actually :-)\nTips: 1.The encode pragram is given; 2.Do u no index of coincidence ？ 3.The key is last 6 words of the plain text(with “nctf{}” when submitted, also without any interpunction)\nencode.cpp code.txt\n什么是异或 异或（exclusive or）是二元逻辑运算符，符号为 XOR 或 EOR 或 ⊕或 ^ 。对于表达式 a^b 的取值，当且仅当a、b逻辑值不同时为真。具体来说就是四个式子：1^1=0;\t0^0=0;\t1^0=1;\t0^1=1 。另外，异或有一些基本的特性，本题仅用到第七行的特性即可。\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 a^a=0; a^0=a; a^b=b^a; a^(b^c)=(a^b)^c; a^b^b=a; ------------------------------------------ 如果 cipher = plain ^ key，那么 plain = cipher ^ key 简单地证明一下： c = p ^ k --\u003e c ^ k = p ^ k ^ k --\u003e c ^ k = p ------------------------------------------ 一个以字节为单位进行异或的例子： 97^98\t--\u003e 01100001 ^ 01100010 = 00000011 -\u003e 3 概念 我们知道，英文中的每个字母使用频率是不同的，在够长的一段话里，各个字母的占比大致稳定，并且这个稳定值也已经用巨大的语料库统计出来了，这就是字母频率。这种统计层面的现象，就给我们提供了判断一段文字是否可能有意义的依据，并且这种判断可以通过编程轻松完成。然而，给定两个字母组合，只计算出其中各字母的占比是不够的，想要准确高效地比较两段文字谁更可能具备有意义的语义，我们最好算出一个归一化参数，用以直观表示可能性的大小，这就是文中提到的 correlation ，计算公式也是有的 ，其中n(i)指字母i在一段话的所有字母中所占的比例，f(i)就是已经统计出来的i字母的频率，具体如下所示。\n字母频率列表：\n1 2 3 4 5 6 frequencies = {\"e\": 0.12702, \"t\": 0.09056, \"a\": 0.08167, \"o\": 0.07507, \"i\": 0.06966, \"n\": 0.06749, \"s\": 0.06327, \"h\": 0.06094, \"r\": 0.05987, \"d\": 0.04253, \"l\": 0.04025, \"c\": 0.02782, \"u\": 0.02758, \"m\": 0.02406, \"w\": 0.02360, \"f\": 0.02228, \"g\": 0.02015, \"y\": 0.01974, \"p\": 0.01929, \"b\": 0.01492, \"v\": 0.00978, \"k\": 0.00772, \"j\": 0.00153, \"x\": 0.00150, \"q\": 0.00095, \"z\": 0.00074} 解题 理解加密 题目的加密方式大致等价于这样写：\n1 2 3 4 5 6 7 8 9 10 # coding:utf8 key = [0xba, 0x1f, 0x91, 0xb2, 0x53, 0xcd, 0x3e] # 长度范围是1-13，当然，我们还不知道key是多少 plain = open('ptext.txt').read() cipher = open('ctext.txt', 'w+') c = '' k = 0 for p in plain: c += hex(ord(p) ^ key[k])[2:].zfill(2) k = (k + 1) % len(key) cipher.write(c) 程序意思是将明文和密钥逐字节异或，每次异或后的值用两位十六进制表示写入文件，也就是我们见到的code.txt，在这个过程中，密钥是循环使用的。\n那么现在情况是这样的，我们知道：\n密钥的长度区间为1-13字节\n加密方式为逐字节循环异或\n加密结果，即密文的完整内容\n我们想知道\n明文内容\n密钥内容\n(⊙﹏⊙) 这看起来有点困难。\n不过，其实还有两个不言而喻但非常重要的信息\n明文的每一个字节都是可见字符。\n明文是一段有意义的话。\n解密代码主程序 先放个主程序，和下面的对照着看。全部代码在文章底部 。\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 def main(): ps = [] ks = [] ss = [] ps.extend(xrange(32, 127)) ks.extend(xrange(0xff + 1)) ss.extend(xrange(1, 14)) cipher = getCipher() keyPool = getKeyPool(cipher=cipher, stepSet=ss, plainSet=ps, keySet=ks) for i in keyPool: freq = getFrequency(cipher, keyPool[i]) key = analyseFrequency(freq) plain = vigenereDecrypt(cipher, key) print key, plain 确定密钥的长度和候选字符集 明文由可见字符组成。这意味着任何一个使明文出现不可见字符的值都不可能出现在key里。 依据此可以取得两个进展。\n求出key的每一个字节有哪些候选字符。 具体操作： 当我们假设某一字节的key的值时，就可以使用前文提到的plain = cipher ^ key 求出这一字节密文对应的明文，如果这个明文是不可见的，那么我们假设的这个值就不可能出现在key的这个字节。 因为是循环异或，所以每个字节的key会去加密多个字节的明文，我们就可以如法炮制，大大缩小key的每个字节的候选字符集。 在1的基础上，确定key可能有哪几种长度。 具体操作： 我们假设key每一种可能的长度，一一去求对应的候选字符集， 如果有一种长度的key在某一字节的候选字符集为空，那么key就不可能是这个长度。 至此，我们可以从无到有求得 key有哪些可能的长度 以及 **key在每一种长度下对应的每个字节的候选字符集 **。\n上代码：\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 def getKeyPool(cipher, stepSet, plainSet, keySet): ''' 传入的密文串、明文字符集、密钥字符集、密钥长度范围均作为数字列表处理.形如[0x11,0x22,0x33] 返回一个字典，以可能的密钥长度为键，以对应的每一字节的密钥字符集构成的列表为值， 密钥字符集为数字列表。 形如{ 1:[[0x11]], 3:[ [0x11,0x33,0x46], [0x22,0x58], [0x33] ] } ''' keyPool = dict() for step in stepSet: maybe = [None] * step for pos in xrange(step): maybe[pos] = [] for k in keySet: flag = 1 for c in cipher[pos::step]: if c ^ k not in plainSet: flag = 0 if flag: maybe[pos].append(k) for posPool in maybe: if len(posPool) == 0: maybe = [] break if len(maybe) != 0: keyPool[step] = maybe return keyPool 遍历候选字符集，求出对应的字频 这虽是个体力活，却也得小心翼翼。\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 def getFrequency(cipher, keyPoolList): ''' 传入的密文作为数字列表处理 传入密钥的字符集应为列表，依次包含各字节字符集。 形如[[0x11,0x12],[0x22]] 返回字频列表，依次为各字节字符集中每一字符作为密钥组成部分时对应的明文字频 形如[{ 0x11:{'a':2,'b':3}, 0x12:{'e':6} }, { 0x22:{'g':1} }] ''' freqList = [] keyLen = len(keyPoolList) for i in xrange(keyLen): posFreq = dict() for k in keyPoolList[i]: posFreq[k] = dict() for c in cipher[i::keyLen]: p = chr(k ^ c) posFreq[k][p] = posFreq[k][p] + 1 if p in posFreq[k] else 1 freqList.append(posFreq) return freqList 根据字频求得密钥 明文是一段有意义的话。这意味着它算出来的correlation值一定是所有候选明文中最大的，依照这一点就能挑出密钥每个字节的值，从而得到整个密钥。这也是整个解密过程最核心的一部分。\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 def calCorrelation(cpool): '''传入字典，形如{'e':2,'p':3} 返回可能性，0~1,值越大可能性越大 (correlation between the decrypted column letter frequencies and the relative letter frequencies for normal English text) ''' frequencies = {\"e\": 0.12702, \"t\": 0.09056, \"a\": 0.08167, \"o\": 0.07507, \"i\": 0.06966, \"n\": 0.06749, \"s\": 0.06327, \"h\": 0.06094, \"r\": 0.05987, \"d\": 0.04253, \"l\": 0.04025, \"c\": 0.02782, \"u\": 0.02758, \"m\": 0.02406, \"w\": 0.02360, \"f\": 0.02228, \"g\": 0.02015, \"y\": 0.01974, \"p\": 0.01929, \"b\": 0.01492, \"v\": 0.00978, \"k\": 0.00772, \"j\": 0.00153, \"x\": 0.00150, \"q\": 0.00095, \"z\": 0.00074} relative = 0.0 total = 0 fpool = 'etaoinshrdlcumwfgypbvkjxqz' total = sum(cpool.values()) # 总和应包括字母和其他可见字符 for i in cpool.keys(): if i in fpool: relative += frequencies[i] * cpool[i] / total return relative def analyseFrequency(cfreq): key = [] for posFreq in cfreq: mostRelative = 0 for keyChr in posFreq.keys(): r = calCorrelation(posFreq[keyChr]) if r \u003e mostRelative: mostRelative = r keychar = keyChr key.append(keychar) return key 根据密钥解密 求出密钥剩下的就好办了。\n1 2 3 4 5 6 7 8 def vigenereDecrypt(cipher, key): plain = '' cur = 0 ll = len(key) for c in cipher: plain += chr(c ^ key[cur]) cur = (cur + 1) % ll return plain 一些数据 可能的密钥长度和对应字符集 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 {7: [[162, 165, 168, 169, 170, 174, 175, 178, 179, 180, 184, 185, 186, 187, 189, 190, 191], [0, 2, 10, 11, 12, 17, 21, 23, 25, 26, 27, 28, 29, 30, 31, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95], [132, 133, 142, 144, 145, 146, 147, 148, 149, 150, 155, 159, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223], [161, 166, 167, 170, 173, 176, 177, 178, 179, 180, 181, 182, 183, 186, 188], [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 68, 70, 72, 76, 78, 80, 81, 82, 83, 84, 86, 87, 90, 93], [128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 195, 196, 200, 201, 202, 204, 205, 206, 207, 208, 210, 213, 216, 217, 223], [33, 39, 43, 44, 52, 55, 57, 58, 59, 60, 61, 62, 63] ]} 最后结果 1 2 [186, 31, 145, 178, 83, 205, 62] Cryptography is the practice and study of techniques for, among other things, secure communication in the presence of attackers. Cryptography has been used for hundreds, if not thousands, of years, but traditional cryptosystems were designed and evaluated in a fairly ad hoc manner. For example, the Vigenere encryption scheme was thought to be secure for decades after it was invented, but we now know, and this exercise demonstrates, that it can be broken very easily. [Finished in 2.2s] 解密代码全文 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 # coding:utf8 # by https://findneo.github.io/ def getCipher(file='code.txt'): '''从文件中读取十六进制串，返回十六进制数组 ''' c = open(file).read() codeintlist = [] codeintlist.extend( (map(lambda i: int(c[i:i + 2], 16), range(0, len(c), 2)))) return codeintlist def getKeyPool(cipher, stepSet, plainSet, keySet): ''' 传入的密文串、明文字符集、密钥字符集、密钥长度范围均作为数字列表处理.形如[0x11,0x22,0x33] 返回一个字典，以可能的密钥长度为键，以对应的每一字节的密钥字符集构成的列表为值，密钥字符集为数字列表。 形如{ 1:[[0x11]], 3:[ [0x11,0x33,0x46], [0x22,0x58], [0x33] ] } ''' keyPool = dict() for step in stepSet: maybe = [None] * step for pos in xrange(step): maybe[pos] = [] for k in keySet: flag = 1 for c in cipher[pos::step]: if c ^ k not in plainSet: flag = 0 if flag: maybe[pos].append(k) for posPool in maybe: if len(posPool) == 0: maybe = [] break if len(maybe) != 0: keyPool[step] = maybe return keyPool def calCorrelation(cpool): '''传入字典，形如{'e':2,'p':3} 返回可能性，0~1,值越大可能性越大 (correlation between the decrypted column letter frequencies and the relative letter frequencies for normal English text) ''' frequencies = {\"e\": 0.12702, \"t\": 0.09056, \"a\": 0.08167, \"o\": 0.07507, \"i\": 0.06966, \"n\": 0.06749, \"s\": 0.06327, \"h\": 0.06094, \"r\": 0.05987, \"d\": 0.04253, \"l\": 0.04025, \"c\": 0.02782, \"u\": 0.02758, \"m\": 0.02406, \"w\": 0.02360, \"f\": 0.02228, \"g\": 0.02015, \"y\": 0.01974, \"p\": 0.01929, \"b\": 0.01492, \"v\": 0.00978, \"k\": 0.00772, \"j\": 0.00153, \"x\": 0.00150, \"q\": 0.00095, \"z\": 0.00074} relative = 0.0 total = 0 fpool = 'etaoinshrdlcumwfgypbvkjxqz' total = sum(cpool.values()) # 总和应包括字母和其他可见字符 for i in cpool.keys(): if i in fpool: relative += frequencies[i] * cpool[i] / total return relative def analyseFrequency(cfreq): key = [] for posFreq in cfreq: mostRelative = 0 for keyChr in posFreq.keys(): r = calCorrelation(posFreq[keyChr]) if r \u003e mostRelative: mostRelative = r keychar = keyChr key.append(keychar) return key def getFrequency(cipher, keyPoolList): ''' 传入的密文作为数字列表处理 传入密钥的字符集应为列表，依次包含各字节字符集。 形如[[0x11,0x12],[0x22]] 返回字频列表，依次为各字节字符集中每一字符作为密钥组成部分时对应的明文字频 形如[{ 0x11:{'a':2,'b':3}, 0x12:{'e':6} }, { 0x22:{'g':1} }] ''' freqList = [] keyLen = len(keyPoolList) for i in xrange(keyLen): posFreq = dict() for k in keyPoolList[i]: posFreq[k] = dict() for c in cipher[i::keyLen]: p = chr(k ^ c) posFreq[k][p] = posFreq[k][p] + 1 if p in posFreq[k] else 1 freqList.append(posFreq) return freqList def vigenereDecrypt(cipher, key): plain = '' cur = 0 ll = len(key) for c in cipher: plain += chr(c ^ key[cur]) cur = (cur + 1) % ll return plain def main(): ps = [] ks = [] ss = [] ps.extend(xrange(32, 127)) ks.extend(xrange(0xff + 1)) ss.extend(xrange(1, 14)) cipher = getCipher() keyPool = getKeyPool(cipher=cipher, stepSet=ss, plainSet=ps, keySet=ks) for i in keyPool: freq = getFrequency(cipher, keyPool[i]) key = analyseFrequency(freq) plain = vigenereDecrypt(cipher, key) print key, plain if __name__ == '__main__': main() 题目备份 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 http://ctf.nuptsast.com/static/uploads/13706e3281c1fb0c04417d3452cb745b/encode.cpp #include #define KEY_LENGTH 2 // Can be anything from 1 to 13 main(){ unsigned char ch; FILE *fpIn, *fpOut; int i; unsigned char key[KEY_LENGTH] = {0x00, 0x00}; /* of course, I did not use the all-0s key to encrypt */ fpIn = fopen(\"ptext.txt\", \"r\"); fpOut = fopen(\"ctext.txt\", \"w\"); i=0; while (fscanf(fpIn, \"%c\", \u0026ch) != EOF) { /* avoid encrypting newline characters */ /* In a \"real-world\" implementation of the Vigenere cipher, every ASCII character in the plaintext would be encrypted. However, I want to avoid encrypting newlines here because it makes recovering the plaintext slightly more difficult... */ /* ...and my goal is not to create \"production-quality\" code =) */ if (ch!='\\n') { fprintf(fpOut, \"%02X\", ch ^ key[i % KEY_LENGTH]); // ^ is logical XOR i++; } } fclose(fpIn); fclose(fpOut); return; } ---------------------------------------------------------------------------------- http://ctf.nuptsast.com/static/uploads/9a27a6c8b9fb7b8d2a07ad94924c02e5/code.txt F96DE8C227A259C87EE1DA2AED57C93FE5DA36ED4EC87EF2C63AAE5B9A7EFFD673BE4ACF7BE8923CAB1ECE7AF2DA3DA44FCF7AE29235A24C963FF0DF3CA3599A70E5DA36BF1ECE77F8DC34BE129A6CF4D126BF5B9A7CFEDF3EB850D37CF0C63AA2509A76FF9227A55B9A6FE3D720A850D97AB1DD35ED5FCE6BF0D138A84CC931B1F121B44ECE70F6C032BD56C33FF9D320ED5CDF7AFF9226BE5BDE3FF7DD21ED56CF71F5C036A94D963FF8D473A351CE3FE5DA3CB84DDB71F5C17FED51DC3FE8D732BF4D963FF3C727ED4AC87EF5DB27A451D47EFD9230BF47CA6BFEC12ABE4ADF72E29224A84CDF3FF5D720A459D47AF59232A35A9A7AE7D33FB85FCE7AF5923AA31EDB3FF7D33ABF52C33FF0D673A551D93FFCD33DA35BC831B1F43CBF1EDF67F0DF23A15B963FE5DA36ED68D378F4DC36BF5B9A7AFFD121B44ECE76FEDC73BE5DD27AFCD773BA5FC93FE5DA3CB859D26BB1C63CED5CDF3FE2D730B84CDF3FF7DD21ED5ADF7CF0D636BE1EDB79E5D721ED57CE3FE6D320ED57D469F4DC27A85A963FF3C727ED49DF3FFFDD24ED55D470E69E73AC50DE3FE5DA3ABE1EDF67F4C030A44DDF3FF5D73EA250C96BE3D327A84D963FE5DA32B91ED36BB1D132A31ED87AB1D021A255DF71B1C436BF479A7AF0C13AA14794 参考链接 https://en.wikipedia.org/wiki/Index_of_coincidence https://en.wikipedia.org/wiki/One-time_pad https://en.wikipedia.org/wiki/Vigen%C3%A8re_cipher https://en.wikipedia.org/wiki/Letter_frequency https://www.lijinma.com/blog/2014/05/29/amazing-xor/ http://blog.csdn.net/qq_31344951/article/details/77934717 ","wordCount":"1794","inLanguage":"en","datePublished":"2017-10-05T19:40:09+08:00","dateModified":"2017-10-05T19:40:09+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://ret2neo.cn/post/171005nuptvigenerewp/"},"publisher":{"@type":"Organization","name":"闲言语","logo":{"@type":"ImageObject","url":"https://ret2neo.cn/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://ret2neo.cn/ accesskey=h title="闲言语 (Alt + H)">闲言语</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://ret2neo.cn/mind/ title=随笔><span>随笔</span></a></li><li><a href=https://ret2neo.cn/about title=关于><span>关于</span></a></li><li><a href=https://ret2neo.cn/search title="搜索 (Alt + /)" accesskey=/><span>搜索</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>南邮CTF平台 Vigenere writeup</h1><div class=post-description>题目挺不错的，实打实，没脑洞，也锻炼了使用python的能力。</div><div class=post-meta><span title='2017-10-05 19:40:09 +0800 CST'>October 5, 2017</span>&nbsp;|&nbsp;<a href=https://github.dev/findneo/priblog/content/post/171005nuptvigenerewp.md rel="noopener noreferrer" target=_blank>edit</a></div></header><aside id=toc-container class="toc-container wide"><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>目录</span></summary><div class=inner><ul><li><a href=#%e9%a2%98%e7%9b%ae aria-label=题目>题目</a></li><li><a href=#%e4%bb%80%e4%b9%88%e6%98%af%e5%bc%82%e6%88%96 aria-label=什么是异或>什么是异或</a></li><li><a href=#%e6%a6%82%e5%bf%b5 aria-label=概念>概念</a></li><li><a href=#%e8%a7%a3%e9%a2%98 aria-label=解题>解题</a><ul><li><a href=#%e7%90%86%e8%a7%a3%e5%8a%a0%e5%af%86 aria-label=理解加密>理解加密</a></li><li><a href=#%e8%a7%a3%e5%af%86%e4%bb%a3%e7%a0%81%e4%b8%bb%e7%a8%8b%e5%ba%8f aria-label=解密代码主程序>解密代码主程序</a></li><li><a href=#%e7%a1%ae%e5%ae%9a%e5%af%86%e9%92%a5%e7%9a%84%e9%95%bf%e5%ba%a6%e5%92%8c%e5%80%99%e9%80%89%e5%ad%97%e7%ac%a6%e9%9b%86 aria-label=确定密钥的长度和候选字符集>确定密钥的长度和候选字符集</a></li><li><a href=#%e9%81%8d%e5%8e%86%e5%80%99%e9%80%89%e5%ad%97%e7%ac%a6%e9%9b%86%e6%b1%82%e5%87%ba%e5%af%b9%e5%ba%94%e7%9a%84%e5%ad%97%e9%a2%91 aria-label=遍历候选字符集，求出对应的字频>遍历候选字符集，求出对应的字频</a></li><li><a href=#%e6%a0%b9%e6%8d%ae%e5%ad%97%e9%a2%91%e6%b1%82%e5%be%97%e5%af%86%e9%92%a5 aria-label=根据字频求得密钥>根据字频求得密钥</a></li><li><a href=#%e6%a0%b9%e6%8d%ae%e5%af%86%e9%92%a5%e8%a7%a3%e5%af%86 aria-label=根据密钥解密>根据密钥解密</a></li></ul></li><li><a href=#%e4%b8%80%e4%ba%9b%e6%95%b0%e6%8d%ae aria-label=一些数据>一些数据</a><ul><li><a href=#%e5%8f%af%e8%83%bd%e7%9a%84%e5%af%86%e9%92%a5%e9%95%bf%e5%ba%a6%e5%92%8c%e5%af%b9%e5%ba%94%e5%ad%97%e7%ac%a6%e9%9b%86 aria-label=可能的密钥长度和对应字符集>可能的密钥长度和对应字符集</a></li><li><a href=#%e6%9c%80%e5%90%8e%e7%bb%93%e6%9e%9c aria-label=最后结果>最后结果</a></li></ul></li><li><a href=#%e8%a7%a3%e5%af%86%e4%bb%a3%e7%a0%81%e5%85%a8%e6%96%87 aria-label=解密代码全文>解密代码全文</a></li><li><a href=#%e9%a2%98%e7%9b%ae%e5%a4%87%e4%bb%bd aria-label=题目备份>题目备份</a></li><li><a href=#%e5%8f%82%e8%80%83%e9%93%be%e6%8e%a5 aria-label=参考链接>参考链接</a></li></ul></div></details></div></aside><script>let activeElement,elements;window.addEventListener("DOMContentLoaded",function(){checkTocPosition(),elements=document.querySelectorAll("h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]"),activeElement=elements[0];const t=encodeURI(activeElement.getAttribute("id")).toLowerCase();document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active")},!1),window.addEventListener("resize",function(){checkTocPosition()},!1),window.addEventListener("scroll",()=>{activeElement=Array.from(elements).find(e=>{if(getOffsetTop(e)-window.pageYOffset>0&&getOffsetTop(e)-window.pageYOffset<window.innerHeight/2)return e})||activeElement,elements.forEach(e=>{const t=encodeURI(e.getAttribute("id")).toLowerCase();e===activeElement?document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active"):document.querySelector(`.inner ul li a[href="#${t}"]`).classList.remove("active")})},!1);const main=parseInt(getComputedStyle(document.body).getPropertyValue("--article-width"),10),toc=parseInt(getComputedStyle(document.body).getPropertyValue("--toc-width"),10),gap=parseInt(getComputedStyle(document.body).getPropertyValue("--gap"),10);function checkTocPosition(){const e=document.body.scrollWidth;e-main-toc*2-gap*4>0?document.getElementById("toc-container").classList.add("wide"):document.getElementById("toc-container").classList.remove("wide")}function getOffsetTop(e){if(!e.getClientRects().length)return 0;let t=e.getBoundingClientRect(),n=e.ownerDocument.defaultView;return t.top+n.pageYOffset}</script><div class=post-content><h3 id=题目>题目<a hidden class=anchor aria-hidden=true href=#题目>#</a></h3><blockquote><p>It is said that Vigenere cipher does not achieve the perfect secrecy actually :-)</p><p>Tips:
1.The encode pragram is given;
2.Do u no <a href=https://en.wikipedia.org/wiki/Index_of_coincidence>index of coincidence </a>？
3.The key is last 6 words of the plain text(with &ldquo;nctf{}&rdquo; when submitted, also without any interpunction)</p><p><a href=http://ctf.nuptsast.com/static/uploads/13706e3281c1fb0c04417d3452cb745b/encode.cpp>encode.cpp</a> <a href=http://ctf.nuptsast.com/static/uploads/9a27a6c8b9fb7b8d2a07ad94924c02e5/code.txt>code.txt</a></p></blockquote><h3 id=什么是异或>什么是异或<a hidden class=anchor aria-hidden=true href=#什么是异或>#</a></h3><p>异或（exclusive or）是二元逻辑运算符，符号为 XOR 或 EOR 或 ⊕或 ^ 。对于表达式 <code>a^b</code> 的取值，当且仅当a、b逻辑值不同时为真。具体来说就是四个式子：<code>1^1=0; 0^0=0; 1^0=1; 0^1=1</code> 。另外，异或有一些基本的特性，<strong>本题仅用到第七行的特性</strong>即可。</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-13>13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-14>14</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#a6e22e>a</span><span style=color:#f92672>^</span><span style=color:#a6e22e>a</span><span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span><span style=color:#a6e22e>a</span><span style=color:#f92672>^</span><span style=color:#ae81ff>0</span><span style=color:#f92672>=</span><span style=color:#a6e22e>a</span>;
</span></span><span style=display:flex><span><span style=color:#a6e22e>a</span><span style=color:#f92672>^</span><span style=color:#a6e22e>b</span><span style=color:#f92672>=</span><span style=color:#a6e22e>b</span><span style=color:#f92672>^</span><span style=color:#a6e22e>a</span>;
</span></span><span style=display:flex><span><span style=color:#a6e22e>a</span><span style=color:#f92672>^</span>(<span style=color:#a6e22e>b</span><span style=color:#f92672>^</span><span style=color:#a6e22e>c</span>)<span style=color:#f92672>=</span>(<span style=color:#a6e22e>a</span><span style=color:#f92672>^</span><span style=color:#a6e22e>b</span>)<span style=color:#f92672>^</span><span style=color:#a6e22e>c</span>;
</span></span><span style=display:flex><span><span style=color:#a6e22e>a</span><span style=color:#f92672>^</span><span style=color:#a6e22e>b</span><span style=color:#f92672>^</span><span style=color:#a6e22e>b</span><span style=color:#f92672>=</span><span style=color:#a6e22e>a</span>;
</span></span><span style=display:flex><span><span style=color:#f92672>------------------------------------------</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>如果</span> <span style=color:#a6e22e>cipher</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>plain</span> <span style=color:#f92672>^</span> <span style=color:#a6e22e>key，那么</span> <span style=color:#a6e22e>plain</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>cipher</span> <span style=color:#f92672>^</span> <span style=color:#a6e22e>key</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>简单地证明一下：</span>
</span></span><span style=display:flex><span>	        <span style=color:#a6e22e>c</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>p</span> <span style=color:#f92672>^</span> <span style=color:#a6e22e>k</span>
</span></span><span style=display:flex><span> <span style=color:#f92672>--&gt;</span>  	<span style=color:#a6e22e>c</span> <span style=color:#f92672>^</span> <span style=color:#a6e22e>k</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>p</span> <span style=color:#f92672>^</span> <span style=color:#a6e22e>k</span> <span style=color:#f92672>^</span> <span style=color:#a6e22e>k</span>
</span></span><span style=display:flex><span> <span style=color:#f92672>--&gt;</span>  	<span style=color:#a6e22e>c</span> <span style=color:#f92672>^</span> <span style=color:#a6e22e>k</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>p</span>
</span></span><span style=display:flex><span><span style=color:#f92672>------------------------------------------</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>一个以字节为单位进行异或的例子：</span>
</span></span><span style=display:flex><span>  <span style=color:#ae81ff>97</span><span style=color:#f92672>^</span><span style=color:#ae81ff>98</span>	<span style=color:#f92672>--&gt;</span> <span style=color:#ae81ff>01100001</span> <span style=color:#f92672>^</span> <span style=color:#ae81ff>01100010</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>00000011</span> <span style=color:#f92672>-&gt;</span> <span style=color:#ae81ff>3</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=概念>概念<a hidden class=anchor aria-hidden=true href=#概念>#</a></h3><p>我们知道，英文中的每个字母使用频率是不同的，在够长的一段话里，各个字母的占比大致稳定，并且这个稳定值也已经用巨大的语料库统计出来了，这就是<a href=https://zh.wikipedia.org/wiki/%E5%AD%97%E6%AF%8D%E9%A2%91%E7%8E%87>字母频率</a>。这种统计层面的现象，就给我们提供了判断一段文字是否可能有意义的依据，并且这种判断可以通过编程轻松完成。然而，给定两个字母组合，只计算出其中各字母的占比是不够的，想要准确高效地比较两段文字谁更可能具备有意义的语义，我们最好算出一个归一化参数，用以直观表示可能性的大小，这就是文中提到的 <a href=https://en.wikipedia.org/wiki/Index_of_coincidence#Example>correlation</a> ，计算公式也是有的 <img loading=lazy src=fac20c468a5cf6354.png alt>
，其中n(i)指字母i在一段话的所有字母中所占的比例，f(i)就是已经统计出来的i字母的频率，具体如下所示。</p><p>字母频率列表：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-1>1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-2>2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-3>3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-4>4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-5>5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-6>6</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#a6e22e>frequencies</span> <span style=color:#f92672>=</span> {<span style=color:#e6db74>&#34;e&#34;</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0.12702</span>, <span style=color:#e6db74>&#34;t&#34;</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0.09056</span>, <span style=color:#e6db74>&#34;a&#34;</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0.08167</span>, <span style=color:#e6db74>&#34;o&#34;</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0.07507</span>, <span style=color:#e6db74>&#34;i&#34;</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0.06966</span>,
</span></span><span style=display:flex><span>               <span style=color:#e6db74>&#34;n&#34;</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0.06749</span>, <span style=color:#e6db74>&#34;s&#34;</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0.06327</span>, <span style=color:#e6db74>&#34;h&#34;</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0.06094</span>, <span style=color:#e6db74>&#34;r&#34;</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0.05987</span>, <span style=color:#e6db74>&#34;d&#34;</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0.04253</span>,
</span></span><span style=display:flex><span>               <span style=color:#e6db74>&#34;l&#34;</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0.04025</span>, <span style=color:#e6db74>&#34;c&#34;</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0.02782</span>, <span style=color:#e6db74>&#34;u&#34;</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0.02758</span>, <span style=color:#e6db74>&#34;m&#34;</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0.02406</span>, <span style=color:#e6db74>&#34;w&#34;</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0.02360</span>,
</span></span><span style=display:flex><span>               <span style=color:#e6db74>&#34;f&#34;</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0.02228</span>, <span style=color:#e6db74>&#34;g&#34;</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0.02015</span>, <span style=color:#e6db74>&#34;y&#34;</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0.01974</span>, <span style=color:#e6db74>&#34;p&#34;</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0.01929</span>, <span style=color:#e6db74>&#34;b&#34;</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0.01492</span>,
</span></span><span style=display:flex><span>               <span style=color:#e6db74>&#34;v&#34;</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0.00978</span>, <span style=color:#e6db74>&#34;k&#34;</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0.00772</span>, <span style=color:#e6db74>&#34;j&#34;</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0.00153</span>, <span style=color:#e6db74>&#34;x&#34;</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0.00150</span>, <span style=color:#e6db74>&#34;q&#34;</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0.00095</span>,
</span></span><span style=display:flex><span>               <span style=color:#e6db74>&#34;z&#34;</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0.00074</span>}
</span></span></code></pre></td></tr></table></div></div><h3 id=解题>解题<a hidden class=anchor aria-hidden=true href=#解题>#</a></h3><h4 id=理解加密>理解加密<a hidden class=anchor aria-hidden=true href=#理解加密>#</a></h4><p>题目的加密方式大致等价于这样写：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-10>10</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># coding:utf8</span>
</span></span><span style=display:flex><span>key <span style=color:#f92672>=</span> [<span style=color:#ae81ff>0xba</span>, <span style=color:#ae81ff>0x1f</span>, <span style=color:#ae81ff>0x91</span>, <span style=color:#ae81ff>0xb2</span>, <span style=color:#ae81ff>0x53</span>, <span style=color:#ae81ff>0xcd</span>, <span style=color:#ae81ff>0x3e</span>]  <span style=color:#75715e># 长度范围是1-13，当然，我们还不知道key是多少</span>
</span></span><span style=display:flex><span>plain <span style=color:#f92672>=</span> open(<span style=color:#e6db74>&#39;ptext.txt&#39;</span>)<span style=color:#f92672>.</span>read()
</span></span><span style=display:flex><span>cipher <span style=color:#f92672>=</span> open(<span style=color:#e6db74>&#39;ctext.txt&#39;</span>, <span style=color:#e6db74>&#39;w+&#39;</span>)
</span></span><span style=display:flex><span>c <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span>
</span></span><span style=display:flex><span>k <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> p <span style=color:#f92672>in</span> plain:
</span></span><span style=display:flex><span>    c <span style=color:#f92672>+=</span> hex(ord(p) <span style=color:#f92672>^</span> key[k])[<span style=color:#ae81ff>2</span>:]<span style=color:#f92672>.</span>zfill(<span style=color:#ae81ff>2</span>)
</span></span><span style=display:flex><span>    k <span style=color:#f92672>=</span> (k <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>%</span> len(key)
</span></span><span style=display:flex><span>cipher<span style=color:#f92672>.</span>write(c)
</span></span></code></pre></td></tr></table></div></div><p>程序意思是将明文和密钥逐字节异或，每次异或后的值用两位十六进制表示写入文件，也就是我们见到的code.txt，在这个过程中，密钥是循环使用的。</p><p>那么现在情况是这样的，我们知道：</p><blockquote><p>密钥的长度区间为1-13字节</p><p>加密方式为逐字节循环异或</p><p>加密结果，即密文的完整内容</p></blockquote><p>我们想知道</p><blockquote><p>明文内容</p><p>密钥内容</p></blockquote><p>(⊙﹏⊙) 这看起来有点困难。</p><p>不过，其实还有两个不言而喻但非常重要的信息</p><blockquote><p>明文的每一个字节都是可见字符。</p><p>明文是一段有意义的话。</p></blockquote><h4 id=解密代码主程序>解密代码主程序<a hidden class=anchor aria-hidden=true href=#解密代码主程序>#</a></h4><p>先放个主程序，和下面的对照着看。全部代码在<a href=#%E8%A7%A3%E5%AF%86%E4%BB%A3%E7%A0%81%E5%85%A8%E6%96%87>文章底部</a> 。</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-13>13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-14>14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-15>15</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>main</span>():
</span></span><span style=display:flex><span>    ps <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>    ks <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>    ss <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>    ps<span style=color:#f92672>.</span>extend(xrange(<span style=color:#ae81ff>32</span>, <span style=color:#ae81ff>127</span>))
</span></span><span style=display:flex><span>    ks<span style=color:#f92672>.</span>extend(xrange(<span style=color:#ae81ff>0xff</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>))
</span></span><span style=display:flex><span>    ss<span style=color:#f92672>.</span>extend(xrange(<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>14</span>))
</span></span><span style=display:flex><span>    cipher <span style=color:#f92672>=</span> getCipher()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    keyPool <span style=color:#f92672>=</span> getKeyPool(cipher<span style=color:#f92672>=</span>cipher, stepSet<span style=color:#f92672>=</span>ss, plainSet<span style=color:#f92672>=</span>ps, keySet<span style=color:#f92672>=</span>ks)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> keyPool:
</span></span><span style=display:flex><span>        freq <span style=color:#f92672>=</span> getFrequency(cipher, keyPool[i])
</span></span><span style=display:flex><span>        key <span style=color:#f92672>=</span> analyseFrequency(freq)
</span></span><span style=display:flex><span>        plain <span style=color:#f92672>=</span> vigenereDecrypt(cipher, key)
</span></span><span style=display:flex><span>        print key, plain
</span></span></code></pre></td></tr></table></div></div><h4 id=确定密钥的长度和候选字符集>确定密钥的长度和候选字符集<a hidden class=anchor aria-hidden=true href=#确定密钥的长度和候选字符集>#</a></h4><p>明文由可见字符组成。这意味着任何一个使明文出现不可见字符的值都不可能出现在key里。
依据此可以取得两个进展。</p><ol><li>求出key的每一个字节有哪些候选字符。
具体操作：
当我们假设某一字节的key的值时，就可以使用前文提到的plain = cipher ^ key 求出这一字节密文对应的明文，如果这个明文是不可见的，那么我们假设的这个值就不可能出现在key的这个字节。
因为是循环异或，所以每个字节的key会去加密多个字节的明文，我们就可以如法炮制，大大缩小key的每个字节的候选字符集。</li><li>在1的基础上，确定key可能有哪几种长度。
具体操作：
我们假设key每一种可能的长度，一一去求对应的候选字符集， 如果有一种长度的key在某一字节的候选字符集为空，那么key就不可能是这个长度。</li></ol><p>至此，我们可以从无到有求得 <strong>key有哪些可能的长度</strong> 以及 **key在每一种长度下对应的每个字节的候选字符集 **。</p><p>上代码：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-13>13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-14>14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-15>15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-16><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-16>16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-17><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-17>17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-18><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-18>18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-19><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-19>19</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-20><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-20>20</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-21><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-21>21</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-22><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-22>22</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-23><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-23>23</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-24><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-24>24</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-25><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-25>25</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-26><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-26>26</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-27><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-27>27</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-28><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-28>28</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-29><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-29>29</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-30><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-30>30</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-31><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-31>31</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-32><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-32>32</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>getKeyPool</span>(cipher, stepSet, plainSet, keySet):
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;&#39;&#39; 传入的密文串、明文字符集、密钥字符集、密钥长度范围均作为数字列表处理.形如[0x11,0x22,0x33]
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        返回一个字典，以可能的密钥长度为键，以对应的每一字节的密钥字符集构成的列表为值，
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        密钥字符集为数字列表。
</span></span></span><span style=display:flex><span><span style=color:#e6db74>            形如{
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                    1:[[0x11]],
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                    3:[
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                        [0x11,0x33,0x46],
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                        [0x22,0x58],
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                        [0x33]
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                       ]
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                }
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    &#39;&#39;&#39;</span>
</span></span><span style=display:flex><span>    keyPool <span style=color:#f92672>=</span> dict()
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> step <span style=color:#f92672>in</span> stepSet:
</span></span><span style=display:flex><span>        maybe <span style=color:#f92672>=</span> [<span style=color:#66d9ef>None</span>] <span style=color:#f92672>*</span> step
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> pos <span style=color:#f92672>in</span> xrange(step):
</span></span><span style=display:flex><span>            maybe[pos] <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>for</span> k <span style=color:#f92672>in</span> keySet:
</span></span><span style=display:flex><span>                flag <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>for</span> c <span style=color:#f92672>in</span> cipher[pos::step]:
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>if</span> c <span style=color:#f92672>^</span> k <span style=color:#f92672>not</span> <span style=color:#f92672>in</span> plainSet:
</span></span><span style=display:flex><span>                        flag <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> flag:
</span></span><span style=display:flex><span>                    maybe[pos]<span style=color:#f92672>.</span>append(k)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> posPool <span style=color:#f92672>in</span> maybe:
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> len(posPool) <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>:
</span></span><span style=display:flex><span>                maybe <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>break</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> len(maybe) <span style=color:#f92672>!=</span> <span style=color:#ae81ff>0</span>:
</span></span><span style=display:flex><span>            keyPool[step] <span style=color:#f92672>=</span> maybe
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> keyPool
</span></span></code></pre></td></tr></table></div></div><h4 id=遍历候选字符集求出对应的字频>遍历候选字符集，求出对应的字频<a hidden class=anchor aria-hidden=true href=#遍历候选字符集求出对应的字频>#</a></h4><p>这虽是个体力活，却也得小心翼翼。</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-13>13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-14>14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-15>15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-16><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-16>16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-17><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-17>17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-18><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-18>18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-19><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-19>19</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-20><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-20>20</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-21><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-21>21</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-22><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-22>22</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-23><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-23>23</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-24><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-24>24</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>getFrequency</span>(cipher, keyPoolList):
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;&#39;&#39; 传入的密文作为数字列表处理
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        传入密钥的字符集应为列表，依次包含各字节字符集。
</span></span></span><span style=display:flex><span><span style=color:#e6db74>            形如[[0x11,0x12],[0x22]]
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        返回字频列表，依次为各字节字符集中每一字符作为密钥组成部分时对应的明文字频
</span></span></span><span style=display:flex><span><span style=color:#e6db74>            形如[{
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                    0x11:{&#39;a&#39;:2,&#39;b&#39;:3},
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                    0x12:{&#39;e&#39;:6}
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                 },
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                 {
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                    0x22:{&#39;g&#39;:1}
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                 }]
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    &#39;&#39;&#39;</span>
</span></span><span style=display:flex><span>    freqList <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>    keyLen <span style=color:#f92672>=</span> len(keyPoolList)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> xrange(keyLen):
</span></span><span style=display:flex><span>        posFreq <span style=color:#f92672>=</span> dict()
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> k <span style=color:#f92672>in</span> keyPoolList[i]:
</span></span><span style=display:flex><span>            posFreq[k] <span style=color:#f92672>=</span> dict()
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>for</span> c <span style=color:#f92672>in</span> cipher[i::keyLen]:
</span></span><span style=display:flex><span>                p <span style=color:#f92672>=</span> chr(k <span style=color:#f92672>^</span> c)
</span></span><span style=display:flex><span>                posFreq[k][p] <span style=color:#f92672>=</span> posFreq[k][p] <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span> <span style=color:#66d9ef>if</span> p <span style=color:#f92672>in</span> posFreq[k] <span style=color:#66d9ef>else</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>        freqList<span style=color:#f92672>.</span>append(posFreq)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> freqList
</span></span></code></pre></td></tr></table></div></div><h4 id=根据字频求得密钥>根据字频求得密钥<a hidden class=anchor aria-hidden=true href=#根据字频求得密钥>#</a></h4><p>明文是一段有意义的话。这意味着它算出来的correlation值一定是所有候选明文中最大的，依照这一点就能挑出密钥每个字节的值，从而得到整个密钥。这也是整个解密过程最核心的一部分。</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-6-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-6-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-6-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-6-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-6-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-6-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-6-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-6-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-6-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-6-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-6-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-6-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-6-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-6-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-6-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-6-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-6-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-6-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-6-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-6-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-6-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-6-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-6-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-6-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-6-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-6-13>13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-6-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-6-14>14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-6-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-6-15>15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-6-16><a style=outline:none;text-decoration:none;color:inherit href=#hl-6-16>16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-6-17><a style=outline:none;text-decoration:none;color:inherit href=#hl-6-17>17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-6-18><a style=outline:none;text-decoration:none;color:inherit href=#hl-6-18>18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-6-19><a style=outline:none;text-decoration:none;color:inherit href=#hl-6-19>19</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-6-20><a style=outline:none;text-decoration:none;color:inherit href=#hl-6-20>20</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-6-21><a style=outline:none;text-decoration:none;color:inherit href=#hl-6-21>21</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-6-22><a style=outline:none;text-decoration:none;color:inherit href=#hl-6-22>22</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-6-23><a style=outline:none;text-decoration:none;color:inherit href=#hl-6-23>23</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-6-24><a style=outline:none;text-decoration:none;color:inherit href=#hl-6-24>24</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-6-25><a style=outline:none;text-decoration:none;color:inherit href=#hl-6-25>25</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-6-26><a style=outline:none;text-decoration:none;color:inherit href=#hl-6-26>26</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-6-27><a style=outline:none;text-decoration:none;color:inherit href=#hl-6-27>27</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-6-28><a style=outline:none;text-decoration:none;color:inherit href=#hl-6-28>28</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-6-29><a style=outline:none;text-decoration:none;color:inherit href=#hl-6-29>29</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-6-30><a style=outline:none;text-decoration:none;color:inherit href=#hl-6-30>30</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-6-31><a style=outline:none;text-decoration:none;color:inherit href=#hl-6-31>31</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-6-32><a style=outline:none;text-decoration:none;color:inherit href=#hl-6-32>32</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-6-33><a style=outline:none;text-decoration:none;color:inherit href=#hl-6-33>33</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-6-34><a style=outline:none;text-decoration:none;color:inherit href=#hl-6-34>34</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>calCorrelation</span>(cpool):
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;&#39;&#39;传入字典，形如{&#39;e&#39;:2,&#39;p&#39;:3}
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        返回可能性，0~1,值越大可能性越大
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        (correlation between the decrypted column letter frequencies and
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        the relative letter frequencies for normal English text)
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    &#39;&#39;&#39;</span>
</span></span><span style=display:flex><span>    frequencies <span style=color:#f92672>=</span> {<span style=color:#e6db74>&#34;e&#34;</span>: <span style=color:#ae81ff>0.12702</span>, <span style=color:#e6db74>&#34;t&#34;</span>: <span style=color:#ae81ff>0.09056</span>, <span style=color:#e6db74>&#34;a&#34;</span>: <span style=color:#ae81ff>0.08167</span>, <span style=color:#e6db74>&#34;o&#34;</span>: <span style=color:#ae81ff>0.07507</span>, <span style=color:#e6db74>&#34;i&#34;</span>: <span style=color:#ae81ff>0.06966</span>,
</span></span><span style=display:flex><span>                   <span style=color:#e6db74>&#34;n&#34;</span>: <span style=color:#ae81ff>0.06749</span>, <span style=color:#e6db74>&#34;s&#34;</span>: <span style=color:#ae81ff>0.06327</span>, <span style=color:#e6db74>&#34;h&#34;</span>: <span style=color:#ae81ff>0.06094</span>, <span style=color:#e6db74>&#34;r&#34;</span>: <span style=color:#ae81ff>0.05987</span>, <span style=color:#e6db74>&#34;d&#34;</span>: <span style=color:#ae81ff>0.04253</span>,
</span></span><span style=display:flex><span>                   <span style=color:#e6db74>&#34;l&#34;</span>: <span style=color:#ae81ff>0.04025</span>, <span style=color:#e6db74>&#34;c&#34;</span>: <span style=color:#ae81ff>0.02782</span>, <span style=color:#e6db74>&#34;u&#34;</span>: <span style=color:#ae81ff>0.02758</span>, <span style=color:#e6db74>&#34;m&#34;</span>: <span style=color:#ae81ff>0.02406</span>, <span style=color:#e6db74>&#34;w&#34;</span>: <span style=color:#ae81ff>0.02360</span>,
</span></span><span style=display:flex><span>                   <span style=color:#e6db74>&#34;f&#34;</span>: <span style=color:#ae81ff>0.02228</span>, <span style=color:#e6db74>&#34;g&#34;</span>: <span style=color:#ae81ff>0.02015</span>, <span style=color:#e6db74>&#34;y&#34;</span>: <span style=color:#ae81ff>0.01974</span>, <span style=color:#e6db74>&#34;p&#34;</span>: <span style=color:#ae81ff>0.01929</span>, <span style=color:#e6db74>&#34;b&#34;</span>: <span style=color:#ae81ff>0.01492</span>,
</span></span><span style=display:flex><span>                   <span style=color:#e6db74>&#34;v&#34;</span>: <span style=color:#ae81ff>0.00978</span>, <span style=color:#e6db74>&#34;k&#34;</span>: <span style=color:#ae81ff>0.00772</span>, <span style=color:#e6db74>&#34;j&#34;</span>: <span style=color:#ae81ff>0.00153</span>, <span style=color:#e6db74>&#34;x&#34;</span>: <span style=color:#ae81ff>0.00150</span>, <span style=color:#e6db74>&#34;q&#34;</span>: <span style=color:#ae81ff>0.00095</span>,
</span></span><span style=display:flex><span>                   <span style=color:#e6db74>&#34;z&#34;</span>: <span style=color:#ae81ff>0.00074</span>}
</span></span><span style=display:flex><span>    relative <span style=color:#f92672>=</span> <span style=color:#ae81ff>0.0</span>
</span></span><span style=display:flex><span>    total <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>    fpool <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;etaoinshrdlcumwfgypbvkjxqz&#39;</span>
</span></span><span style=display:flex><span>    total <span style=color:#f92672>=</span> sum(cpool<span style=color:#f92672>.</span>values())  <span style=color:#75715e># 总和应包括字母和其他可见字符</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> cpool<span style=color:#f92672>.</span>keys():
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> i <span style=color:#f92672>in</span> fpool:
</span></span><span style=display:flex><span>            relative <span style=color:#f92672>+=</span> frequencies[i] <span style=color:#f92672>*</span> cpool[i] <span style=color:#f92672>/</span> total
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> relative
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>analyseFrequency</span>(cfreq):
</span></span><span style=display:flex><span>    key <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> posFreq <span style=color:#f92672>in</span> cfreq:
</span></span><span style=display:flex><span>        mostRelative <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> keyChr <span style=color:#f92672>in</span> posFreq<span style=color:#f92672>.</span>keys():
</span></span><span style=display:flex><span>            r <span style=color:#f92672>=</span> calCorrelation(posFreq[keyChr])
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> r <span style=color:#f92672>&gt;</span> mostRelative:
</span></span><span style=display:flex><span>                mostRelative <span style=color:#f92672>=</span> r
</span></span><span style=display:flex><span>                keychar <span style=color:#f92672>=</span> keyChr
</span></span><span style=display:flex><span>        key<span style=color:#f92672>.</span>append(keychar)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> key
</span></span></code></pre></td></tr></table></div></div><h4 id=根据密钥解密>根据密钥解密<a hidden class=anchor aria-hidden=true href=#根据密钥解密>#</a></h4><p>求出密钥剩下的就好办了。</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-1>1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-2>2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-3>3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-4>4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-5>5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-6>6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-7>7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-8>8</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>vigenereDecrypt</span>(cipher, key):
</span></span><span style=display:flex><span>    plain <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span>
</span></span><span style=display:flex><span>    cur <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>    ll <span style=color:#f92672>=</span> len(key)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> c <span style=color:#f92672>in</span> cipher:
</span></span><span style=display:flex><span>        plain <span style=color:#f92672>+=</span> chr(c <span style=color:#f92672>^</span> key[cur])
</span></span><span style=display:flex><span>        cur <span style=color:#f92672>=</span> (cur <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>%</span> ll
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> plain
</span></span></code></pre></td></tr></table></div></div><h3 id=一些数据>一些数据<a hidden class=anchor aria-hidden=true href=#一些数据>#</a></h3><h4 id=可能的密钥长度和对应字符集>可能的密钥长度和对应字符集<a hidden class=anchor aria-hidden=true href=#可能的密钥长度和对应字符集>#</a></h4><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-13>13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-14>14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-15>15</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>{7: 
</span></span><span style=display:flex><span>[[162, 165, 168, 169, 170, 174, 175, 178, 179, 180, 184, 185, 186, 187, 189, 190, 191], 
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>[0, 2, 10, 11, 12, 17, 21, 23, 25, 26, 27, 28, 29, 30, 31, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95], 
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>[132, 133, 142, 144, 145, 146, 147, 148, 149, 150, 155, 159, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223], 
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>[161, 166, 167, 170, 173, 176, 177, 178, 179, 180, 181, 182, 183, 186, 188], 
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 68, 70, 72, 76, 78, 80, 81, 82, 83, 84, 86, 87, 90, 93], 
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>[128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 195, 196, 200, 201, 202, 204, 205, 206, 207, 208, 210, 213, 216, 217, 223], 
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>[33, 39, 43, 44, 52, 55, 57, 58, 59, 60, 61, 62, 63]
</span></span><span style=display:flex><span>]}
</span></span></code></pre></td></tr></table></div></div><h4 id=最后结果>最后结果<a hidden class=anchor aria-hidden=true href=#最后结果>#</a></h4><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-9-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-9-1>1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-9-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-9-2>2</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>[186, 31, 145, 178, 83, 205, 62] Cryptography is the practice and study of techniques for, among other things, secure communication in the presence of attackers. Cryptography has been used for hundreds, if not thousands, of years, but traditional cryptosystems were designed and evaluated in a fairly ad hoc manner. For example, the Vigenere encryption scheme was thought to be secure for decades after it was invented, but we now know, and this exercise demonstrates, that it can be broken very easily.
</span></span><span style=display:flex><span>[Finished in 2.2s]
</span></span></code></pre></td></tr></table></div></div><h3 id=解密代码全文>解密代码全文<a hidden class=anchor aria-hidden=true href=#解密代码全文>#</a></h3><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-1>  1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-2>  2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-3>  3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-4>  4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-5>  5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-6>  6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-7>  7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-8>  8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-9>  9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-10> 10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-11> 11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-12> 12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-13> 13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-14> 14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-15> 15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-16><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-16> 16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-17><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-17> 17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-18><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-18> 18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-19><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-19> 19</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-20><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-20> 20</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-21><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-21> 21</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-22><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-22> 22</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-23><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-23> 23</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-24><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-24> 24</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-25><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-25> 25</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-26><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-26> 26</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-27><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-27> 27</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-28><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-28> 28</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-29><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-29> 29</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-30><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-30> 30</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-31><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-31> 31</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-32><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-32> 32</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-33><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-33> 33</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-34><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-34> 34</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-35><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-35> 35</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-36><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-36> 36</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-37><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-37> 37</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-38><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-38> 38</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-39><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-39> 39</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-40><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-40> 40</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-41><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-41> 41</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-42><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-42> 42</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-43><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-43> 43</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-44><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-44> 44</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-45><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-45> 45</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-46><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-46> 46</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-47><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-47> 47</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-48><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-48> 48</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-49><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-49> 49</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-50><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-50> 50</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-51><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-51> 51</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-52><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-52> 52</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-53><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-53> 53</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-54><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-54> 54</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-55><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-55> 55</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-56><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-56> 56</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-57><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-57> 57</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-58><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-58> 58</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-59><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-59> 59</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-60><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-60> 60</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-61><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-61> 61</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-62><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-62> 62</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-63><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-63> 63</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-64><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-64> 64</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-65><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-65> 65</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-66><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-66> 66</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-67><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-67> 67</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-68><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-68> 68</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-69><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-69> 69</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-70><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-70> 70</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-71><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-71> 71</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-72><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-72> 72</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-73><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-73> 73</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-74><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-74> 74</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-75><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-75> 75</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-76><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-76> 76</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-77><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-77> 77</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-78><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-78> 78</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-79><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-79> 79</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-80><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-80> 80</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-81><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-81> 81</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-82><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-82> 82</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-83><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-83> 83</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-84><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-84> 84</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-85><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-85> 85</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-86><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-86> 86</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-87><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-87> 87</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-88><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-88> 88</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-89><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-89> 89</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-90><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-90> 90</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-91><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-91> 91</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-92><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-92> 92</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-93><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-93> 93</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-94><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-94> 94</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-95><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-95> 95</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-96><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-96> 96</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-97><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-97> 97</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-98><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-98> 98</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-99><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-99> 99</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-100><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-100>100</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-101><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-101>101</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-102><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-102>102</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-103><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-103>103</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-104><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-104>104</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-105><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-105>105</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-106><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-106>106</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-107><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-107>107</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-108><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-108>108</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-109><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-109>109</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-110><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-110>110</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-111><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-111>111</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-112><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-112>112</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-113><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-113>113</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-114><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-114>114</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-115><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-115>115</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-116><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-116>116</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-117><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-117>117</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-118><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-118>118</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-119><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-119>119</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-120><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-120>120</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-121><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-121>121</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-122><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-122>122</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-123><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-123>123</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-124><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-124>124</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-125><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-125>125</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-126><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-126>126</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-127><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-127>127</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-128><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-128>128</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-129><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-129>129</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-130><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-130>130</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-131><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-131>131</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-132><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-132>132</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-133><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-133>133</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-134><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-134>134</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-135><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-135>135</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-136><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-136>136</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># coding:utf8</span>
</span></span><span style=display:flex><span><span style=color:#75715e># by https://findneo.github.io/</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>getCipher</span>(file<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;code.txt&#39;</span>):
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;&#39;&#39;从文件中读取十六进制串，返回十六进制数组
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    &#39;&#39;&#39;</span>
</span></span><span style=display:flex><span>    c <span style=color:#f92672>=</span> open(file)<span style=color:#f92672>.</span>read()
</span></span><span style=display:flex><span>    codeintlist <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>    codeintlist<span style=color:#f92672>.</span>extend(
</span></span><span style=display:flex><span>        (map(<span style=color:#66d9ef>lambda</span> i: int(c[i:i <span style=color:#f92672>+</span> <span style=color:#ae81ff>2</span>], <span style=color:#ae81ff>16</span>), range(<span style=color:#ae81ff>0</span>, len(c), <span style=color:#ae81ff>2</span>))))
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> codeintlist
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>getKeyPool</span>(cipher, stepSet, plainSet, keySet):
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;&#39;&#39; 传入的密文串、明文字符集、密钥字符集、密钥长度范围均作为数字列表处理.形如[0x11,0x22,0x33]
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        返回一个字典，以可能的密钥长度为键，以对应的每一字节的密钥字符集构成的列表为值，密钥字符集为数字列表。
</span></span></span><span style=display:flex><span><span style=color:#e6db74>            形如{
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                    1:[[0x11]],
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                    3:[
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                        [0x11,0x33,0x46],
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                        [0x22,0x58],
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                        [0x33]
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                       ]
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                }
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    &#39;&#39;&#39;</span>
</span></span><span style=display:flex><span>    keyPool <span style=color:#f92672>=</span> dict()
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> step <span style=color:#f92672>in</span> stepSet:
</span></span><span style=display:flex><span>        maybe <span style=color:#f92672>=</span> [<span style=color:#66d9ef>None</span>] <span style=color:#f92672>*</span> step
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> pos <span style=color:#f92672>in</span> xrange(step):
</span></span><span style=display:flex><span>            maybe[pos] <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>for</span> k <span style=color:#f92672>in</span> keySet:
</span></span><span style=display:flex><span>                flag <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>for</span> c <span style=color:#f92672>in</span> cipher[pos::step]:
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>if</span> c <span style=color:#f92672>^</span> k <span style=color:#f92672>not</span> <span style=color:#f92672>in</span> plainSet:
</span></span><span style=display:flex><span>                        flag <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> flag:
</span></span><span style=display:flex><span>                    maybe[pos]<span style=color:#f92672>.</span>append(k)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> posPool <span style=color:#f92672>in</span> maybe:
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> len(posPool) <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>:
</span></span><span style=display:flex><span>                maybe <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>break</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> len(maybe) <span style=color:#f92672>!=</span> <span style=color:#ae81ff>0</span>:
</span></span><span style=display:flex><span>            keyPool[step] <span style=color:#f92672>=</span> maybe
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> keyPool
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>calCorrelation</span>(cpool):
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;&#39;&#39;传入字典，形如{&#39;e&#39;:2,&#39;p&#39;:3}
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        返回可能性，0~1,值越大可能性越大
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        (correlation between the decrypted column letter frequencies and
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        the relative letter frequencies for normal English text)
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    &#39;&#39;&#39;</span>
</span></span><span style=display:flex><span>    frequencies <span style=color:#f92672>=</span> {<span style=color:#e6db74>&#34;e&#34;</span>: <span style=color:#ae81ff>0.12702</span>, <span style=color:#e6db74>&#34;t&#34;</span>: <span style=color:#ae81ff>0.09056</span>, <span style=color:#e6db74>&#34;a&#34;</span>: <span style=color:#ae81ff>0.08167</span>, <span style=color:#e6db74>&#34;o&#34;</span>: <span style=color:#ae81ff>0.07507</span>, <span style=color:#e6db74>&#34;i&#34;</span>: <span style=color:#ae81ff>0.06966</span>,
</span></span><span style=display:flex><span>                   <span style=color:#e6db74>&#34;n&#34;</span>: <span style=color:#ae81ff>0.06749</span>, <span style=color:#e6db74>&#34;s&#34;</span>: <span style=color:#ae81ff>0.06327</span>, <span style=color:#e6db74>&#34;h&#34;</span>: <span style=color:#ae81ff>0.06094</span>, <span style=color:#e6db74>&#34;r&#34;</span>: <span style=color:#ae81ff>0.05987</span>, <span style=color:#e6db74>&#34;d&#34;</span>: <span style=color:#ae81ff>0.04253</span>,
</span></span><span style=display:flex><span>                   <span style=color:#e6db74>&#34;l&#34;</span>: <span style=color:#ae81ff>0.04025</span>, <span style=color:#e6db74>&#34;c&#34;</span>: <span style=color:#ae81ff>0.02782</span>, <span style=color:#e6db74>&#34;u&#34;</span>: <span style=color:#ae81ff>0.02758</span>, <span style=color:#e6db74>&#34;m&#34;</span>: <span style=color:#ae81ff>0.02406</span>, <span style=color:#e6db74>&#34;w&#34;</span>: <span style=color:#ae81ff>0.02360</span>,
</span></span><span style=display:flex><span>                   <span style=color:#e6db74>&#34;f&#34;</span>: <span style=color:#ae81ff>0.02228</span>, <span style=color:#e6db74>&#34;g&#34;</span>: <span style=color:#ae81ff>0.02015</span>, <span style=color:#e6db74>&#34;y&#34;</span>: <span style=color:#ae81ff>0.01974</span>, <span style=color:#e6db74>&#34;p&#34;</span>: <span style=color:#ae81ff>0.01929</span>, <span style=color:#e6db74>&#34;b&#34;</span>: <span style=color:#ae81ff>0.01492</span>,
</span></span><span style=display:flex><span>                   <span style=color:#e6db74>&#34;v&#34;</span>: <span style=color:#ae81ff>0.00978</span>, <span style=color:#e6db74>&#34;k&#34;</span>: <span style=color:#ae81ff>0.00772</span>, <span style=color:#e6db74>&#34;j&#34;</span>: <span style=color:#ae81ff>0.00153</span>, <span style=color:#e6db74>&#34;x&#34;</span>: <span style=color:#ae81ff>0.00150</span>, <span style=color:#e6db74>&#34;q&#34;</span>: <span style=color:#ae81ff>0.00095</span>,
</span></span><span style=display:flex><span>                   <span style=color:#e6db74>&#34;z&#34;</span>: <span style=color:#ae81ff>0.00074</span>}
</span></span><span style=display:flex><span>    relative <span style=color:#f92672>=</span> <span style=color:#ae81ff>0.0</span>
</span></span><span style=display:flex><span>    total <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>    fpool <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;etaoinshrdlcumwfgypbvkjxqz&#39;</span>
</span></span><span style=display:flex><span>    total <span style=color:#f92672>=</span> sum(cpool<span style=color:#f92672>.</span>values())  <span style=color:#75715e># 总和应包括字母和其他可见字符</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> cpool<span style=color:#f92672>.</span>keys():
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> i <span style=color:#f92672>in</span> fpool:
</span></span><span style=display:flex><span>            relative <span style=color:#f92672>+=</span> frequencies[i] <span style=color:#f92672>*</span> cpool[i] <span style=color:#f92672>/</span> total
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> relative
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>analyseFrequency</span>(cfreq):
</span></span><span style=display:flex><span>    key <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> posFreq <span style=color:#f92672>in</span> cfreq:
</span></span><span style=display:flex><span>        mostRelative <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> keyChr <span style=color:#f92672>in</span> posFreq<span style=color:#f92672>.</span>keys():
</span></span><span style=display:flex><span>            r <span style=color:#f92672>=</span> calCorrelation(posFreq[keyChr])
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> r <span style=color:#f92672>&gt;</span> mostRelative:
</span></span><span style=display:flex><span>                mostRelative <span style=color:#f92672>=</span> r
</span></span><span style=display:flex><span>                keychar <span style=color:#f92672>=</span> keyChr
</span></span><span style=display:flex><span>        key<span style=color:#f92672>.</span>append(keychar)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> key
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>getFrequency</span>(cipher, keyPoolList):
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;&#39;&#39; 传入的密文作为数字列表处理
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        传入密钥的字符集应为列表，依次包含各字节字符集。
</span></span></span><span style=display:flex><span><span style=color:#e6db74>            形如[[0x11,0x12],[0x22]]
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        返回字频列表，依次为各字节字符集中每一字符作为密钥组成部分时对应的明文字频
</span></span></span><span style=display:flex><span><span style=color:#e6db74>            形如[{
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                    0x11:{&#39;a&#39;:2,&#39;b&#39;:3},
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                    0x12:{&#39;e&#39;:6}
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                 },
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                 {
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                    0x22:{&#39;g&#39;:1}
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                 }]
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    &#39;&#39;&#39;</span>
</span></span><span style=display:flex><span>    freqList <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>    keyLen <span style=color:#f92672>=</span> len(keyPoolList)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> xrange(keyLen):
</span></span><span style=display:flex><span>        posFreq <span style=color:#f92672>=</span> dict()
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> k <span style=color:#f92672>in</span> keyPoolList[i]:
</span></span><span style=display:flex><span>            posFreq[k] <span style=color:#f92672>=</span> dict()
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>for</span> c <span style=color:#f92672>in</span> cipher[i::keyLen]:
</span></span><span style=display:flex><span>                p <span style=color:#f92672>=</span> chr(k <span style=color:#f92672>^</span> c)
</span></span><span style=display:flex><span>                posFreq[k][p] <span style=color:#f92672>=</span> posFreq[k][p] <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span> <span style=color:#66d9ef>if</span> p <span style=color:#f92672>in</span> posFreq[k] <span style=color:#66d9ef>else</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>        freqList<span style=color:#f92672>.</span>append(posFreq)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> freqList
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>vigenereDecrypt</span>(cipher, key):
</span></span><span style=display:flex><span>    plain <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span>
</span></span><span style=display:flex><span>    cur <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>    ll <span style=color:#f92672>=</span> len(key)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> c <span style=color:#f92672>in</span> cipher:
</span></span><span style=display:flex><span>        plain <span style=color:#f92672>+=</span> chr(c <span style=color:#f92672>^</span> key[cur])
</span></span><span style=display:flex><span>        cur <span style=color:#f92672>=</span> (cur <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>%</span> ll
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> plain
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>main</span>():
</span></span><span style=display:flex><span>    ps <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>    ks <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>    ss <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>    ps<span style=color:#f92672>.</span>extend(xrange(<span style=color:#ae81ff>32</span>, <span style=color:#ae81ff>127</span>))
</span></span><span style=display:flex><span>    ks<span style=color:#f92672>.</span>extend(xrange(<span style=color:#ae81ff>0xff</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>))
</span></span><span style=display:flex><span>    ss<span style=color:#f92672>.</span>extend(xrange(<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>14</span>))
</span></span><span style=display:flex><span>    cipher <span style=color:#f92672>=</span> getCipher()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    keyPool <span style=color:#f92672>=</span> getKeyPool(cipher<span style=color:#f92672>=</span>cipher, stepSet<span style=color:#f92672>=</span>ss, plainSet<span style=color:#f92672>=</span>ps, keySet<span style=color:#f92672>=</span>ks)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> keyPool:
</span></span><span style=display:flex><span>        freq <span style=color:#f92672>=</span> getFrequency(cipher, keyPool[i])
</span></span><span style=display:flex><span>        key <span style=color:#f92672>=</span> analyseFrequency(freq)
</span></span><span style=display:flex><span>        plain <span style=color:#f92672>=</span> vigenereDecrypt(cipher, key)
</span></span><span style=display:flex><span>        print key, plain
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> __name__ <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;__main__&#39;</span>:
</span></span><span style=display:flex><span>    main()
</span></span></code></pre></td></tr></table></div></div><h3 id=题目备份>题目备份<a hidden class=anchor aria-hidden=true href=#题目备份>#</a></h3><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-13>13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-14>14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-15>15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-16><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-16>16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-17><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-17>17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-18><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-18>18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-19><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-19>19</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-20><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-20>20</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-21><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-21>21</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-22><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-22>22</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-23><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-23>23</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-24><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-24>24</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-25><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-25>25</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-26><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-26>26</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-27><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-27>27</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-28><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-28>28</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-29><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-29>29</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-30><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-30>30</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-31><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-31>31</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-32><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-32>32</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-33><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-33>33</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-34><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-34>34</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-35><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-35>35</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-36><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-36>36</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-37><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-37>37</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span>http:<span style=color:#75715e>//ctf.nuptsast.com/static/uploads/13706e3281c1fb0c04417d3452cb745b/encode.cpp
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;stdio.h&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#define KEY_LENGTH 2 </span><span style=color:#75715e>// Can be anything from 1 to 13
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>main</span>(){
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>char</span> ch;
</span></span><span style=display:flex><span>  FILE <span style=color:#f92672>*</span>fpIn, <span style=color:#f92672>*</span>fpOut;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>int</span> i;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>char</span> key[KEY_LENGTH] <span style=color:#f92672>=</span> {<span style=color:#ae81ff>0x00</span>, <span style=color:#ae81ff>0x00</span>};
</span></span><span style=display:flex><span>  <span style=color:#75715e>/* of course, I did not use the all-0s key to encrypt */</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  fpIn <span style=color:#f92672>=</span> <span style=color:#a6e22e>fopen</span>(<span style=color:#e6db74>&#34;ptext.txt&#34;</span>, <span style=color:#e6db74>&#34;r&#34;</span>);
</span></span><span style=display:flex><span>  fpOut <span style=color:#f92672>=</span> <span style=color:#a6e22e>fopen</span>(<span style=color:#e6db74>&#34;ctext.txt&#34;</span>, <span style=color:#e6db74>&#34;w&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  i<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>while</span> (<span style=color:#a6e22e>fscanf</span>(fpIn, <span style=color:#e6db74>&#34;%c&#34;</span>, <span style=color:#f92672>&amp;</span>ch) <span style=color:#f92672>!=</span> EOF) {
</span></span><span style=display:flex><span>    <span style=color:#75715e>/* avoid encrypting newline characters */</span>  
</span></span><span style=display:flex><span>    <span style=color:#75715e>/* In a &#34;real-world&#34; implementation of the Vigenere cipher, 
</span></span></span><span style=display:flex><span><span style=color:#75715e>       every ASCII character in the plaintext would be encrypted.
</span></span></span><span style=display:flex><span><span style=color:#75715e>       However, I want to avoid encrypting newlines here because 
</span></span></span><span style=display:flex><span><span style=color:#75715e>       it makes recovering the plaintext slightly more difficult... */</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/* ...and my goal is not to create &#34;production-quality&#34; code =) */</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (ch<span style=color:#f92672>!=</span><span style=color:#e6db74>&#39;\n&#39;</span>) {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>fprintf</span>(fpOut, <span style=color:#e6db74>&#34;%02X&#34;</span>, ch <span style=color:#f92672>^</span> key[i <span style=color:#f92672>%</span> KEY_LENGTH]); <span style=color:#75715e>// ^ is logical XOR    
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      i<span style=color:#f92672>++</span>;
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>fclose</span>(fpIn);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>fclose</span>(fpOut);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span>;
</span></span><span style=display:flex><span>} 
</span></span><span style=display:flex><span><span style=color:#f92672>----------------------------------------------------------------------------------</span>
</span></span><span style=display:flex><span>http:<span style=color:#75715e>//ctf.nuptsast.com/static/uploads/9a27a6c8b9fb7b8d2a07ad94924c02e5/code.txt
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>F96DE8C227A259C87EE1DA2AED57C93FE5DA36ED4EC87EF2C63AAE5B9A7EFFD673BE4ACF7BE8923CAB1ECE7AF2DA3DA44FCF7AE29235A24C963FF0DF3CA3599A70E5DA36BF1ECE77F8DC34BE129A6CF4D126BF5B9A7CFEDF3EB850D37CF0C63AA2509A76FF9227A55B9A6FE3D720A850D97AB1DD35ED5FCE6BF0D138A84CC931B1F121B44ECE70F6C032BD56C33FF9D320ED5CDF7AFF9226BE5BDE3FF7DD21ED56CF71F5C036A94D963FF8D473A351CE3FE5DA3CB84DDB71F5C17FED51DC3FE8D732BF4D963FF3C727ED4AC87EF5DB27A451D47EFD9230BF47CA6BFEC12ABE4ADF72E29224A84CDF3FF5D720A459D47AF59232A35A9A7AE7D33FB85FCE7AF5923AA31EDB3FF7D33ABF52C33FF0D673A551D93FFCD33DA35BC831B1F43CBF1EDF67F0DF23A15B963FE5DA36ED68D378F4DC36BF5B9A7AFFD121B44ECE76FEDC73BE5DD27AFCD773BA5FC93FE5DA3CB859D26BB1C63CED5CDF3FE2D730B84CDF3FF7DD21ED5ADF7CF0D636BE1EDB79E5D721ED57CE3FE6D320ED57D469F4DC27A85A963FF3C727ED49DF3FFFDD24ED55D470E69E73AC50DE3FE5DA3ABE1EDF67F4C030A44DDF3FF5D73EA250C96BE3D327A84D963FE5DA32B91ED36BB1D132A31ED87AB1D021A255DF71B1C436BF479A7AF0C13AA14794
</span></span></code></pre></td></tr></table></div></div><h3 id=参考链接>参考链接<a hidden class=anchor aria-hidden=true href=#参考链接>#</a></h3><ul><li><a href=https://en.wikipedia.org/wiki/Index_of_coincidence>https://en.wikipedia.org/wiki/Index_of_coincidence</a></li><li><a href=https://en.wikipedia.org/wiki/One-time_pad>https://en.wikipedia.org/wiki/One-time_pad</a></li><li><a href=https://en.wikipedia.org/wiki/Vigen%C3%A8re_cipher>https://en.wikipedia.org/wiki/Vigen%C3%A8re_cipher</a></li><li><a href=https://en.wikipedia.org/wiki/Letter_frequency>https://en.wikipedia.org/wiki/Letter_frequency</a></li><li><a href=https://www.lijinma.com/blog/2014/05/29/amazing-xor/>https://www.lijinma.com/blog/2014/05/29/amazing-xor/</a></li><li><a href=http://blog.csdn.net/qq_31344951/article/details/77934717>http://blog.csdn.net/qq_31344951/article/details/77934717</a></li></ul></div><footer class=post-footer><ul class=post-tags></ul><nav class=paginav><a class=prev href=https://ret2neo.cn/post/171015miacwp/><span class=title>« Prev</span><br><span>2017 MIAC移动安全赛</span></a>
<a class=next href=https://ret2neo.cn/post/171004nuptzonghe2wp/><span class=title>Next »</span><br><span>南邮CTF平台综合题2writeup</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2026 <a href=https://ret2neo.cn/>闲言语</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2303473689051162" crossorigin=anonymous></script><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>