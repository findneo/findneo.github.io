<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>CTF中常见的RSA相关问题总结 | 闲言语</title><meta name=keywords content><meta name=description content="本文首发先知社区 ，转载请注明链接。
CTF中常见的RSA相关问题总结 前言 ​理解基本概念后，代码就可以说明一切，所以本文将每种攻击方式的实现方法都提炼成了一个函数，在理解原理时会有帮助，在需要时也可以直接调用。
基础 RSA概要 在开始前可以通过 《RSA算法详解》 这篇文章了解关于RSA的基础知识，包括加解密方法，算法原理和可行性证明等。
应用流程 选取两个较大的互不相等的质数p和q，计算n = p * q 。 计算phi = (p-1) * (q-1) 。 选取任意e，使得e满足 1<e<phi 且 gcd(e , phi) == 1 。 计算e关于 phi 的模逆元d， 即d满足(e * d)% phi ==1 。 加解密：c = (m ^ e) % n ， m = (c ^ d) % n 。其中m为明文，c为密文，(n,e)为公钥对，d为私钥，要求 0 <= m < n 。 理解模逆运算 如果 (a*b)%c==1 ，那么a和b互为对方模c的模逆元/数论倒数，也写作 。
关于最大公约数有一个基本事实：给予两整数a、c，必存在整数x、y使得ax + cy = gcd(a,c) ，基于这个事实，当a,c互素即gcd(a,c)==1 时，有ax+cy=1 ，那么就有(a*x)%c==1 ，所以x就是a 对c的模逆元。因此，a对c存在模逆元b的充要条件是gcd(a,c)==1 。显然对于每一组a,c ，存在一族满足条件的x，在求模逆元时我们取得是最小正整数解x mod n 。"><meta name=author content><link rel=canonical href=https://ret2neo.cn/post/180727rsa-attack/><link crossorigin=anonymous href=/assets/css/stylesheet.42b1e004fb78db2fc933d33c9db659598f62453f0de6f9db50c85e5936c0d8c3.css integrity="sha256-QrHgBPt42y/JM9M8nbZZWY9iRT8N5vnbUMheWTbA2MM=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://ret2neo.cn/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://ret2neo.cn/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://ret2neo.cn/favicon-32x32.png><link rel=apple-touch-icon href=https://ret2neo.cn/apple-touch-icon.png><link rel=mask-icon href=https://ret2neo.cn/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="CTF中常见的RSA相关问题总结"><meta property="og:description" content="本文首发先知社区 ，转载请注明链接。
CTF中常见的RSA相关问题总结 前言 ​理解基本概念后，代码就可以说明一切，所以本文将每种攻击方式的实现方法都提炼成了一个函数，在理解原理时会有帮助，在需要时也可以直接调用。
基础 RSA概要 在开始前可以通过 《RSA算法详解》 这篇文章了解关于RSA的基础知识，包括加解密方法，算法原理和可行性证明等。
应用流程 选取两个较大的互不相等的质数p和q，计算n = p * q 。 计算phi = (p-1) * (q-1) 。 选取任意e，使得e满足 1<e<phi 且 gcd(e , phi) == 1 。 计算e关于 phi 的模逆元d， 即d满足(e * d)% phi ==1 。 加解密：c = (m ^ e) % n ， m = (c ^ d) % n 。其中m为明文，c为密文，(n,e)为公钥对，d为私钥，要求 0 <= m < n 。 理解模逆运算 如果 (a*b)%c==1 ，那么a和b互为对方模c的模逆元/数论倒数，也写作 。
关于最大公约数有一个基本事实：给予两整数a、c，必存在整数x、y使得ax + cy = gcd(a,c) ，基于这个事实，当a,c互素即gcd(a,c)==1 时，有ax+cy=1 ，那么就有(a*x)%c==1 ，所以x就是a 对c的模逆元。因此，a对c存在模逆元b的充要条件是gcd(a,c)==1 。显然对于每一组a,c ，存在一族满足条件的x，在求模逆元时我们取得是最小正整数解x mod n 。"><meta property="og:type" content="article"><meta property="og:url" content="https://ret2neo.cn/post/180727rsa-attack/"><meta property="article:section" content="post"><meta property="article:published_time" content="2018-07-15T19:41:04+08:00"><meta property="article:modified_time" content="2018-07-15T19:41:04+08:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="CTF中常见的RSA相关问题总结"><meta name=twitter:description content="本文首发先知社区 ，转载请注明链接。
CTF中常见的RSA相关问题总结 前言 ​理解基本概念后，代码就可以说明一切，所以本文将每种攻击方式的实现方法都提炼成了一个函数，在理解原理时会有帮助，在需要时也可以直接调用。
基础 RSA概要 在开始前可以通过 《RSA算法详解》 这篇文章了解关于RSA的基础知识，包括加解密方法，算法原理和可行性证明等。
应用流程 选取两个较大的互不相等的质数p和q，计算n = p * q 。 计算phi = (p-1) * (q-1) 。 选取任意e，使得e满足 1<e<phi 且 gcd(e , phi) == 1 。 计算e关于 phi 的模逆元d， 即d满足(e * d)% phi ==1 。 加解密：c = (m ^ e) % n ， m = (c ^ d) % n 。其中m为明文，c为密文，(n,e)为公钥对，d为私钥，要求 0 <= m < n 。 理解模逆运算 如果 (a*b)%c==1 ，那么a和b互为对方模c的模逆元/数论倒数，也写作 。
关于最大公约数有一个基本事实：给予两整数a、c，必存在整数x、y使得ax + cy = gcd(a,c) ，基于这个事实，当a,c互素即gcd(a,c)==1 时，有ax+cy=1 ，那么就有(a*x)%c==1 ，所以x就是a 对c的模逆元。因此，a对c存在模逆元b的充要条件是gcd(a,c)==1 。显然对于每一组a,c ，存在一族满足条件的x，在求模逆元时我们取得是最小正整数解x mod n 。"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://ret2neo.cn/post/"},{"@type":"ListItem","position":2,"name":"CTF中常见的RSA相关问题总结","item":"https://ret2neo.cn/post/180727rsa-attack/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"CTF中常见的RSA相关问题总结","name":"CTF中常见的RSA相关问题总结","description":"本文首发先知社区 ，转载请注明链接。\nCTF中常见的RSA相关问题总结 前言 ​理解基本概念后，代码就可以说明一切，所以本文将每种攻击方式的实现方法都提炼成了一个函数，在理解原理时会有帮助，在需要时也可以直接调用。\n基础 RSA概要 在开始前可以通过 《RSA算法详解》 这篇文章了解关于RSA的基础知识，包括加解密方法，算法原理和可行性证明等。\n应用流程 选取两个较大的互不相等的质数p和q，计算n = p * q 。 计算phi = (p-1) * (q-1) 。 选取任意e，使得e满足 1\u0026lt;e\u0026lt;phi 且 gcd(e , phi) == 1 。 计算e关于 phi 的模逆元d， 即d满足(e * d)% phi ==1 。 加解密：c = (m ^ e) % n ， m = (c ^ d) % n 。其中m为明文，c为密文，(n,e)为公钥对，d为私钥，要求 0 \u0026lt;= m \u0026lt; n 。 理解模逆运算 如果 (a*b)%c==1 ，那么a和b互为对方模c的模逆元/数论倒数，也写作 。\n关于最大公约数有一个基本事实：给予两整数a、c，必存在整数x、y使得ax + cy = gcd(a,c) ，基于这个事实，当a,c互素即gcd(a,c)==1 时，有ax+cy=1 ，那么就有(a*x)%c==1 ，所以x就是a 对c的模逆元。因此，a对c存在模逆元b的充要条件是gcd(a,c)==1 。显然对于每一组a,c ，存在一族满足条件的x，在求模逆元时我们取得是最小正整数解x mod n 。","keywords":[],"articleBody":"本文首发先知社区 ，转载请注明链接。\nCTF中常见的RSA相关问题总结 前言 ​理解基本概念后，代码就可以说明一切，所以本文将每种攻击方式的实现方法都提炼成了一个函数，在理解原理时会有帮助，在需要时也可以直接调用。\n基础 RSA概要 在开始前可以通过 《RSA算法详解》 这篇文章了解关于RSA的基础知识，包括加解密方法，算法原理和可行性证明等。\n应用流程 选取两个较大的互不相等的质数p和q，计算n = p * q 。 计算phi = (p-1) * (q-1) 。 选取任意e，使得e满足 1","wordCount":"2523","inLanguage":"en","datePublished":"2018-07-15T19:41:04+08:00","dateModified":"2018-07-15T19:41:04+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://ret2neo.cn/post/180727rsa-attack/"},"publisher":{"@type":"Organization","name":"闲言语","logo":{"@type":"ImageObject","url":"https://ret2neo.cn/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://ret2neo.cn/ accesskey=h title="闲言语 (Alt + H)">闲言语</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://ret2neo.cn/mind/ title=随笔><span>随笔</span></a></li><li><a href=https://ret2neo.cn/about title=关于><span>关于</span></a></li><li><a href=https://ret2neo.cn/search title="搜索 (Alt + /)" accesskey=/><span>搜索</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>CTF中常见的RSA相关问题总结</h1><div class=post-meta><span title='2018-07-15 19:41:04 +0800 CST'>July 15, 2018</span>&nbsp;|&nbsp;<a href=https://github.dev/findneo/priblog/content/post/180727rsa-attack.md rel="noopener noreferrer" target=_blank>edit</a></div></header><aside id=toc-container class="toc-container wide"><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>目录</span></summary><div class=inner><ul><li><a href=#ctf%e4%b8%ad%e5%b8%b8%e8%a7%81%e7%9a%84rsa%e7%9b%b8%e5%85%b3%e9%97%ae%e9%a2%98%e6%80%bb%e7%bb%93 aria-label=CTF中常见的RSA相关问题总结>CTF中常见的RSA相关问题总结</a></li><li><a href=#%e5%89%8d%e8%a8%80 aria-label=前言>前言</a></li><li><a href=#%e5%9f%ba%e7%a1%80 aria-label=基础>基础</a><ul><li><a href=#rsa%e6%a6%82%e8%a6%81 aria-label=RSA概要>RSA概要</a></li><li><a href=#%e5%ba%94%e7%94%a8%e6%b5%81%e7%a8%8b aria-label=应用流程>应用流程</a></li><li><a href=#%e7%90%86%e8%a7%a3%e6%a8%a1%e9%80%86%e8%bf%90%e7%ae%97 aria-label=理解模逆运算>理解模逆运算</a></li><li><a href=#%e6%a8%a1%e6%84%8f%e4%b9%89%e4%b8%8b%e7%9a%84%e8%bf%90%e7%ae%97%e6%b3%95%e5%88%99 aria-label=模意义下的运算法则>模意义下的运算法则</a></li><li><a href=#%e6%ac%a7%e5%87%a0%e9%87%8c%e5%be%97%e7%ae%97%e6%b3%95 aria-label=欧几里得算法>欧几里得算法</a></li><li><a href=#%e6%89%a9%e5%b1%95%e6%ac%a7%e5%87%a0%e9%87%8c%e5%be%97%e7%ae%97%e6%b3%95 aria-label=扩展欧几里得算法>扩展欧几里得算法</a></li><li><a href=#%e4%b8%ad%e5%9b%bd%e5%89%a9%e4%bd%99%e5%ae%9a%e7%90%86 aria-label=中国剩余定理>中国剩余定理</a></li></ul></li><li><a href=#%e5%b8%b8%e8%a7%81%e6%94%bb%e5%87%bb%e6%96%b9%e5%bc%8f%e5%ae%9e%e8%b7%b5 aria-label=常见攻击方式实践>常见攻击方式实践</a><ul><li><a href=#%e5%87%86%e5%a4%87%e5%b7%a5%e5%85%b7 aria-label=准备工具>准备工具</a></li><li><a href=#rsa%e8%a7%a3%e5%af%86 aria-label=RSA解密>RSA解密</a></li><li><a href=#%e6%9f%a5%e8%af%a2%e5%b7%b2%e7%9f%a5%e7%9a%84n%e7%9a%84%e5%8f%af%e5%88%86%e8%a7%a3%e6%83%85%e5%86%b5 aria-label=查询已知的n的可分解情况>查询已知的n的可分解情况</a></li><li><a href=#%e4%bd%bf%e7%94%a8yafu%e5%88%86%e8%a7%a3n aria-label=使用yafu分解N>使用yafu分解N</a></li><li><a href=#%e6%a8%a1%e4%b8%8d%e4%ba%92%e7%b4%a0gcdn1n21 aria-label="模不互素	（gcd(N1,N2)!=1）">模不互素 （<code>gcd(N1,N2)!=1</code>）</a></li><li><a href=#%e5%85%b1%e6%a8%a1%e6%94%bb%e5%87%bb aria-label=共模攻击>共模攻击</a><ul><li><a href=#%e4%be%8b%e5%ad%90qctf2018-xman%e9%80%89%e6%8b%94%e8%b5%9b--xman-rsa-%e5%85%b1%e6%a8%a1%e6%94%bb%e5%87%bb%e6%a8%a1%e4%b8%8d%e4%ba%92%e7%b4%a0 aria-label="例子：QCTF2018-XMan选拔赛 / Xman-RSA 【共模攻击+模不互素】">例子：QCTF2018-XMan选拔赛 / Xman-RSA 【共模攻击+模不互素】</a></li></ul></li><li><a href=#%e5%b0%8f%e6%98%8e%e6%96%87%e6%94%bb%e5%87%bb aria-label=小明文攻击>小明文攻击</a><ul><li><a href=#%e4%be%8b%e5%ad%90extremely-hard-rsa aria-label="例子：Extremely hard RSA">例子：Extremely hard RSA</a></li></ul></li><li><a href=#rabin%e5%8a%a0%e5%af%86%e4%b8%ad%e7%9a%84n%e5%8f%af%e8%a2%ab%e5%88%86%e8%a7%a3 aria-label=Rabin加密中的N可被分解>Rabin加密中的N可被分解</a><ul><li><a href=#%e4%be%8b%e5%ad%90jarvis-oj-hard-rsa aria-label="例子：Jarvis OJ hard RSA">例子：Jarvis OJ hard RSA</a></li></ul></li><li><a href=#wieners-attack aria-label="Wiener&amp;rsquo;s Attack">Wiener&rsquo;s Attack</a><ul><li><a href=#%e4%be%8b%e5%ad%902018%e5%bc%ba%e7%bd%91%e6%9d%afnextrsa-level2 aria-label=例子：2018强网杯nextrsa-Level2>例子：2018强网杯nextrsa-Level2</a></li></ul></li><li><a href=#%e7%a7%81%e9%92%a5%e6%96%87%e4%bb%b6%e4%bf%ae%e5%a4%8d aria-label=私钥文件修复>私钥文件修复</a><ul><li><a href=#%e4%be%8b%e5%ad%90jarvis-oj-god-like-rsa aria-label="例子：Jarvis OJ-God Like RSA">例子：Jarvis OJ-God Like RSA</a></li></ul></li><li><a href=#lsb-oracle-attack aria-label="LSB Oracle Attack">LSB Oracle Attack</a><ul><li><a href=#%e4%be%8b%e5%ad%90qctf2018-xman%e9%80%89%e6%8b%94%e8%b5%9bbaby-rsa aria-label="例子：QCTF2018-XMan选拔赛/Baby RSA">例子：QCTF2018-XMan选拔赛/Baby RSA</a></li></ul></li><li><a href=#%e9%80%89%e6%8b%a9%e5%af%86%e6%96%87%e6%94%bb%e5%87%bb aria-label=选择密文攻击>选择密文攻击</a></li><li><a href=#%e5%b9%bf%e6%92%ad%e6%94%bb%e5%87%bb aria-label=广播攻击>广播攻击</a><ul><li><a href=#%e4%be%8b%e5%ad%902018%e5%bc%ba%e7%bd%91%e6%9d%afnextrsa-level9 aria-label=例子：2018强网杯nextrsa-Level9>例子：2018强网杯nextrsa-Level9</a></li></ul></li></ul></li><li><a href=#%e5%85%b6%e4%bb%96%e4%be%8b%e9%a2%98 aria-label=其他例题>其他例题</a><ul><li><a href=#jarvis-oj-medium-rsa%e8%a7%a3%e6%9e%90%e5%85%ac%e9%92%a5%e6%96%87%e4%bb%b6 aria-label="【Jarvis OJ Medium RSA】解析公钥文件">【Jarvis OJ Medium RSA】解析公钥文件</a></li></ul></li><li><a href=#%e5%90%8e%e8%af%9d aria-label=后话>后话</a></li><li><a href=#%e5%8f%82%e8%80%83%e9%93%be%e6%8e%a5 aria-label=参考链接>参考链接</a></li></ul></div></details></div></aside><script>let activeElement,elements;window.addEventListener("DOMContentLoaded",function(){checkTocPosition(),elements=document.querySelectorAll("h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]"),activeElement=elements[0];const t=encodeURI(activeElement.getAttribute("id")).toLowerCase();document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active")},!1),window.addEventListener("resize",function(){checkTocPosition()},!1),window.addEventListener("scroll",()=>{activeElement=Array.from(elements).find(e=>{if(getOffsetTop(e)-window.pageYOffset>0&&getOffsetTop(e)-window.pageYOffset<window.innerHeight/2)return e})||activeElement,elements.forEach(e=>{const t=encodeURI(e.getAttribute("id")).toLowerCase();e===activeElement?document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active"):document.querySelector(`.inner ul li a[href="#${t}"]`).classList.remove("active")})},!1);const main=parseInt(getComputedStyle(document.body).getPropertyValue("--article-width"),10),toc=parseInt(getComputedStyle(document.body).getPropertyValue("--toc-width"),10),gap=parseInt(getComputedStyle(document.body).getPropertyValue("--gap"),10);function checkTocPosition(){const e=document.body.scrollWidth;e-main-toc*2-gap*4>0?document.getElementById("toc-container").classList.add("wide"):document.getElementById("toc-container").classList.remove("wide")}function getOffsetTop(e){if(!e.getClientRects().length)return 0;let t=e.getBoundingClientRect(),n=e.ownerDocument.defaultView;return t.top+n.pageYOffset}</script><div class=post-content><p><strong>本文首发<a href=https://xz.aliyun.com/t/2446>先知社区</a> ，转载请注明链接。</strong></p><h1 id=ctf中常见的rsa相关问题总结>CTF中常见的RSA相关问题总结<a hidden class=anchor aria-hidden=true href=#ctf中常见的rsa相关问题总结>#</a></h1><h1 id=前言>前言<a hidden class=anchor aria-hidden=true href=#前言>#</a></h1><p>​理解基本概念后，代码就可以说明一切，所以本文将每种攻击方式的实现方法都提炼成了一个函数，在理解原理时会有帮助，在需要时也可以直接调用。</p><h1 id=基础>基础<a hidden class=anchor aria-hidden=true href=#基础>#</a></h1><h2 id=rsa概要>RSA概要<a hidden class=anchor aria-hidden=true href=#rsa概要>#</a></h2><p>在开始前可以通过 <a href="http://www.guideep.com/read?guide=5676830073815040">《RSA算法详解》</a> 这篇文章了解关于RSA的基础知识，包括加解密方法，算法原理和可行性证明等。</p><h2 id=应用流程>应用流程<a hidden class=anchor aria-hidden=true href=#应用流程>#</a></h2><ol><li>选取两个较大的互不相等的质数p和q，计算<code>n = p * q</code> 。</li><li>计算<code>phi = (p-1) * (q-1)</code> 。</li><li>选取任意e，使得e满足 <code>1&lt;e&lt;phi</code> 且 <code>gcd(e , phi) == 1</code> 。</li><li>计算e关于 phi 的模逆元d， 即d满足<code>(e * d)% phi ==1</code> 。</li><li>加解密：<code>c = (m ^ e) % n</code> ， <code>m = (c ^ d) % n</code> 。其中m为明文，c为密文，(n,e)为公钥对，d为私钥，要求 <code>0 &lt;= m &lt; n</code> 。</li></ol><h2 id=理解模逆运算>理解模逆运算<a hidden class=anchor aria-hidden=true href=#理解模逆运算>#</a></h2><ul><li><p>如果<code> (a*b)%c==1</code> ，那么a和b互为对方模c的模逆元/数论倒数，也写作<img loading=lazy src=5e686ec51b2fa8fc2.png alt>
。</p></li><li><p>关于最大公约数有一个基本事实：<code>给予两整数a、c，必存在整数x、y使得ax + cy = gcd(a,c)</code> ，基于这个事实，当a,c互素即<code>gcd(a,c)==1</code> 时，有<code>ax+cy=1</code> ，那么就有<code>(a*x)%c==1</code> ，所以x就是a 对c的模逆元。因此，a对c存在模逆元b的充要条件是<code>gcd(a,c)==1</code> 。显然对于每一组<code>a,c</code> ，存在一族满足条件的x，在求模逆元时我们取得是最小正整数解<code>x mod n</code> 。</p></li><li><p>上述的基本事实很容易理解，因为a和c的最大公约数是gcd(a,b)，所以a和c都可表示为gcd(a,b)的整数倍，那么a和b的任意整系数的线性组合ax+by也必定能表示成gcd(a,c)的整数倍，他们当中最小的正整数就应该是gcd(a,c)。实际上最大公约数有一个定义就是：<code>a和b的最大公约数g是a和b的线性和中的最小正整数</code> 。</p><ul><li><p>求模逆元主要基于扩展欧几里得算法，贴一个Python实现：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-1>1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-2>2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-3>3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-4>4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-5>5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-6>6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-7>7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-8>8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-9>9</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span> <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>egcd</span> ( a , b ):
</span></span><span style=display:flex><span>     <span style=color:#66d9ef>if</span> (b <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>):
</span></span><span style=display:flex><span>         <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, a
</span></span><span style=display:flex><span>     <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>         x , y , q <span style=color:#f92672>=</span> egcd( b , a <span style=color:#f92672>%</span> b ) <span style=color:#75715e># q = GCD(a, b) = GCD(b, a%b)</span>
</span></span><span style=display:flex><span>         x , y <span style=color:#f92672>=</span> y, ( x <span style=color:#f92672>-</span> (a <span style=color:#f92672>//</span> b) <span style=color:#f92672>*</span> y )
</span></span><span style=display:flex><span>         <span style=color:#66d9ef>return</span> x, y, q 
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>mod_inv</span>(a,b):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> egcd(a,b)[<span style=color:#ae81ff>0</span>]<span style=color:#f92672>%</span>b <span style=color:#75715e>#求a模b得逆元</span>
</span></span></code></pre></td></tr></table></div></div></li></ul></li><li><p>求模逆也可直接利用gmpy2库。如 <code>import gmpy2;print gmpy2.invert(47,30)</code> 可求得47模30的逆为23。</p></li></ul><h2 id=模意义下的运算法则>模意义下的运算法则<a hidden class=anchor aria-hidden=true href=#模意义下的运算法则>#</a></h2><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-13>13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-14>14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-15>15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-16><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-16>16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-17><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-17>17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-18><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-18>18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-19><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-19>19</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-20><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-20>20</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span>(a <span style=color:#f92672>+</span> b) <span style=color:#f92672>%</span> n <span style=color:#960050;background-color:#1e0010>≡</span> (a <span style=color:#f92672>%</span> n <span style=color:#f92672>+</span> b <span style=color:#f92672>%</span> n) <span style=color:#f92672>%</span> <span style=color:#a6e22e>n</span>
</span></span><span style=display:flex><span>(a <span style=color:#f92672>-</span> b) <span style=color:#f92672>%</span> n <span style=color:#960050;background-color:#1e0010>≡</span> (a <span style=color:#f92672>%</span> n <span style=color:#f92672>-</span> b <span style=color:#f92672>%</span> n) <span style=color:#f92672>%</span> <span style=color:#a6e22e>n</span>
</span></span><span style=display:flex><span>(a <span style=color:#f92672>*</span> b) <span style=color:#f92672>%</span> n <span style=color:#960050;background-color:#1e0010>≡</span> (a <span style=color:#f92672>%</span> n <span style=color:#f92672>*</span> b <span style=color:#f92672>%</span> n) <span style=color:#f92672>%</span> <span style=color:#a6e22e>n</span>
</span></span><span style=display:flex><span>(a <span style=color:#f92672>^</span> b) <span style=color:#f92672>%</span> n <span style=color:#960050;background-color:#1e0010>≡</span> ((a <span style=color:#f92672>%</span> n) <span style=color:#f92672>^</span> b) <span style=color:#f92672>%</span> n <span style=color:#75715e>//幂运算
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>若</span> a <span style=color:#960050;background-color:#1e0010>≡</span> <span style=color:#a6e22e>b</span>(mod n) ,<span style=color:#960050;background-color:#1e0010>则</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>1.</span><span style=color:#960050;background-color:#1e0010>对于任意正整数</span>c,<span style=color:#960050;background-color:#1e0010>有</span>a<span style=color:#f92672>^</span>c <span style=color:#960050;background-color:#1e0010>≡</span> b<span style=color:#f92672>^</span><span style=color:#a6e22e>c</span>(mod n)
</span></span><span style=display:flex><span><span style=color:#ae81ff>2.</span><span style=color:#960050;background-color:#1e0010>对于任意整数</span>c,<span style=color:#960050;background-color:#1e0010>有</span>ac <span style=color:#960050;background-color:#1e0010>≡</span> <span style=color:#a6e22e>bc</span>(mod n),a<span style=color:#f92672>+</span>c <span style=color:#960050;background-color:#1e0010>≡</span> b<span style=color:#f92672>+</span><span style=color:#a6e22e>c</span>(mod n),
</span></span><span style=display:flex><span><span style=color:#ae81ff>3.</span><span style=color:#960050;background-color:#1e0010>若</span> c <span style=color:#960050;background-color:#1e0010>≡</span> <span style=color:#a6e22e>d</span>(mod n),<span style=color:#960050;background-color:#1e0010>则</span>a<span style=color:#f92672>-</span>c <span style=color:#960050;background-color:#1e0010>≡</span> b<span style=color:#f92672>-</span><span style=color:#a6e22e>d</span>(mod n),a<span style=color:#f92672>+</span>c <span style=color:#960050;background-color:#1e0010>≡</span> b<span style=color:#f92672>+</span><span style=color:#a6e22e>d</span>(mod n),ac <span style=color:#960050;background-color:#1e0010>≡</span> <span style=color:#a6e22e>bd</span>(mod n)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>如果</span>ac<span style=color:#960050;background-color:#1e0010>≡</span><span style=color:#a6e22e>bc</span> (mod m)<span style=color:#960050;background-color:#1e0010>，且</span>c<span style=color:#960050;background-color:#1e0010>和</span>m<span style=color:#960050;background-color:#1e0010>互质，则</span>a<span style=color:#960050;background-color:#1e0010>≡</span><span style=color:#a6e22e>b</span> (mod m<span style=color:#960050;background-color:#1e0010>）。</span>
</span></span><span style=display:flex><span>[<span style=color:#960050;background-color:#1e0010>理解：当且仅当</span>c<span style=color:#960050;background-color:#1e0010>和</span>m<span style=color:#960050;background-color:#1e0010>互质</span>,c<span style=color:#f92672>^-</span><span style=color:#ae81ff>1</span><span style=color:#960050;background-color:#1e0010>存在</span>,<span style=color:#960050;background-color:#1e0010>等式左右可同乘模逆。</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>除法规则：</span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>在模</span>n<span style=color:#960050;background-color:#1e0010>意义下，</span>a<span style=color:#f92672>/</span>b<span style=color:#960050;background-color:#1e0010>不再仅仅代表这两个数相除，而是指</span> a<span style=color:#f92672>+</span>k1<span style=color:#f92672>*</span>n <span style=color:#960050;background-color:#1e0010>和</span> b<span style=color:#f92672>+</span>k2<span style=color:#f92672>*</span>n<span style=color:#960050;background-color:#1e0010>这两个组数中任意两个相除，使商为整数</span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>因此也就可以理解，除以一个数等价于乘以它的逆</span>
</span></span><span style=display:flex><span>a<span style=color:#f92672>/</span>b <span style=color:#960050;background-color:#1e0010>≡</span> <span style=color:#a6e22e>c</span>(mod n) <span style=color:#f92672>&lt;=&gt;</span> a <span style=color:#960050;background-color:#1e0010>≡</span> c<span style=color:#f92672>*</span>(b<span style=color:#f92672>^-</span><span style=color:#ae81ff>1</span>) (mod n)<span style=color:#960050;background-color:#1e0010>，其中</span>b<span style=color:#960050;background-color:#1e0010>模</span>n<span style=color:#960050;background-color:#1e0010>的逆记作</span>b<span style=color:#960050;background-color:#1e0010>的负一次方。</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>费马小定理</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>a<span style=color:#960050;background-color:#1e0010>是整数</span>,p<span style=color:#960050;background-color:#1e0010>是质数</span>,<span style=color:#960050;background-color:#1e0010>则</span>a<span style=color:#f92672>^</span>p<span style=color:#f92672>==</span><span style=color:#a6e22e>a</span>(mod p),<span style=color:#960050;background-color:#1e0010>如果</span>a<span style=color:#960050;background-color:#1e0010>不是</span>p<span style=color:#960050;background-color:#1e0010>的倍数</span>,<span style=color:#960050;background-color:#1e0010>还有</span>a<span style=color:#f92672>^</span>(p<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>) <span style=color:#960050;background-color:#1e0010>≡</span> <span style=color:#ae81ff>1</span>(mod p)	
</span></span></code></pre></td></tr></table></div></div><p>推荐文章 <a href=https://blog.sengxian.com/algorithms/mod-world>模运算总结</a> 和 <a href=https://github.com/wujr5/algorithm-analysis-and-design/blob/master/relative-algorithm-learning/6-algorithm-about-modulo-operation.md>取模运算涉及的算法</a> 。</p><h2 id=欧几里得算法>欧几里得算法<a hidden class=anchor aria-hidden=true href=#欧几里得算法>#</a></h2><p>欧几里得算法是求最大公约数的算法, 也就是中学学的 <a href=https://zh.wikipedia.org/wiki/%E8%BC%BE%E8%BD%89%E7%9B%B8%E9%99%A4%E6%B3%95>辗转相除法</a> 。记 <code>gcd(a,b)</code> 为a和b的最大公约数，欧几里得算法的基本原理是<code>gcd(a,b)==gcd(b,a%b),(b!=0)</code> 和 <code>gcd(a,0)==a</code> 。</p><p>Python实现如下：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-1>1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-2>2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-3>3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-4>4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-5>5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-6>6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-7>7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-8>8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-9>9</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># 递归版</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>gcd</span>(a, b):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> a <span style=color:#66d9ef>if</span> <span style=color:#f92672>not</span> b <span style=color:#66d9ef>else</span> gcd(b, a <span style=color:#f92672>%</span> b)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 迭代版</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>gcd2</span>(a, b):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>while</span> b:
</span></span><span style=display:flex><span>        a, b <span style=color:#f92672>=</span> b, a <span style=color:#f92672>%</span> b
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> a
</span></span></code></pre></td></tr></table></div></div><h2 id=扩展欧几里得算法>扩展欧几里得算法<a hidden class=anchor aria-hidden=true href=#扩展欧几里得算法>#</a></h2><p>扩展欧几里得算法基于欧几里得算法，能够求出使得 <code>ax+by=gcd(a,b)</code> 的一组x,y。</p><p><a href=http://blog.miskcoo.com/2014/09/chinese-remainder-theorem#i-3>这篇文章</a> 解释得很到位，对照下图和以下递归版实现容易理解。</p><p><img loading=lazy src=38a284492263563dc.png alt></p><p>Python实现如下：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-13>13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-14>14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-15>15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-16><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-16>16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-17><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-17>17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-18><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-18>18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-19><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-19>19</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-20><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-20>20</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-21><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-21>21</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-22><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-22>22</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-23><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-23>23</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-24><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-24>24</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-25><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-25>25</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># 递归版</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>ext_euclid</span> ( a , b ):
</span></span><span style=display:flex><span>    <span style=color:#75715e># ref:https://zh.wikipedia.org/wiki/扩展欧几里得算法</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (b <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, a
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>        x1 , y1 , q <span style=color:#f92672>=</span> ext_euclid( b , a <span style=color:#f92672>%</span> b ) <span style=color:#75715e># q = GCD(a, b) = GCD(b, a%b)</span>
</span></span><span style=display:flex><span>        x , y <span style=color:#f92672>=</span> y1, ( x1 <span style=color:#f92672>-</span> (a <span style=color:#f92672>//</span> b) <span style=color:#f92672>*</span> y1 )
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> x, y, q
</span></span><span style=display:flex><span><span style=color:#75715e># 迭代版</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>egcd</span>(a, b):
</span></span><span style=display:flex><span>    <span style=color:#75715e># ref:https://blog.csdn.net/wyf12138/article/details/60476773</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> b <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> (<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, a)
</span></span><span style=display:flex><span>    x, y <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>    s1, s2 <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>    r, q <span style=color:#f92672>=</span> a <span style=color:#f92672>%</span> b, a <span style=color:#f92672>/</span> b
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>while</span> r:
</span></span><span style=display:flex><span>        m, n <span style=color:#f92672>=</span> x, y
</span></span><span style=display:flex><span>        x <span style=color:#f92672>=</span> s1 <span style=color:#f92672>-</span> x <span style=color:#f92672>*</span> q
</span></span><span style=display:flex><span>        y <span style=color:#f92672>=</span> s2 <span style=color:#f92672>-</span> y <span style=color:#f92672>*</span> q
</span></span><span style=display:flex><span>        s1, s2 <span style=color:#f92672>=</span> m, n
</span></span><span style=display:flex><span>        a, b <span style=color:#f92672>=</span> b, r
</span></span><span style=display:flex><span>        r, q <span style=color:#f92672>=</span> a <span style=color:#f92672>%</span> b, a <span style=color:#f92672>/</span> b
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> (x, y, b)
</span></span></code></pre></td></tr></table></div></div><h2 id=中国剩余定理>中国剩余定理<a hidden class=anchor aria-hidden=true href=#中国剩余定理>#</a></h2><p><a href=https://zh.wikipedia.org/wiki/%E4%B8%AD%E5%9B%BD%E5%89%A9%E4%BD%99%E5%AE%9A%E7%90%86>维基百科</a> 给出了简洁生动的说明:</p><p><img loading=lazy src=b53b0cb9b7d40e98e.png alt></p><p>参考以上说明进行的Python实现:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-11>11</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>CRT</span>(mi, ai):
</span></span><span style=display:flex><span>    <span style=color:#75715e># mi,ai分别表示模数和取模后的值,都为列表结构</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># Chinese Remainder Theorem</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># lcm=lambda x , y:x*y/gcd(x,y)</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># mul=lambda x , y:x*y</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># assert(reduce(mul,mi)==reduce(lcm,mi))</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># 以上可用于保证mi两两互质</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>assert</span> (isinstance(mi, list) <span style=color:#f92672>and</span> isinstance(ai, list))
</span></span><span style=display:flex><span>    M <span style=color:#f92672>=</span> reduce(<span style=color:#66d9ef>lambda</span> x, y: x <span style=color:#f92672>*</span> y, mi)
</span></span><span style=display:flex><span>    ai_ti_Mi <span style=color:#f92672>=</span> [a <span style=color:#f92672>*</span> (M <span style=color:#f92672>/</span> m) <span style=color:#f92672>*</span> gmpy2<span style=color:#f92672>.</span>invert(M <span style=color:#f92672>/</span> m, m) <span style=color:#66d9ef>for</span> (m, a) <span style=color:#f92672>in</span> zip(mi, ai)]
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> reduce(<span style=color:#66d9ef>lambda</span> x, y: x <span style=color:#f92672>+</span> y, ai_ti_Mi) <span style=color:#f92672>%</span> M
</span></span></code></pre></td></tr></table></div></div><p>以上程序将mi当作两两互质处理,实际上有时会遇到其他情况，这时就需要逐一两两合并方程组。我参照下图实现了一个互质与不互质两种情况下都能工作良好的中国剩余定理（解同余方程组）的Python程序。</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-13>13</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>GCRT</span>(mi, ai):
</span></span><span style=display:flex><span>    <span style=color:#75715e># mi,ai分别表示模数和取模后的值,都为列表结构</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>assert</span> (isinstance(mi, list) <span style=color:#f92672>and</span> isinstance(ai, list))
</span></span><span style=display:flex><span>    curm, cura <span style=color:#f92672>=</span> mi[<span style=color:#ae81ff>0</span>], ai[<span style=color:#ae81ff>0</span>]
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (m, a) <span style=color:#f92672>in</span> zip(mi[<span style=color:#ae81ff>1</span>:], ai[<span style=color:#ae81ff>1</span>:]):
</span></span><span style=display:flex><span>        d <span style=color:#f92672>=</span> gmpy2<span style=color:#f92672>.</span>gcd(curm, m)
</span></span><span style=display:flex><span>        c <span style=color:#f92672>=</span> a <span style=color:#f92672>-</span> cura
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>assert</span> (c <span style=color:#f92672>%</span> d <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>) <span style=color:#75715e>#不成立则不存在解</span>
</span></span><span style=display:flex><span>        K <span style=color:#f92672>=</span> c <span style=color:#f92672>/</span> d <span style=color:#f92672>*</span> gmpy2<span style=color:#f92672>.</span>invert(curm <span style=color:#f92672>/</span> d, m <span style=color:#f92672>/</span> d)
</span></span><span style=display:flex><span>        cura <span style=color:#f92672>+=</span> curm <span style=color:#f92672>*</span> K
</span></span><span style=display:flex><span>        curm <span style=color:#f92672>=</span> curm <span style=color:#f92672>*</span> m <span style=color:#f92672>/</span> d
</span></span><span style=display:flex><span>        cura <span style=color:#f92672>%=</span> curm
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> (cura <span style=color:#f92672>%</span> curm, curm) <span style=color:#75715e>#(解,最小公倍数)</span>
</span></span></code></pre></td></tr></table></div></div><p>图片截自 <a href=https://blog.csdn.net/qq_29980371/article/details/71053219>中国剩余定理（互质与不互质的情况）</a> 。</p><p><img loading=lazy src=45283458091c177b4.png alt></p><h1 id=常见攻击方式实践>常见攻击方式实践<a hidden class=anchor aria-hidden=true href=#常见攻击方式实践>#</a></h1><h2 id=准备工具>准备工具<a hidden class=anchor aria-hidden=true href=#准备工具>#</a></h2><ul><li>python<ul><li>gmpy2库<ul><li>Windows：可从https://pypi.org/project/gmpy2/#files 直接下载已编译的安装包。</li><li>Linux： <code>sudo apt install python-gmpy2</code></li></ul></li><li>libnum库：<ul><li><code>git clone https://github.com/hellman/libnum.git && cd libnum && python setup.py install</code></li></ul></li></ul></li><li>yafu<ul><li><a href=https://sourceforge.net/projects/yafu/>https://sourceforge.net/projects/yafu/</a></li></ul></li><li>RSATool2v17.exe</li></ul><h2 id=rsa解密>RSA解密<a hidden class=anchor aria-hidden=true href=#rsa解密>#</a></h2><p>若已知私钥d，则可以直接解密： <code>m=pow(c,d,n)</code> 。</p><p>若已知质数p和q，则通过依次计算欧拉函数值phi、私钥d可解密。简易实现如下：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-6-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-6-1>1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-6-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-6-2>2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-6-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-6-3>3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-6-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-6-4>4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-6-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-6-5>5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-6-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-6-6>6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-6-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-6-7>7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-6-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-6-8>8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-6-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-6-9>9</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>rsa_decrypt</span>(e, c, p, q):
</span></span><span style=display:flex><span>    phi <span style=color:#f92672>=</span> (p <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>*</span> (q <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>    n <span style=color:#f92672>=</span> p <span style=color:#f92672>*</span> q
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>try</span>:
</span></span><span style=display:flex><span>        d <span style=color:#f92672>=</span> gmpy2<span style=color:#f92672>.</span>invert(e, phi) <span style=color:#75715e>#求e模phi的逆</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> pow(c, d, n)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>except</span> <span style=color:#a6e22e>Exception</span> <span style=color:#66d9ef>as</span> e:
</span></span><span style=display:flex><span>        print <span style=color:#e6db74>&#34;e and phi are not coprime!&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>raise</span> e
</span></span></code></pre></td></tr></table></div></div><p>在选取加密指数e时要求phi，e互质，也就是<code>gcd(phi,e)==1</code> ，如果不满足是无法直接解密的。</p><p>为什么说这个呢？是因为有时会有乍一看有点奇怪的情况。比如SCTF2018的<code> Crypto - a number problem</code> ，题目是</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-1>1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-2>2</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>x<span style=color:#f92672>**</span><span style=color:#ae81ff>33</span><span style=color:#f92672>=</span><span style=color:#ae81ff>1926041757553905692219721422025224638913707</span> mod <span style=color:#ae81ff>3436415358139016629092568198745009225773259</span>
</span></span><span style=display:flex><span>tell me the smallest answer of x
</span></span></code></pre></td></tr></table></div></div><p>其中<code>n=3436415358139016629092568198745009225773259</code> 可以直接分解得到p,q，出<code>phi=(p-1)*(q-1)</code> ，然后惊奇地发现<code>gcd(phi,33)==3</code> 。这时如果对加密过程比较熟悉的话，就可以想到实际上公钥<code>e=11</code> ，明文是<code>m=x^3</code> ，应该先求出m。然后再爆破x。</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-1>1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-2>2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-3>3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-4>4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-5>5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-6>6</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>1000000</span>):
</span></span><span style=display:flex><span>    <span style=color:#75715e># 推荐使用gmpy2库运算，用pow开立方不可行</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> gmpy2<span style=color:#f92672>.</span>iroot(m <span style=color:#f92672>+</span> i <span style=color:#f92672>*</span> n, <span style=color:#ae81ff>3</span>)[<span style=color:#ae81ff>1</span>]:
</span></span><span style=display:flex><span>        x <span style=color:#f92672>=</span> gmpy2<span style=color:#f92672>.</span>iroot(m <span style=color:#f92672>+</span> i <span style=color:#f92672>*</span> n, <span style=color:#ae81ff>3</span>)[<span style=color:#ae81ff>0</span>]
</span></span><span style=display:flex><span>        <span style=color:#75715e># i==243277,x==9420391510958023</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>break</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=查询已知的n的可分解情况>查询已知的n的可分解情况<a hidden class=anchor aria-hidden=true href=#查询已知的n的可分解情况>#</a></h2><p>在线查询：https://factordb.com/</p><p>api接口：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-9-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-9-1>1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-9-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-9-2>2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-9-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-9-3>3</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>curl http://factordb.com/api?query<span style=color:#f92672>=</span><span style=color:#ae81ff>12345</span>
</span></span><span style=display:flex><span>response:
</span></span><span style=display:flex><span><span style=color:#f92672>{</span><span style=color:#e6db74>&#34;id&#34;</span>:<span style=color:#e6db74>&#34;12345&#34;</span>,<span style=color:#e6db74>&#34;status&#34;</span>:<span style=color:#e6db74>&#34;FF&#34;</span>,<span style=color:#e6db74>&#34;factors&#34;</span>:<span style=color:#f92672>[[</span><span style=color:#e6db74>&#34;3&#34;</span>,1<span style=color:#f92672>]</span>,<span style=color:#f92672>[</span><span style=color:#e6db74>&#34;5&#34;</span>,1<span style=color:#f92672>]</span>,<span style=color:#f92672>[</span><span style=color:#e6db74>&#34;823&#34;</span>,1<span style=color:#f92672>]]}</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=使用yafu分解n>使用yafu分解N<a hidden class=anchor aria-hidden=true href=#使用yafu分解n>#</a></h2><p><strong>适用情况：p,q相差较大或较小时可快速分解。</strong></p><p>使用方法：<code> yafu-x64.exe factor(233)</code> ，<code>yafu-x64.exe help</code></p><h2 id=模不互素gcdn1n21>模不互素 （<code>gcd(N1,N2)!=1</code>）<a hidden class=anchor aria-hidden=true href=#模不互素gcdn1n21>#</a></h2><p><strong>适用情况：存在两个或更多模数 ，且<code>gcd(N1,N2)!=1</code> 。</strong></p><p>多个模数n共用质数，则可以很容易利用欧几里得算法求得他们的质因数之一<code>gcd(N1,N2)</code> ，然后这个最大公约数可用于分解模数分别得到对应的p和q，即可进行解密。实现参照本文<code>欧几里得算法</code> 部分和<code>RSA解密</code> 部分。</p><h2 id=共模攻击>共模攻击<a hidden class=anchor aria-hidden=true href=#共模攻击>#</a></h2><p><strong>适用情况：明文m、模数n相同，公钥指数e、密文c不同，<code>gcd(e1,e2)==1</code></strong></p><p>对同一明文的多次加密使用相同的模数和不同的公钥指数可能导致共模攻击。简单证明见代码注释。</p><p>Python实现：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-12>12</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>common_modulus</span>(n, e1, e2, c1, c2):
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;&#34;&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    ref: https://crypto.stackexchange.com/questions/16283/how-to-use-common-modulus-attack
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    ∵gcd(e1,e2)==1,∴由扩展欧几里得算法，存在e1*s1+e2*s2==1
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    ∴m==m^1==m^(e1*s1+e2*s2)==((m^e1)^s1)*((m^e2)^s2)==(c1^s1)*(c2^s2)
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    &#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>assert</span> (libnum<span style=color:#f92672>.</span>gcd(e1, e2) <span style=color:#f92672>==</span> <span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>    _, s1, s2 <span style=color:#f92672>=</span> gmpy2<span style=color:#f92672>.</span>gcdext(e1, e2)
</span></span><span style=display:flex><span>    <span style=color:#75715e># 若s1&lt;0，则c1^s1==(c1^-1)^(-s1)，其中c1^-1为c1模n的逆元。</span>
</span></span><span style=display:flex><span>    m <span style=color:#f92672>=</span> pow(c1, s1, n) <span style=color:#66d9ef>if</span> s1 <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span> <span style=color:#66d9ef>else</span> pow(gmpy2<span style=color:#f92672>.</span>invert(c1, n), <span style=color:#f92672>-</span>s1, n)
</span></span><span style=display:flex><span>    m <span style=color:#f92672>*=</span> pow(c2, s2, n) <span style=color:#66d9ef>if</span> s2 <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span> <span style=color:#66d9ef>else</span> pow(gmpy2<span style=color:#f92672>.</span>invert(c2, n), <span style=color:#f92672>-</span>s2, n)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> m <span style=color:#f92672>%</span> n
</span></span></code></pre></td></tr></table></div></div><h3 id=例子qctf2018-xman选拔赛--xman-rsa-共模攻击模不互素>例子：QCTF2018-XMan选拔赛 / Xman-RSA 【共模攻击+模不互素】<a hidden class=anchor aria-hidden=true href=#例子qctf2018-xman选拔赛--xman-rsa-共模攻击模不互素>#</a></h3><p>这道题利用了共模攻击和模不互素。刚开始是一个字符替换，与本文无关。encryption.encrypted文件被做了字符替换，根据语法确定替换表，修复文件得到源文件如下。</p><p>题目附件见文末链接。</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-13>13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-14>14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-15>15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-16><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-16>16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-17><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-17>17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-18><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-18>18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-19><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-19>19</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-20><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-20>20</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-21><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-21>21</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-22><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-22>22</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-23><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-23>23</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-24><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-24>24</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-25><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-25>25</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-26><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-26>26</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-27><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-27>27</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-28><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-28>28</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-29><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-29>29</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-30><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-30>30</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-31><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-31>31</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-32><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-32>32</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-33><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-33>33</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-34><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-34>34</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-35><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-35>35</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-36><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-36>36</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-37><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-37>37</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-38><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-38>38</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-39><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-39>39</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-40><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-40>40</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-41><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-41>41</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-42><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-42>42</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-43><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-43>43</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-44><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-44>44</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-45><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-45>45</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-46><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-46>46</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-47><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-47>47</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-48><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-48>48</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-49><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-49>49</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-50><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-50>50</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-51><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-51>51</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-52><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-52>52</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-53><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-53>53</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-54><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-54>54</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-55><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-55>55</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-56><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-56>56</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-57><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-57>57</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-58><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-58>58</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-59><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-59>59</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-60><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-60>60</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-61><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-61>61</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-62><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-62>62</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-63><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-63>63</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-64><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-64>64</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-65><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-65>65</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-66><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-66>66</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-67><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-67>67</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-68><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-68>68</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-69><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-69>69</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-70><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-70>70</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-71><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-71>71</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-72><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-72>72</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-73><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-73>73</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>from</span> gmpy2 <span style=color:#f92672>import</span> is_prime
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> os <span style=color:#f92672>import</span> urandom
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> base64
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>bytes_to_num</span>(b):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> int(b<span style=color:#f92672>.</span>encode(<span style=color:#e6db74>&#39;hex&#39;</span>), <span style=color:#ae81ff>16</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>num_to_bytes</span>(n):
</span></span><span style=display:flex><span>    b <span style=color:#f92672>=</span> hex(n)[<span style=color:#ae81ff>2</span>:<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>]
</span></span><span style=display:flex><span>    b <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;0&#39;</span> <span style=color:#f92672>+</span> b <span style=color:#66d9ef>if</span> len(b) <span style=color:#f92672>%</span> <span style=color:#ae81ff>2</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>1</span> <span style=color:#66d9ef>else</span> b
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> b<span style=color:#f92672>.</span>decode(<span style=color:#e6db74>&#39;hex&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>get_a_prime</span>(l):
</span></span><span style=display:flex><span>    random_seed <span style=color:#f92672>=</span> urandom(l)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    num <span style=color:#f92672>=</span> bytes_to_num(random_seed)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>while</span> <span style=color:#66d9ef>True</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> is_prime(num):
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>break</span>
</span></span><span style=display:flex><span>        num <span style=color:#f92672>+=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> num
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>encrypt</span>(s, e, n):
</span></span><span style=display:flex><span>    p <span style=color:#f92672>=</span> bytes_to_num(s)
</span></span><span style=display:flex><span>    p <span style=color:#f92672>=</span> pow(p, e, n)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> num_to_bytes(p)<span style=color:#f92672>.</span>encode(<span style=color:#e6db74>&#39;hex&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>separate</span>(n):
</span></span><span style=display:flex><span>    p <span style=color:#f92672>=</span> n <span style=color:#f92672>%</span> <span style=color:#ae81ff>4</span>
</span></span><span style=display:flex><span>    t <span style=color:#f92672>=</span> (p <span style=color:#f92672>*</span> p) <span style=color:#f92672>%</span> <span style=color:#ae81ff>4</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> t <span style=color:#f92672>==</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>f <span style=color:#f92672>=</span> open(<span style=color:#e6db74>&#39;flag.txt&#39;</span>, <span style=color:#e6db74>&#39;r&#39;</span>)
</span></span><span style=display:flex><span>flag <span style=color:#f92672>=</span> f<span style=color:#f92672>.</span>read()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>msg1 <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>msg2 <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(len(flag)):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> separate(i):
</span></span><span style=display:flex><span>        msg2 <span style=color:#f92672>+=</span> flag[i]
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>        msg1 <span style=color:#f92672>+=</span> flag[i]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>p1 <span style=color:#f92672>=</span> get_a_prime(<span style=color:#ae81ff>128</span>)
</span></span><span style=display:flex><span>p2 <span style=color:#f92672>=</span> get_a_prime(<span style=color:#ae81ff>128</span>)
</span></span><span style=display:flex><span>p3 <span style=color:#f92672>=</span> get_a_prime(<span style=color:#ae81ff>128</span>)
</span></span><span style=display:flex><span>n1 <span style=color:#f92672>=</span> p1 <span style=color:#f92672>*</span> p2
</span></span><span style=display:flex><span>n2 <span style=color:#f92672>=</span> p1 <span style=color:#f92672>*</span> p3
</span></span><span style=display:flex><span>e <span style=color:#f92672>=</span> <span style=color:#ae81ff>0x1001</span>
</span></span><span style=display:flex><span>c1 <span style=color:#f92672>=</span> encrypt(msg1, e, n1)
</span></span><span style=display:flex><span>c2 <span style=color:#f92672>=</span> encrypt(msg2, e, n2)
</span></span><span style=display:flex><span>print(c1)
</span></span><span style=display:flex><span>print(c2)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>e1 <span style=color:#f92672>=</span> <span style=color:#ae81ff>0x1001</span>
</span></span><span style=display:flex><span>e2 <span style=color:#f92672>=</span> <span style=color:#ae81ff>0x101</span>
</span></span><span style=display:flex><span>p4 <span style=color:#f92672>=</span> get_a_prime(<span style=color:#ae81ff>128</span>)
</span></span><span style=display:flex><span>p5 <span style=color:#f92672>=</span> get_a_prime(<span style=color:#ae81ff>128</span>)
</span></span><span style=display:flex><span>n3 <span style=color:#f92672>=</span> p4 <span style=color:#f92672>*</span> p5
</span></span><span style=display:flex><span>c1 <span style=color:#f92672>=</span> num_to_bytes(pow(n1, e1, n3))<span style=color:#f92672>.</span>encode(<span style=color:#e6db74>&#39;hex&#39;</span>)
</span></span><span style=display:flex><span>c2 <span style=color:#f92672>=</span> num_to_bytes(pow(n1, e2, n3))<span style=color:#f92672>.</span>encode(<span style=color:#e6db74>&#39;hex&#39;</span>)
</span></span><span style=display:flex><span>print(c1)
</span></span><span style=display:flex><span>print(c2)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print(base64<span style=color:#f92672>.</span>b64encode(num_to_bytes(n2)))
</span></span><span style=display:flex><span>print(base64<span style=color:#f92672>.</span>b64encode(num_to_bytes(n3)))
</span></span></code></pre></td></tr></table></div></div><p>n2，n3已知，利用共模攻击得到n1，由<code>gcd(n1,n2)==p1</code> 分解n1，n2，就可解密得到两部分msg，拼接即可。</p><p>解题脚本如下：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-13>13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-14>14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-15>15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-16><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-16>16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-17><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-17>17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-18><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-18>18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-19><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-19>19</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-20><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-20>20</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-21><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-21>21</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-22><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-22>22</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-23><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-23>23</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-24><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-24>24</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-25><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-25>25</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-26><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-26>26</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-27><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-27>27</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-28><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-28>28</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-29><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-29>29</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-30><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-30>30</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-31><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-31>31</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-32><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-32>32</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-33><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-33>33</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-34><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-34>34</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-35><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-35>35</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-36><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-36>36</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-37><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-37>37</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-38><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-38>38</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-39><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-39>39</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-40><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-40>40</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-41><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-41>41</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-42><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-42>42</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-43><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-43>43</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-44><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-44>44</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-45><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-45>45</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-46><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-46>46</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-47><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-47>47</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-48><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-48>48</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-49><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-49>49</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-50><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-50>50</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-51><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-51>51</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-52><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-52>52</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-53><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-53>53</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-54><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-54>54</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># -*- coding: utf-8 -*-</span>
</span></span><span style=display:flex><span><span style=color:#75715e># by https://findneo.github.io/</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> base64
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> libnum
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> gmpy2
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>fix_py</span>():
</span></span><span style=display:flex><span>    <span style=color:#75715e># decode encryption.encrypted</span>
</span></span><span style=display:flex><span>    s1 <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;abdefghijklmpqrtuvwxyz&#39;</span>
</span></span><span style=display:flex><span>    s2 <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;dmenwfoxgpyhirasbktclu&#39;</span>
</span></span><span style=display:flex><span>    f1 <span style=color:#f92672>=</span> open(<span style=color:#e6db74>&#39;encryption.encrypted&#39;</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>with</span> open(<span style=color:#e6db74>&#39;encryption.py&#39;</span>, <span style=color:#e6db74>&#39;w&#39;</span>) <span style=color:#66d9ef>as</span> f2:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> f1<span style=color:#f92672>.</span>readlines():
</span></span><span style=display:flex><span>            tmp <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>for</span> j <span style=color:#f92672>in</span> i:
</span></span><span style=display:flex><span>                tmp <span style=color:#f92672>+=</span> s2[s1<span style=color:#f92672>.</span>index(j)] <span style=color:#66d9ef>if</span> j <span style=color:#f92672>in</span> s1 <span style=color:#66d9ef>else</span> j
</span></span><span style=display:flex><span>            f2<span style=color:#f92672>.</span>write(tmp)
</span></span><span style=display:flex><span><span style=color:#75715e># fix_py()</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>common_modulus</span>(n, e1, e2, c1, c2):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>assert</span> (libnum<span style=color:#f92672>.</span>gcd(e1, e2) <span style=color:#f92672>==</span> <span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>    _, s1, s2 <span style=color:#f92672>=</span> gmpy2<span style=color:#f92672>.</span>gcdext(e1, e2)
</span></span><span style=display:flex><span>    m <span style=color:#f92672>=</span> pow(c1, s1, n) <span style=color:#66d9ef>if</span> s1 <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span> <span style=color:#66d9ef>else</span> pow(gmpy2<span style=color:#f92672>.</span>invert(c1, n), <span style=color:#f92672>-</span>s1, n)
</span></span><span style=display:flex><span>    m <span style=color:#f92672>*=</span> pow(c2, s2, n) <span style=color:#66d9ef>if</span> s2 <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span> <span style=color:#66d9ef>else</span> pow(gmpy2<span style=color:#f92672>.</span>invert(c2, n), <span style=color:#f92672>-</span>s2, n)
</span></span><span style=display:flex><span>    m <span style=color:#f92672>%=</span> n
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> m
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>[n2, n3] <span style=color:#f92672>=</span> map(<span style=color:#66d9ef>lambda</span> x: int(base64<span style=color:#f92672>.</span>b64decode(x)<span style=color:#f92672>.</span>encode(<span style=color:#e6db74>&#39;hex&#39;</span>), <span style=color:#ae81ff>16</span>),
</span></span><span style=display:flex><span>               open(<span style=color:#e6db74>&#39;n2&amp;n3&#39;</span>)<span style=color:#f92672>.</span>readlines())
</span></span><span style=display:flex><span>[n1c1, n1c2] <span style=color:#f92672>=</span> map(<span style=color:#66d9ef>lambda</span> x: int(x, <span style=color:#ae81ff>16</span>), open(<span style=color:#e6db74>&#39;n1.encrypted&#39;</span>)<span style=color:#f92672>.</span>readlines())
</span></span><span style=display:flex><span>[msg1c1, msg2c2] <span style=color:#f92672>=</span> map(<span style=color:#66d9ef>lambda</span> x: int(x, <span style=color:#ae81ff>16</span>), open(<span style=color:#e6db74>&#39;ciphertext&#39;</span>)<span style=color:#f92672>.</span>readlines())
</span></span><span style=display:flex><span><span style=color:#75715e># 通过共模攻击得到n1</span>
</span></span><span style=display:flex><span>e1 <span style=color:#f92672>=</span> <span style=color:#ae81ff>0x1001</span>
</span></span><span style=display:flex><span>e2 <span style=color:#f92672>=</span> <span style=color:#ae81ff>0x101</span>
</span></span><span style=display:flex><span>n1 <span style=color:#f92672>=</span> common_modulus(n3, e1, e2, n1c1, n1c2)
</span></span><span style=display:flex><span><span style=color:#75715e># n1,n2有一个共有质因数p1</span>
</span></span><span style=display:flex><span><span style=color:#75715e># n1 += n3  # 存在n3比n1小的可能，并且确实如此;貌似主办方中途改题，把n1改成小于n3了。</span>
</span></span><span style=display:flex><span>p1 <span style=color:#f92672>=</span> gmpy2<span style=color:#f92672>.</span>gcd(n1, n2)
</span></span><span style=display:flex><span><span style=color:#66d9ef>assert</span> (p1 <span style=color:#f92672>!=</span> <span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>p2 <span style=color:#f92672>=</span> n1 <span style=color:#f92672>/</span> p1
</span></span><span style=display:flex><span>p3 <span style=color:#f92672>=</span> n2 <span style=color:#f92672>/</span> p1
</span></span><span style=display:flex><span>e <span style=color:#f92672>=</span> <span style=color:#ae81ff>0x1001</span>
</span></span><span style=display:flex><span>d1 <span style=color:#f92672>=</span> gmpy2<span style=color:#f92672>.</span>invert(e, (p1 <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>*</span> (p2 <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>))
</span></span><span style=display:flex><span>d2 <span style=color:#f92672>=</span> gmpy2<span style=color:#f92672>.</span>invert(e, (p1 <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>*</span> (p3 <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>))
</span></span><span style=display:flex><span>msg1 <span style=color:#f92672>=</span> pow(msg1c1, d1, n1)
</span></span><span style=display:flex><span>msg2 <span style=color:#f92672>=</span> pow(msg2c2, d2, n2)
</span></span><span style=display:flex><span>msg1 <span style=color:#f92672>=</span> hex(msg1)[<span style=color:#ae81ff>2</span>:]<span style=color:#f92672>.</span>decode(<span style=color:#e6db74>&#39;hex&#39;</span>)
</span></span><span style=display:flex><span>msg2 <span style=color:#f92672>=</span> hex(msg2)[<span style=color:#ae81ff>2</span>:]<span style=color:#f92672>.</span>decode(<span style=color:#e6db74>&#39;hex&#39;</span>)
</span></span><span style=display:flex><span>print msg1, msg2
</span></span><span style=display:flex><span><span style=color:#75715e># XA{RP0I_0Itrsigi s.y</span>
</span></span><span style=display:flex><span><span style=color:#75715e># MNCYT_55_neetnvmrap}</span>
</span></span><span style=display:flex><span><span style=color:#75715e># XMAN{CRYPT0_I5_50_Interestingvim rsa.py}</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=小明文攻击>小明文攻击<a hidden class=anchor aria-hidden=true href=#小明文攻击>#</a></h2><p><strong>适用情况：e较小，一般为3。</strong></p><p>公钥e很小，明文m也不大的话，于是<code>m^e=k*n+m</code> 中的的k值很小甚至为0，爆破k或直接开三次方即可。</p><p>Python实现：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-1>1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-2>2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-3>3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-4>4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-5>5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-6>6</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>small_msg</span>(e, n, c):
</span></span><span style=display:flex><span>    print time<span style=color:#f92672>.</span>asctime(), <span style=color:#e6db74>&#34;Let&#39;s waiting...&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> k <span style=color:#f92672>in</span> xrange(<span style=color:#ae81ff>200000000</span>):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> gmpy2<span style=color:#f92672>.</span>iroot(c <span style=color:#f92672>+</span> n <span style=color:#f92672>*</span> k, e)[<span style=color:#ae81ff>1</span>] <span style=color:#f92672>==</span> <span style=color:#ae81ff>1</span>:
</span></span><span style=display:flex><span>            print time<span style=color:#f92672>.</span>asctime(), <span style=color:#e6db74>&#34;...done!&#34;</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> gmpy2<span style=color:#f92672>.</span>iroot(c <span style=color:#f92672>+</span> n <span style=color:#f92672>*</span> k, <span style=color:#ae81ff>3</span>)[<span style=color:#ae81ff>0</span>]
</span></span></code></pre></td></tr></table></div></div><h3 id=例子extremely-hard-rsa>例子：Extremely hard RSA<a hidden class=anchor aria-hidden=true href=#例子extremely-hard-rsa>#</a></h3><p>题目提供的n是4096位的，e=3。</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-13>13</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> gmpy2<span style=color:#f92672>,</span>binascii<span style=color:#f92672>,</span>libnum<span style=color:#f92672>,</span>time
</span></span><span style=display:flex><span>n<span style=color:#f92672>=</span><span style=color:#ae81ff>0xB0BEE5E3E9E5A7E8D00B493355C618FC8C7D7D03B82E409951C182F398DEE3104580E7BA70D383AE5311475656E8A964D380CB157F48C951ADFA65DB0B122CA40E42FA709189B719A4F0D746E2F6069BAF11CEBD650F14B93C977352FD13B1EEA6D6E1DA775502ABFF89D3A8B3615FD0DB49B88A976BC20568489284E181F6F11E270891C8EF80017BAD238E363039A458470F1749101BC29949D3A4F4038D463938851579C7525A69984F15B5667F34209B70EB261136947FA123E549DFFF00601883AFD936FE411E006E4E93D1A00B0FEA541BBFC8C5186CB6220503A94B2413110D640C77EA54BA3220FC8F4CC6CE77151E29B3E06578C478BD1BEBE04589EF9A197F6F806DB8B3ECD826CAD24F5324CCDEC6E8FEAD2C2150068602C8DCDC59402CCAC9424B790048CCDD9327068095EFA010B7F196C74BA8C37B128F9E1411751633F78B7B9E56F71F77A1B4DAAD3FC54B5E7EF935D9A72FB176759765522B4BBC02E314D5C06B64D5054B7B096C601236E6CCF45B5E611C805D335DBAB0C35D226CC208D8CE4736BA39A0354426FAE006C7FE52D5267DCFB9C3884F51FDDFDF4A9794BCFE0E1557113749E6C8EF421DBA263AFF68739CE00ED80FD0022EF92D3488F76DEB62BDEF7BEA6026F22A1D25AA2A92D124414A8021FE0C174B9803E6BB5FAD75E186A946A17280770F1243F4387446CCCEB2222A965CC30B3929</span>
</span></span><span style=display:flex><span>e<span style=color:#f92672>=</span><span style=color:#ae81ff>3</span>
</span></span><span style=display:flex><span>res<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>c<span style=color:#f92672>=</span>int(open(<span style=color:#e6db74>&#39;extremelyhardRSA.rar/flag.enc&#39;</span>,<span style=color:#e6db74>&#39;rb&#39;</span>)<span style=color:#f92672>.</span>read()<span style=color:#f92672>.</span>encode(<span style=color:#e6db74>&#39;hex&#39;</span>),<span style=color:#ae81ff>16</span>)
</span></span><span style=display:flex><span>print time<span style=color:#f92672>.</span>asctime()
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> xrange(<span style=color:#ae81ff>200000000</span>):
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>if</span> gmpy2<span style=color:#f92672>.</span>iroot(c<span style=color:#f92672>+</span>n<span style=color:#f92672>*</span>i,<span style=color:#ae81ff>3</span>)[<span style=color:#ae81ff>1</span>]<span style=color:#f92672>==</span><span style=color:#ae81ff>1</span>:
</span></span><span style=display:flex><span>		res<span style=color:#f92672>=</span>gmpy2<span style=color:#f92672>.</span>iroot(c<span style=color:#f92672>+</span>n<span style=color:#f92672>*</span>i,<span style=color:#ae81ff>3</span>)[<span style=color:#ae81ff>0</span>]
</span></span><span style=display:flex><span>		print i,res
</span></span><span style=display:flex><span>		print libnum<span style=color:#f92672>.</span>n2s(res)
</span></span><span style=display:flex><span>		print time<span style=color:#f92672>.</span>asctime()
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>break</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=rabin加密中的n可被分解>Rabin加密中的N可被分解<a hidden class=anchor aria-hidden=true href=#rabin加密中的n可被分解>#</a></h2><p><strong>适用情况：e==2</strong></p><p>Rabin加密是RSA的衍生算法，e==2是Rabin加密典型特征，可以百度或阅读 <a href=https://en.wikipedia.org/wiki/Rabin_cryptosystem>https://en.wikipedia.org/wiki/Rabin_cryptosystem</a> 以了解到详细的说明，这里只关注解密方法。一般先通过其他方法分解得到p，q，然后解密。</p><p>Python实现：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-11>11</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>rabin_decrypt</span>(c, p, q, e<span style=color:#f92672>=</span><span style=color:#ae81ff>2</span>):
</span></span><span style=display:flex><span>    n <span style=color:#f92672>=</span> p <span style=color:#f92672>*</span> q
</span></span><span style=display:flex><span>    mp <span style=color:#f92672>=</span> pow(c, (p <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>/</span> <span style=color:#ae81ff>4</span>, p)
</span></span><span style=display:flex><span>    mq <span style=color:#f92672>=</span> pow(c, (q <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>/</span> <span style=color:#ae81ff>4</span>, q)
</span></span><span style=display:flex><span>    yp <span style=color:#f92672>=</span> gmpy2<span style=color:#f92672>.</span>invert(p, q)
</span></span><span style=display:flex><span>    yq <span style=color:#f92672>=</span> gmpy2<span style=color:#f92672>.</span>invert(q, p)
</span></span><span style=display:flex><span>    r <span style=color:#f92672>=</span> (yp <span style=color:#f92672>*</span> p <span style=color:#f92672>*</span> mq <span style=color:#f92672>+</span> yq <span style=color:#f92672>*</span> q <span style=color:#f92672>*</span> mp) <span style=color:#f92672>%</span> n
</span></span><span style=display:flex><span>    rr <span style=color:#f92672>=</span> n <span style=color:#f92672>-</span> r
</span></span><span style=display:flex><span>    s <span style=color:#f92672>=</span> (yp <span style=color:#f92672>*</span> p <span style=color:#f92672>*</span> mq <span style=color:#f92672>-</span> yq <span style=color:#f92672>*</span> q <span style=color:#f92672>*</span> mp) <span style=color:#f92672>%</span> n
</span></span><span style=display:flex><span>    ss <span style=color:#f92672>=</span> n <span style=color:#f92672>-</span> s
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> (r, rr, s, ss)
</span></span></code></pre></td></tr></table></div></div><p>函数返回四个数，这其中只有一个是我们想要的明文，需要通过其他方式验证，当然CTF中显然就是flag字眼了。</p><p>解密方法是参照维基百科的，截图如下：</p><p><img loading=lazy src=27d43eec75f20858e.png alt></p><h3 id=例子jarvis-oj-hard-rsa>例子：Jarvis OJ hard RSA<a hidden class=anchor aria-hidden=true href=#例子jarvis-oj-hard-rsa>#</a></h3><p>解题脚本</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-13>13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-14>14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-15>15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-16><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-16>16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-17><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-17>17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-18><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-18>18</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> gmpy2<span style=color:#f92672>,</span>libnum
</span></span><span style=display:flex><span>n<span style=color:#f92672>=</span><span style=color:#ae81ff>0xC2636AE5C3D8E43FFB97AB09028F1AAC6C0BF6CD3D70EBCA281BFFE97FBE30DD</span>
</span></span><span style=display:flex><span>p<span style=color:#f92672>=</span><span style=color:#ae81ff>275127860351348928173285174381581152299</span>
</span></span><span style=display:flex><span>q<span style=color:#f92672>=</span><span style=color:#ae81ff>319576316814478949870590164193048041239</span>
</span></span><span style=display:flex><span>e<span style=color:#f92672>=</span><span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>c<span style=color:#f92672>=</span>int(open(<span style=color:#e6db74>&#39;hardRSA.rar/flag.enc&#39;</span>,<span style=color:#e6db74>&#39;rb&#39;</span>)<span style=color:#f92672>.</span>read()<span style=color:#f92672>.</span>encode(<span style=color:#e6db74>&#39;hex&#39;</span>),<span style=color:#ae81ff>16</span>)
</span></span><span style=display:flex><span>mp<span style=color:#f92672>=</span>pow(c,(p<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>)<span style=color:#f92672>/</span><span style=color:#ae81ff>4</span>,p)
</span></span><span style=display:flex><span>mq<span style=color:#f92672>=</span>pow(c,(q<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>)<span style=color:#f92672>/</span><span style=color:#ae81ff>4</span>,q)
</span></span><span style=display:flex><span>yp<span style=color:#f92672>=</span>gmpy2<span style=color:#f92672>.</span>invert(p,q)
</span></span><span style=display:flex><span>yq<span style=color:#f92672>=</span>gmpy2<span style=color:#f92672>.</span>invert(q,p)
</span></span><span style=display:flex><span>r<span style=color:#f92672>=</span>(yp<span style=color:#f92672>*</span>p<span style=color:#f92672>*</span>mq<span style=color:#f92672>+</span>yq<span style=color:#f92672>*</span>q<span style=color:#f92672>*</span>mp)<span style=color:#f92672>%</span>n
</span></span><span style=display:flex><span>rr<span style=color:#f92672>=</span>n<span style=color:#f92672>-</span>r
</span></span><span style=display:flex><span>s<span style=color:#f92672>=</span>(yp<span style=color:#f92672>*</span>p<span style=color:#f92672>*</span>mq<span style=color:#f92672>-</span>yq<span style=color:#f92672>*</span>q<span style=color:#f92672>*</span>mp)<span style=color:#f92672>%</span>n
</span></span><span style=display:flex><span>ss<span style=color:#f92672>=</span>n<span style=color:#f92672>-</span>s
</span></span><span style=display:flex><span>print libnum<span style=color:#f92672>.</span>n2s(r)
</span></span><span style=display:flex><span>print libnum<span style=color:#f92672>.</span>n2s(rr)
</span></span><span style=display:flex><span>print libnum<span style=color:#f92672>.</span>n2s(s)
</span></span><span style=display:flex><span>print libnum<span style=color:#f92672>.</span>n2s(ss)
</span></span></code></pre></td></tr></table></div></div><h2 id=wieners-attack>Wiener&rsquo;s Attack<a hidden class=anchor aria-hidden=true href=#wieners-attack>#</a></h2><p><strong>适用情况：e过大或过小。</strong></p><p>工具：https://github.com/pablocelayes/rsa-wiener-attack</p><p>在e过大或过小的情况下，可使用算法从e中快速推断出d的值。详细的算法原理可以阅读：<a href=https://www.tr0y.wang/2017/11/06/CTFRSA/index.html#%E4%BD%8E%E8%A7%A3%E5%AF%86%E6%8C%87%E6%95%B0%E6%94%BB%E5%87%BB>低解密指数攻击</a> 。</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-13>13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-14>14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-15>15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-16><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-16>16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-17><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-17>17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-18><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-18>18</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>from</span> Crypto.PublicKey <span style=color:#f92672>import</span> RSA
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> ContinuedFractions<span style=color:#f92672>,</span> Arithmetic
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>wiener_hack</span>(e, n):
</span></span><span style=display:flex><span>    <span style=color:#75715e># firstly git clone https://github.com/pablocelayes/rsa-wiener-attack.git !</span>
</span></span><span style=display:flex><span>    frac <span style=color:#f92672>=</span> ContinuedFractions<span style=color:#f92672>.</span>rational_to_contfrac(e, n)
</span></span><span style=display:flex><span>    convergents <span style=color:#f92672>=</span> ContinuedFractions<span style=color:#f92672>.</span>convergents_from_contfrac(frac)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (k, d) <span style=color:#f92672>in</span> convergents:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> k <span style=color:#f92672>!=</span> <span style=color:#ae81ff>0</span> <span style=color:#f92672>and</span> (e <span style=color:#f92672>*</span> d <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>%</span> k <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>:
</span></span><span style=display:flex><span>            phi <span style=color:#f92672>=</span> (e <span style=color:#f92672>*</span> d <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>//</span> k
</span></span><span style=display:flex><span>            s <span style=color:#f92672>=</span> n <span style=color:#f92672>-</span> phi <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>            discr <span style=color:#f92672>=</span> s <span style=color:#f92672>*</span> s <span style=color:#f92672>-</span> <span style=color:#ae81ff>4</span> <span style=color:#f92672>*</span> n
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (discr <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>0</span>):
</span></span><span style=display:flex><span>                t <span style=color:#f92672>=</span> Arithmetic<span style=color:#f92672>.</span>is_perfect_square(discr)
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> t <span style=color:#f92672>!=</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span> <span style=color:#f92672>and</span> (s <span style=color:#f92672>+</span> t) <span style=color:#f92672>%</span> <span style=color:#ae81ff>2</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>:
</span></span><span style=display:flex><span>                    print(<span style=color:#e6db74>&#34;Hacked!&#34;</span>)
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>return</span> d
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>False</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=例子2018强网杯nextrsa-level2>例子：2018强网杯nextrsa-Level2<a hidden class=anchor aria-hidden=true href=#例子2018强网杯nextrsa-level2>#</a></h3><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-1>1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-2>2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-3>3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-4>4</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>n <span style=color:#f92672>=</span> <span style=color:#ae81ff>0x92411fa0c93c1b27f89e436d8c4698bcf554938396803a5b62bd10c9bfcbf85a483bd87bb2d6a8dc00c32d8a7caf30d8899d90cb8f5838cae95f7ff5358847db1244006c140edfcc36adbdcaa16cd27432b4d50d2348b5c15c209364d7914ef50425e4c3da07612cc34e9b93b98d394b43f3eb0a5a806c70f06697b6189606eb9707104a7b6ff059011bac957e2aae9ec406a4ff8f8062400d2312a207a9e018f4b4e961c943dfc410a26828d2e88b24e4100162228a5bbf0824cf2f1c8e7b915efa385efeb505a9746e5d19967766618007ddf0d99525e9a41997217484d64c6a879d762098b9807bee46a219be76941b9ff31465463981e230eecec69691d1</span>L
</span></span><span style=display:flex><span>e <span style=color:#f92672>=</span> <span style=color:#ae81ff>0x6f6b385dd0f06043c20a7d8e5920802265e1baab9d692e7c20b69391cc5635dbcaae59726ec5882f168b3a292bd52c976533d3ad498b7f561c3dc01a76597e47cfe60614f247551b3dbe200e2196eaa001a1d183886eeacddfe82d80b38aea24de1a337177683ed802942827ce4d28e20efef92f38f1b1a18c66f9b45f5148cceabfd736de8ac4a49e63a8d35a83b664f9f3b00f822b6f11ff13257ee6e0c00ca5c98e661ea594a9e66f2bd56b33d9a13f5c997e67a37fcf9a0c7f04d119fe1ba261127357e64a4b069aefed3049c1c1fe4f964fd078b88bedd064abea385cfebd65e563f93c12d34eb6426e8aa321033cfd8fe8855b9e74d07fe4f9d70de46f</span>L
</span></span><span style=display:flex><span>d <span style=color:#f92672>=</span> wiener_hack(e, n)
</span></span><span style=display:flex><span>print d  <span style=color:#75715e>#42043</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=私钥文件修复>私钥文件修复<a hidden class=anchor aria-hidden=true href=#私钥文件修复>#</a></h2><p><strong>适用情况：提供破损的私钥文件。</strong></p><h3 id=例子jarvis-oj-god-like-rsa>例子：Jarvis OJ-God Like RSA<a hidden class=anchor aria-hidden=true href=#例子jarvis-oj-god-like-rsa>#</a></h3><p>参考 <a href=https://www.40huo.cn/blog/rsa-private-key-recovery-and-oaep.html>https://www.40huo.cn/blog/rsa-private-key-recovery-and-oaep.html</a> 修复存储私钥的文件，得到p和q。</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-19-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-19-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-19-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-19-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-19-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-19-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-19-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-19-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-19-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-19-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-19-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-19-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-19-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-19-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-19-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-19-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-19-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-19-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-19-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-19-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-19-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-19-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-19-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-19-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-19-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-19-13>13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-19-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-19-14>14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-19-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-19-15>15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-19-16><a style=outline:none;text-decoration:none;color:inherit href=#hl-19-16>16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-19-17><a style=outline:none;text-decoration:none;color:inherit href=#hl-19-17>17</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> gmpy2<span style=color:#f92672>,</span>binascii<span style=color:#f92672>,</span>libnum<span style=color:#f92672>,</span>time
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> Crypto.PublicKey <span style=color:#f92672>import</span> RSA
</span></span><span style=display:flex><span><span style=color:#66d9ef>with</span> open(<span style=color:#e6db74>&#39;godlikeRSA.rar/pubkey.pem&#39;</span>, <span style=color:#e6db74>&#39;r&#39;</span>) <span style=color:#66d9ef>as</span> f:
</span></span><span style=display:flex><span>    key <span style=color:#f92672>=</span> RSA<span style=color:#f92672>.</span>importKey(f)
</span></span><span style=display:flex><span>    n <span style=color:#f92672>=</span> key<span style=color:#f92672>.</span>n
</span></span><span style=display:flex><span>    e <span style=color:#f92672>=</span> key<span style=color:#f92672>.</span>e
</span></span><span style=display:flex><span>p <span style=color:#f92672>=</span> <span style=color:#ae81ff>30061432003658510087798871614869318011389940352798147030129806359975911392091235344042288409629143229311060231549478211871643725394470760528211801310601767727834886942210718412087541234398453046895030858579989874035849439867334906873642352112428914855967993998732685221108379784833027771293275558876952608462050146340591449046825135890871650866799299533696175818103240024841274114925018619060818213433528894936128306780366785977567327073724428211445259983614467640785163297734447975723664659822673456683284394386723716344090232882990461174301609971805075768328757325956784604364401827152431260896927633163074694121679</span>
</span></span><span style=display:flex><span>q <span style=color:#f92672>=</span> <span style=color:#ae81ff>26136662545551829820746942051638228325025130519175536694008242208616774469870765684858288042819063837180243501117310278632509413217676559484513481677689042623348188876598901642459170232360966754692434316796014314498263800234390539118817050074978421973817764644287745302885861277447227180288605200894138168586207384484170481511828680117688324729381172912436910052489279406590356734739774635376711681212908417321705094537960645308009611045658947359297373154395500467689532455017647450616447445444254910371922944620114234547655209970657063715028350418518417105772707885648587233103869340985670430269862943630137067052883</span>
</span></span><span style=display:flex><span>print n<span style=color:#f92672>==</span>p<span style=color:#f92672>*</span>q
</span></span><span style=display:flex><span>phi<span style=color:#f92672>=</span>(p<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>)<span style=color:#f92672>*</span>(q<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>d<span style=color:#f92672>=</span>gmpy2<span style=color:#f92672>.</span>invert(e,phi)
</span></span><span style=display:flex><span>print e<span style=color:#f92672>*</span>d<span style=color:#f92672>%</span>phi
</span></span><span style=display:flex><span>c<span style=color:#f92672>=</span>int(open(<span style=color:#e6db74>&#39;godlikeRSA.rar/flag.enc&#39;</span>,<span style=color:#e6db74>&#39;rb&#39;</span>)<span style=color:#f92672>.</span>read()<span style=color:#f92672>.</span>encode(<span style=color:#e6db74>&#39;hex&#39;</span>),<span style=color:#ae81ff>16</span>)
</span></span><span style=display:flex><span>m<span style=color:#f92672>=</span>pow(c,d,n)
</span></span><span style=display:flex><span>print m
</span></span><span style=display:flex><span><span style=color:#75715e># 1370223550024951160390505387130177939237950112048472397389773634788136940247048803373180904499220116137720016277614401463947529601059601275191225565163007356175594695217230371190488219356030961008234353281422568670237109241798409859772276203338663213736672988507101836099731545753186306605979236795416523018072994981230167509019379957053839561135207769133885837247551721998502691458955042383536845772871317832519566606644011038158531192089650858814552702073939336587081668849526410118259284356539710136294431275218448114094635426857980426460905608258535404240097392254948848433684475139365021846569436926295331904560877283857331146381104141185386272078892946248648795223866902960499271054375730866146508724739787771837579817109380817612386428775429383894697178101165350212843220568133053034913426083965937819287414427916848075303046293039426388342757953620799736182799948741710617974079729792088434776370340095313622264898772452440870247810948774919910578850614282925852564445288646487485017449052934955175051072066751519784123645584671119185023928739438748519535869994754998423784897445884244844154563303115861175492133906368196005147361767160830004522010287149025190543608485818909441439294996482797249312140402141744752129890112</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 明文是这个，flag是啥不知道</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=lsb-oracle-attack>LSB Oracle Attack<a hidden class=anchor aria-hidden=true href=#lsb-oracle-attack>#</a></h2><p><strong>适用情况：可以选择密文并泄露最低位。</strong></p><p>在一次RSA加密中，明文为m，模数为n，加密指数为e，密文为c。我们可以构造出<code>c'=((2^e)*c)%n=((2^e)*(m^e))%n=((2*m)^e)%n</code> ， 因为m的两倍可能大于n，所以经过解密得到的明文是 <code>m'=(2*m)%n</code> 。我们还能够知道 <code>m'</code> 的最低位<code>lsb</code> 是1还是0。 因为n是奇数，而<code>2*m</code> 是偶数，所以如果<code>lsb</code> 是0，说明<code>(2*m)%n</code> 是偶数，没有超过n，即<code>m&lt;n/2.0</code> ，反之则<code>m>n/2.0</code> 。举个例子就能明白<code>2%3=2</code> 是偶数，而<code>4%3=1</code> 是奇数。以此类推，构造密文<code>c"=(4^e)*c)%n</code> 使其解密后为<code>m"=(4*m)%n</code> ，判断<code>m"</code> 的奇偶性可以知道<code>m</code> 和 <code>n/4</code> 的大小关系。所以我们就有了一个二分算法，可以在对数时间内将m的范围逼近到一个足够狭窄的空间。</p><p>更多信息可参考：<a href=https://introspelliam.github.io/2018/03/27/crypto/RSA-Least-Significant-Bit-Oracle-Attack/>RSA Least-Significant-Bit Oracle Attack</a> 和 <a href=https://crypto.stackexchange.com/questions/11053/rsa-least-significant-bit-oracle-attack>RSA least significant bit oracle attack</a> 。</p><p>Python实现：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-20-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-20-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-20-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-20-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-20-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-20-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-20-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-20-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-20-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-20-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-20-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-20-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-20-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-20-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-20-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-20-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-20-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-20-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-20-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-20-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-20-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-20-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-20-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-20-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-20-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-20-13>13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-20-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-20-14>14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-20-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-20-15>15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-20-16><a style=outline:none;text-decoration:none;color:inherit href=#hl-20-16>16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-20-17><a style=outline:none;text-decoration:none;color:inherit href=#hl-20-17>17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-20-18><a style=outline:none;text-decoration:none;color:inherit href=#hl-20-18>18</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> decimal
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>oracle</span>():
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> lsb <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;odd&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>partial</span>(c, e, n):
</span></span><span style=display:flex><span>    k <span style=color:#f92672>=</span> n<span style=color:#f92672>.</span>bit_length()
</span></span><span style=display:flex><span>    decimal<span style=color:#f92672>.</span>getcontext()<span style=color:#f92672>.</span>prec <span style=color:#f92672>=</span> k  <span style=color:#75715e># for &#39;precise enough&#39; floats</span>
</span></span><span style=display:flex><span>    lo <span style=color:#f92672>=</span> decimal<span style=color:#f92672>.</span>Decimal(<span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>    hi <span style=color:#f92672>=</span> decimal<span style=color:#f92672>.</span>Decimal(n)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(k):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> <span style=color:#f92672>not</span> oracle(c):
</span></span><span style=display:flex><span>            hi <span style=color:#f92672>=</span> (lo <span style=color:#f92672>+</span> hi) <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>            lo <span style=color:#f92672>=</span> (lo <span style=color:#f92672>+</span> hi) <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>        c <span style=color:#f92672>=</span> (c <span style=color:#f92672>*</span> pow(<span style=color:#ae81ff>2</span>, e, n)) <span style=color:#f92672>%</span> n
</span></span><span style=display:flex><span>        <span style=color:#75715e># print i, int(hi - lo)</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> int(hi)
</span></span></code></pre></td></tr></table></div></div><h3 id=例子qctf2018-xman选拔赛baby-rsa>例子：QCTF2018-XMan选拔赛/Baby RSA<a hidden class=anchor aria-hidden=true href=#例子qctf2018-xman选拔赛baby-rsa>#</a></h3><p>题目如下</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-21-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-21-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-21-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-21-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-21-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-21-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-21-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-21-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-21-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-21-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-21-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-21-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-21-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-21-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-21-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-21-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-21-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-21-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-21-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-21-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-21-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-21-11>11</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>e <span style=color:#f92672>=</span> <span style=color:#ae81ff>0x10001</span>
</span></span><span style=display:flex><span>n <span style=color:#f92672>=</span> <span style=color:#ae81ff>0x0b765daa79117afe1a77da7ff8122872bbcbddb322bb078fe0786dc40c9033fadd639adc48c3f2627fb7cb59bb0658707fe516967464439bdec2d6479fa3745f57c0a5ca255812f0884978b2a8aaeb750e0228cbe28a1e5a63bf0309b32a577eecea66f7610a9a4e720649129e9dc2115db9d4f34dc17f8b0806213c035e22f2c5054ae584b440def00afbccd458d020cae5fd1138be6507bc0b1a10da7e75def484c5fc1fcb13d11be691670cf38b487de9c4bde6c2c689be5adab08b486599b619a0790c0b2d70c9c461346966bcbae53c5007d0146fc520fa6e3106fbfc89905220778870a7119831c17f98628563ca020652d18d72203529a784ca73716db</span>
</span></span><span style=display:flex><span>c <span style=color:#f92672>=</span> <span style=color:#ae81ff>0x4f377296a19b3a25078d614e1c92ff632d3e3ded772c4445b75e468a9405de05d15c77532964120ae11f8655b68a630607df0568a7439bc694486ae50b5c0c8507e5eecdea4654eeff3e75fb8396e505a36b0af40bd5011990663a7655b91c9e6ed2d770525e4698dec9455db17db38fa4b99b53438b9e09000187949327980ca903d0eef114afc42b771657ea5458a4cb399212e943d139b7ceb6d5721f546b75cd53d65e025f4df7eb8637152ecbb6725962c7f66b714556d754f41555c691a34a798515f1e2a69c129047cb29a9eef466c206a7f4dbc2cea1a46a39ad3349a7db56c1c997dc181b1afcb76fa1bbbf118a4ab5c515e274ab2250dba1872be0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>λ nc <span style=color:#ae81ff>47.96.239.28</span> <span style=color:#ae81ff>23333</span>
</span></span><span style=display:flex><span><span style=color:#f92672>-----------------------------</span> baby rsa <span style=color:#f92672>-----------------------------</span>
</span></span><span style=display:flex><span>Come <span style=color:#f92672>and</span> Decode your data
</span></span><span style=display:flex><span>If you give me ciphertext, I can tell you whether decoded data <span style=color:#f92672>is</span> even <span style=color:#f92672>or</span> odd
</span></span><span style=display:flex><span>You can input ciphertext(hexdecimal) now
</span></span><span style=display:flex><span><span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>odd
</span></span></code></pre></td></tr></table></div></div><p>解题脚本：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-22-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-22-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-22-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-22-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-22-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-22-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-22-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-22-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-22-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-22-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-22-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-22-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-22-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-22-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-22-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-22-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-22-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-22-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-22-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-22-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-22-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-22-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-22-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-22-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-22-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-22-13>13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-22-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-22-14>14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-22-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-22-15>15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-22-16><a style=outline:none;text-decoration:none;color:inherit href=#hl-22-16>16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-22-17><a style=outline:none;text-decoration:none;color:inherit href=#hl-22-17>17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-22-18><a style=outline:none;text-decoration:none;color:inherit href=#hl-22-18>18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-22-19><a style=outline:none;text-decoration:none;color:inherit href=#hl-22-19>19</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-22-20><a style=outline:none;text-decoration:none;color:inherit href=#hl-22-20>20</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-22-21><a style=outline:none;text-decoration:none;color:inherit href=#hl-22-21>21</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-22-22><a style=outline:none;text-decoration:none;color:inherit href=#hl-22-22>22</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-22-23><a style=outline:none;text-decoration:none;color:inherit href=#hl-22-23>23</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-22-24><a style=outline:none;text-decoration:none;color:inherit href=#hl-22-24>24</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-22-25><a style=outline:none;text-decoration:none;color:inherit href=#hl-22-25>25</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-22-26><a style=outline:none;text-decoration:none;color:inherit href=#hl-22-26>26</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-22-27><a style=outline:none;text-decoration:none;color:inherit href=#hl-22-27>27</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-22-28><a style=outline:none;text-decoration:none;color:inherit href=#hl-22-28>28</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-22-29><a style=outline:none;text-decoration:none;color:inherit href=#hl-22-29>29</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-22-30><a style=outline:none;text-decoration:none;color:inherit href=#hl-22-30>30</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-22-31><a style=outline:none;text-decoration:none;color:inherit href=#hl-22-31>31</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-22-32><a style=outline:none;text-decoration:none;color:inherit href=#hl-22-32>32</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-22-33><a style=outline:none;text-decoration:none;color:inherit href=#hl-22-33>33</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-22-34><a style=outline:none;text-decoration:none;color:inherit href=#hl-22-34>34</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-22-35><a style=outline:none;text-decoration:none;color:inherit href=#hl-22-35>35</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-22-36><a style=outline:none;text-decoration:none;color:inherit href=#hl-22-36>36</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-22-37><a style=outline:none;text-decoration:none;color:inherit href=#hl-22-37>37</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-22-38><a style=outline:none;text-decoration:none;color:inherit href=#hl-22-38>38</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-22-39><a style=outline:none;text-decoration:none;color:inherit href=#hl-22-39>39</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-22-40><a style=outline:none;text-decoration:none;color:inherit href=#hl-22-40>40</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-22-41><a style=outline:none;text-decoration:none;color:inherit href=#hl-22-41>41</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-22-42><a style=outline:none;text-decoration:none;color:inherit href=#hl-22-42>42</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-22-43><a style=outline:none;text-decoration:none;color:inherit href=#hl-22-43>43</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-22-44><a style=outline:none;text-decoration:none;color:inherit href=#hl-22-44>44</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-22-45><a style=outline:none;text-decoration:none;color:inherit href=#hl-22-45>45</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-22-46><a style=outline:none;text-decoration:none;color:inherit href=#hl-22-46>46</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-22-47><a style=outline:none;text-decoration:none;color:inherit href=#hl-22-47>47</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-22-48><a style=outline:none;text-decoration:none;color:inherit href=#hl-22-48>48</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-22-49><a style=outline:none;text-decoration:none;color:inherit href=#hl-22-49>49</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-22-50><a style=outline:none;text-decoration:none;color:inherit href=#hl-22-50>50</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-22-51><a style=outline:none;text-decoration:none;color:inherit href=#hl-22-51>51</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-22-52><a style=outline:none;text-decoration:none;color:inherit href=#hl-22-52>52</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-22-53><a style=outline:none;text-decoration:none;color:inherit href=#hl-22-53>53</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-22-54><a style=outline:none;text-decoration:none;color:inherit href=#hl-22-54>54</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-22-55><a style=outline:none;text-decoration:none;color:inherit href=#hl-22-55>55</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-22-56><a style=outline:none;text-decoration:none;color:inherit href=#hl-22-56>56</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-22-57><a style=outline:none;text-decoration:none;color:inherit href=#hl-22-57>57</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-22-58><a style=outline:none;text-decoration:none;color:inherit href=#hl-22-58>58</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-22-59><a style=outline:none;text-decoration:none;color:inherit href=#hl-22-59>59</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-22-60><a style=outline:none;text-decoration:none;color:inherit href=#hl-22-60>60</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># -*- coding: utf-8 -*-</span>
</span></span><span style=display:flex><span><span style=color:#75715e># by https://findneo.github.io/</span>
</span></span><span style=display:flex><span><span style=color:#75715e># ref:</span>
</span></span><span style=display:flex><span><span style=color:#75715e># https://crypto.stackexchange.com/questions/11053/rsa-least-significant-bit-oracle-attack</span>
</span></span><span style=display:flex><span><span style=color:#75715e># https://ctf.rip/sharif-ctf-2016-lsb-oracle-crypto-challenge/</span>
</span></span><span style=display:flex><span><span style=color:#75715e># https://introspelliam.github.io/2018/03/27/crypto/RSA-Least-Significant-Bit-Oracle-Attack/</span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> libnum<span style=color:#f92672>,</span> gmpy2<span style=color:#f92672>,</span> socket<span style=color:#f92672>,</span> time<span style=color:#f92672>,</span> decimal
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>oracle</span>(c1):
</span></span><span style=display:flex><span>    s <span style=color:#f92672>=</span> socket<span style=color:#f92672>.</span>socket(socket<span style=color:#f92672>.</span>AF_INET, socket<span style=color:#f92672>.</span>SOCK_STREAM)
</span></span><span style=display:flex><span>    hostname <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;47.96.239.28&#39;</span>
</span></span><span style=display:flex><span>    port <span style=color:#f92672>=</span> <span style=color:#ae81ff>23333</span>
</span></span><span style=display:flex><span>    s<span style=color:#f92672>.</span>connect((hostname, port))
</span></span><span style=display:flex><span>    s<span style=color:#f92672>.</span>recv(<span style=color:#ae81ff>1024</span>)
</span></span><span style=display:flex><span>    s<span style=color:#f92672>.</span>send(hex(c1)[<span style=color:#ae81ff>2</span>:]<span style=color:#f92672>.</span>strip(<span style=color:#e6db74>&#34;lL&#34;</span>) <span style=color:#f92672>+</span> <span style=color:#e6db74>&#39;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#39;</span>)
</span></span><span style=display:flex><span>    res <span style=color:#f92672>=</span> s<span style=color:#f92672>.</span>recv(<span style=color:#ae81ff>1024</span>)<span style=color:#f92672>.</span>strip()
</span></span><span style=display:flex><span>    s<span style=color:#f92672>.</span>close()
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> res <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;even&#39;</span>: <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> res <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;odd&#39;</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>assert</span> (<span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>partial</span>(c, n):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>global</span> c_of_2
</span></span><span style=display:flex><span>    k <span style=color:#f92672>=</span> n<span style=color:#f92672>.</span>bit_length()
</span></span><span style=display:flex><span>    decimal<span style=color:#f92672>.</span>getcontext()<span style=color:#f92672>.</span>prec <span style=color:#f92672>=</span> k  <span style=color:#75715e># allows for &#39;precise enough&#39; floats</span>
</span></span><span style=display:flex><span>    lower <span style=color:#f92672>=</span> decimal<span style=color:#f92672>.</span>Decimal(<span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>    upper <span style=color:#f92672>=</span> decimal<span style=color:#f92672>.</span>Decimal(n)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(k):
</span></span><span style=display:flex><span>        possible_plaintext <span style=color:#f92672>=</span> (lower <span style=color:#f92672>+</span> upper) <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e># lower==0 when i&lt;1809</span>
</span></span><span style=display:flex><span>        flag <span style=color:#f92672>=</span> oracle(c)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> <span style=color:#f92672>not</span> flag:
</span></span><span style=display:flex><span>            upper <span style=color:#f92672>=</span> possible_plaintext  <span style=color:#75715e># plaintext is in the lower half</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>            lower <span style=color:#f92672>=</span> possible_plaintext  <span style=color:#75715e># plaintext is in the upper half</span>
</span></span><span style=display:flex><span>        c <span style=color:#f92672>=</span> (c <span style=color:#f92672>*</span> c_of_2) <span style=color:#f92672>%</span> n  <span style=color:#75715e># multiply y by the encryption of 2 again</span>
</span></span><span style=display:flex><span>        print i, flag, int(upper <span style=color:#f92672>-</span> lower)
</span></span><span style=display:flex><span>        <span style=color:#75715e># time.sleep(0.2)</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># By now, our plaintext is revealed!</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> int(upper)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>main</span>():
</span></span><span style=display:flex><span>    print <span style=color:#e6db74>&#34;[*] Conducting Oracle attack...&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> partial((c <span style=color:#f92672>*</span> c_of_2) <span style=color:#f92672>%</span> n, n)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> __name__ <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;__main__&#39;</span>:
</span></span><span style=display:flex><span>    e <span style=color:#f92672>=</span> <span style=color:#ae81ff>0x10001</span>
</span></span><span style=display:flex><span>    n <span style=color:#f92672>=</span> <span style=color:#ae81ff>0x0b765daa79117afe1a77da7ff8122872bbcbddb322bb078fe0786dc40c9033fadd639adc48c3f2627fb7cb59bb0658707fe516967464439bdec2d6479fa3745f57c0a5ca255812f0884978b2a8aaeb750e0228cbe28a1e5a63bf0309b32a577eecea66f7610a9a4e720649129e9dc2115db9d4f34dc17f8b0806213c035e22f2c5054ae584b440def00afbccd458d020cae5fd1138be6507bc0b1a10da7e75def484c5fc1fcb13d11be691670cf38b487de9c4bde6c2c689be5adab08b486599b619a0790c0b2d70c9c461346966bcbae53c5007d0146fc520fa6e3106fbfc89905220778870a7119831c17f98628563ca020652d18d72203529a784ca73716db</span>
</span></span><span style=display:flex><span>    c <span style=color:#f92672>=</span> <span style=color:#ae81ff>0x4f377296a19b3a25078d614e1c92ff632d3e3ded772c4445b75e468a9405de05d15c77532964120ae11f8655b68a630607df0568a7439bc694486ae50b5c0c8507e5eecdea4654eeff3e75fb8396e505a36b0af40bd5011990663a7655b91c9e6ed2d770525e4698dec9455db17db38fa4b99b53438b9e09000187949327980ca903d0eef114afc42b771657ea5458a4cb399212e943d139b7ceb6d5721f546b75cd53d65e025f4df7eb8637152ecbb6725962c7f66b714556d754f41555c691a34a798515f1e2a69c129047cb29a9eef466c206a7f4dbc2cea1a46a39ad3349a7db56c1c997dc181b1afcb76fa1bbbf118a4ab5c515e274ab2250dba1872be0</span>
</span></span><span style=display:flex><span>    c_of_2 <span style=color:#f92672>=</span> pow(<span style=color:#ae81ff>2</span>, e, n)
</span></span><span style=display:flex><span>    m <span style=color:#f92672>=</span> main()
</span></span><span style=display:flex><span>    <span style=color:#75715e># m = 560856645743734814774953158390773525781916094468093308691660509501812349</span>
</span></span><span style=display:flex><span>    print libnum<span style=color:#f92672>.</span>n2s(m)
</span></span><span style=display:flex><span>    <span style=color:#75715e># QCTF{RSA_parity_oracle_is_fun}</span>
</span></span></code></pre></td></tr></table></div></div><p><img loading=lazy src=989d67a1ce3b318b9.png alt></p><h2 id=选择密文攻击>选择密文攻击<a hidden class=anchor aria-hidden=true href=#选择密文攻击>#</a></h2><p><strong>适用情况：可以构造任意密文并获得对应明文。</strong></p><p>这个好理解，在一个RSA加密过程中，明文为m，密文为c，模数为n，加密指数为e，选取x以满足<code>gcd(x,n)==1</code> 从而使x模n的逆存在，构造密文 <code>c'=c*(x^e)</code> 使解密后明文为 <code>m'=(m*x)%n</code> ，则<code>m=m'*x^-1(mod n)</code> 。可参看<code>模意义下的运算法则部分</code> 。</p><h2 id=广播攻击>广播攻击<a hidden class=anchor aria-hidden=true href=#广播攻击>#</a></h2><p><strong>适用情况：模数n、密文c不同，明文m、加密指数e相同。一般会是e=k，然后给k组数据</strong></p><p>使用不同的模数n，相同的公钥指数e加密相同的信息。就会得到多个(m^e) ==ci (mod ni)，将(m^e)视为一个整体M，这就是典型的中国剩余定理适用情况。按照本文的<code>中国剩余定理</code>小节容易求得m^e的值，当e较小时直接开e方即可，可使用<code>gmpy2.iroot(M,e)</code> 方法。</p><p>Python实现：参见本文 <code>中国剩余定理</code>小节。</p><h3 id=例子2018强网杯nextrsa-level9>例子：2018强网杯nextrsa-Level9<a hidden class=anchor aria-hidden=true href=#例子2018强网杯nextrsa-level9>#</a></h3><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-23-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-23-1>1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-23-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-23-2>2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-23-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-23-3>3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-23-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-23-4>4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-23-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-23-5>5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-23-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-23-6>6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-23-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-23-7>7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-23-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-23-8>8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-23-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-23-9>9</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>m <span style=color:#f92672>=</span> random<span style=color:#f92672>.</span>randint(<span style=color:#ae81ff>0x100000000000</span>, <span style=color:#ae81ff>0xffffffffffff</span>)
</span></span><span style=display:flex><span>e <span style=color:#f92672>=</span> <span style=color:#ae81ff>3</span>
</span></span><span style=display:flex><span>n1 <span style=color:#f92672>=</span> <span style=color:#ae81ff>0x43d819a4caf16806e1c540fd7c0e51a96a6dfdbe68735a5fd99a468825e5ee55c4087106f7d1f91e10d50df1f2082f0f32bb82f398134b0b8758353bdabc5ba2817f4e6e0786e176686b2e75a7c47d073f346d6adb2684a9d28b658dddc75b3c5d10a22a3e85c6c12549d0ce7577e79a068405d3904f3f6b9cc408c4cd8595bf67fe672474e0b94dc99072caaa4f866fc6c3feddc74f10d6a0fb31864f52adef71649684f1a72c910ec5ca7909cc10aef85d43a57ec91f096a2d4794299e967fcd5add6e9cfb5baf7751387e24b93dbc1f37315ce573dc063ecddd4ae6fb9127307cfc80a037e7ff5c40a5f7590c8b2f5bd06dd392fbc51e5d059cffbcb85555</span>L
</span></span><span style=display:flex><span>n2 <span style=color:#f92672>=</span> <span style=color:#ae81ff>0x60d175fdb0a96eca160fb0cbf8bad1a14dd680d353a7b3bc77e620437da70fd9153f7609efde652b825c4ae7f25decf14a3c8240ea8c5892003f1430cc88b0ded9dae12ebffc6b23632ac530ac4ae23fbffb7cfe431ff3d802f5a54ab76257a86aeec1cf47d482fec970fc27c5b376fbf2cf993270bba9b78174395de3346d4e221d1eafdb8eecc8edb953d1ccaa5fc250aed83b3a458f9e9d947c4b01a6e72ce4fee37e77faaf5597d780ad5f0a7623edb08ce76264f72c3ff17afc932f5812b10692bcc941a18b6f3904ca31d038baf3fc1968d1cc0588a656d0c53cd5c89cedba8a5230956af2170554d27f524c2027adce84fd4d0e018dc88ca4d5d26867</span>L
</span></span><span style=display:flex><span>n3 <span style=color:#f92672>=</span> <span style=color:#ae81ff>0x280f992dd63fcabdcb739f52c5ed1887e720cbfe73153adf5405819396b28cb54423d196600cce76c8554cd963281fc4b153e3b257e96d091e5d99567dd1fa9ace52511ace4da407f5269e71b1b13822316d751e788dc935d63916075530d7fb89cbec9b02c01aef19c39b4ecaa1f7fe2faf990aa938eb89730eda30558e669da5459ed96f1463a983443187359c07fba8e97024452087b410c9ac1e39ed1c74f380fd29ebdd28618d60c36e6973fc87c066cae05e9e270b5ac25ea5ca0bac5948de0263d8cc89d91c4b574202e71811d0ddf1ed23c1bc35f3a042aac6a0bdf32d37dede3536f70c257aafb4cfbe3370cd7b4187c023c35671de3888a1ed1303</span>L
</span></span><span style=display:flex><span>c1 <span style=color:#f92672>=</span> pow(m, e, n1)
</span></span><span style=display:flex><span>c2 <span style=color:#f92672>=</span> pow(m, e, n2)
</span></span><span style=display:flex><span>c3 <span style=color:#f92672>=</span> pow(m, e, n3)
</span></span><span style=display:flex><span>print m <span style=color:#f92672>==</span> gmpy2<span style=color:#f92672>.</span>iroot(CRT([n1, n2, n3], [c1, c2, c3]), e)[<span style=color:#ae81ff>0</span>]
</span></span></code></pre></td></tr></table></div></div><h1 id=其他例题>其他例题<a hidden class=anchor aria-hidden=true href=#其他例题>#</a></h1><h2 id=jarvis-oj-medium-rsa解析公钥文件>【Jarvis OJ Medium RSA】解析公钥文件<a hidden class=anchor aria-hidden=true href=#jarvis-oj-medium-rsa解析公钥文件>#</a></h2><p>使用命令从PEM文件（Privacy-Enhanced Mail 是用于存储和发送密钥、证书等数据的文件格式）中解析公钥对(n,e)，n可在线查询 (<a href=http://factordb.com/>http://factordb.com/</a>) 到质因子，分解n得到p和q，便能够计算欧拉函数值及解密指数，从而解密。</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-24-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-24-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-24-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-24-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-24-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-24-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-24-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-24-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-24-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-24-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-24-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-24-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-24-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-24-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-24-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-24-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-24-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-24-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-24-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-24-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-24-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-24-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-24-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-24-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-24-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-24-13>13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-24-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-24-14>14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-24-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-24-15>15</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>C:<span style=color:#ae81ff>\U</span>sers<span style=color:#ae81ff>\n</span>eo<span style=color:#ae81ff>\D</span>ownloads<span style=color:#ae81ff>\m</span>ediumRSA.rar
</span></span><span style=display:flex><span>λ openssl rsa -pubin -text -modulus -in pubkey.pem
</span></span><span style=display:flex><span>WARNING: can<span style=color:#960050;background-color:#1e0010>&#39;</span>t open config file: /usr/local/ssl/openssl.cnf
</span></span><span style=display:flex><span>Public-Key: <span style=color:#f92672>(</span><span style=color:#ae81ff>256</span> bit<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Modulus:
</span></span><span style=display:flex><span>    00:c2:63:6a:e5:c3:d8:e4:3f:fb:97:ab:09:02:8f:
</span></span><span style=display:flex><span>    1a:ac:6c:0b:f6:cd:3d:70:eb:ca:28:1b:ff:e9:7f:
</span></span><span style=display:flex><span>    be:30:dd
</span></span><span style=display:flex><span>Exponent: <span style=color:#ae81ff>65537</span> <span style=color:#f92672>(</span>0x10001<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Modulus<span style=color:#f92672>=</span>C2636AE5C3D8E43FFB97AB09028F1AAC6C0BF6CD3D70EBCA281BFFE97FBE30DD
</span></span><span style=display:flex><span>writing RSA key
</span></span><span style=display:flex><span>-----BEGIN PUBLIC KEY-----
</span></span><span style=display:flex><span>MDwwDQYJKoZIhvcNAQEBBQADKwAwKAIhAMJjauXD2OQ/+5erCQKPGqxsC/bNPXDr
</span></span><span style=display:flex><span>yigb/+l/vjDdAgMBAAE<span style=color:#f92672>=</span>
</span></span><span style=display:flex><span>-----END PUBLIC KEY-----
</span></span></code></pre></td></tr></table></div></div><p>carck.py</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-25-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-25-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-25-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-25-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-25-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-25-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-25-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-25-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-25-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-25-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-25-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-25-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-25-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-25-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-25-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-25-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-25-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-25-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-25-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-25-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-25-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-25-11>11</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> gmpy2<span style=color:#f92672>,</span>binascii
</span></span><span style=display:flex><span>n<span style=color:#f92672>=</span><span style=color:#ae81ff>87924348264132406875276140514499937145050893665602592992418171647042491658461</span>
</span></span><span style=display:flex><span>e<span style=color:#f92672>=</span><span style=color:#ae81ff>0x10001</span>
</span></span><span style=display:flex><span><span style=color:#75715e># via http://factordb.com/</span>
</span></span><span style=display:flex><span>p<span style=color:#f92672>=</span><span style=color:#ae81ff>275127860351348928173285174381581152299</span>
</span></span><span style=display:flex><span>q<span style=color:#f92672>=</span><span style=color:#ae81ff>319576316814478949870590164193048041239</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>d<span style=color:#f92672>=</span>gmpy2<span style=color:#f92672>.</span>invert(e,(p<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>)<span style=color:#f92672>*</span>(q<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>))
</span></span><span style=display:flex><span>c<span style=color:#f92672>=</span>int(open(<span style=color:#e6db74>&#39;flag.enc&#39;</span>,<span style=color:#e6db74>&#39;rb&#39;</span>)<span style=color:#f92672>.</span>read()<span style=color:#f92672>.</span>encode(<span style=color:#e6db74>&#39;hex&#39;</span>),<span style=color:#ae81ff>16</span>)
</span></span><span style=display:flex><span>m<span style=color:#f92672>=</span>hex(pow(c,d,n))[<span style=color:#ae81ff>2</span>:]
</span></span><span style=display:flex><span>print binascii<span style=color:#f92672>.</span>unhexlify(m<span style=color:#f92672>.</span>zfill(len(m)<span style=color:#f92672>+</span><span style=color:#ae81ff>8</span><span style=color:#f92672>-</span>len(m)<span style=color:#f92672>%</span><span style=color:#ae81ff>8</span>))
</span></span></code></pre></td></tr></table></div></div><h1 id=后话>后话<a hidden class=anchor aria-hidden=true href=#后话>#</a></h1><p>RSA可谓现代密码学的中流砥柱，关于它的可行攻击方法研究还有很多，诸如Timing Attack ，Padding oracle attack，Side-channel analysis attacks等类型的攻击，本文仅介绍了一些通俗易懂的方法，读者还可以阅读 <a href=https://ctf-wiki.github.io/ctf-wiki/crypto/asymmetric/rsa/rsa_theory/>CTF wiki中的非对称加密部分</a> ，以及以 <a href=https://en.wikipedia.org/wiki/RSA_%28cryptosystem%29>RSA (cryptosystem)</a> 为目录结合谷歌进行进一步学习。</p><p>本文的例题附件、代码段、工具和后续更新都会放在 <a href=https://github.com/findneo/RSA-ATTACK>RSA-ATTACK</a> ，欢迎 star & watch 。</p><h1 id=参考链接>参考链接<a hidden class=anchor aria-hidden=true href=#参考链接>#</a></h1><p><a href=http://secgroup.dais.unive.it/wp-content/uploads/2012/11/Practical-Padding-Oracle-Attacks-on-RSA.html>Practical Padding Oracle Attacks on RSA</a></p><p><a href=https://ctf-wiki.github.io/ctf-wiki/crypto/asymmetric/rsa/rsa_theory/>CTF wiki中的非对称加密部分</a></p></div><footer class=post-footer><ul class=post-tags></ul><nav class=paginav><a class=prev href=https://ret2neo.cn/post/180719meepwn_py3inject/><span class=title>« Prev</span><br><span>Meepwn2018：PyCalx&amp;PyCalx2——Python3的f-string与eval注入</span></a>
<a class=next href=https://ret2neo.cn/post/180706doubanmovie/><span class=title>Next »</span><br><span>根据豆瓣观影记录生成海报</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://ret2neo.cn/>闲言语</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2303473689051162" crossorigin=anonymous></script><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>