<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>点击劫持漏洞的批量检测 | 闲言语</title><meta name=keywords content><meta name=description content="概述 batchDetectClickjacking可以用于自动化批量检测和利用点击劫持类漏洞。支持
对多个HTTP站点批量快速检测 对存在点击劫持类漏洞的网站生成利用代码PoC 指定检测时使用的并发线程数 从管道或文件输入被测站点 指定单个网站检测的超时时间 指定检测时使用的网络代理 指定检测时使用的User-Agent 常见用法 1 2 3 4 5 6 7 8 # 检测单个网站链接是否受点击劫持漏洞影响 echo https://www.qq.com | ./batchDetectClickjacking # 检测文件urls.txt中的多个链接 cat urls.txt | ./batchDetectClickjacking # 使用100个线程检测大量url链接，只显示存在漏洞的网站，同时为每个漏洞网站生成PoC ./batchDetectClickjacking -iL urls.txt -s -g -t 100 支持参数 1 2 3 4 5 6 7 8 -h 查看帮助 -g 为存在漏洞的网站生成PoC -iL 指定一个文件，其中包含若干待检测的网站地址，每行一个 -s 只显示存在漏洞的网站；默认情况下还会显示不存在漏洞的网站链接并显示响应头的X-Frame-Options值。 -t 指定检测时候使用的线程数，默认情况下是50个线程 -u 指定发起请求使用的UA，默认情况下是Firefox -w 指定每个请求的超时时间，默认情况下是30s -x 指定发起请求使用的网络代理，可以用于和burpsuite联动 漏洞原理及危害 点击劫持攻击，也称UI覆盖攻击，允许恶意页面以用户的名义点击“受害网站”，欺骗用户进行转账、点赞、关注、转发等操作，或者窃取用户凭据。
一个典型的利用场景是欺骗用户进行转账、点赞、关注或转发。如果业务网站的某正常功能页面A存在点击劫持漏洞，攻击者可以在恶意网站B中使用iframe标签包含A页面，但将A页面置顶并设为透明，这样用户认为自己在B网站上点击时，实际上是在被欺骗着点击了A网站。从而恶意网站B能够做到以用户名义点击A网站，进行转账、转发等敏感操作。
另一种典型的利用场景是窃取用户账号密码等身份凭据。如果业务网站的某正常功能页面A存在点击劫持漏洞，攻击者可以在恶意网站B包含A页面，将A页面置底并将B网站设为透明，这样用户认为自己在A网站进行输入时，实际上输入数据会被B网站获取到。
漏洞修复方法 主要有两种方式可以防御点击劫持，第一种是X-Frame-Options头信息（推荐使用，但可能有些浏览器不支持）；第二种方式是使用javascript编写嵌入阻断代码（代码编写不当时可能被绕过，但当流量经过的某些web代理可能被去掉X-Frame-Options头时可以考虑这种方式）。"><meta name=author content><link rel=canonical href=https://ret2neo.cn/post/210528-click-jacking-batch-detect/><link crossorigin=anonymous href=/assets/css/stylesheet.42b1e004fb78db2fc933d33c9db659598f62453f0de6f9db50c85e5936c0d8c3.css integrity="sha256-QrHgBPt42y/JM9M8nbZZWY9iRT8N5vnbUMheWTbA2MM=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://ret2neo.cn/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://ret2neo.cn/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://ret2neo.cn/favicon-32x32.png><link rel=apple-touch-icon href=https://ret2neo.cn/apple-touch-icon.png><link rel=mask-icon href=https://ret2neo.cn/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="点击劫持漏洞的批量检测"><meta property="og:description" content="概述 batchDetectClickjacking可以用于自动化批量检测和利用点击劫持类漏洞。支持
对多个HTTP站点批量快速检测 对存在点击劫持类漏洞的网站生成利用代码PoC 指定检测时使用的并发线程数 从管道或文件输入被测站点 指定单个网站检测的超时时间 指定检测时使用的网络代理 指定检测时使用的User-Agent 常见用法 1 2 3 4 5 6 7 8 # 检测单个网站链接是否受点击劫持漏洞影响 echo https://www.qq.com | ./batchDetectClickjacking # 检测文件urls.txt中的多个链接 cat urls.txt | ./batchDetectClickjacking # 使用100个线程检测大量url链接，只显示存在漏洞的网站，同时为每个漏洞网站生成PoC ./batchDetectClickjacking -iL urls.txt -s -g -t 100 支持参数 1 2 3 4 5 6 7 8 -h 查看帮助 -g 为存在漏洞的网站生成PoC -iL 指定一个文件，其中包含若干待检测的网站地址，每行一个 -s 只显示存在漏洞的网站；默认情况下还会显示不存在漏洞的网站链接并显示响应头的X-Frame-Options值。 -t 指定检测时候使用的线程数，默认情况下是50个线程 -u 指定发起请求使用的UA，默认情况下是Firefox -w 指定每个请求的超时时间，默认情况下是30s -x 指定发起请求使用的网络代理，可以用于和burpsuite联动 漏洞原理及危害 点击劫持攻击，也称UI覆盖攻击，允许恶意页面以用户的名义点击“受害网站”，欺骗用户进行转账、点赞、关注、转发等操作，或者窃取用户凭据。
一个典型的利用场景是欺骗用户进行转账、点赞、关注或转发。如果业务网站的某正常功能页面A存在点击劫持漏洞，攻击者可以在恶意网站B中使用iframe标签包含A页面，但将A页面置顶并设为透明，这样用户认为自己在B网站上点击时，实际上是在被欺骗着点击了A网站。从而恶意网站B能够做到以用户名义点击A网站，进行转账、转发等敏感操作。
另一种典型的利用场景是窃取用户账号密码等身份凭据。如果业务网站的某正常功能页面A存在点击劫持漏洞，攻击者可以在恶意网站B包含A页面，将A页面置底并将B网站设为透明，这样用户认为自己在A网站进行输入时，实际上输入数据会被B网站获取到。
漏洞修复方法 主要有两种方式可以防御点击劫持，第一种是X-Frame-Options头信息（推荐使用，但可能有些浏览器不支持）；第二种方式是使用javascript编写嵌入阻断代码（代码编写不当时可能被绕过，但当流量经过的某些web代理可能被去掉X-Frame-Options头时可以考虑这种方式）。"><meta property="og:type" content="article"><meta property="og:url" content="https://ret2neo.cn/post/210528-click-jacking-batch-detect/"><meta property="article:section" content="post"><meta property="article:published_time" content="2021-05-28T22:24:58+08:00"><meta property="article:modified_time" content="2021-05-28T22:24:58+08:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="点击劫持漏洞的批量检测"><meta name=twitter:description content="概述 batchDetectClickjacking可以用于自动化批量检测和利用点击劫持类漏洞。支持
对多个HTTP站点批量快速检测 对存在点击劫持类漏洞的网站生成利用代码PoC 指定检测时使用的并发线程数 从管道或文件输入被测站点 指定单个网站检测的超时时间 指定检测时使用的网络代理 指定检测时使用的User-Agent 常见用法 1 2 3 4 5 6 7 8 # 检测单个网站链接是否受点击劫持漏洞影响 echo https://www.qq.com | ./batchDetectClickjacking # 检测文件urls.txt中的多个链接 cat urls.txt | ./batchDetectClickjacking # 使用100个线程检测大量url链接，只显示存在漏洞的网站，同时为每个漏洞网站生成PoC ./batchDetectClickjacking -iL urls.txt -s -g -t 100 支持参数 1 2 3 4 5 6 7 8 -h 查看帮助 -g 为存在漏洞的网站生成PoC -iL 指定一个文件，其中包含若干待检测的网站地址，每行一个 -s 只显示存在漏洞的网站；默认情况下还会显示不存在漏洞的网站链接并显示响应头的X-Frame-Options值。 -t 指定检测时候使用的线程数，默认情况下是50个线程 -u 指定发起请求使用的UA，默认情况下是Firefox -w 指定每个请求的超时时间，默认情况下是30s -x 指定发起请求使用的网络代理，可以用于和burpsuite联动 漏洞原理及危害 点击劫持攻击，也称UI覆盖攻击，允许恶意页面以用户的名义点击“受害网站”，欺骗用户进行转账、点赞、关注、转发等操作，或者窃取用户凭据。
一个典型的利用场景是欺骗用户进行转账、点赞、关注或转发。如果业务网站的某正常功能页面A存在点击劫持漏洞，攻击者可以在恶意网站B中使用iframe标签包含A页面，但将A页面置顶并设为透明，这样用户认为自己在B网站上点击时，实际上是在被欺骗着点击了A网站。从而恶意网站B能够做到以用户名义点击A网站，进行转账、转发等敏感操作。
另一种典型的利用场景是窃取用户账号密码等身份凭据。如果业务网站的某正常功能页面A存在点击劫持漏洞，攻击者可以在恶意网站B包含A页面，将A页面置底并将B网站设为透明，这样用户认为自己在A网站进行输入时，实际上输入数据会被B网站获取到。
漏洞修复方法 主要有两种方式可以防御点击劫持，第一种是X-Frame-Options头信息（推荐使用，但可能有些浏览器不支持）；第二种方式是使用javascript编写嵌入阻断代码（代码编写不当时可能被绕过，但当流量经过的某些web代理可能被去掉X-Frame-Options头时可以考虑这种方式）。"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://ret2neo.cn/post/"},{"@type":"ListItem","position":2,"name":"点击劫持漏洞的批量检测","item":"https://ret2neo.cn/post/210528-click-jacking-batch-detect/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"点击劫持漏洞的批量检测","name":"点击劫持漏洞的批量检测","description":"概述 batchDetectClickjacking可以用于自动化批量检测和利用点击劫持类漏洞。支持\n对多个HTTP站点批量快速检测 对存在点击劫持类漏洞的网站生成利用代码PoC 指定检测时使用的并发线程数 从管道或文件输入被测站点 指定单个网站检测的超时时间 指定检测时使用的网络代理 指定检测时使用的User-Agent 常见用法 1 2 3 4 5 6 7 8 # 检测单个网站链接是否受点击劫持漏洞影响 echo https://www.qq.com | ./batchDetectClickjacking # 检测文件urls.txt中的多个链接 cat urls.txt | ./batchDetectClickjacking # 使用100个线程检测大量url链接，只显示存在漏洞的网站，同时为每个漏洞网站生成PoC ./batchDetectClickjacking -iL urls.txt -s -g -t 100 支持参数 1 2 3 4 5 6 7 8 -h 查看帮助 -g 为存在漏洞的网站生成PoC -iL 指定一个文件，其中包含若干待检测的网站地址，每行一个 -s 只显示存在漏洞的网站；默认情况下还会显示不存在漏洞的网站链接并显示响应头的X-Frame-Options值。 -t 指定检测时候使用的线程数，默认情况下是50个线程 -u 指定发起请求使用的UA，默认情况下是Firefox -w 指定每个请求的超时时间，默认情况下是30s -x 指定发起请求使用的网络代理，可以用于和burpsuite联动 漏洞原理及危害 点击劫持攻击，也称UI覆盖攻击，允许恶意页面以用户的名义点击“受害网站”，欺骗用户进行转账、点赞、关注、转发等操作，或者窃取用户凭据。\n一个典型的利用场景是欺骗用户进行转账、点赞、关注或转发。如果业务网站的某正常功能页面A存在点击劫持漏洞，攻击者可以在恶意网站B中使用iframe标签包含A页面，但将A页面置顶并设为透明，这样用户认为自己在B网站上点击时，实际上是在被欺骗着点击了A网站。从而恶意网站B能够做到以用户名义点击A网站，进行转账、转发等敏感操作。\n另一种典型的利用场景是窃取用户账号密码等身份凭据。如果业务网站的某正常功能页面A存在点击劫持漏洞，攻击者可以在恶意网站B包含A页面，将A页面置底并将B网站设为透明，这样用户认为自己在A网站进行输入时，实际上输入数据会被B网站获取到。\n漏洞修复方法 主要有两种方式可以防御点击劫持，第一种是X-Frame-Options头信息（推荐使用，但可能有些浏览器不支持）；第二种方式是使用javascript编写嵌入阻断代码（代码编写不当时可能被绕过，但当流量经过的某些web代理可能被去掉X-Frame-Options头时可以考虑这种方式）。","keywords":[],"articleBody":"概述 batchDetectClickjacking可以用于自动化批量检测和利用点击劫持类漏洞。支持\n对多个HTTP站点批量快速检测 对存在点击劫持类漏洞的网站生成利用代码PoC 指定检测时使用的并发线程数 从管道或文件输入被测站点 指定单个网站检测的超时时间 指定检测时使用的网络代理 指定检测时使用的User-Agent 常见用法 1 2 3 4 5 6 7 8 # 检测单个网站链接是否受点击劫持漏洞影响 echo https://www.qq.com | ./batchDetectClickjacking # 检测文件urls.txt中的多个链接 cat urls.txt | ./batchDetectClickjacking # 使用100个线程检测大量url链接，只显示存在漏洞的网站，同时为每个漏洞网站生成PoC ./batchDetectClickjacking -iL urls.txt -s -g -t 100 支持参数 1 2 3 4 5 6 7 8 -h 查看帮助 -g 为存在漏洞的网站生成PoC -iL 指定一个文件，其中包含若干待检测的网站地址，每行一个 -s 只显示存在漏洞的网站；默认情况下还会显示不存在漏洞的网站链接并显示响应头的X-Frame-Options值。 -t 指定检测时候使用的线程数，默认情况下是50个线程 -u 指定发起请求使用的UA，默认情况下是Firefox -w 指定每个请求的超时时间，默认情况下是30s -x 指定发起请求使用的网络代理，可以用于和burpsuite联动 漏洞原理及危害 点击劫持攻击，也称UI覆盖攻击，允许恶意页面以用户的名义点击“受害网站”，欺骗用户进行转账、点赞、关注、转发等操作，或者窃取用户凭据。\n一个典型的利用场景是欺骗用户进行转账、点赞、关注或转发。如果业务网站的某正常功能页面A存在点击劫持漏洞，攻击者可以在恶意网站B中使用iframe标签包含A页面，但将A页面置顶并设为透明，这样用户认为自己在B网站上点击时，实际上是在被欺骗着点击了A网站。从而恶意网站B能够做到以用户名义点击A网站，进行转账、转发等敏感操作。\n另一种典型的利用场景是窃取用户账号密码等身份凭据。如果业务网站的某正常功能页面A存在点击劫持漏洞，攻击者可以在恶意网站B包含A页面，将A页面置底并将B网站设为透明，这样用户认为自己在A网站进行输入时，实际上输入数据会被B网站获取到。\n漏洞修复方法 主要有两种方式可以防御点击劫持，第一种是X-Frame-Options头信息（推荐使用，但可能有些浏览器不支持）；第二种方式是使用javascript编写嵌入阻断代码（代码编写不当时可能被绕过，但当流量经过的某些web代理可能被去掉X-Frame-Options头时可以考虑这种方式）。\nX-Frame-Options HTTP响应头能用来向浏览器指明是否允许渲染在iframe标签内的页面。网站可以用它来确保网站内容不被嵌入到其他站点，从而避免遭受点击劫持攻击。X-Frame-Options头信息有三种可用的值:，推荐使用SAMEORIGIN或DENY。\nDENY，阻止所有的域名嵌入此页面。. SAMEORIGIN，只允许同源站点嵌入此页面。 ALLOW-FROM uri，允许指定的“URI”嵌入此页面（如ALLOW-FROM http://www.example.com ，则允许www.example.com嵌入此页面）。ALLOW-FROM选项是2012年左右添加的, 所以一些旧浏览器可能不支持这个参数。不要依赖ALLOW-FROM参数。如果你使用这个选项，但是浏览器不支持它，那相当于你没有做任何点击劫持防御。 漏洞示意demo 正常业务网站A（存在点击劫持漏洞）: http://localhost:8090/sitea.html\n恶意网站B（实际攻击中会将A网站完全透明化）：http://localhost:8091/siteb.html\n用户被吸引点击彩色按钮时实际上可能触发转账或者转发的操作。\ndemo源码： sitea.html\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 \u003chtml lang=\"en-US\"\u003e \u003chead\u003e \u003cmeta charset=\"UTF-8\"\u003e \u003ctitle\u003eI Frame\u003c/title\u003e \u003cstyle\u003e body { background-color: #93B874; } \u003c/style\u003e \u003c/head\u003e \u003cbody\u003e \u003ch1 align=\"center\"\u003eA 网站：提供正常业务，可以点击进行转账等敏感操作\u003c/h1\u003e \u003cbr\u003e \u003cp align=\"center\"\u003e \u003cbutton style=\"height:100px;width:180px;background:grey\"\u003e喜欢这篇文章吗？\u003cbr\u003e点这个按钮给作者转账\u003c/button\u003e \u003cbr\u003e\u003cbr\u003e\u003cbr\u003e \u003cbutton style=\"height:125px;width:250px;background:grey\"\u003e不喜欢这篇文章吗？\u003cbr\u003e点这个按钮转发文章，让更多人讨厌它\u003c/button\u003e \u003c/p\u003e \u003c/body\u003e \u003c/html\u003e siteb\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 \u003chtml lang=\"zh-CN\"\u003e \u003chead\u003e \u003cmeta charset=\"UTF-8\" /\u003e \u003ctitle\u003e彩票开奖网站\u003c/title\u003e \u003cstyle\u003e #target_website { position:absolute; width:2000px; height:1280px; opacity:0.2; z-index:1; } #decoy_website { position:absolute; width:2000px; height:1280px; z-index:-1; } \u003c/style\u003e \u003c/head\u003e \u003cbody\u003e \u003cdiv id=\"decoy_website\" align=\"center\"\u003e \u003cbr\u003e\u003ch1 \u003eB网站：花里胡哨但会吸引人进行点击操作的恶意网站\u003c/h1\u003e \u003cp align=\"center\"\u003e \u003cbutton style=\"height:30px;width:140px;background:red\"\u003e点这个按钮抽大奖\u003c/button\u003e \u003cbr\u003e\u003cbr\u003e\u003cbr\u003e\u003cbr\u003e\u003cbr\u003e \u003cb style=\"color:blue\"\u003e快来点我啊，点我有惊喜！！！\u003c/b\u003e \u003cbr\u003e\u003cbr\u003e \u003cbutton style=\"height:30px;width:140px;background:green\"\u003e点这个按钮领红包\u003c/button\u003e \u003c/p\u003e \u003c/div\u003e \u003cdiv id=\"target_website\" align=\"center\"\u003e \u003ciframe src=\"http://localhost:8090/sitea.html\" height=\"40%\" width=\"40%\" align=\"middle\" allowtransparency=\"true\"\u003e\u003c/iframe\u003e \u003c/div\u003e \u003c/body\u003e \u003c/html\u003e 工具源码 v2 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239 240 241 242 243 244 245 246 247 248 249 250 251 252 253 254 255 256 257 258 259 260 261 262 263 264 265 266 267 268 269 270 271 package main import ( \"bufio\" \"crypto/md5\" \"crypto/tls\" \"errors\" \"flag\" \"fmt\" \"net/http\" \"net/url\" \"os\" \"path\" \"path/filepath\" \"strings\" \"sync\" \"time\" ) //batchDetectClickjacking.go // usage //sort -u /mnt/d/record/burphttp/monitor/domain | httpx | ./batchDetectClickjacking -x http://127.0.0.1:8080 -v -t 50 | tee -a res.txt // banner //https://manytools.org/hacker-tools/ascii-banner/ // Rounded font const banner = ` ______ _ ______ (____ \\ _ | | (______) _ _ ____) )_____ _| |_ ____| |__ _ _ _____ _| |_ _____ ____ _| |_ | __ ((____ (_ _) ___) _ \\ | | | | ___ (_ _) ___ |/ ___|_ _) | |__) ) ___ | | |( (___| | | | | |__/ /| ____| | |_| ____( (___ | |_ |______/\\_____| \\__)____)_| |_| |_____/ |_____) \\__)_____)\\____) \\__) _______ _ _ _ _ _ _ (_______) |(_) | | (_) | | (_) _ | | _ ____| | _ _ _____ ____| | _ _ ____ ____ | | | || |/ ___) |_/ )| (____ |/ ___) |_/ ) | _ \\ / _ | | |_____| || ( (___| _ ( | / ___ ( (___| _ (| | | | ( (_| | \\______)\\_)_|\\____)_| \\_)| \\_____|\\____)_| \\_)_|_| |_|\\___ | (__/ (_____| by findneo ` // options type Options struct { mode string InputFile string Silent bool generatePoC bool threads int timeout int useragent string proxy string headersFile string } type customHeader struct { key string value string } var options *Options func parse_options() *Options { options := \u0026Options{} //flag.StringVar(\u0026options.mode, \"m\", \"\", \"find404|fmtjs|newjs\") flag.StringVar(\u0026options.InputFile, \"iL\", \"\", \"file contains url stirngs /input can be from os.stdin or pipe\") flag.BoolVar(\u0026options.Silent, \"s\", false, \"show only vuln sites\") flag.BoolVar(\u0026options.generatePoC, \"g\", false, \"gen PoC for vuln sites\") flag.IntVar(\u0026options.threads, \"t\", 50, \"limit concurrent threads num\") flag.IntVar(\u0026options.timeout, \"w\", 30, \"timeout seconds\") flag.StringVar(\u0026options.useragent, \"u\", \"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Custom User agent\") flag.StringVar(\u0026options.proxy, \"x\", \"\", \"Custom proxy,like http://127.0.0.1:8080\") flag.StringVar(\u0026options.headersFile, \"hf\", \"\", \"file contains Custom Headers,like Cookie: qwq\") flag.Parse() return options } var tr *http.Transport var client *http.Client var PoCdir string var customHeaders []customHeader func global_init() { tr = \u0026http.Transport{ //MaxIdleConns: 10, //MaxIdleConns: options.threads, //IdleConnTimeout: 30 * time.Second, //no good ，即使设了这个，单个请求超时时间还是会达到130秒 //DisableCompression: true, MaxIdleConnsPerHost: -1, TLSClientConfig: \u0026tls.Config{ InsecureSkipVerify: true, }, DisableKeepAlives: true, } // 如果指定了proxy，则所有请求都使用该proxy if options.proxy != \"\" { proxyUrl, err := url.Parse(options.proxy) if err != nil { fmt.Fprintln(os.Stderr, \"自定义的proxy格式有误，不设置代理\") } else { tr.Proxy = http.ProxyURL(proxyUrl) } } client = \u0026http.Client{ Transport: tr, Timeout: time.Duration(options.timeout) * time.Second, CheckRedirect: func(req *http.Request, via []*http.Request) error { redirect_limit := 20 if len(via) \u003e= redirect_limit { // 默认重定向次数是10次 return errors.New(fmt.Sprintf(\"stopped after %d redirects\", redirect_limit)) } return nil }, } if options.generatePoC { // 如果指定要生成PoC，则新建一个文件夹。 PoCdir = \"clickjackPoCs_\" + time.Now().Format(\"20060102_150405\") if _, err := os.Stat(PoCdir); os.IsNotExist(err) { err1 := os.Mkdir(PoCdir, 777) if err1 != nil { throwErr(\"创建PoC文件夹失败：\"+PoCdir, err1) } else { //fmt.Fprintln(os.Stderr,\"创建PoC文件夹成功：\"+PoCdir) abs, _ := filepath.Abs(PoCdir) throwErr(\"生成的PoC将存放在以下文件夹：\"+abs, nil) } } } //如果指定了自定义请求头的文件，则尝试解析请求头文件 if options.headersFile != \"\" { finput, err := os.Open(options.headersFile) if err != nil { throwErr(\"打开自定义header文件失败\", err) } scanner := bufio.NewScanner(finput) for scanner.Scan() { headerstring := scanner.Text() colon_index := strings.Index(headerstring, \":\") if colon_index == -1 { throwErr(\"自定义请求头格式有误\", nil) } key := headerstring[:colon_index] value := headerstring[colon_index+1:] customHeaders = append(customHeaders, customHeader{key, value}) } } } func throwErr(errdesc string, err error) { fmt.Fprintln(os.Stderr, strings.Repeat(\"-\", 50)) fmt.Fprintln(os.Stderr, errdesc) if err != nil { fmt.Fprintln(os.Stderr, err.Error()) } fmt.Fprintln(os.Stderr, strings.Repeat(\"-\", 50)) } func genClickjackingPoC(u string) string { uu, err := url.Parse(u) if err != nil { fmt.Fprintln(os.Stderr, \"为 %s 生成PoC时出现错误 [%s]\", u, err) } pocName := fmt.Sprintf(\"%s_%x.html\", uu.Host, md5.Sum([]byte(u))) pocFilename := path.Join(PoCdir, pocName) poc := fmt.Sprintf(` PoC of Clickjacking Batch Detect Clickjacking this site is vulnerable: %s\n`, u, u, u) f, err := os.Create(pocFilename) if err != nil { throwErr(\"创建PoC文件时出错\", err) } f.WriteString(poc) f.Close() return pocName } func is_vuln_to__clickjacking(url string) int { req, err := http.NewRequest(\"GET\", url, nil) if err != nil { throwErr(\"构造请求时出现错误：\", err) return 2 // 链接请求失败，需要进一步手工检查 } req.Header.Add(\"User-Agent\", options.useragent) for _, header := range customHeaders { req.Header.Add(header.key, header.value) } resp, err := client.Do(req) if err != nil { throwErr(\"发起请求时出现错误：\", err) return 2 // 链接请求失败，需要进一步手工检查 } //被 defer 的函数在 return 之后执行，用于释放资源 defer resp.Body.Close() //body, err := io.ReadAll(resp.Body) if len(resp.Header[\"X-Frame-Options\"]) == 0 { if options.generatePoC { fmt.Println(\"[vul]\\t\" + url + \"\\t\" + genClickjackingPoC(url)) } else { fmt.Println(\"[vul]\\t\" + url) } return 1 // 响应头没有XFO，确认受点击劫持漏洞影响 } else { if options.Silent == false { // 打印出具体的响应XFO头，便于人工判断 fmt.Println(fmt.Sprintf(\"[nop]\\t%s\\t[%d]%s\", url, resp.StatusCode, resp.Header[\"X-Frame-Options\"][0])) //fmt.Println(resp.Header) //fmt.Println(resp.StatusCode) } return 0 // 响应头有XFO，认为不受漏洞影响 // todo: 这里可以细分检测，比如XFO值是什么的时候还是可能有漏洞 sameorigin则没有漏洞 // todo: 有时域名无法解析，但响应头居然有xfo:deny，不知道是不是net/http自己加的，这个现象有点怪。 } } func batch_detect_clickjacking() { batchurl_filename := options.InputFile var scanner *bufio.Scanner if batchurl_filename != \"\" { finput, _ := os.Open(batchurl_filename) scanner = bufio.NewScanner(finput) } else { scanner = bufio.NewScanner(os.Stdin) } var wg sync.WaitGroup var ch = make(chan struct{}, options.threads) for scanner.Scan() { u, err := url.Parse(scanner.Text()) if err != nil { fmt.Fprintf(os.Stderr, \"failed to parse url %s [%s]\\n\", scanner.Text(), err) continue } wg.Add(1) ch \u003c- struct{}{} // acquire a token go func(url string) { defer wg.Done() is_vuln_to__clickjacking(url) \u003c-ch // release the token }(u.String()) } wg.Wait() } func main() { fmt.Fprintln(os.Stderr, banner) options = parse_options() global_init() batch_detect_clickjacking() } v1 早期单线程版本\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 package uispoof import ( \"bufio\" \"crypto/tls\" \"flag\" \"fmt\" \"net/http\" \"net/url\" \"os\" \"strings\" \"time\" ) // banner //https://manytools.org/hacker-tools/ascii-banner/ // Rounded font const banner = ` ______ _ ______ (____ \\ _ | | (______) _ _ ____) )_____ _| |_ ____| |__ _ _ _____ _| |_ _____ ____ _| |_ | __ ((____ (_ _) ___) _ \\ | | | | ___ (_ _) ___ |/ ___|_ _) | |__) ) ___ | | |( (___| | | | | |__/ /| ____| | |_| ____( (___ | |_ |______/\\_____| \\__)____)_| |_| |_____/ |_____) \\__)_____)\\____) \\__) _______ _ _ _ _ _ _ (_______) |(_) | | (_) | | (_) _ | | _ ____| | _ _ _____ ____| | _ _ ____ ____ | | | || |/ ___) |_/ )| (____ |/ ___) |_/ ) | _ \\ / _ | | |_____| || ( (___| _ ( | / ___ ( (___| _ (| | | | ( (_| | \\______)\\_)_|\\____)_| \\_)| \\_____|\\____)_| \\_)_|_| |_|\\___ | (__/ (_____| by findneo ` // options type Options struct { mode string InputFile string Verbose bool threads int useragent string proxy string } var options *Options func parse_options() *Options { options := \u0026Options{} flag.StringVar(\u0026options.mode, \"m\", \"\", \"find404|fmtjs|newjs\") flag.StringVar(\u0026options.InputFile, \"l\", \"\", \"file contains url stirngs\") flag.BoolVar(\u0026options.Verbose, \"v\", false, \"show X-Frame-Options header content in response\") flag.IntVar(\u0026options.threads, \"t\", 10, \"limit concurrent threads num\") flag.StringVar(\u0026options.useragent, \"u\", \"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Custom User agent\") flag.StringVar(\u0026options.proxy, \"x\", \"\", \"Custom proxy like http://127.0.0.1:8080\") flag.Parse() return options } var tr *http.Transport var client *http.Client func global_init(){ //fmt.Fprintln(os.Stderr,banner) tr = \u0026http.Transport{ MaxIdleConns: 10, IdleConnTimeout: 30 * time.Second, DisableCompression: true, TLSClientConfig: \u0026tls.Config{ InsecureSkipVerify: true, }, DisableKeepAlives: true, } // 如果指定了proxy，则所有请求都使用该proxy if options.proxy!=\"\"{ proxyUrl, err := url.Parse(options.proxy) if err!=nil{ fmt.Fprintln(os.Stderr,\"自定义的proxy格式有误，不设置代理\") } else{ tr.Proxy=http.ProxyURL(proxyUrl) } } client = \u0026http.Client{Transport: tr} } func is_vuln_to__clickjacking(url string) int{ req,err:=http.NewRequest(\"GET\",url,nil) if err != nil{ fmt.Fprintln(os.Stderr,\"构造请求时出现错误：\") fmt.Fprintln(os.Stderr,strings.Repeat(\"-\",50)) fmt.Fprintln(os.Stderr,err.Error()) fmt.Fprintln(os.Stderr,strings.Repeat(\"-\",50)) return 2 // 链接请求失败，需要进一步手工检查 } req.Header.Add(\"User-Agent\",options.useragent) resp, err := client.Do(req) if err != nil { fmt.Fprintln(os.Stderr,\"发起请求时出现错误：\") fmt.Fprintln(os.Stderr,strings.Repeat(\"-\",50)) fmt.Fprintln(os.Stderr,err.Error()) fmt.Fprintln(os.Stderr,strings.Repeat(\"-\",50)) return 2 // 链接请求失败，需要进一步手工检查 } //被 defer 的函数在 return 之后执行，用于释放资源 defer resp.Body.Close() //body, err := io.ReadAll(resp.Body) if len(resp.Header[\"X-Frame-Options\"])==0 { fmt.Println(\"[vul]\"+url) return 1 // 响应头没有XFO，确认受点击劫持漏洞影响 }else{ if options.Verbose==true{ // 打印出具体的响应XFO头，便于人工判断 fmt.Println(\"[nop]\"+url+\"\\t[\"+fmt.Sprintf(\"%d\",resp.StatusCode)+\"]\"+resp.Header[\"X-Frame-Options\"][0]) //fmt.Println(resp.Header) //fmt.Println(resp.StatusCode) } return 0 // 响应头有XFO，认为不受漏洞影响 // todo: 这里可以细分检测，比如XFO值是什么的时候还是可能有漏洞 sameorigin则没有漏洞 } } func batch_detect_clickjacking() { sc := bufio.NewScanner(os.Stdin) for sc.Scan() { u, err := url.Parse(sc.Text()) if err != nil { fmt.Fprintf(os.Stderr, \"failed to parse url %s [%s]\\n\", sc.Text(), err) continue } is_vuln_to__clickjacking(u.String()) } } func main() { options = parse_options() global_init() batch_detect_clickjacking() } 参考文档 点击劫持防御备忘单 点击劫持攻击 ","wordCount":"1923","inLanguage":"en","datePublished":"2021-05-28T22:24:58+08:00","dateModified":"2021-05-28T22:24:58+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://ret2neo.cn/post/210528-click-jacking-batch-detect/"},"publisher":{"@type":"Organization","name":"闲言语","logo":{"@type":"ImageObject","url":"https://ret2neo.cn/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://ret2neo.cn/ accesskey=h title="闲言语 (Alt + H)">闲言语</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://ret2neo.cn/mind/ title=随笔><span>随笔</span></a></li><li><a href=https://ret2neo.cn/about title=关于><span>关于</span></a></li><li><a href=https://ret2neo.cn/search title="搜索 (Alt + /)" accesskey=/><span>搜索</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>点击劫持漏洞的批量检测</h1><div class=post-meta><span title='2021-05-28 22:24:58 +0800 +0800'>May 28, 2021</span>&nbsp;|&nbsp;<a href=https://github.dev/findneo/priblog/content/post/210528-click-jacking-batch-detect.md rel="noopener noreferrer" target=_blank>edit</a></div></header><aside id=toc-container class="toc-container wide"><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>目录</span></summary><div class=inner><ul><li><a href=#%e6%a6%82%e8%bf%b0 aria-label=概述>概述</a></li><li><a href=#%e5%b8%b8%e8%a7%81%e7%94%a8%e6%b3%95 aria-label=常见用法>常见用法</a></li><li><a href=#%e6%94%af%e6%8c%81%e5%8f%82%e6%95%b0 aria-label=支持参数>支持参数</a></li><li><a href=#%e6%bc%8f%e6%b4%9e%e5%8e%9f%e7%90%86%e5%8f%8a%e5%8d%b1%e5%ae%b3 aria-label=漏洞原理及危害>漏洞原理及危害</a></li><li><a href=#%e6%bc%8f%e6%b4%9e%e4%bf%ae%e5%a4%8d%e6%96%b9%e6%b3%95 aria-label=漏洞修复方法>漏洞修复方法</a></li><li><a href=#%e6%bc%8f%e6%b4%9e%e7%a4%ba%e6%84%8fdemo aria-label=漏洞示意demo>漏洞示意demo</a></li><li><a href=#%e5%b7%a5%e5%85%b7%e6%ba%90%e7%a0%81 aria-label=工具源码>工具源码</a><ul><li><a href=#v2 aria-label=v2>v2</a></li><li><a href=#v1 aria-label=v1>v1</a></li></ul></li><li><a href=#%e5%8f%82%e8%80%83%e6%96%87%e6%a1%a3 aria-label=参考文档>参考文档</a></li></ul></div></details></div></aside><script>let activeElement,elements;window.addEventListener("DOMContentLoaded",function(){checkTocPosition(),elements=document.querySelectorAll("h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]"),activeElement=elements[0];const t=encodeURI(activeElement.getAttribute("id")).toLowerCase();document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active")},!1),window.addEventListener("resize",function(){checkTocPosition()},!1),window.addEventListener("scroll",()=>{activeElement=Array.from(elements).find(e=>{if(getOffsetTop(e)-window.pageYOffset>0&&getOffsetTop(e)-window.pageYOffset<window.innerHeight/2)return e})||activeElement,elements.forEach(e=>{const t=encodeURI(e.getAttribute("id")).toLowerCase();e===activeElement?document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active"):document.querySelector(`.inner ul li a[href="#${t}"]`).classList.remove("active")})},!1);const main=parseInt(getComputedStyle(document.body).getPropertyValue("--article-width"),10),toc=parseInt(getComputedStyle(document.body).getPropertyValue("--toc-width"),10),gap=parseInt(getComputedStyle(document.body).getPropertyValue("--gap"),10);function checkTocPosition(){const e=document.body.scrollWidth;e-main-toc*2-gap*4>0?document.getElementById("toc-container").classList.add("wide"):document.getElementById("toc-container").classList.remove("wide")}function getOffsetTop(e){if(!e.getClientRects().length)return 0;let t=e.getBoundingClientRect(),n=e.ownerDocument.defaultView;return t.top+n.pageYOffset}</script><div class=post-content><h1 id=概述>概述<a hidden class=anchor aria-hidden=true href=#概述>#</a></h1><p>batchDetectClickjacking可以用于自动化批量检测和利用点击劫持类漏洞。支持</p><ul><li>对多个HTTP站点批量快速检测</li><li>对存在点击劫持类漏洞的网站生成利用代码PoC</li><li>指定检测时使用的并发线程数</li><li>从管道或文件输入被测站点</li><li>指定单个网站检测的超时时间</li><li>指定检测时使用的网络代理</li><li>指定检测时使用的User-Agent</li></ul><h1 id=常见用法>常见用法<a hidden class=anchor aria-hidden=true href=#常见用法>#</a></h1><p><img loading=lazy src=ffb688051afca7aa1.png alt></p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-1>1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-2>2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-3>3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-4>4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-5>5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-6>6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-7>7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-8>8</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># 检测单个网站链接是否受点击劫持漏洞影响</span>
</span></span><span style=display:flex><span>echo https://www.qq.com | ./batchDetectClickjacking
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 检测文件urls.txt中的多个链接</span>
</span></span><span style=display:flex><span>cat urls.txt | ./batchDetectClickjacking
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 使用100个线程检测大量url链接，只显示存在漏洞的网站，同时为每个漏洞网站生成PoC</span>
</span></span><span style=display:flex><span>./batchDetectClickjacking -iL urls.txt -s -g -t <span style=color:#ae81ff>100</span>
</span></span></code></pre></td></tr></table></div></div><h1 id=支持参数>支持参数<a hidden class=anchor aria-hidden=true href=#支持参数>#</a></h1><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-1>1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-2>2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-3>3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-4>4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-5>5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-6>6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-7>7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-8>8</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>-h 查看帮助
</span></span><span style=display:flex><span>-g 为存在漏洞的网站生成PoC
</span></span><span style=display:flex><span>-iL 指定一个文件，其中包含若干待检测的网站地址，每行一个
</span></span><span style=display:flex><span>-s 只显示存在漏洞的网站；默认情况下还会显示不存在漏洞的网站链接并显示响应头的X-Frame-Options值。
</span></span><span style=display:flex><span>-t 指定检测时候使用的线程数，默认情况下是50个线程
</span></span><span style=display:flex><span>-u 指定发起请求使用的UA，默认情况下是Firefox
</span></span><span style=display:flex><span>-w 指定每个请求的超时时间，默认情况下是30s
</span></span><span style=display:flex><span>-x 指定发起请求使用的网络代理，可以用于和burpsuite联动
</span></span></code></pre></td></tr></table></div></div><h1 id=漏洞原理及危害>漏洞原理及危害<a hidden class=anchor aria-hidden=true href=#漏洞原理及危害>#</a></h1><p>点击劫持攻击，也称UI覆盖攻击，允许恶意页面以用户的名义点击“受害网站”，欺骗用户进行转账、点赞、关注、转发等操作，或者窃取用户凭据。</p><p>一个典型的利用场景是欺骗用户进行转账、点赞、关注或转发。如果业务网站的某正常功能页面A存在点击劫持漏洞，攻击者可以在恶意网站B中使用iframe标签包含A页面，但将A页面置顶并设为透明，这样用户认为自己在B网站上点击时，实际上是在被欺骗着点击了A网站。从而恶意网站B能够做到以用户名义点击A网站，进行转账、转发等敏感操作。</p><p>另一种典型的利用场景是窃取用户账号密码等身份凭据。如果业务网站的某正常功能页面A存在点击劫持漏洞，攻击者可以在恶意网站B包含A页面，将A页面置底并将B网站设为透明，这样用户认为自己在A网站进行输入时，实际上输入数据会被B网站获取到。</p><h1 id=漏洞修复方法>漏洞修复方法<a hidden class=anchor aria-hidden=true href=#漏洞修复方法>#</a></h1><p>主要有两种方式可以防御点击劫持，第一种是X-Frame-Options头信息（推荐使用，但可能有些浏览器不支持）；第二种方式是使用javascript编写嵌入阻断代码（代码编写不当时可能被绕过，但当流量经过的某些web代理可能被去掉X-Frame-Options头时可以考虑这种方式）。</p><p>X-Frame-Options HTTP响应头能用来向浏览器指明是否允许渲染在iframe标签内的页面。网站可以用它来确保网站内容不被嵌入到其他站点，从而避免遭受点击劫持攻击。X-Frame-Options头信息有三种可用的值:，推荐使用SAMEORIGIN或DENY。</p><ul><li>DENY，阻止所有的域名嵌入此页面。.</li><li>SAMEORIGIN，只允许同源站点嵌入此页面。</li><li>ALLOW-FROM uri，允许指定的“URI”嵌入此页面（如ALLOW-FROM <a href=http://www.example.com>http://www.example.com</a> ，则允许www.example.com嵌入此页面）。ALLOW-FROM选项是2012年左右添加的, 所以一些旧浏览器可能不支持这个参数。不要依赖ALLOW-FROM参数。如果你使用这个选项，但是浏览器不支持它，那相当于你没有做任何点击劫持防御。</li></ul><h1 id=漏洞示意demo>漏洞示意demo<a hidden class=anchor aria-hidden=true href=#漏洞示意demo>#</a></h1><p>正常业务网站A（存在点击劫持漏洞）: http://localhost:8090/sitea.html</p><p><img loading=lazy src=77902c7ee7aa59558.png alt></p><p>恶意网站B（实际攻击中会将A网站完全透明化）：http://localhost:8091/siteb.html</p><p><img loading=lazy src=caca70f1c9a047575.png alt></p><p>用户被吸引点击彩色按钮时实际上可能触发转账或者转发的操作。</p><p>demo源码：
sitea.html</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-13>13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-14>14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-15>15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-16><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-16>16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-17><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-17>17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-18><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-18>18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-19><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-19>19</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-20><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-20>20</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>&lt;<span style=color:#f92672>html</span><span style=color:#960050;background-color:#1e0010> </span><span style=color:#a6e22e>lang</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;en-US&#34;</span>&gt;
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>head</span>&gt;
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>meta</span><span style=color:#960050;background-color:#1e0010> </span><span style=color:#a6e22e>charset</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;UTF-8&#34;</span>&gt;
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>title</span>&gt;I Frame&lt;/<span style=color:#f92672>title</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>style</span>&gt;
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>        </span><span style=color:#f92672>body</span><span style=color:#960050;background-color:#1e0010> </span>{
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>            </span><span style=color:#66d9ef>background-color</span>:<span style=color:#960050;background-color:#1e0010> </span><span style=color:#ae81ff>#93B874</span>;
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>        </span>}
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>    </span>&lt;/<span style=color:#f92672>style</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>head</span>&gt;
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>body</span>&gt;
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>h1</span><span style=color:#960050;background-color:#1e0010> </span><span style=color:#a6e22e>align</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;center&#34;</span>&gt;A 网站：提供正常业务，可以点击进行转账等敏感操作&lt;/<span style=color:#f92672>h1</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>br</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>p</span><span style=color:#960050;background-color:#1e0010> </span><span style=color:#a6e22e>align</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;center&#34;</span>&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>button</span><span style=color:#960050;background-color:#1e0010> </span><span style=color:#a6e22e>style</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;height:100px;width:180px;background:grey&#34;</span>&gt;喜欢这篇文章吗？&lt;<span style=color:#f92672>br</span>&gt;点这个按钮给作者转账&lt;/<span style=color:#f92672>button</span>&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>br</span>&gt;&lt;<span style=color:#f92672>br</span>&gt;&lt;<span style=color:#f92672>br</span>&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>button</span><span style=color:#960050;background-color:#1e0010> </span><span style=color:#a6e22e>style</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;height:125px;width:250px;background:grey&#34;</span>&gt;不喜欢这篇文章吗？&lt;<span style=color:#f92672>br</span>&gt;点这个按钮转发文章，让更多人讨厌它&lt;/<span style=color:#f92672>button</span>&gt;
</span></span><span style=display:flex><span>    &lt;/<span style=color:#f92672>p</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>body</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>html</span>&gt;
</span></span></code></pre></td></tr></table></div></div><p>siteb</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-13>13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-14>14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-15>15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-16><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-16>16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-17><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-17>17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-18><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-18>18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-19><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-19>19</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-20><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-20>20</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-21><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-21>21</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-22><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-22>22</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-23><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-23>23</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-24><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-24>24</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-25><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-25>25</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-26><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-26>26</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-27><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-27>27</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-28><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-28>28</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-29><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-29>29</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-30><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-30>30</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-31><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-31>31</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-32><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-32>32</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-33><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-33>33</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-34><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-34>34</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-35><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-35>35</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-36><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-36>36</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-37><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-37>37</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>&lt;<span style=color:#f92672>html</span><span style=color:#960050;background-color:#1e0010> </span><span style=color:#a6e22e>lang</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;zh-CN&#34;</span>&gt;
</span></span><span style=display:flex><span>  &lt;<span style=color:#f92672>head</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>meta</span><span style=color:#960050;background-color:#1e0010> </span><span style=color:#a6e22e>charset</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;UTF-8&#34;</span><span style=color:#960050;background-color:#1e0010> </span>/&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>title</span>&gt;彩票开奖网站&lt;/<span style=color:#f92672>title</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>style</span>&gt;
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>        </span>#target_website<span style=color:#960050;background-color:#1e0010> </span>{
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>        </span><span style=color:#66d9ef>position</span>:<span style=color:#66d9ef>absolute</span>;
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>        </span><span style=color:#66d9ef>width</span>:<span style=color:#ae81ff>2000</span><span style=color:#66d9ef>px</span>;
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>        </span><span style=color:#66d9ef>height</span>:<span style=color:#ae81ff>1280</span><span style=color:#66d9ef>px</span>;
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>        </span><span style=color:#66d9ef>opacity</span>:<span style=color:#ae81ff>0.2</span>;
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>        </span><span style=color:#66d9ef>z-index</span>:<span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>      </span>}
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>    </span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>        </span>#decoy_website<span style=color:#960050;background-color:#1e0010> </span>{
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>        </span><span style=color:#66d9ef>position</span>:<span style=color:#66d9ef>absolute</span>;
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>        </span><span style=color:#66d9ef>width</span>:<span style=color:#ae81ff>2000</span><span style=color:#66d9ef>px</span>;
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>        </span><span style=color:#66d9ef>height</span>:<span style=color:#ae81ff>1280</span><span style=color:#66d9ef>px</span>;
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>        </span><span style=color:#66d9ef>z-index</span>:<span style=color:#ae81ff>-1</span>;
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>      </span>}
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>    </span>&lt;/<span style=color:#f92672>style</span>&gt;
</span></span><span style=display:flex><span>  &lt;/<span style=color:#f92672>head</span>&gt;
</span></span><span style=display:flex><span>  &lt;<span style=color:#f92672>body</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>div</span><span style=color:#960050;background-color:#1e0010> </span><span style=color:#a6e22e>id</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;decoy_website&#34;</span><span style=color:#960050;background-color:#1e0010> </span><span style=color:#a6e22e>align</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;center&#34;</span>&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>br</span>&gt;&lt;<span style=color:#f92672>h1</span><span style=color:#960050;background-color:#1e0010> </span>&gt;B网站：花里胡哨但会吸引人进行点击操作的恶意网站&lt;/<span style=color:#f92672>h1</span>&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>p</span><span style=color:#960050;background-color:#1e0010> </span><span style=color:#a6e22e>align</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;center&#34;</span>&gt;
</span></span><span style=display:flex><span>            &lt;<span style=color:#f92672>button</span><span style=color:#960050;background-color:#1e0010> </span><span style=color:#a6e22e>style</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;height:30px;width:140px;background:red&#34;</span>&gt;点这个按钮抽大奖&lt;/<span style=color:#f92672>button</span>&gt;
</span></span><span style=display:flex><span>            &lt;<span style=color:#f92672>br</span>&gt;&lt;<span style=color:#f92672>br</span>&gt;&lt;<span style=color:#f92672>br</span>&gt;&lt;<span style=color:#f92672>br</span>&gt;&lt;<span style=color:#f92672>br</span>&gt;
</span></span><span style=display:flex><span>            &lt;<span style=color:#f92672>b</span><span style=color:#960050;background-color:#1e0010> </span><span style=color:#a6e22e>style</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;color:blue&#34;</span>&gt;快来点我啊，点我有惊喜！！！&lt;/<span style=color:#f92672>b</span>&gt;
</span></span><span style=display:flex><span>            &lt;<span style=color:#f92672>br</span>&gt;&lt;<span style=color:#f92672>br</span>&gt;
</span></span><span style=display:flex><span>            &lt;<span style=color:#f92672>button</span><span style=color:#960050;background-color:#1e0010> </span><span style=color:#a6e22e>style</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;height:30px;width:140px;background:green&#34;</span>&gt;点这个按钮领红包&lt;/<span style=color:#f92672>button</span>&gt;
</span></span><span style=display:flex><span>        &lt;/<span style=color:#f92672>p</span>&gt;
</span></span><span style=display:flex><span>    &lt;/<span style=color:#f92672>div</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>div</span><span style=color:#960050;background-color:#1e0010> </span><span style=color:#a6e22e>id</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;target_website&#34;</span><span style=color:#960050;background-color:#1e0010> </span><span style=color:#a6e22e>align</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;center&#34;</span>&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>iframe</span><span style=color:#960050;background-color:#1e0010> </span><span style=color:#a6e22e>src</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;http://localhost:8090/sitea.html&#34;</span><span style=color:#960050;background-color:#1e0010> </span><span style=color:#a6e22e>height</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;40%&#34;</span><span style=color:#960050;background-color:#1e0010> </span><span style=color:#a6e22e>width</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;40%&#34;</span><span style=color:#960050;background-color:#1e0010> </span><span style=color:#a6e22e>align</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;middle&#34;</span><span style=color:#960050;background-color:#1e0010> </span><span style=color:#a6e22e>allowtransparency</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;true&#34;</span>&gt;&lt;/<span style=color:#f92672>iframe</span>&gt;
</span></span><span style=display:flex><span>    &lt;/<span style=color:#f92672>div</span>&gt;
</span></span><span style=display:flex><span>  &lt;/<span style=color:#f92672>body</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>html</span>&gt;
</span></span></code></pre></td></tr></table></div></div><h1 id=工具源码>工具源码<a hidden class=anchor aria-hidden=true href=#工具源码>#</a></h1><h2 id=v2>v2<a hidden class=anchor aria-hidden=true href=#v2>#</a></h2><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-1>  1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-2>  2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-3>  3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-4>  4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-5>  5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-6>  6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-7>  7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-8>  8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-9>  9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-10> 10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-11> 11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-12> 12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-13> 13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-14> 14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-15> 15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-16><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-16> 16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-17><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-17> 17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-18><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-18> 18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-19><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-19> 19</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-20><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-20> 20</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-21><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-21> 21</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-22><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-22> 22</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-23><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-23> 23</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-24><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-24> 24</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-25><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-25> 25</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-26><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-26> 26</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-27><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-27> 27</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-28><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-28> 28</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-29><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-29> 29</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-30><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-30> 30</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-31><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-31> 31</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-32><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-32> 32</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-33><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-33> 33</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-34><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-34> 34</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-35><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-35> 35</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-36><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-36> 36</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-37><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-37> 37</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-38><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-38> 38</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-39><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-39> 39</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-40><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-40> 40</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-41><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-41> 41</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-42><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-42> 42</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-43><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-43> 43</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-44><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-44> 44</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-45><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-45> 45</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-46><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-46> 46</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-47><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-47> 47</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-48><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-48> 48</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-49><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-49> 49</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-50><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-50> 50</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-51><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-51> 51</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-52><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-52> 52</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-53><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-53> 53</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-54><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-54> 54</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-55><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-55> 55</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-56><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-56> 56</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-57><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-57> 57</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-58><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-58> 58</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-59><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-59> 59</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-60><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-60> 60</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-61><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-61> 61</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-62><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-62> 62</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-63><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-63> 63</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-64><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-64> 64</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-65><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-65> 65</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-66><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-66> 66</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-67><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-67> 67</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-68><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-68> 68</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-69><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-69> 69</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-70><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-70> 70</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-71><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-71> 71</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-72><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-72> 72</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-73><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-73> 73</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-74><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-74> 74</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-75><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-75> 75</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-76><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-76> 76</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-77><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-77> 77</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-78><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-78> 78</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-79><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-79> 79</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-80><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-80> 80</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-81><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-81> 81</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-82><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-82> 82</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-83><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-83> 83</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-84><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-84> 84</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-85><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-85> 85</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-86><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-86> 86</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-87><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-87> 87</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-88><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-88> 88</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-89><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-89> 89</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-90><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-90> 90</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-91><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-91> 91</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-92><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-92> 92</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-93><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-93> 93</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-94><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-94> 94</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-95><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-95> 95</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-96><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-96> 96</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-97><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-97> 97</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-98><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-98> 98</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-99><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-99> 99</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-100><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-100>100</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-101><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-101>101</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-102><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-102>102</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-103><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-103>103</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-104><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-104>104</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-105><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-105>105</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-106><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-106>106</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-107><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-107>107</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-108><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-108>108</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-109><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-109>109</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-110><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-110>110</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-111><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-111>111</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-112><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-112>112</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-113><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-113>113</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-114><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-114>114</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-115><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-115>115</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-116><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-116>116</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-117><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-117>117</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-118><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-118>118</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-119><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-119>119</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-120><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-120>120</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-121><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-121>121</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-122><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-122>122</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-123><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-123>123</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-124><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-124>124</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-125><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-125>125</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-126><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-126>126</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-127><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-127>127</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-128><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-128>128</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-129><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-129>129</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-130><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-130>130</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-131><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-131>131</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-132><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-132>132</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-133><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-133>133</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-134><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-134>134</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-135><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-135>135</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-136><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-136>136</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-137><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-137>137</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-138><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-138>138</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-139><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-139>139</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-140><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-140>140</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-141><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-141>141</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-142><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-142>142</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-143><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-143>143</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-144><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-144>144</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-145><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-145>145</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-146><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-146>146</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-147><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-147>147</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-148><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-148>148</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-149><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-149>149</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-150><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-150>150</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-151><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-151>151</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-152><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-152>152</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-153><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-153>153</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-154><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-154>154</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-155><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-155>155</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-156><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-156>156</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-157><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-157>157</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-158><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-158>158</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-159><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-159>159</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-160><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-160>160</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-161><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-161>161</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-162><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-162>162</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-163><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-163>163</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-164><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-164>164</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-165><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-165>165</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-166><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-166>166</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-167><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-167>167</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-168><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-168>168</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-169><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-169>169</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-170><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-170>170</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-171><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-171>171</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-172><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-172>172</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-173><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-173>173</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-174><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-174>174</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-175><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-175>175</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-176><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-176>176</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-177><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-177>177</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-178><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-178>178</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-179><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-179>179</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-180><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-180>180</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-181><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-181>181</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-182><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-182>182</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-183><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-183>183</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-184><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-184>184</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-185><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-185>185</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-186><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-186>186</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-187><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-187>187</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-188><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-188>188</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-189><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-189>189</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-190><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-190>190</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-191><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-191>191</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-192><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-192>192</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-193><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-193>193</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-194><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-194>194</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-195><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-195>195</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-196><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-196>196</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-197><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-197>197</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-198><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-198>198</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-199><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-199>199</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-200><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-200>200</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-201><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-201>201</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-202><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-202>202</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-203><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-203>203</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-204><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-204>204</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-205><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-205>205</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-206><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-206>206</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-207><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-207>207</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-208><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-208>208</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-209><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-209>209</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-210><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-210>210</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-211><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-211>211</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-212><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-212>212</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-213><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-213>213</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-214><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-214>214</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-215><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-215>215</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-216><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-216>216</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-217><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-217>217</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-218><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-218>218</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-219><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-219>219</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-220><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-220>220</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-221><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-221>221</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-222><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-222>222</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-223><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-223>223</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-224><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-224>224</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-225><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-225>225</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-226><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-226>226</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-227><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-227>227</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-228><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-228>228</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-229><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-229>229</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-230><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-230>230</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-231><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-231>231</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-232><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-232>232</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-233><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-233>233</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-234><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-234>234</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-235><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-235>235</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-236><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-236>236</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-237><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-237>237</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-238><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-238>238</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-239><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-239>239</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-240><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-240>240</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-241><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-241>241</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-242><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-242>242</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-243><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-243>243</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-244><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-244>244</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-245><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-245>245</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-246><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-246>246</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-247><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-247>247</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-248><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-248>248</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-249><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-249>249</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-250><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-250>250</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-251><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-251>251</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-252><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-252>252</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-253><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-253>253</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-254><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-254>254</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-255><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-255>255</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-256><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-256>256</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-257><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-257>257</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-258><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-258>258</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-259><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-259>259</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-260><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-260>260</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-261><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-261>261</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-262><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-262>262</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-263><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-263>263</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-264><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-264>264</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-265><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-265>265</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-266><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-266>266</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-267><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-267>267</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-268><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-268>268</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-269><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-269>269</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-270><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-270>270</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-271><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-271>271</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#f92672>package</span> <span style=color:#a6e22e>main</span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> (
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;bufio&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;crypto/md5&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;crypto/tls&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;errors&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;flag&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;fmt&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;net/http&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;net/url&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;os&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;path&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;path/filepath&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;strings&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;sync&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;time&#34;</span>
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>//batchDetectClickjacking.go
</span></span></span><span style=display:flex><span><span style=color:#75715e>// usage
</span></span></span><span style=display:flex><span><span style=color:#75715e>//sort -u  /mnt/d/record/burphttp/monitor/domain | httpx | ./batchDetectClickjacking -x http://127.0.0.1:8080 -v -t 50 | tee -a res.txt
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>// banner
</span></span></span><span style=display:flex><span><span style=color:#75715e>//https://manytools.org/hacker-tools/ascii-banner/
</span></span></span><span style=display:flex><span><span style=color:#75715e>// Rounded font
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>banner</span> = <span style=color:#e6db74>`
</span></span></span><span style=display:flex><span><span style=color:#e6db74> ______                   _        ______                                
</span></span></span><span style=display:flex><span><span style=color:#e6db74>(____  \         _       | |      (______)         _                 _   
</span></span></span><span style=display:flex><span><span style=color:#e6db74> ____)  )_____ _| |_ ____| |__     _     _ _____ _| |_ _____  ____ _| |_ 
</span></span></span><span style=display:flex><span><span style=color:#e6db74>|  __  ((____ (_   _) ___)  _ \   | |   | | ___ (_   _) ___ |/ ___|_   _)
</span></span></span><span style=display:flex><span><span style=color:#e6db74>| |__)  ) ___ | | |( (___| | | |  | |__/ /| ____| | |_| ____( (___  | |_ 
</span></span></span><span style=display:flex><span><span style=color:#e6db74>|______/\_____|  \__)____)_| |_|  |_____/ |_____)  \__)_____)\____)  \__)
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                                                                         
</span></span></span><span style=display:flex><span><span style=color:#e6db74> _______ _  _       _      _             _     _                         
</span></span></span><span style=display:flex><span><span style=color:#e6db74>(_______) |(_)     | |    (_)           | |   (_)                        
</span></span></span><span style=display:flex><span><span style=color:#e6db74> _      | | _  ____| |  _  _ _____  ____| |  _ _ ____   ____             
</span></span></span><span style=display:flex><span><span style=color:#e6db74>| |     | || |/ ___) |_/ )| (____ |/ ___) |_/ ) |  _ \ / _  |            
</span></span></span><span style=display:flex><span><span style=color:#e6db74>| |_____| || ( (___|  _ ( | / ___ ( (___|  _ (| | | | ( (_| |            
</span></span></span><span style=display:flex><span><span style=color:#e6db74> \______)\_)_|\____)_| \_)| \_____|\____)_| \_)_|_| |_|\___ |            
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                        (__/                          (_____| by findneo
</span></span></span><span style=display:flex><span><span style=color:#e6db74>`</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// options
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>type</span> <span style=color:#a6e22e>Options</span> <span style=color:#66d9ef>struct</span> {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>mode</span>        <span style=color:#66d9ef>string</span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>InputFile</span>   <span style=color:#66d9ef>string</span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>Silent</span>      <span style=color:#66d9ef>bool</span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>generatePoC</span> <span style=color:#66d9ef>bool</span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>threads</span>     <span style=color:#66d9ef>int</span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>timeout</span>     <span style=color:#66d9ef>int</span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>useragent</span>   <span style=color:#66d9ef>string</span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>proxy</span>       <span style=color:#66d9ef>string</span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>headersFile</span> <span style=color:#66d9ef>string</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#66d9ef>type</span> <span style=color:#a6e22e>customHeader</span> <span style=color:#66d9ef>struct</span> {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>key</span>   <span style=color:#66d9ef>string</span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>value</span> <span style=color:#66d9ef>string</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>options</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>Options</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>parse_options</span>() <span style=color:#f92672>*</span><span style=color:#a6e22e>Options</span> {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>options</span> <span style=color:#f92672>:=</span> <span style=color:#f92672>&amp;</span><span style=color:#a6e22e>Options</span>{}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#75715e>//flag.StringVar(&amp;options.mode, &#34;m&#34;, &#34;&#34;, &#34;find404|fmtjs|newjs&#34;)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#a6e22e>flag</span>.<span style=color:#a6e22e>StringVar</span>(<span style=color:#f92672>&amp;</span><span style=color:#a6e22e>options</span>.<span style=color:#a6e22e>InputFile</span>, <span style=color:#e6db74>&#34;iL&#34;</span>, <span style=color:#e6db74>&#34;&#34;</span>, <span style=color:#e6db74>&#34;file contains url stirngs /input can be from os.stdin or pipe&#34;</span>)
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>flag</span>.<span style=color:#a6e22e>BoolVar</span>(<span style=color:#f92672>&amp;</span><span style=color:#a6e22e>options</span>.<span style=color:#a6e22e>Silent</span>, <span style=color:#e6db74>&#34;s&#34;</span>, <span style=color:#66d9ef>false</span>, <span style=color:#e6db74>&#34;show only vuln sites&#34;</span>)
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>flag</span>.<span style=color:#a6e22e>BoolVar</span>(<span style=color:#f92672>&amp;</span><span style=color:#a6e22e>options</span>.<span style=color:#a6e22e>generatePoC</span>, <span style=color:#e6db74>&#34;g&#34;</span>, <span style=color:#66d9ef>false</span>, <span style=color:#e6db74>&#34;gen PoC for vuln sites&#34;</span>)
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>flag</span>.<span style=color:#a6e22e>IntVar</span>(<span style=color:#f92672>&amp;</span><span style=color:#a6e22e>options</span>.<span style=color:#a6e22e>threads</span>, <span style=color:#e6db74>&#34;t&#34;</span>, <span style=color:#ae81ff>50</span>, <span style=color:#e6db74>&#34;limit concurrent threads num&#34;</span>)
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>flag</span>.<span style=color:#a6e22e>IntVar</span>(<span style=color:#f92672>&amp;</span><span style=color:#a6e22e>options</span>.<span style=color:#a6e22e>timeout</span>, <span style=color:#e6db74>&#34;w&#34;</span>, <span style=color:#ae81ff>30</span>, <span style=color:#e6db74>&#34;timeout seconds&#34;</span>)
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>flag</span>.<span style=color:#a6e22e>StringVar</span>(<span style=color:#f92672>&amp;</span><span style=color:#a6e22e>options</span>.<span style=color:#a6e22e>useragent</span>, <span style=color:#e6db74>&#34;u&#34;</span>, <span style=color:#e6db74>&#34;Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36&#34;</span>, <span style=color:#e6db74>&#34;Custom User agent&#34;</span>)
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>flag</span>.<span style=color:#a6e22e>StringVar</span>(<span style=color:#f92672>&amp;</span><span style=color:#a6e22e>options</span>.<span style=color:#a6e22e>proxy</span>, <span style=color:#e6db74>&#34;x&#34;</span>, <span style=color:#e6db74>&#34;&#34;</span>, <span style=color:#e6db74>&#34;Custom proxy,like http://127.0.0.1:8080&#34;</span>)
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>flag</span>.<span style=color:#a6e22e>StringVar</span>(<span style=color:#f92672>&amp;</span><span style=color:#a6e22e>options</span>.<span style=color:#a6e22e>headersFile</span>, <span style=color:#e6db74>&#34;hf&#34;</span>, <span style=color:#e6db74>&#34;&#34;</span>, <span style=color:#e6db74>&#34;file contains Custom Headers,like Cookie: qwq&#34;</span>)
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>flag</span>.<span style=color:#a6e22e>Parse</span>()
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>return</span> <span style=color:#a6e22e>options</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>tr</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>http</span>.<span style=color:#a6e22e>Transport</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>client</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>http</span>.<span style=color:#a6e22e>Client</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>PoCdir</span> <span style=color:#66d9ef>string</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>customHeaders</span> []<span style=color:#a6e22e>customHeader</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>global_init</span>() {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>tr</span> = <span style=color:#f92672>&amp;</span><span style=color:#a6e22e>http</span>.<span style=color:#a6e22e>Transport</span>{
</span></span><span style=display:flex><span>		<span style=color:#75715e>//MaxIdleConns:       10,
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>		<span style=color:#75715e>//MaxIdleConns:       options.threads,
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>		<span style=color:#75715e>//IdleConnTimeout:    30 * time.Second, //no good ，即使设了这个，单个请求超时时间还是会达到130秒
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>		<span style=color:#75715e>//DisableCompression: true,
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>		<span style=color:#a6e22e>MaxIdleConnsPerHost</span>: <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>TLSClientConfig</span>: <span style=color:#f92672>&amp;</span><span style=color:#a6e22e>tls</span>.<span style=color:#a6e22e>Config</span>{
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>InsecureSkipVerify</span>: <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>		},
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>DisableKeepAlives</span>: <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#75715e>// 如果指定了proxy，则所有请求都使用该proxy
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>options</span>.<span style=color:#a6e22e>proxy</span> <span style=color:#f92672>!=</span> <span style=color:#e6db74>&#34;&#34;</span> {
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>proxyUrl</span>, <span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>url</span>.<span style=color:#a6e22e>Parse</span>(<span style=color:#a6e22e>options</span>.<span style=color:#a6e22e>proxy</span>)
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Fprintln</span>(<span style=color:#a6e22e>os</span>.<span style=color:#a6e22e>Stderr</span>, <span style=color:#e6db74>&#34;自定义的proxy格式有误，不设置代理&#34;</span>)
</span></span><span style=display:flex><span>		} <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>tr</span>.<span style=color:#a6e22e>Proxy</span> = <span style=color:#a6e22e>http</span>.<span style=color:#a6e22e>ProxyURL</span>(<span style=color:#a6e22e>proxyUrl</span>)
</span></span><span style=display:flex><span>		}
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>client</span> = <span style=color:#f92672>&amp;</span><span style=color:#a6e22e>http</span>.<span style=color:#a6e22e>Client</span>{
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>Transport</span>: <span style=color:#a6e22e>tr</span>,
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>Timeout</span>:   <span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>Duration</span>(<span style=color:#a6e22e>options</span>.<span style=color:#a6e22e>timeout</span>) <span style=color:#f92672>*</span> <span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>Second</span>,
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>CheckRedirect</span>: <span style=color:#66d9ef>func</span>(<span style=color:#a6e22e>req</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>http</span>.<span style=color:#a6e22e>Request</span>, <span style=color:#a6e22e>via</span> []<span style=color:#f92672>*</span><span style=color:#a6e22e>http</span>.<span style=color:#a6e22e>Request</span>) <span style=color:#66d9ef>error</span> {
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>redirect_limit</span> <span style=color:#f92672>:=</span> <span style=color:#ae81ff>20</span>
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>if</span> len(<span style=color:#a6e22e>via</span>) <span style=color:#f92672>&gt;=</span> <span style=color:#a6e22e>redirect_limit</span> { <span style=color:#75715e>// 默认重定向次数是10次
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>				<span style=color:#66d9ef>return</span> <span style=color:#a6e22e>errors</span>.<span style=color:#a6e22e>New</span>(<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Sprintf</span>(<span style=color:#e6db74>&#34;stopped after %d redirects&#34;</span>, <span style=color:#a6e22e>redirect_limit</span>))
</span></span><span style=display:flex><span>			}
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>return</span> <span style=color:#66d9ef>nil</span>
</span></span><span style=display:flex><span>		},
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>options</span>.<span style=color:#a6e22e>generatePoC</span> {
</span></span><span style=display:flex><span>		<span style=color:#75715e>// 如果指定要生成PoC，则新建一个文件夹。
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>		<span style=color:#a6e22e>PoCdir</span> = <span style=color:#e6db74>&#34;clickjackPoCs_&#34;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>Now</span>().<span style=color:#a6e22e>Format</span>(<span style=color:#e6db74>&#34;20060102_150405&#34;</span>)
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>_</span>, <span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>os</span>.<span style=color:#a6e22e>Stat</span>(<span style=color:#a6e22e>PoCdir</span>); <span style=color:#a6e22e>os</span>.<span style=color:#a6e22e>IsNotExist</span>(<span style=color:#a6e22e>err</span>) {
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>err1</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>os</span>.<span style=color:#a6e22e>Mkdir</span>(<span style=color:#a6e22e>PoCdir</span>, <span style=color:#ae81ff>777</span>)
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err1</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
</span></span><span style=display:flex><span>				<span style=color:#a6e22e>throwErr</span>(<span style=color:#e6db74>&#34;创建PoC文件夹失败：&#34;</span><span style=color:#f92672>+</span><span style=color:#a6e22e>PoCdir</span>, <span style=color:#a6e22e>err1</span>)
</span></span><span style=display:flex><span>			} <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>				<span style=color:#75715e>//fmt.Fprintln(os.Stderr,&#34;创建PoC文件夹成功：&#34;+PoCdir)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>				<span style=color:#a6e22e>abs</span>, <span style=color:#a6e22e>_</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>filepath</span>.<span style=color:#a6e22e>Abs</span>(<span style=color:#a6e22e>PoCdir</span>)
</span></span><span style=display:flex><span>				<span style=color:#a6e22e>throwErr</span>(<span style=color:#e6db74>&#34;生成的PoC将存放在以下文件夹：&#34;</span><span style=color:#f92672>+</span><span style=color:#a6e22e>abs</span>, <span style=color:#66d9ef>nil</span>)
</span></span><span style=display:flex><span>			}
</span></span><span style=display:flex><span>		}
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#75715e>//如果指定了自定义请求头的文件，则尝试解析请求头文件
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>options</span>.<span style=color:#a6e22e>headersFile</span> <span style=color:#f92672>!=</span> <span style=color:#e6db74>&#34;&#34;</span> {
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>finput</span>, <span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>os</span>.<span style=color:#a6e22e>Open</span>(<span style=color:#a6e22e>options</span>.<span style=color:#a6e22e>headersFile</span>)
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>throwErr</span>(<span style=color:#e6db74>&#34;打开自定义header文件失败&#34;</span>, <span style=color:#a6e22e>err</span>)
</span></span><span style=display:flex><span>		}
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>scanner</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>bufio</span>.<span style=color:#a6e22e>NewScanner</span>(<span style=color:#a6e22e>finput</span>)
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>for</span> <span style=color:#a6e22e>scanner</span>.<span style=color:#a6e22e>Scan</span>() {
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>headerstring</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>scanner</span>.<span style=color:#a6e22e>Text</span>()
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>colon_index</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>strings</span>.<span style=color:#a6e22e>Index</span>(<span style=color:#a6e22e>headerstring</span>, <span style=color:#e6db74>&#34;:&#34;</span>)
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>colon_index</span> <span style=color:#f92672>==</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span> {
</span></span><span style=display:flex><span>				<span style=color:#a6e22e>throwErr</span>(<span style=color:#e6db74>&#34;自定义请求头格式有误&#34;</span>, <span style=color:#66d9ef>nil</span>)
</span></span><span style=display:flex><span>			}
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>key</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>headerstring</span>[:<span style=color:#a6e22e>colon_index</span>]
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>value</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>headerstring</span>[<span style=color:#a6e22e>colon_index</span><span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>:]
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>customHeaders</span> = append(<span style=color:#a6e22e>customHeaders</span>, <span style=color:#a6e22e>customHeader</span>{<span style=color:#a6e22e>key</span>, <span style=color:#a6e22e>value</span>})
</span></span><span style=display:flex><span>		}
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>throwErr</span>(<span style=color:#a6e22e>errdesc</span> <span style=color:#66d9ef>string</span>, <span style=color:#a6e22e>err</span> <span style=color:#66d9ef>error</span>) {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Fprintln</span>(<span style=color:#a6e22e>os</span>.<span style=color:#a6e22e>Stderr</span>, <span style=color:#a6e22e>strings</span>.<span style=color:#a6e22e>Repeat</span>(<span style=color:#e6db74>&#34;-&#34;</span>, <span style=color:#ae81ff>50</span>))
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Fprintln</span>(<span style=color:#a6e22e>os</span>.<span style=color:#a6e22e>Stderr</span>, <span style=color:#a6e22e>errdesc</span>)
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Fprintln</span>(<span style=color:#a6e22e>os</span>.<span style=color:#a6e22e>Stderr</span>, <span style=color:#a6e22e>err</span>.<span style=color:#a6e22e>Error</span>())
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Fprintln</span>(<span style=color:#a6e22e>os</span>.<span style=color:#a6e22e>Stderr</span>, <span style=color:#a6e22e>strings</span>.<span style=color:#a6e22e>Repeat</span>(<span style=color:#e6db74>&#34;-&#34;</span>, <span style=color:#ae81ff>50</span>))
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>genClickjackingPoC</span>(<span style=color:#a6e22e>u</span> <span style=color:#66d9ef>string</span>) <span style=color:#66d9ef>string</span> {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>uu</span>, <span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>url</span>.<span style=color:#a6e22e>Parse</span>(<span style=color:#a6e22e>u</span>)
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Fprintln</span>(<span style=color:#a6e22e>os</span>.<span style=color:#a6e22e>Stderr</span>, <span style=color:#e6db74>&#34;为 %s 生成PoC时出现错误 [%s]&#34;</span>, <span style=color:#a6e22e>u</span>, <span style=color:#a6e22e>err</span>)
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>pocName</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Sprintf</span>(<span style=color:#e6db74>&#34;%s_%x.html&#34;</span>, <span style=color:#a6e22e>uu</span>.<span style=color:#a6e22e>Host</span>, <span style=color:#a6e22e>md5</span>.<span style=color:#a6e22e>Sum</span>([]byte(<span style=color:#a6e22e>u</span>)))
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>pocFilename</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>path</span>.<span style=color:#a6e22e>Join</span>(<span style=color:#a6e22e>PoCdir</span>, <span style=color:#a6e22e>pocName</span>)
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>poc</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Sprintf</span>(<span style=color:#e6db74>`
</span></span></span><span style=display:flex><span><span style=color:#e6db74>&lt;html lang=&#34;zh-CN&#34;&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  &lt;head&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    &lt;meta charset=&#34;UTF-8&#34; /&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    &lt;title&gt;PoC of Clickjacking&lt;/title&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  &lt;/head&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  &lt;body&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>	&lt;h1 align=&#34;center&#34;&gt;Batch Detect Clickjacking&lt;/h1&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    &lt;p align=&#34;center&#34;&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>		this site is vulnerable: &lt;br&gt; 
</span></span></span><span style=display:flex><span><span style=color:#e6db74>		&lt;a href=&#34;%s&#34;&gt;%s&lt;/a&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        &lt;iframe  src=&#34;%s&#34; height=&#34;80%&#34; width=&#34;80%&#34; align=&#34;middle&#34;&gt;&lt;/iframe&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    &lt;/p&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  &lt;/body&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>&lt;/html&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>`</span>, <span style=color:#a6e22e>u</span>, <span style=color:#a6e22e>u</span>, <span style=color:#a6e22e>u</span>)
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>f</span>, <span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>os</span>.<span style=color:#a6e22e>Create</span>(<span style=color:#a6e22e>pocFilename</span>)
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>throwErr</span>(<span style=color:#e6db74>&#34;创建PoC文件时出错&#34;</span>, <span style=color:#a6e22e>err</span>)
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>f</span>.<span style=color:#a6e22e>WriteString</span>(<span style=color:#a6e22e>poc</span>)
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>f</span>.<span style=color:#a6e22e>Close</span>()
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>return</span> <span style=color:#a6e22e>pocName</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>is_vuln_to__clickjacking</span>(<span style=color:#a6e22e>url</span> <span style=color:#66d9ef>string</span>) <span style=color:#66d9ef>int</span> {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>req</span>, <span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>http</span>.<span style=color:#a6e22e>NewRequest</span>(<span style=color:#e6db74>&#34;GET&#34;</span>, <span style=color:#a6e22e>url</span>, <span style=color:#66d9ef>nil</span>)
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>throwErr</span>(<span style=color:#e6db74>&#34;构造请求时出现错误：&#34;</span>, <span style=color:#a6e22e>err</span>)
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>return</span> <span style=color:#ae81ff>2</span> <span style=color:#75715e>// 链接请求失败，需要进一步手工检查
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	}
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>req</span>.<span style=color:#a6e22e>Header</span>.<span style=color:#a6e22e>Add</span>(<span style=color:#e6db74>&#34;User-Agent&#34;</span>, <span style=color:#a6e22e>options</span>.<span style=color:#a6e22e>useragent</span>)
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>for</span> <span style=color:#a6e22e>_</span>, <span style=color:#a6e22e>header</span> <span style=color:#f92672>:=</span> <span style=color:#66d9ef>range</span> <span style=color:#a6e22e>customHeaders</span> {
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>req</span>.<span style=color:#a6e22e>Header</span>.<span style=color:#a6e22e>Add</span>(<span style=color:#a6e22e>header</span>.<span style=color:#a6e22e>key</span>, <span style=color:#a6e22e>header</span>.<span style=color:#a6e22e>value</span>)
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>resp</span>, <span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>client</span>.<span style=color:#a6e22e>Do</span>(<span style=color:#a6e22e>req</span>)
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>throwErr</span>(<span style=color:#e6db74>&#34;发起请求时出现错误：&#34;</span>, <span style=color:#a6e22e>err</span>)
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>return</span> <span style=color:#ae81ff>2</span> <span style=color:#75715e>// 链接请求失败，需要进一步手工检查
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#75715e>//被 defer 的函数在 return 之后执行，用于释放资源
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#66d9ef>defer</span> <span style=color:#a6e22e>resp</span>.<span style=color:#a6e22e>Body</span>.<span style=color:#a6e22e>Close</span>()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#75715e>//body, err := io.ReadAll(resp.Body)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>if</span> len(<span style=color:#a6e22e>resp</span>.<span style=color:#a6e22e>Header</span>[<span style=color:#e6db74>&#34;X-Frame-Options&#34;</span>]) <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span> {
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>options</span>.<span style=color:#a6e22e>generatePoC</span> {
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Println</span>(<span style=color:#e6db74>&#34;[vul]\t&#34;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>url</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;\t&#34;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>genClickjackingPoC</span>(<span style=color:#a6e22e>url</span>))
</span></span><span style=display:flex><span>		} <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Println</span>(<span style=color:#e6db74>&#34;[vul]\t&#34;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>url</span>)
</span></span><span style=display:flex><span>		}
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>return</span> <span style=color:#ae81ff>1</span> <span style=color:#75715e>// 响应头没有XFO，确认受点击劫持漏洞影响
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	} <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>options</span>.<span style=color:#a6e22e>Silent</span> <span style=color:#f92672>==</span> <span style=color:#66d9ef>false</span> {
</span></span><span style=display:flex><span>			<span style=color:#75715e>// 打印出具体的响应XFO头，便于人工判断
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>			<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Println</span>(<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Sprintf</span>(<span style=color:#e6db74>&#34;[nop]\t%s\t[%d]%s&#34;</span>, <span style=color:#a6e22e>url</span>, <span style=color:#a6e22e>resp</span>.<span style=color:#a6e22e>StatusCode</span>, <span style=color:#a6e22e>resp</span>.<span style=color:#a6e22e>Header</span>[<span style=color:#e6db74>&#34;X-Frame-Options&#34;</span>][<span style=color:#ae81ff>0</span>]))
</span></span><span style=display:flex><span>			<span style=color:#75715e>//fmt.Println(resp.Header)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>			<span style=color:#75715e>//fmt.Println(resp.StatusCode)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>		}
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span> <span style=color:#75715e>// 响应头有XFO，认为不受漏洞影响
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>		<span style=color:#75715e>// todo: 这里可以细分检测，比如XFO值是什么的时候还是可能有漏洞 sameorigin则没有漏洞
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>		<span style=color:#75715e>// todo: 有时域名无法解析，但响应头居然有xfo:deny，不知道是不是net/http自己加的，这个现象有点怪。
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	}
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>batch_detect_clickjacking</span>() {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>batchurl_filename</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>options</span>.<span style=color:#a6e22e>InputFile</span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>var</span> <span style=color:#a6e22e>scanner</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>bufio</span>.<span style=color:#a6e22e>Scanner</span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>batchurl_filename</span> <span style=color:#f92672>!=</span> <span style=color:#e6db74>&#34;&#34;</span> {
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>finput</span>, <span style=color:#a6e22e>_</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>os</span>.<span style=color:#a6e22e>Open</span>(<span style=color:#a6e22e>batchurl_filename</span>)
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>scanner</span> = <span style=color:#a6e22e>bufio</span>.<span style=color:#a6e22e>NewScanner</span>(<span style=color:#a6e22e>finput</span>)
</span></span><span style=display:flex><span>	} <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>scanner</span> = <span style=color:#a6e22e>bufio</span>.<span style=color:#a6e22e>NewScanner</span>(<span style=color:#a6e22e>os</span>.<span style=color:#a6e22e>Stdin</span>)
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>var</span> <span style=color:#a6e22e>wg</span> <span style=color:#a6e22e>sync</span>.<span style=color:#a6e22e>WaitGroup</span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>var</span> <span style=color:#a6e22e>ch</span> = make(<span style=color:#66d9ef>chan</span> <span style=color:#66d9ef>struct</span>{}, <span style=color:#a6e22e>options</span>.<span style=color:#a6e22e>threads</span>)
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>for</span> <span style=color:#a6e22e>scanner</span>.<span style=color:#a6e22e>Scan</span>() {
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>u</span>, <span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>url</span>.<span style=color:#a6e22e>Parse</span>(<span style=color:#a6e22e>scanner</span>.<span style=color:#a6e22e>Text</span>())
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Fprintf</span>(<span style=color:#a6e22e>os</span>.<span style=color:#a6e22e>Stderr</span>, <span style=color:#e6db74>&#34;failed to parse url %s [%s]\n&#34;</span>, <span style=color:#a6e22e>scanner</span>.<span style=color:#a6e22e>Text</span>(), <span style=color:#a6e22e>err</span>)
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>continue</span>
</span></span><span style=display:flex><span>		}
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>wg</span>.<span style=color:#a6e22e>Add</span>(<span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>ch</span> <span style=color:#f92672>&lt;-</span> <span style=color:#66d9ef>struct</span>{}{} <span style=color:#75715e>// acquire a token
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>go</span> <span style=color:#66d9ef>func</span>(<span style=color:#a6e22e>url</span> <span style=color:#66d9ef>string</span>) {
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>defer</span> <span style=color:#a6e22e>wg</span>.<span style=color:#a6e22e>Done</span>()
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>is_vuln_to__clickjacking</span>(<span style=color:#a6e22e>url</span>)
</span></span><span style=display:flex><span>			<span style=color:#f92672>&lt;-</span><span style=color:#a6e22e>ch</span> <span style=color:#75715e>// release the token
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>		}(<span style=color:#a6e22e>u</span>.<span style=color:#a6e22e>String</span>())
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>wg</span>.<span style=color:#a6e22e>Wait</span>()
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>main</span>() {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Fprintln</span>(<span style=color:#a6e22e>os</span>.<span style=color:#a6e22e>Stderr</span>, <span style=color:#a6e22e>banner</span>)
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>options</span> = <span style=color:#a6e22e>parse_options</span>()
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>global_init</span>()
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>batch_detect_clickjacking</span>()
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><h2 id=v1>v1<a hidden class=anchor aria-hidden=true href=#v1>#</a></h2><p>早期单线程版本</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-1>  1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-2>  2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-3>  3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-4>  4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-5>  5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-6>  6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-7>  7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-8>  8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-9>  9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-10> 10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-11> 11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-12> 12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-13> 13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-14> 14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-15> 15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-16><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-16> 16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-17><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-17> 17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-18><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-18> 18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-19><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-19> 19</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-20><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-20> 20</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-21><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-21> 21</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-22><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-22> 22</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-23><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-23> 23</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-24><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-24> 24</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-25><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-25> 25</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-26><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-26> 26</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-27><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-27> 27</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-28><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-28> 28</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-29><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-29> 29</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-30><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-30> 30</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-31><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-31> 31</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-32><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-32> 32</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-33><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-33> 33</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-34><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-34> 34</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-35><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-35> 35</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-36><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-36> 36</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-37><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-37> 37</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-38><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-38> 38</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-39><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-39> 39</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-40><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-40> 40</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-41><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-41> 41</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-42><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-42> 42</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-43><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-43> 43</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-44><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-44> 44</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-45><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-45> 45</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-46><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-46> 46</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-47><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-47> 47</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-48><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-48> 48</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-49><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-49> 49</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-50><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-50> 50</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-51><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-51> 51</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-52><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-52> 52</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-53><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-53> 53</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-54><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-54> 54</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-55><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-55> 55</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-56><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-56> 56</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-57><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-57> 57</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-58><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-58> 58</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-59><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-59> 59</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-60><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-60> 60</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-61><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-61> 61</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-62><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-62> 62</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-63><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-63> 63</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-64><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-64> 64</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-65><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-65> 65</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-66><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-66> 66</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-67><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-67> 67</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-68><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-68> 68</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-69><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-69> 69</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-70><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-70> 70</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-71><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-71> 71</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-72><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-72> 72</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-73><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-73> 73</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-74><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-74> 74</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-75><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-75> 75</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-76><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-76> 76</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-77><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-77> 77</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-78><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-78> 78</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-79><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-79> 79</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-80><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-80> 80</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-81><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-81> 81</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-82><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-82> 82</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-83><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-83> 83</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-84><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-84> 84</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-85><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-85> 85</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-86><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-86> 86</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-87><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-87> 87</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-88><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-88> 88</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-89><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-89> 89</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-90><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-90> 90</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-91><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-91> 91</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-92><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-92> 92</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-93><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-93> 93</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-94><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-94> 94</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-95><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-95> 95</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-96><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-96> 96</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-97><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-97> 97</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-98><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-98> 98</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-99><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-99> 99</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-100><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-100>100</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-101><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-101>101</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-102><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-102>102</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-103><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-103>103</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-104><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-104>104</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-105><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-105>105</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-106><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-106>106</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-107><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-107>107</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-108><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-108>108</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-109><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-109>109</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-110><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-110>110</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-111><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-111>111</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-112><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-112>112</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-113><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-113>113</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-114><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-114>114</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-115><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-115>115</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-116><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-116>116</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-117><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-117>117</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-118><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-118>118</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-119><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-119>119</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-120><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-120>120</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-121><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-121>121</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-122><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-122>122</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-123><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-123>123</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-124><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-124>124</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-125><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-125>125</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-126><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-126>126</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-127><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-127>127</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-128><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-128>128</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-129><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-129>129</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-130><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-130>130</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-131><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-131>131</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-132><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-132>132</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-133><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-133>133</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-134><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-134>134</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-135><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-135>135</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-136><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-136>136</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-137><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-137>137</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-138><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-138>138</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-139><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-139>139</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-140><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-140>140</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-141><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-141>141</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-142><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-142>142</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-143><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-143>143</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-144><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-144>144</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-145><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-145>145</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-146><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-146>146</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-147><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-147>147</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#f92672>package</span> <span style=color:#a6e22e>uispoof</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> (
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;bufio&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;crypto/tls&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;flag&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;fmt&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;net/http&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;net/url&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;os&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;strings&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;time&#34;</span>
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// banner
</span></span></span><span style=display:flex><span><span style=color:#75715e>//https://manytools.org/hacker-tools/ascii-banner/
</span></span></span><span style=display:flex><span><span style=color:#75715e>// Rounded font
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>banner</span> = <span style=color:#e6db74>`
</span></span></span><span style=display:flex><span><span style=color:#e6db74> ______                   _        ______                                
</span></span></span><span style=display:flex><span><span style=color:#e6db74>(____  \         _       | |      (______)         _                 _   
</span></span></span><span style=display:flex><span><span style=color:#e6db74> ____)  )_____ _| |_ ____| |__     _     _ _____ _| |_ _____  ____ _| |_ 
</span></span></span><span style=display:flex><span><span style=color:#e6db74>|  __  ((____ (_   _) ___)  _ \   | |   | | ___ (_   _) ___ |/ ___|_   _)
</span></span></span><span style=display:flex><span><span style=color:#e6db74>| |__)  ) ___ | | |( (___| | | |  | |__/ /| ____| | |_| ____( (___  | |_ 
</span></span></span><span style=display:flex><span><span style=color:#e6db74>|______/\_____|  \__)____)_| |_|  |_____/ |_____)  \__)_____)\____)  \__)
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                                                                         
</span></span></span><span style=display:flex><span><span style=color:#e6db74> _______ _  _       _      _             _     _                         
</span></span></span><span style=display:flex><span><span style=color:#e6db74>(_______) |(_)     | |    (_)           | |   (_)                        
</span></span></span><span style=display:flex><span><span style=color:#e6db74> _      | | _  ____| |  _  _ _____  ____| |  _ _ ____   ____             
</span></span></span><span style=display:flex><span><span style=color:#e6db74>| |     | || |/ ___) |_/ )| (____ |/ ___) |_/ ) |  _ \ / _  |            
</span></span></span><span style=display:flex><span><span style=color:#e6db74>| |_____| || ( (___|  _ ( | / ___ ( (___|  _ (| | | | ( (_| |            
</span></span></span><span style=display:flex><span><span style=color:#e6db74> \______)\_)_|\____)_| \_)| \_____|\____)_| \_)_|_| |_|\___ |            
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                        (__/                          (_____| by findneo
</span></span></span><span style=display:flex><span><span style=color:#e6db74>`</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// options
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>type</span> <span style=color:#a6e22e>Options</span> <span style=color:#66d9ef>struct</span> {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>mode</span>      <span style=color:#66d9ef>string</span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>InputFile</span> <span style=color:#66d9ef>string</span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>Verbose</span>   <span style=color:#66d9ef>bool</span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>threads</span>   <span style=color:#66d9ef>int</span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>useragent</span> <span style=color:#66d9ef>string</span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>proxy</span> <span style=color:#66d9ef>string</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>options</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>Options</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>parse_options</span>() <span style=color:#f92672>*</span><span style=color:#a6e22e>Options</span> {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>options</span> <span style=color:#f92672>:=</span> <span style=color:#f92672>&amp;</span><span style=color:#a6e22e>Options</span>{}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>flag</span>.<span style=color:#a6e22e>StringVar</span>(<span style=color:#f92672>&amp;</span><span style=color:#a6e22e>options</span>.<span style=color:#a6e22e>mode</span>, <span style=color:#e6db74>&#34;m&#34;</span>, <span style=color:#e6db74>&#34;&#34;</span>, <span style=color:#e6db74>&#34;find404|fmtjs|newjs&#34;</span>)
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>flag</span>.<span style=color:#a6e22e>StringVar</span>(<span style=color:#f92672>&amp;</span><span style=color:#a6e22e>options</span>.<span style=color:#a6e22e>InputFile</span>, <span style=color:#e6db74>&#34;l&#34;</span>, <span style=color:#e6db74>&#34;&#34;</span>, <span style=color:#e6db74>&#34;file contains url stirngs&#34;</span>)
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>flag</span>.<span style=color:#a6e22e>BoolVar</span>(<span style=color:#f92672>&amp;</span><span style=color:#a6e22e>options</span>.<span style=color:#a6e22e>Verbose</span>, <span style=color:#e6db74>&#34;v&#34;</span>, <span style=color:#66d9ef>false</span>, <span style=color:#e6db74>&#34;show X-Frame-Options header content in response&#34;</span>)
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>flag</span>.<span style=color:#a6e22e>IntVar</span>(<span style=color:#f92672>&amp;</span><span style=color:#a6e22e>options</span>.<span style=color:#a6e22e>threads</span>, <span style=color:#e6db74>&#34;t&#34;</span>, <span style=color:#ae81ff>10</span>, <span style=color:#e6db74>&#34;limit concurrent threads num&#34;</span>)
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>flag</span>.<span style=color:#a6e22e>StringVar</span>(<span style=color:#f92672>&amp;</span><span style=color:#a6e22e>options</span>.<span style=color:#a6e22e>useragent</span>, <span style=color:#e6db74>&#34;u&#34;</span>, <span style=color:#e6db74>&#34;Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36&#34;</span>, <span style=color:#e6db74>&#34;Custom User agent&#34;</span>)
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>flag</span>.<span style=color:#a6e22e>StringVar</span>(<span style=color:#f92672>&amp;</span><span style=color:#a6e22e>options</span>.<span style=color:#a6e22e>proxy</span>, <span style=color:#e6db74>&#34;x&#34;</span>, <span style=color:#e6db74>&#34;&#34;</span>, <span style=color:#e6db74>&#34;Custom proxy like http://127.0.0.1:8080&#34;</span>)
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>flag</span>.<span style=color:#a6e22e>Parse</span>()
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>return</span> <span style=color:#a6e22e>options</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>tr</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>http</span>.<span style=color:#a6e22e>Transport</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>client</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>http</span>.<span style=color:#a6e22e>Client</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>global_init</span>(){
</span></span><span style=display:flex><span>	<span style=color:#75715e>//fmt.Fprintln(os.Stderr,banner)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>tr</span> = <span style=color:#f92672>&amp;</span><span style=color:#a6e22e>http</span>.<span style=color:#a6e22e>Transport</span>{
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>MaxIdleConns</span>:       <span style=color:#ae81ff>10</span>,
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>IdleConnTimeout</span>:    <span style=color:#ae81ff>30</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>Second</span>,
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>DisableCompression</span>: <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>TLSClientConfig</span>: <span style=color:#f92672>&amp;</span><span style=color:#a6e22e>tls</span>.<span style=color:#a6e22e>Config</span>{
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>InsecureSkipVerify</span>: <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>		},
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>DisableKeepAlives</span>: <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#75715e>// 如果指定了proxy，则所有请求都使用该proxy
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>options</span>.<span style=color:#a6e22e>proxy</span><span style=color:#f92672>!=</span><span style=color:#e6db74>&#34;&#34;</span>{
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>proxyUrl</span>, <span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>url</span>.<span style=color:#a6e22e>Parse</span>(<span style=color:#a6e22e>options</span>.<span style=color:#a6e22e>proxy</span>)
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span><span style=color:#f92672>!=</span><span style=color:#66d9ef>nil</span>{
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Fprintln</span>(<span style=color:#a6e22e>os</span>.<span style=color:#a6e22e>Stderr</span>,<span style=color:#e6db74>&#34;自定义的proxy格式有误，不设置代理&#34;</span>)
</span></span><span style=display:flex><span>		} <span style=color:#66d9ef>else</span>{
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>tr</span>.<span style=color:#a6e22e>Proxy</span>=<span style=color:#a6e22e>http</span>.<span style=color:#a6e22e>ProxyURL</span>(<span style=color:#a6e22e>proxyUrl</span>)
</span></span><span style=display:flex><span>		}
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>client</span> = <span style=color:#f92672>&amp;</span><span style=color:#a6e22e>http</span>.<span style=color:#a6e22e>Client</span>{<span style=color:#a6e22e>Transport</span>: <span style=color:#a6e22e>tr</span>}
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>is_vuln_to__clickjacking</span>(<span style=color:#a6e22e>url</span> <span style=color:#66d9ef>string</span>) <span style=color:#66d9ef>int</span>{
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>req</span>,<span style=color:#a6e22e>err</span><span style=color:#f92672>:=</span><span style=color:#a6e22e>http</span>.<span style=color:#a6e22e>NewRequest</span>(<span style=color:#e6db74>&#34;GET&#34;</span>,<span style=color:#a6e22e>url</span>,<span style=color:#66d9ef>nil</span>)
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span>{
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Fprintln</span>(<span style=color:#a6e22e>os</span>.<span style=color:#a6e22e>Stderr</span>,<span style=color:#e6db74>&#34;构造请求时出现错误：&#34;</span>)
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Fprintln</span>(<span style=color:#a6e22e>os</span>.<span style=color:#a6e22e>Stderr</span>,<span style=color:#a6e22e>strings</span>.<span style=color:#a6e22e>Repeat</span>(<span style=color:#e6db74>&#34;-&#34;</span>,<span style=color:#ae81ff>50</span>))
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Fprintln</span>(<span style=color:#a6e22e>os</span>.<span style=color:#a6e22e>Stderr</span>,<span style=color:#a6e22e>err</span>.<span style=color:#a6e22e>Error</span>())
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Fprintln</span>(<span style=color:#a6e22e>os</span>.<span style=color:#a6e22e>Stderr</span>,<span style=color:#a6e22e>strings</span>.<span style=color:#a6e22e>Repeat</span>(<span style=color:#e6db74>&#34;-&#34;</span>,<span style=color:#ae81ff>50</span>))
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>return</span> <span style=color:#ae81ff>2</span> <span style=color:#75715e>// 链接请求失败，需要进一步手工检查
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	}
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>req</span>.<span style=color:#a6e22e>Header</span>.<span style=color:#a6e22e>Add</span>(<span style=color:#e6db74>&#34;User-Agent&#34;</span>,<span style=color:#a6e22e>options</span>.<span style=color:#a6e22e>useragent</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>resp</span>, <span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>client</span>.<span style=color:#a6e22e>Do</span>(<span style=color:#a6e22e>req</span>)
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Fprintln</span>(<span style=color:#a6e22e>os</span>.<span style=color:#a6e22e>Stderr</span>,<span style=color:#e6db74>&#34;发起请求时出现错误：&#34;</span>)
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Fprintln</span>(<span style=color:#a6e22e>os</span>.<span style=color:#a6e22e>Stderr</span>,<span style=color:#a6e22e>strings</span>.<span style=color:#a6e22e>Repeat</span>(<span style=color:#e6db74>&#34;-&#34;</span>,<span style=color:#ae81ff>50</span>))
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Fprintln</span>(<span style=color:#a6e22e>os</span>.<span style=color:#a6e22e>Stderr</span>,<span style=color:#a6e22e>err</span>.<span style=color:#a6e22e>Error</span>())
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Fprintln</span>(<span style=color:#a6e22e>os</span>.<span style=color:#a6e22e>Stderr</span>,<span style=color:#a6e22e>strings</span>.<span style=color:#a6e22e>Repeat</span>(<span style=color:#e6db74>&#34;-&#34;</span>,<span style=color:#ae81ff>50</span>))
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>return</span> <span style=color:#ae81ff>2</span> <span style=color:#75715e>// 链接请求失败，需要进一步手工检查
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#75715e>//被 defer 的函数在 return 之后执行，用于释放资源
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#66d9ef>defer</span> <span style=color:#a6e22e>resp</span>.<span style=color:#a6e22e>Body</span>.<span style=color:#a6e22e>Close</span>()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#75715e>//body, err := io.ReadAll(resp.Body)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>if</span> len(<span style=color:#a6e22e>resp</span>.<span style=color:#a6e22e>Header</span>[<span style=color:#e6db74>&#34;X-Frame-Options&#34;</span>])<span style=color:#f92672>==</span><span style=color:#ae81ff>0</span> {
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Println</span>(<span style=color:#e6db74>&#34;[vul]&#34;</span><span style=color:#f92672>+</span><span style=color:#a6e22e>url</span>)
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>return</span> <span style=color:#ae81ff>1</span> <span style=color:#75715e>// 响应头没有XFO，确认受点击劫持漏洞影响
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	}<span style=color:#66d9ef>else</span>{
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>options</span>.<span style=color:#a6e22e>Verbose</span><span style=color:#f92672>==</span><span style=color:#66d9ef>true</span>{
</span></span><span style=display:flex><span>			<span style=color:#75715e>// 打印出具体的响应XFO头，便于人工判断
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>			<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Println</span>(<span style=color:#e6db74>&#34;[nop]&#34;</span><span style=color:#f92672>+</span><span style=color:#a6e22e>url</span><span style=color:#f92672>+</span><span style=color:#e6db74>&#34;\t[&#34;</span><span style=color:#f92672>+</span><span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Sprintf</span>(<span style=color:#e6db74>&#34;%d&#34;</span>,<span style=color:#a6e22e>resp</span>.<span style=color:#a6e22e>StatusCode</span>)<span style=color:#f92672>+</span><span style=color:#e6db74>&#34;]&#34;</span><span style=color:#f92672>+</span><span style=color:#a6e22e>resp</span>.<span style=color:#a6e22e>Header</span>[<span style=color:#e6db74>&#34;X-Frame-Options&#34;</span>][<span style=color:#ae81ff>0</span>])
</span></span><span style=display:flex><span>			<span style=color:#75715e>//fmt.Println(resp.Header)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>			<span style=color:#75715e>//fmt.Println(resp.StatusCode)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>		}
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span> <span style=color:#75715e>// 响应头有XFO，认为不受漏洞影响
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>		<span style=color:#75715e>// todo: 这里可以细分检测，比如XFO值是什么的时候还是可能有漏洞 sameorigin则没有漏洞
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	}
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>batch_detect_clickjacking</span>() {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>sc</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>bufio</span>.<span style=color:#a6e22e>NewScanner</span>(<span style=color:#a6e22e>os</span>.<span style=color:#a6e22e>Stdin</span>)
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>for</span> <span style=color:#a6e22e>sc</span>.<span style=color:#a6e22e>Scan</span>() {
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>u</span>, <span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>url</span>.<span style=color:#a6e22e>Parse</span>(<span style=color:#a6e22e>sc</span>.<span style=color:#a6e22e>Text</span>())
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Fprintf</span>(<span style=color:#a6e22e>os</span>.<span style=color:#a6e22e>Stderr</span>, <span style=color:#e6db74>&#34;failed to parse url %s [%s]\n&#34;</span>, <span style=color:#a6e22e>sc</span>.<span style=color:#a6e22e>Text</span>(), <span style=color:#a6e22e>err</span>)
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>continue</span>
</span></span><span style=display:flex><span>		}
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>is_vuln_to__clickjacking</span>(<span style=color:#a6e22e>u</span>.<span style=color:#a6e22e>String</span>())
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>main</span>() {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>options</span> = <span style=color:#a6e22e>parse_options</span>()
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>global_init</span>()
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>batch_detect_clickjacking</span>()
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><h1 id=参考文档>参考文档<a hidden class=anchor aria-hidden=true href=#参考文档>#</a></h1><ul><li><a href=https://wizardforcel.gitbooks.io/owasp-cheat-sheet-zh/content/clickjacking-defense-cheat-sheet.html>点击劫持防御备忘单</a></li><li><a href=https://zh.javascript.info/clickjacking>点击劫持攻击</a></li></ul></div><footer class=post-footer><ul class=post-tags></ul><nav class=paginav><a class=prev href=https://ret2neo.cn/post/210721-build-proxenet-using-docker/><span class=title>« Prev</span><br><span>使用docker构建proxenet</span></a>
<a class=next href=https://ret2neo.cn/post/210323-how-to-save-tiddly-wiki/><span class=title>Next »</span><br><span>如何保存tiddlywiki</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://ret2neo.cn/>闲言语</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2303473689051162" crossorigin=anonymous></script><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>