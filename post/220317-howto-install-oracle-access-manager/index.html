<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>如何搭建 Oracle Access Manager | 闲言语</title><meta name=keywords content><meta name=description content="大纲 参考 https://docs.oracle.com/en/middleware/idm/access-manager/12.2.1.4/tutorial-oam-docker/#Background 使用方法2获取OAM镜像
Download a prebuilt OAM image from Oracle Container Registry by by navigating to Middleware > oam. This image contains no patches and should only be used in Developer or Test environments. 下载到的OAM镜像用于跑起来三个OAM容器
WebLogic Administration Server (AdminServer) OAM Managed Server (oam_server1) OAM Policy Manager Managed Server (oam_policy_mgr1) 跑起来这三个容器依赖一个可用的Oracle数据库
步骤汇总 创建一台全新的Ubuntu18.04，切换到root用户。
在 https://hub.docker.com/_/oracle-database-enterprise-edition 和 https://container-registry.oracle.com/ 登录账号后同意协议。（参考步骤二）
安装docker
1 2 apt update apt install docker.io docker 登录dockerhub 和 container-registry.oracle.com"><meta name=author content><link rel=canonical href=https://ret2neo.cn/post/220317-howto-install-oracle-access-manager/><link crossorigin=anonymous href=/assets/css/stylesheet.42b1e004fb78db2fc933d33c9db659598f62453f0de6f9db50c85e5936c0d8c3.css integrity="sha256-QrHgBPt42y/JM9M8nbZZWY9iRT8N5vnbUMheWTbA2MM=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://ret2neo.cn/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://ret2neo.cn/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://ret2neo.cn/favicon-32x32.png><link rel=apple-touch-icon href=https://ret2neo.cn/apple-touch-icon.png><link rel=mask-icon href=https://ret2neo.cn/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="如何搭建 Oracle Access Manager"><meta property="og:description" content="大纲 参考 https://docs.oracle.com/en/middleware/idm/access-manager/12.2.1.4/tutorial-oam-docker/#Background 使用方法2获取OAM镜像
Download a prebuilt OAM image from Oracle Container Registry by by navigating to Middleware > oam. This image contains no patches and should only be used in Developer or Test environments. 下载到的OAM镜像用于跑起来三个OAM容器
WebLogic Administration Server (AdminServer) OAM Managed Server (oam_server1) OAM Policy Manager Managed Server (oam_policy_mgr1) 跑起来这三个容器依赖一个可用的Oracle数据库
步骤汇总 创建一台全新的Ubuntu18.04，切换到root用户。
在 https://hub.docker.com/_/oracle-database-enterprise-edition 和 https://container-registry.oracle.com/ 登录账号后同意协议。（参考步骤二）
安装docker
1 2 apt update apt install docker.io docker 登录dockerhub 和 container-registry.oracle.com"><meta property="og:type" content="article"><meta property="og:url" content="https://ret2neo.cn/post/220317-howto-install-oracle-access-manager/"><meta property="article:section" content="post"><meta property="article:published_time" content="2022-03-17T18:11:09+08:00"><meta property="article:modified_time" content="2022-03-17T18:11:09+08:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="如何搭建 Oracle Access Manager"><meta name=twitter:description content="大纲 参考 https://docs.oracle.com/en/middleware/idm/access-manager/12.2.1.4/tutorial-oam-docker/#Background 使用方法2获取OAM镜像
Download a prebuilt OAM image from Oracle Container Registry by by navigating to Middleware > oam. This image contains no patches and should only be used in Developer or Test environments. 下载到的OAM镜像用于跑起来三个OAM容器
WebLogic Administration Server (AdminServer) OAM Managed Server (oam_server1) OAM Policy Manager Managed Server (oam_policy_mgr1) 跑起来这三个容器依赖一个可用的Oracle数据库
步骤汇总 创建一台全新的Ubuntu18.04，切换到root用户。
在 https://hub.docker.com/_/oracle-database-enterprise-edition 和 https://container-registry.oracle.com/ 登录账号后同意协议。（参考步骤二）
安装docker
1 2 apt update apt install docker.io docker 登录dockerhub 和 container-registry.oracle.com"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://ret2neo.cn/post/"},{"@type":"ListItem","position":2,"name":"如何搭建 Oracle Access Manager","item":"https://ret2neo.cn/post/220317-howto-install-oracle-access-manager/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"如何搭建 Oracle Access Manager","name":"如何搭建 Oracle Access Manager","description":"大纲 参考 https://docs.oracle.com/en/middleware/idm/access-manager/12.2.1.4/tutorial-oam-docker/#Background 使用方法2获取OAM镜像\nDownload a prebuilt OAM image from Oracle Container Registry by by navigating to Middleware \u0026gt; oam. This image contains no patches and should only be used in Developer or Test environments. 下载到的OAM镜像用于跑起来三个OAM容器\nWebLogic Administration Server (AdminServer) OAM Managed Server (oam_server1) OAM Policy Manager Managed Server (oam_policy_mgr1) 跑起来这三个容器依赖一个可用的Oracle数据库\n步骤汇总 创建一台全新的Ubuntu18.04，切换到root用户。\n在 https://hub.docker.com/_/oracle-database-enterprise-edition 和 https://container-registry.oracle.com/ 登录账号后同意协议。（参考步骤二）\n安装docker\n1 2 apt update apt install docker.io docker 登录dockerhub 和 container-registry.oracle.com","keywords":[],"articleBody":"大纲 参考 https://docs.oracle.com/en/middleware/idm/access-manager/12.2.1.4/tutorial-oam-docker/#Background 使用方法2获取OAM镜像\nDownload a prebuilt OAM image from Oracle Container Registry by by navigating to Middleware \u003e oam. This image contains no patches and should only be used in Developer or Test environments. 下载到的OAM镜像用于跑起来三个OAM容器\nWebLogic Administration Server (AdminServer) OAM Managed Server (oam_server1) OAM Policy Manager Managed Server (oam_policy_mgr1) 跑起来这三个容器依赖一个可用的Oracle数据库\n步骤汇总 创建一台全新的Ubuntu18.04，切换到root用户。\n在 https://hub.docker.com/_/oracle-database-enterprise-edition 和 https://container-registry.oracle.com/ 登录账号后同意协议。（参考步骤二）\n安装docker\n1 2 apt update apt install docker.io docker 登录dockerhub 和 container-registry.oracle.com\n1 2 3 4 docker login 输入 login.docker.com 的账号密码\tdocker login container-registry.oracle.com 输入 login.oracle.com 的账号密码 拉取两个镜像\n1 2 docker pull store/oracle/database-enterprise:12.2.0.1 docker pull container-registry.oracle.com/middleware/oam:12.2.1.4.0 一些准备工作\n1 2 3 docker network create -d bridge OamNET mkdir -p /scratch/user_projects chmod 777 /scratch/user_projects 启动四个容器（将172.17.0.1替换为docker虚拟网卡网关的IP）\n1 2 3 4 docker run -d -it --name myOracleDB -p 1521:1521 store/oracle/database-enterprise:12.2.0.1 docker run -d --network=OamNET -p 7001:7001 --name=oamadmin --env CONNECTION_STRING=172.17.0.1:1521/ORCLPDB1.localdomain --env ADMIN_LISTEN_HOST=oamadmin --env DOMAIN_NAME=access_domain --env ADMIN_USER=weblogic --env ADMIN_PASSWORD=W3bl@gic --env ADMIN_LISTEN_PORT=7001 --env RCUPREFIX=OAM1 --env DB_USER=sys --env DB_PASSWORD=Oradoc_db1 --env DB_SCHEMA_PASSWORD=Oradoc_db2 -v /scratch/user_projects/:/u01/oracle/user_projects container-registry.oracle.com/middleware/oam:12.2.1.4.0 docker run -d -p 14100:14100 --network=OamNET --volumes-from oamadmin --name oamms --env DOMAIN_NAME=access_domain --env ADMIN_USER=weblogic --env ADMIN_PASSWORD=W3bl@gic --env ADMIN_LISTEN_HOST=oamadmin --env ADMIN_LISTEN_PORT=7001 --env MANAGEDSERVER_PORT=14100 --env MANAGED_SERVER_CONTAINER=true --env MS_NAME=oam_server1 --env MS_HOST=oamms container-registry.oracle.com/middleware/oam:12.2.1.4.0 \"/u01/oracle/dockertools/startMS.sh\" docker run -d -p 15100:15100 --network=OamNET --volumes-from oamadmin --name oampolicy --env DOMAIN_NAME=access_domain --env ADMIN_USER=weblogic --env ADMIN_PASSWORD=W3bl@gic --env ADMIN_LISTEN_HOST=oamadmin --env ADMIN_LISTEN_PORT=7001 --env MANAGEDSERVER_PORT=15100 --env MANAGED_SERVER_CONTAINER=true --env MS_NAME=oam_policy_mgr1 --env MS_HOST=oampolicy container-registry.oracle.com/middleware/oam:12.2.1.4.0 \"/u01/oracle/dockertools/startMS.sh\" 查看各服务IP\n1 docker inspect -f '{{.Name}} - {{range .NetworkSettings.Networks}}{{.IPAddress}}{{end}}' oamadmin oamms oampolicy myOracleDB 使用以下链接访问服务。（192.168.0.105为虚拟机IP）\n1 2 3 4 5 6 7 账号：weblogic 密码：W3bl@gic WebLogic Administration Console http://192.168.0.105:7001/console Oracle Enterprise Manager Console http://192.168.0.105:7001/em Oracle Access Management Console http://192.168.0.105:7001/oamconsole OAM Server Logout http://192.168.0.105:14100/oam/server/logout Policy Manager Access http://192.168.0.105:15100/access ①运行Oracle数据库 创建Oracle数据库 参考 https://hub.docker.com/_/oracle-database-enterprise-edition 登陆账号后跳转到 https://hub.docker.com/u/findneo/content/sub-3762ef81-7448-4275-909b-df7e6b5d4070 ，同意协议。\n1 2 3 4 5 6 7 8 sudo docker login # 输入docker hub的账号密码 sudo docker pull store/oracle/database-enterprise:12.2.0.1 # 拉取镜像 sudo docker run -d -it --name myOracleDB -p 1521:1521 store/oracle/database-enterprise:12.2.0.1 # 运行起来一个Oracle数据库，并且开放到本地的1521端口 测试数据库连接 安装sqlplus 参考https://askubuntu.com/questions/159939/how-to-install-sqlplus\nstep1: 1 sudo apt-get install alien step2: 在 https://www.oracle.com/database/technologies/instant-client/linux-x86-64-downloads.html 下载3个文件 oracle-instantclient12.2-basic-12.2.0.1.0-1.x86_64.rpm oracle-instantclient12.2-sqlplus-12.2.0.1.0-1.x86_64.rpm oracle-instantclient12.2-devel-12.2.0.1.0-1.x86_64.rpm\nstep3: 1 2 3 sudo alien -i oracle-instantclient*-basic*.rpm sudo alien -i oracle-instantclient*-sqlplus*.rpm sudo alien -i oracle-instantclient*-devel*.rpm step4: sudo apt-get install libaio1\nstep5: 1 2 sudo sensible-editor /etc/ld.so.conf.d/oracle.conf # 粘贴 /usr/lib/oracle/12.2/client64/lib/ step6: sudo ldconfig\nstep7 测试链接 1 2 sqlplus64 sys/Oradoc_db1@//127.0.0.1:1521/ORCLCDB.localdomain as sysdba sqlplus64 sys/Oradoc_db1@//172.17.0.1:1521/ORCLPDB1.localdomain as sysdba 其他：sqlplus64的用法 sqlplus64的用法：sqlplus [ [] [{logon | /nolog}] [] ]\n其中 是\n1 {[/][@] | / } [AS {SYSDBA | SYSOPER | SYSASM | SYSBACKUP | SYSDG | SYSKM | SYSRAC}] [EDITION=value] 其中可以是如下格式 @[ | [//]Host[:Port]/]\n如何知道 service_name 或者 net_service_name？Oracle数据库容器镜像文档说service_name定义在环境变量TNS_ADMIN定义的目录下的tnsnames.ora文件中， 进容器看到 TNS_ADMIN=/u01/app/oracle/product/12.2.0/dbhome_1/admin/ORCLCDB ，tnsnames.ora文件内容为\n1 2 ORCLCDB = (DESCRIPTION = (ADDRESS = (PROTOCOL = TCP)(HOST = 0.0.0.0)(PORT = 1521)) (CONNECT_DATA = (SERVER = DEDICATED) (SERVICE_NAME = ORCLCDB.localdomain) ) ) ORCLPDB1 = (DESCRIPTION = (ADDRESS = (PROTOCOL = TCP)(HOST = 0.0.0.0)(PORT = 1521)) (CONNECT_DATA = (SERVER = DEDICATED) (SERVICE_NAME = ORCLPDB1.localdomain) ) ) 所以 SERVICE_NAME 可以是 ORCLCDB.localdomain 或者 ORCLPDB1.localdomain 。\n②下载OAM镜像 进入 https://container-registry.oracle.com/ ，点击右上角Sign In，登陆自己的Oracle账号，然后点击MiddleWare，然后点击OAM。\n在右侧区域同意协议，然后才可以下载。\n否则即使docker login，还是无法下载，会提示\nError response from daemon: pull access denied for container-registry.oracle.com/middleware/oam, repository does not exist or may require ‘docker login’: denied: requested access to the resource is denied。\n同意协议之后执行以下命令\n1 sudo docker login container-registry.oracle.com 输入在Oracle注册的账号密码\n1 sudo docker pull container-registry.oracle.com/middleware/oam:12.2.1.4.0 ③创建容器一 参考教程创建OAM Administration Server Container，其中包含WebLogic 和OAM Consoles.\n1 2 3 4 5 6 7 8 sudo docker images sudo docker network create -d bridge OamNET # 14f104a67b0819335f9490dadc3e4003540bcdbb7b19436b2aea56250a5f2713 sudo mkdir -p /scratch/user_projects sudo chmod 777 /scratch/user_projects sudo docker run -d --network=OamNET -p 7001:7001 --name=oamadmin --env CONNECTION_STRING=127.0.0.1:1521/ORCLCDB.localdomain --env ADMIN_LISTEN_HOST=oamadmin --env DOMAIN_NAME=access_domain --env ADMIN_USER=weblogic --env ADMIN_PASSWORD=password --env ADMIN_LISTEN_PORT=7001 --env RCUPREFIX=OAM1 --env DB_USER=sys --env DB_PASSWORD=Oradoc_db1 --env DB_SCHEMA_PASSWORD=password -v /scratch/user_projects/:/u01/oracle/user_projects container-registry.oracle.com/middleware/oam:12.2.1.4.0 可能会连不上，使用以下命令调试，看看错误是什么\n1 sudo docker run --rm --network=OamNET -p 7001:7001 --name=oamadmin --env CONNECTION_STRING=127.0.0.1:1521/ORCLCDB.localdomain --env ADMIN_LISTEN_HOST=oamadmin --env DOMAIN_NAME=access_domain --env ADMIN_USER=weblogic --env ADMIN_PASSWORD=password --env ADMIN_LISTEN_PORT=7001 --env RCUPREFIX=OAM1 --env DB_USER=sys --env DB_PASSWORD=Oradoc_db1 --env DB_SCHEMA_PASSWORD=password -v /scratch/user_projects/:/u01/oracle/user_projects container-registry.oracle.com/middleware/oam:12.2.1.4.0 报错及解决 报错一：无法连接数据库 1 2 Unable to connect to the database using the provided details. Enter a valid hostname and port or check if the listener is up and running 解决一：使用正确的IP 需要注意CONNECTION_STRING是从新建的容器中访问的，所以给的IP应该是容器网卡的网关或者主机的，比如 172.17.0.1，而不是127.0.0.1。\n报错二：无法连接CDB 1 The selected Oracle database is a multitenant container database (CDB). Connecting to a multitenant container database (CDB) is not supported. Instead, connect to a valid pluggable database (PDB). 解决二：使用PDB PDB和CDB是Oracle12的新特性，CDB是多租的。Oracle 数据库 12 c 多租户选项允许单个容器数据库 （CDB） 来承载多个单独的可插拔数据库 (PDB)。\n——https://www.cnblogs.com/kerrycode/p/3386917.html\n使用以下语句查看自己是否是所租数据库\n1 select name, decode(cdb, 'YES', 'Multitenant Option enabled', 'Regular 12c Database: ') \"Multitenant Option\" , open_mode, con_id from v$database; 结果\n1 2 3 NAME Multitenant Option OPEN_MODE CON_ID --------- -------------------------- -------------------- ---------- ORCLCDB Multitenant Option enabled READ WRITE 0 或者直接\n1 select cdb from v$database YES表示该数据库是CDB,如果是NO表示是NO-CDB(普通数据库)\n或者执行\n1 show pdbs; 结果\n1 2 3 CON_ID CON_NAME OPEN MODE RESTRICTED ---------- ------------------------------ ---------- ---------- 2 PDB$SEED READ ONLY NO 搜索 “how to connect to pdb directly” ，参考此文 想到通过新建服务连接到PDB。然后注意到/u01/app/oracle/product/12.2.0/dbhome_1/admin/ORCLCDB/tnsnames.ora 文件内容如下，其中已经包括两个Service。\n1 2 ORCLCDB = (DESCRIPTION = (ADDRESS = (PROTOCOL = TCP)(HOST = 0.0.0.0)(PORT = 1521)) (CONNECT_DATA = (SERVER = DEDICATED) (SERVICE_NAME = ORCLCDB.localdomain) ) ) ORCLPDB1 = (DESCRIPTION = (ADDRESS = (PROTOCOL = TCP)(HOST = 0.0.0.0)(PORT = 1521)) (CONNECT_DATA = (SERVER = DEDICATED) (SERVICE_NAME = ORCLPDB1.localdomain) ) ) 所以只要，创建容器时CONNECTION_STRING 使用 172.17.0.1:1521/ORCLPDB1.localdomain 而不是 172.17.0.1:1521/ORCLCDB.localdomain 就能解决这个错误。\n报错三：无法执行SQL 1 2 3 ERROR - RCU-6005 Unable to execute sql query. CAUSE - RCU-6005 Database not in open state. ACTION - RCU-6005 Make sure that the database is open. 解决三：打开PDB 为了解决报错二胡乱操作了数据库，其中一个动作关闭了PDB，从而导致了这个错误。打开它就好了。\nSQL\u003e select name,open_mode from v$pdbs;\n1 2 3 4 5 6 NAME -------------------------------------------------------------------------------- OPEN_MODE ---------- ORCLPDB1 MOUNTED SQL\u003e alter pluggable database ORCLPDB1 open;\n1 Pluggable database altered. SQL\u003e select name,open_mode from v$pdbs;\n1 2 3 4 5 6 NAME -------------------------------------------------------------------------------- OPEN_MODE ---------- ORCLPDB1 READ WRITE 报错四：创建domain失败 日志详情：\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 CONNECTION_STRING=172.17.0.1:1521/ORCLPDB1.localdomain RCUPREFIX=OAM1 DOMAIN_HOME=/u01/oracle/user_projects/domains/access_domain INFO: Admin Server not configured. Will run RCU and Domain Configuration Phase... Configuring Domain for first time Start the Admin and Managed Servers ===================================== Loading RCU Phase ================= CONNECTION_STRING=172.17.0.1:1521/ORCLPDB1.localdomain RCUPREFIX=OAM1 jdbc_url=jdbc:oracle:thin:@172.17.0.1:1521/ORCLPDB1.localdomain Creating Domain 1st execution Loading RCU into database with RCUPREFIX OAM1 Domain Configuration Phase ========================== /u01/oracle/oracle_common/common/bin/wlst.sh -skipWLSModuleScanning /u01/oracle/dockertools/create_domain.py -oh /u01/oracle -jh /u01/jdk -parent /u01/oracle/user_projects/domains -name access_domain -user weblogic -password password -rcuDb 172.17.0.1:1521/ORCLPDB1.localdomain -rcuPrefix OAM1 -rcuSchemaPwd password -isSSLEnabled true Cmd is /u01/oracle/oracle_common/common/bin/wlst.sh -skipWLSModuleScanning /u01/oracle/dockertools/create_domain.py -oh /u01/oracle -jh /u01/jdk -parent /u01/oracle/user_projects/domains -name access_domain -user weblogic -password password -rcuDb 172.17.0.1:1521/ORCLPDB1.localdomain -rcuPrefix OAM1 -rcuSchemaPwd password -isSSLEnabled true Initializing WebLogic Scripting Tool (WLST) ... Welcome to WebLogic Server Administration Scripting Shell Type help() for help on available commands create_domain.py called with the following inputs: INFO: sys.argv[0] = /u01/oracle/dockertools/create_domain.py INFO: sys.argv[1] = -oh INFO: sys.argv[2] = /u01/oracle INFO: sys.argv[3] = -jh INFO: sys.argv[4] = /u01/jdk INFO: sys.argv[5] = -parent INFO: sys.argv[6] = /u01/oracle/user_projects/domains INFO: sys.argv[7] = -name INFO: sys.argv[8] = access_domain INFO: sys.argv[9] = -user INFO: sys.argv[10] = weblogic INFO: sys.argv[11] = -password INFO: sys.argv[12] = password INFO: sys.argv[13] = -rcuDb INFO: sys.argv[14] = 172.17.0.1:1521/ORCLPDB1.localdomain INFO: sys.argv[15] = -rcuPrefix INFO: sys.argv[16] = OAM1 INFO: sys.argv[17] = -rcuSchemaPwd INFO: sys.argv[18] = password INFO: sys.argv[19] = -isSSLEnabled INFO: sys.argv[20] = true INFO: Creating Admin server... INFO: Enabling SSL PORT for AdminServer... Error: set() failed. Do dumpStack() to see details. Error: runCmd() failed. Do dumpStack() to see details. Problem invoking WLST - Traceback (innermost last): File \"/u01/oracle/dockertools/create_domain.py\", line 513, in ? File \"/u01/oracle/dockertools/create_domain.py\", line 123, in createOAMDomain File \"/u01/oracle/dockertools/create_domain.py\", line 184, in createBaseDomain File \"/tmp/WLSTOfflineIni5785928536971827845.py\", line 79, in set File \"/tmp/WLSTOfflineIni5785928536971827845.py\", line 19, in command at com.oracle.cie.domain.script.jython.CommandExceptionHandler.handleException(CommandExceptionHandler.java:69) at com.oracle.cie.domain.script.jython.WLScriptContext.handleException(WLScriptContext.java:3085) at com.oracle.cie.domain.script.jython.WLScriptContext.runCmd(WLScriptContext.java:738) at sun.reflect.GeneratedMethodAccessor132.invoke(Unknown Source) at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) at java.lang.reflect.Method.invoke(Method.java:498) com.oracle.cie.domain.script.jython.WLSTException: com.oracle.cie.domain.script.jython.WLSTException Domain Creation Failed.. Please check the Domain Logs 可以从48行看到是在 Creating Admin server... 阶段出错的。\n解决四：提高ADMIN_PASSWORD 密码复杂度 需要注意的是每次失败重试之前要先删除之前留下的痕迹。\n1 2 sudo docker rm oamadmin sudo rm -rf /scratch/user_projects/* 从这里 https://github.com/oracle/docker-images/issues/844#issuecomment-389884511 看到可能是密码复杂度不够，导致无法设置密码。\n启动容器的命令改为以下。将其中 ADMIN_PASSWORD 和 DB_SCHEMA_PASSWORD 的复杂度变高。\n其中ADMIN_PASSWORD 应该是weblogic管理台的密码。DB_SCHEMA_PASSWORD 是 password you want to set for the RCU schemas 。\n那么什么是RCU schemas 呢？什么是RCU呢？不太理解，先跳过。\nRepository Creation Utility is a graphical and CLI-based tool used to create and manage Oracle Fusion Middleware database schemas.\n改进两个密码的复杂度重新创建容器。\n1 sudo docker run -d --network=OamNET -p 7001:7001 --name=oamadmin --env CONNECTION_STRING=172.17.0.1:1521/ORCLPDB1.localdomain --env ADMIN_LISTEN_HOST=oamadmin --env DOMAIN_NAME=access_domain --env ADMIN_USER=weblogic --env ADMIN_PASSWORD=W3bl@gic --env ADMIN_LISTEN_PORT=7001 --env RCUPREFIX=OAM1 --env DB_USER=sys --env DB_PASSWORD=Oradoc_db1 --env DB_SCHEMA_PASSWORD=Dbsch3m@ -v /scratch/user_projects/:/u01/oracle/user_projects container-registry.oracle.com/middleware/oam:12.2.1.4.0 并使用 sudo docker logs -ft oamadmin 查看新建过程打印出来的日志，看到问题得到了解决。\n报错五：创建domain失败 可以看到前几个步骤都顺利完成了，但也出现了新的问题。\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 类似前文日志 INFO: Creating Admin server... INFO: Enabling SSL PORT for AdminServer... Creating Node Managers... Will create Base domain at /u01/oracle/user_projects/domains/access_domain Writing base domain... Base domain created at /u01/oracle/user_projects/domains/access_domain Extending domain at /u01/oracle/user_projects/domains/access_domain Database 172.17.0.1:1521/ORCLPDB1.localdomain Apply Extension templates Extension Templates added Extension Templates added Deleting oam_server1 The default oam_server1 coming from the oam extension template deleted Deleting oam_policy_mgr1 The default oam_server1 coming from the oam extension template deleted Configuring JDBC Templates ... Configuring the Service Table DataSource... fmwDatabase jdbc:oracle:thin:@172.17.0.1:1521/ORCLPDB1.localdomain Getting Database Defaults... Error: getDatabaseDefaults() failed. Do dumpStack() to see details. Error: runCmd() failed. Do dumpStack() to see details. Problem invoking WLST - Traceback (innermost last): File \"/u01/oracle/dockertools/create_domain.py\", line 513, in ? File \"/u01/oracle/dockertools/create_domain.py\", line 124, in createOAMDomain File \"/u01/oracle/dockertools/create_domain.py\", line 328, in extendOamDomain File \"/u01/oracle/dockertools/create_domain.py\", line 259, in configureJDBCTemplates File \"/tmp/WLSTOfflineIni7074819690261705056.py\", line 267, in getDatabaseDefaults File \"/tmp/WLSTOfflineIni7074819690261705056.py\", line 19, in command Failed to build JDBC Connection object: at com.oracle.cie.domain.script.jython.CommandExceptionHandler.handleException(CommandExceptionHandler.java:69) at com.oracle.cie.domain.script.jython.WLScriptContext.handleException(WLScriptContext.java:3085) at com.oracle.cie.domain.script.jython.WLScriptContext.runCmd(WLScriptContext.java:738) at sun.reflect.GeneratedMethodAccessor132.invoke(Unknown Source) at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) at java.lang.reflect.Method.invoke(Method.java:498) com.oracle.cie.domain.script.jython.WLSTException: com.oracle.cie.domain.script.jython.WLSTException: Got exception when auto configuring the schema component(s) with data obtained from shadow table: Failed to build JDBC Connection object: Domain Creation Failed.. Please check the Domain Logs 解决五：修改DB_SCHEMA_PASSWORD 从日志看到是在 Getting Database Defaults... 阶段出现的问题，搜索 getDatabaseDefaults() failed. Do dumpStack() to see details. 发现这个github issue有讨论。\n看到有人说是 schema password 的问题，于是随便改DB_SCHEMA_PASSWORD ，改成Oradoc_db1 还是不行，改成Oradoc_db2就可以了，我也不知道是什么原因😓\n总之呢，用这个命令，就可以跑起来三个容器中的第一个了！\n1 sudo docker run -d --network=OamNET -p 7001:7001 --name=oamadmin --env CONNECTION_STRING=172.17.0.1:1521/ORCLPDB1.localdomain --env ADMIN_LISTEN_HOST=oamadmin --env DOMAIN_NAME=access_domain --env ADMIN_USER=weblogic --env ADMIN_PASSWORD=W3bl@gic --env ADMIN_LISTEN_PORT=7001 --env RCUPREFIX=OAM1 --env DB_USER=sys --env DB_PASSWORD=Oradoc_db1 --env DB_SCHEMA_PASSWORD=Oradoc_db2 -v /scratch/user_projects/:/u01/oracle/user_projects container-registry.oracle.com/middleware/oam:12.2.1.4.0 成果 ④创建容器二 1 sudo docker run -d -p 14100:14100 --network=OamNET --volumes-from oamadmin --name oamms --env DOMAIN_NAME=access_domain --env ADMIN_USER=weblogic --env ADMIN_PASSWORD=W3bl@gic --env ADMIN_LISTEN_HOST=oamadmin --env ADMIN_LISTEN_PORT=7001 --env MANAGEDSERVER_PORT=14100 --env MANAGED_SERVER_CONTAINER=true --env MS_NAME=oam_server1 --env MS_HOST=oamms container-registry.oracle.com/middleware/oam:12.2.1.4.0 \"/u01/oracle/dockertools/startMS.sh\" ⑤创建容器三 1 sudo docker run -d -p 15100:15100 --network=OamNET --volumes-from oamadmin --name oampolicy --env DOMAIN_NAME=access_domain --env ADMIN_USER=weblogic --env ADMIN_PASSWORD=W3bl@gic --env ADMIN_LISTEN_HOST=oamadmin --env ADMIN_LISTEN_PORT=7001 --env MANAGEDSERVER_PORT=15100 --env MANAGED_SERVER_CONTAINER=true --env MS_NAME=oam_policy_mgr1 --env MS_HOST=oampolicy container-registry.oracle.com/middleware/oam:12.2.1.4.0 \"/u01/oracle/dockertools/startMS.sh\" ⑥验证服务可用性 1 sudo docker inspect -f '{{.Name}} - {{range .NetworkSettings.Networks}}{{.IPAddress}}{{end}}' oamadmin oamms oampolicy myOracleDB Console or Page URL WebLogic Administration Console http://:7001/console Oracle Enterprise Manager Console http://:7001/em Oracle Access Management Console http://:7001/oamconsole OAM Server Logout http://:14100/oam/server/logout Policy Manager Access http://:15100/access 各服务截图\n⑦启停与删除 启停\n1 2 sudo docker stop oamadmin oamms oampolicy myOracleDB sudo docker start oamadmin oamms oampolicy myOracleDB 删除\n1 2 3 sudo docker stop oamadmin oamms oampolicy myOracleDB sudo docker rm oamadmin oamms oampolicy myOracleDB sudo rm -rf /scratch/user_projects 参考链接 安装Oracle Access Manager Creating Oracle Access Management Docker Containers https://www.oracle.com/hk/security/identity-management/technologies/downloads/ https://docs.oracle.com/cd/E23104_01/download_readme.htm https://github.com/oracle/docker-images/tree/main/OracleAccessManagement CDB与PDB ORACLE 12C新特性——CDB与PDB 如何连接到 Oracle RAC 12cR1 中的可插拔数据库？ SQLPLus How to install SqlPlus? Oracle Instant Client Downloads for Linux x86-64 (64-bit) Oracle数据库 Oracle Database Server Docker Image Documentation 漏洞分析 【最新漏洞预警】CVE-2021–35587 Oracle Access Manager反序列化漏洞分析与命令回显构造 ","wordCount":"1826","inLanguage":"en","datePublished":"2022-03-17T18:11:09+08:00","dateModified":"2022-03-17T18:11:09+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://ret2neo.cn/post/220317-howto-install-oracle-access-manager/"},"publisher":{"@type":"Organization","name":"闲言语","logo":{"@type":"ImageObject","url":"https://ret2neo.cn/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://ret2neo.cn/ accesskey=h title="闲言语 (Alt + H)">闲言语</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://ret2neo.cn/mind/ title=随笔><span>随笔</span></a></li><li><a href=https://ret2neo.cn/about title=关于><span>关于</span></a></li><li><a href=https://ret2neo.cn/search title="搜索 (Alt + /)" accesskey=/><span>搜索</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>如何搭建 Oracle Access Manager</h1><div class=post-meta><span title='2022-03-17 18:11:09 +0800 CST'>March 17, 2022</span>&nbsp;|&nbsp;<a href=https://github.dev/findneo/priblog/content/post/220317-howto-install-oracle-access-manager.md rel="noopener noreferrer" target=_blank>edit</a></div></header><aside id=toc-container class="toc-container wide"><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>目录</span></summary><div class=inner><ul><li><a href=#%e5%a4%a7%e7%ba%b2 aria-label=大纲>大纲</a></li><li><a href=#%e6%ad%a5%e9%aa%a4%e6%b1%87%e6%80%bb aria-label=步骤汇总>步骤汇总</a></li><li><a href=#%e8%bf%90%e8%a1%8coracle%e6%95%b0%e6%8d%ae%e5%ba%93 aria-label=①运行Oracle数据库>①运行Oracle数据库</a><ul><li><a href=#%e5%88%9b%e5%bb%baoracle%e6%95%b0%e6%8d%ae%e5%ba%93 aria-label=创建Oracle数据库>创建Oracle数据库</a></li><li><a href=#%e6%b5%8b%e8%af%95%e6%95%b0%e6%8d%ae%e5%ba%93%e8%bf%9e%e6%8e%a5 aria-label=测试数据库连接>测试数据库连接</a><ul><li><a href=#%e5%ae%89%e8%a3%85sqlplus aria-label=安装sqlplus>安装sqlplus</a><ul><li><a href=#step1 aria-label=step1:>step1:</a></li><li><a href=#step2 aria-label=step2:>step2:</a></li><li><a href=#step3 aria-label=step3:>step3:</a></li><li><a href=#step4 aria-label=step4:>step4:</a></li><li><a href=#step5 aria-label=step5:>step5:</a></li><li><a href=#step6 aria-label=step6:>step6:</a></li><li><a href=#step7-%e6%b5%8b%e8%af%95%e9%93%be%e6%8e%a5 aria-label="step7 测试链接">step7 测试链接</a></li><li><a href=#%e5%85%b6%e4%bb%96sqlplus64%e7%9a%84%e7%94%a8%e6%b3%95 aria-label=其他：sqlplus64的用法>其他：sqlplus64的用法</a></li></ul></li></ul></li></ul></li><li><a href=#%e4%b8%8b%e8%bd%bdoam%e9%95%9c%e5%83%8f aria-label=②下载OAM镜像>②下载OAM镜像</a></li><li><a href=#%e5%88%9b%e5%bb%ba%e5%ae%b9%e5%99%a8%e4%b8%80 aria-label=③创建容器一>③创建容器一</a><ul><li><a href=#%e6%8a%a5%e9%94%99%e5%8f%8a%e8%a7%a3%e5%86%b3 aria-label=报错及解决>报错及解决</a><ul><li><a href=#%e6%8a%a5%e9%94%99%e4%b8%80%e6%97%a0%e6%b3%95%e8%bf%9e%e6%8e%a5%e6%95%b0%e6%8d%ae%e5%ba%93 aria-label=报错一：无法连接数据库>报错一：无法连接数据库</a></li><li><a href=#%e8%a7%a3%e5%86%b3%e4%b8%80%e4%bd%bf%e7%94%a8%e6%ad%a3%e7%a1%ae%e7%9a%84ip aria-label=解决一：使用正确的IP>解决一：使用正确的IP</a></li><li><a href=#%e6%8a%a5%e9%94%99%e4%ba%8c%e6%97%a0%e6%b3%95%e8%bf%9e%e6%8e%a5cdb aria-label=报错二：无法连接CDB>报错二：无法连接CDB</a></li><li><a href=#%e8%a7%a3%e5%86%b3%e4%ba%8c%e4%bd%bf%e7%94%a8pdb aria-label=解决二：使用PDB>解决二：使用PDB</a></li><li><a href=#%e6%8a%a5%e9%94%99%e4%b8%89%e6%97%a0%e6%b3%95%e6%89%a7%e8%a1%8csql aria-label=报错三：无法执行SQL>报错三：无法执行SQL</a></li><li><a href=#%e8%a7%a3%e5%86%b3%e4%b8%89%e6%89%93%e5%bc%80pdb aria-label=解决三：打开PDB>解决三：打开PDB</a></li><li><a href=#%e6%8a%a5%e9%94%99%e5%9b%9b%e5%88%9b%e5%bb%badomain%e5%a4%b1%e8%b4%a5 aria-label=报错四：创建domain失败>报错四：创建domain失败</a></li><li><a href=#%e8%a7%a3%e5%86%b3%e5%9b%9b%e6%8f%90%e9%ab%98admin_password-%e5%af%86%e7%a0%81%e5%a4%8d%e6%9d%82%e5%ba%a6 aria-label="解决四：提高ADMIN_PASSWORD 密码复杂度">解决四：提高<code>ADMIN_PASSWORD</code> 密码复杂度</a></li><li><a href=#%e6%8a%a5%e9%94%99%e4%ba%94%e5%88%9b%e5%bb%badomain%e5%a4%b1%e8%b4%a5 aria-label=报错五：创建domain失败>报错五：创建domain失败</a></li><li><a href=#%e8%a7%a3%e5%86%b3%e4%ba%94%e4%bf%ae%e6%94%b9db_schema_password aria-label=解决五：修改DB_SCHEMA_PASSWORD>解决五：修改<code>DB_SCHEMA_PASSWORD</code></a></li></ul></li><li><a href=#%e6%88%90%e6%9e%9c aria-label=成果>成果</a></li></ul></li><li><a href=#%e5%88%9b%e5%bb%ba%e5%ae%b9%e5%99%a8%e4%ba%8c aria-label=④创建容器二>④创建容器二</a></li><li><a href=#%e5%88%9b%e5%bb%ba%e5%ae%b9%e5%99%a8%e4%b8%89 aria-label=⑤创建容器三>⑤创建容器三</a></li><li><a href=#%e9%aa%8c%e8%af%81%e6%9c%8d%e5%8a%a1%e5%8f%af%e7%94%a8%e6%80%a7 aria-label=⑥验证服务可用性>⑥验证服务可用性</a></li><li><a href=#%e5%90%af%e5%81%9c%e4%b8%8e%e5%88%a0%e9%99%a4 aria-label=⑦启停与删除>⑦启停与删除</a></li><li><a href=#%e5%8f%82%e8%80%83%e9%93%be%e6%8e%a5 aria-label=参考链接>参考链接</a></li></ul></div></details></div></aside><script>let activeElement,elements;window.addEventListener("DOMContentLoaded",function(){checkTocPosition(),elements=document.querySelectorAll("h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]"),activeElement=elements[0];const t=encodeURI(activeElement.getAttribute("id")).toLowerCase();document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active")},!1),window.addEventListener("resize",function(){checkTocPosition()},!1),window.addEventListener("scroll",()=>{activeElement=Array.from(elements).find(e=>{if(getOffsetTop(e)-window.pageYOffset>0&&getOffsetTop(e)-window.pageYOffset<window.innerHeight/2)return e})||activeElement,elements.forEach(e=>{const t=encodeURI(e.getAttribute("id")).toLowerCase();e===activeElement?document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active"):document.querySelector(`.inner ul li a[href="#${t}"]`).classList.remove("active")})},!1);const main=parseInt(getComputedStyle(document.body).getPropertyValue("--article-width"),10),toc=parseInt(getComputedStyle(document.body).getPropertyValue("--toc-width"),10),gap=parseInt(getComputedStyle(document.body).getPropertyValue("--gap"),10);function checkTocPosition(){const e=document.body.scrollWidth;e-main-toc*2-gap*4>0?document.getElementById("toc-container").classList.add("wide"):document.getElementById("toc-container").classList.remove("wide")}function getOffsetTop(e){if(!e.getClientRects().length)return 0;let t=e.getBoundingClientRect(),n=e.ownerDocument.defaultView;return t.top+n.pageYOffset}</script><div class=post-content><h1 id=大纲>大纲<a hidden class=anchor aria-hidden=true href=#大纲>#</a></h1><p>参考 <a href=https://docs.oracle.com/en/middleware/idm/access-manager/12.2.1.4/tutorial-oam-docker/#Background>https://docs.oracle.com/en/middleware/idm/access-manager/12.2.1.4/tutorial-oam-docker/#Background</a> 使用方法2获取OAM镜像</p><blockquote><ol start=2><li>Download a prebuilt OAM image from <a href=https://container-registry.oracle.com/>Oracle Container Registry</a> by by navigating to <strong>Middleware</strong> > <strong>oam</strong>. This image contains no patches and should only be used in Developer or Test environments.</li></ol></blockquote><p>下载到的OAM镜像用于跑起来三个OAM容器</p><blockquote><ul><li>WebLogic Administration Server (<code>AdminServer</code>)</li><li>OAM Managed Server (<code>oam_server1</code>)</li><li>OAM Policy Manager Managed Server (<code>oam_policy_mgr1</code>)</li></ul></blockquote><p>跑起来这三个容器依赖一个可用的Oracle数据库</p><h1 id=步骤汇总>步骤汇总<a hidden class=anchor aria-hidden=true href=#步骤汇总>#</a></h1><ol><li><p>创建一台全新的Ubuntu18.04，切换到root用户。</p></li><li><p>在 <a href=https://hub.docker.com/_/oracle-database-enterprise-edition>https://hub.docker.com/_/oracle-database-enterprise-edition</a> 和 <a href=https://container-registry.oracle.com/>https://container-registry.oracle.com/</a> 登录账号后同意协议。（参考步骤二）</p></li><li><p>安装docker</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-1>1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-2>2</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>apt update
</span></span><span style=display:flex><span>apt install docker.io
</span></span></code></pre></td></tr></table></div></div></li><li><p>docker 登录dockerhub 和 container-registry.oracle.com</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-1>1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-2>2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-3>3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-4>4</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>docker login
</span></span><span style=display:flex><span>	输入 login.docker.com 的账号密码	
</span></span><span style=display:flex><span>docker login container-registry.oracle.com
</span></span><span style=display:flex><span>	输入 login.oracle.com 的账号密码
</span></span></code></pre></td></tr></table></div></div></li><li><p>拉取两个镜像</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-1>1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-2>2</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>docker pull store/oracle/database-enterprise:12.2.0.1
</span></span><span style=display:flex><span>docker pull container-registry.oracle.com/middleware/oam:12.2.1.4.0
</span></span></code></pre></td></tr></table></div></div></li><li><p>一些准备工作</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-1>1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-2>2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-3>3</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>docker network create -d bridge OamNET
</span></span><span style=display:flex><span>mkdir -p /scratch/user_projects
</span></span><span style=display:flex><span>chmod <span style=color:#ae81ff>777</span> /scratch/user_projects
</span></span></code></pre></td></tr></table></div></div></li><li><p>启动四个容器（将<code>172.17.0.1</code>替换为docker虚拟网卡网关的IP）</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-1>1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-2>2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-3>3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-4>4</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>docker run -d -it --name myOracleDB -p 1521:1521 store/oracle/database-enterprise:12.2.0.1
</span></span><span style=display:flex><span>docker run -d --network<span style=color:#f92672>=</span>OamNET -p 7001:7001 --name<span style=color:#f92672>=</span>oamadmin --env CONNECTION_STRING<span style=color:#f92672>=</span>172.17.0.1:1521/ORCLPDB1.localdomain --env ADMIN_LISTEN_HOST<span style=color:#f92672>=</span>oamadmin --env DOMAIN_NAME<span style=color:#f92672>=</span>access_domain --env ADMIN_USER<span style=color:#f92672>=</span>weblogic --env ADMIN_PASSWORD<span style=color:#f92672>=</span>W3bl@gic --env ADMIN_LISTEN_PORT<span style=color:#f92672>=</span><span style=color:#ae81ff>7001</span> --env RCUPREFIX<span style=color:#f92672>=</span>OAM1 --env DB_USER<span style=color:#f92672>=</span>sys --env DB_PASSWORD<span style=color:#f92672>=</span>Oradoc_db1 --env DB_SCHEMA_PASSWORD<span style=color:#f92672>=</span>Oradoc_db2 -v /scratch/user_projects/:/u01/oracle/user_projects container-registry.oracle.com/middleware/oam:12.2.1.4.0
</span></span><span style=display:flex><span>docker run -d -p 14100:14100 --network<span style=color:#f92672>=</span>OamNET --volumes-from oamadmin --name oamms --env DOMAIN_NAME<span style=color:#f92672>=</span>access_domain --env ADMIN_USER<span style=color:#f92672>=</span>weblogic --env ADMIN_PASSWORD<span style=color:#f92672>=</span>W3bl@gic --env ADMIN_LISTEN_HOST<span style=color:#f92672>=</span>oamadmin --env ADMIN_LISTEN_PORT<span style=color:#f92672>=</span><span style=color:#ae81ff>7001</span> --env MANAGEDSERVER_PORT<span style=color:#f92672>=</span><span style=color:#ae81ff>14100</span> --env MANAGED_SERVER_CONTAINER<span style=color:#f92672>=</span>true --env MS_NAME<span style=color:#f92672>=</span>oam_server1 --env MS_HOST<span style=color:#f92672>=</span>oamms container-registry.oracle.com/middleware/oam:12.2.1.4.0 <span style=color:#e6db74>&#34;/u01/oracle/dockertools/startMS.sh&#34;</span>
</span></span><span style=display:flex><span>docker run -d -p 15100:15100 --network<span style=color:#f92672>=</span>OamNET --volumes-from oamadmin --name oampolicy --env DOMAIN_NAME<span style=color:#f92672>=</span>access_domain --env ADMIN_USER<span style=color:#f92672>=</span>weblogic --env ADMIN_PASSWORD<span style=color:#f92672>=</span>W3bl@gic --env ADMIN_LISTEN_HOST<span style=color:#f92672>=</span>oamadmin --env ADMIN_LISTEN_PORT<span style=color:#f92672>=</span><span style=color:#ae81ff>7001</span> --env MANAGEDSERVER_PORT<span style=color:#f92672>=</span><span style=color:#ae81ff>15100</span> --env MANAGED_SERVER_CONTAINER<span style=color:#f92672>=</span>true --env MS_NAME<span style=color:#f92672>=</span>oam_policy_mgr1 --env MS_HOST<span style=color:#f92672>=</span>oampolicy container-registry.oracle.com/middleware/oam:12.2.1.4.0 <span style=color:#e6db74>&#34;/u01/oracle/dockertools/startMS.sh&#34;</span>
</span></span></code></pre></td></tr></table></div></div></li><li><p>查看各服务IP</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-1>1</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>docker inspect -f <span style=color:#e6db74>&#39;{{.Name}} - {{range .NetworkSettings.Networks}}{{.IPAddress}}{{end}}&#39;</span> oamadmin oamms oampolicy myOracleDB
</span></span></code></pre></td></tr></table></div></div></li><li><p>使用以下链接访问服务。（192.168.0.105为虚拟机IP）</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-6-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-6-1>1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-6-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-6-2>2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-6-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-6-3>3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-6-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-6-4>4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-6-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-6-5>5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-6-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-6-6>6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-6-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-6-7>7</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>账号：weblogic  密码：W3bl@gic
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>WebLogic Administration Console   http://192.168.0.105:7001/console         
</span></span><span style=display:flex><span>Oracle Enterprise Manager Console http://192.168.0.105:7001/em       
</span></span><span style=display:flex><span>Oracle Access Management Console  http://192.168.0.105:7001/oamconsole
</span></span><span style=display:flex><span>OAM Server Logout                 http://192.168.0.105:14100/oam/server/logout
</span></span><span style=display:flex><span>Policy Manager Access             http://192.168.0.105:15100/access
</span></span></code></pre></td></tr></table></div></div></li></ol><h1 id=运行oracle数据库>①运行Oracle数据库<a hidden class=anchor aria-hidden=true href=#运行oracle数据库>#</a></h1><h2 id=创建oracle数据库>创建Oracle数据库<a hidden class=anchor aria-hidden=true href=#创建oracle数据库>#</a></h2><p>参考 <a href=https://hub.docker.com/_/oracle-database-enterprise-edition>https://hub.docker.com/_/oracle-database-enterprise-edition</a> 登陆账号后跳转到 <a href=https://hub.docker.com/u/findneo/content/sub-3762ef81-7448-4275-909b-df7e6b5d4070>https://hub.docker.com/u/findneo/content/sub-3762ef81-7448-4275-909b-df7e6b5d4070</a> ，同意协议。</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-1>1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-2>2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-3>3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-4>4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-5>5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-6>6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-7>7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-8>8</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>sudo docker login 
</span></span><span style=display:flex><span># 输入docker hub的账号密码
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>sudo docker pull store/oracle/database-enterprise:12.2.0.1
</span></span><span style=display:flex><span># 拉取镜像
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>sudo docker run -d -it --name myOracleDB -p 1521:1521 store/oracle/database-enterprise:12.2.0.1
</span></span><span style=display:flex><span># 运行起来一个Oracle数据库，并且开放到本地的1521端口
</span></span></code></pre></td></tr></table></div></div><h2 id=测试数据库连接>测试数据库连接<a hidden class=anchor aria-hidden=true href=#测试数据库连接>#</a></h2><h3 id=安装sqlplus>安装sqlplus<a hidden class=anchor aria-hidden=true href=#安装sqlplus>#</a></h3><p>参考https://askubuntu.com/questions/159939/how-to-install-sqlplus</p><h4 id=step1>step1:<a hidden class=anchor aria-hidden=true href=#step1>#</a></h4><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-1>1</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>sudo apt-get install alien
</span></span></code></pre></td></tr></table></div></div><h4 id=step2>step2:<a hidden class=anchor aria-hidden=true href=#step2>#</a></h4><p>在 <a href=https://www.oracle.com/database/technologies/instant-client/linux-x86-64-downloads.html>https://www.oracle.com/database/technologies/instant-client/linux-x86-64-downloads.html</a> 下载3个文件
oracle-instantclient12.2-basic-12.2.0.1.0-1.x86_64.rpm
oracle-instantclient12.2-sqlplus-12.2.0.1.0-1.x86_64.rpm
oracle-instantclient12.2-devel-12.2.0.1.0-1.x86_64.rpm</p><h4 id=step3>step3:<a hidden class=anchor aria-hidden=true href=#step3>#</a></h4><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-9-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-9-1>1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-9-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-9-2>2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-9-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-9-3>3</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo alien -i oracle-instantclient*-basic*.rpm
</span></span><span style=display:flex><span>sudo alien -i oracle-instantclient*-sqlplus*.rpm
</span></span><span style=display:flex><span>sudo alien -i oracle-instantclient*-devel*.rpm
</span></span></code></pre></td></tr></table></div></div><h4 id=step4>step4:<a hidden class=anchor aria-hidden=true href=#step4>#</a></h4><p>sudo apt-get install libaio1</p><h4 id=step5>step5:<a hidden class=anchor aria-hidden=true href=#step5>#</a></h4><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-1>1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-2>2</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo sensible-editor /etc/ld.so.conf.d/oracle.conf
</span></span><span style=display:flex><span><span style=color:#75715e># 粘贴 /usr/lib/oracle/12.2/client64/lib/</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=step6>step6:<a hidden class=anchor aria-hidden=true href=#step6>#</a></h4><p>sudo ldconfig</p><h4 id=step7-测试链接>step7 测试链接<a hidden class=anchor aria-hidden=true href=#step7-测试链接>#</a></h4><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-1>1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-2>2</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>sqlplus64 sys/Oradoc_db1@//127.0.0.1:1521/ORCLCDB.localdomain as sysdba
</span></span><span style=display:flex><span>sqlplus64 sys/Oradoc_db1@//172.17.0.1:1521/ORCLPDB1.localdomain as sysdba
</span></span></code></pre></td></tr></table></div></div><p><img loading=lazy src=Image.png alt=Image></p><h4 id=其他sqlplus64的用法>其他：sqlplus64的用法<a hidden class=anchor aria-hidden=true href=#其他sqlplus64的用法>#</a></h4><p>sqlplus64的用法：<code>sqlplus [ [&lt;option>] [{logon | /nolog}] [&lt;start>] ]</code></p><p>其中<code>&lt;logon></code> 是</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-1>1</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>{&lt;username&gt;[/&lt;password&gt;][@&lt;connect_identifier&gt;] | / } [AS {SYSDBA | SYSOPER | SYSASM | SYSBACKUP | SYSDG | SYSKM | SYSRAC}] [EDITION=value]
</span></span></code></pre></td></tr></table></div></div><p>其中<code>&lt;connect_identifier></code>可以是如下格式 <code>@[&lt;net_service_name> | [//]Host[:Port]/&lt;service_name>]</code></p><p>如何知道 service_name 或者 net_service_name？<a href=https://hub.docker.com/u/findneo/content/sub-3762ef81-7448-4275-909b-df7e6b5d4070>Oracle数据库容器镜像文档</a>说<code>service_name</code>定义在环境变量TNS_ADMIN定义的目录下的tnsnames.ora文件中，
进容器看到 <code>TNS_ADMIN=/u01/app/oracle/product/12.2.0/dbhome_1/admin/ORCLCDB</code> ，tnsnames.ora文件内容为</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-1>1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-2>2</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>ORCLCDB =   (DESCRIPTION =     (ADDRESS = (PROTOCOL = TCP)(HOST = 0.0.0.0)(PORT = 1521))     (CONNECT_DATA =       (SERVER = DEDICATED)       (SERVICE_NAME = ORCLCDB.localdomain)     )   )
</span></span><span style=display:flex><span>ORCLPDB1 =   (DESCRIPTION =     (ADDRESS = (PROTOCOL = TCP)(HOST = 0.0.0.0)(PORT = 1521))     (CONNECT_DATA =       (SERVER = DEDICATED)       (SERVICE_NAME = ORCLPDB1.localdomain)     )   )
</span></span></code></pre></td></tr></table></div></div><p>所以 <code>SERVICE_NAME</code> 可以是 <code>ORCLCDB.localdomain</code> 或者 <code>ORCLPDB1.localdomain</code> 。</p><h1 id=下载oam镜像>②下载OAM镜像<a hidden class=anchor aria-hidden=true href=#下载oam镜像>#</a></h1><p>进入 <a href=https://container-registry.oracle.com/>https://container-registry.oracle.com/</a> ，点击右上角Sign In，登陆自己的Oracle账号，然后点击MiddleWare，然后点击OAM。</p><p><img loading=lazy src=0c94e3a95ae67b3b7.png alt></p><p><img loading=lazy src=a414f141786c88a13.png alt></p><p>在右侧区域同意协议，然后才可以下载。</p><p><img loading=lazy src=20f0e87b6affb843b.png alt></p><p>否则即使docker login，还是无法下载，会提示</p><blockquote><p>Error response from daemon: pull access denied for container-registry.oracle.com/middleware/oam, repository does not exist or may require &lsquo;docker login&rsquo;: denied: requested access to the resource is denied。</p></blockquote><p><img loading=lazy src=e667bf3a5d97ab241.png alt></p><p>同意协议之后执行以下命令</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-1>1</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo docker login container-registry.oracle.com
</span></span></code></pre></td></tr></table></div></div><p>输入在Oracle注册的账号密码</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-1>1</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>sudo docker pull container-registry.oracle.com/middleware/oam:12.2.1.4.0
</span></span></code></pre></td></tr></table></div></div><p><img loading=lazy src=a3610943f42263d91.png alt></p><h1 id=创建容器一>③创建容器一<a hidden class=anchor aria-hidden=true href=#创建容器一>#</a></h1><p>参考教程创建OAM Administration Server Container，其中包含WebLogic 和OAM Consoles.</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-1>1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-2>2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-3>3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-4>4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-5>5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-6>6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-7>7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-8>8</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo docker images
</span></span><span style=display:flex><span>sudo docker network create -d bridge OamNET
</span></span><span style=display:flex><span><span style=color:#75715e># 14f104a67b0819335f9490dadc3e4003540bcdbb7b19436b2aea56250a5f2713</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>sudo mkdir -p /scratch/user_projects
</span></span><span style=display:flex><span>sudo chmod <span style=color:#ae81ff>777</span> /scratch/user_projects
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>sudo docker run -d --network<span style=color:#f92672>=</span>OamNET -p 7001:7001 --name<span style=color:#f92672>=</span>oamadmin --env CONNECTION_STRING<span style=color:#f92672>=</span>127.0.0.1:1521/ORCLCDB.localdomain --env ADMIN_LISTEN_HOST<span style=color:#f92672>=</span>oamadmin --env DOMAIN_NAME<span style=color:#f92672>=</span>access_domain --env ADMIN_USER<span style=color:#f92672>=</span>weblogic --env ADMIN_PASSWORD<span style=color:#f92672>=</span>password --env ADMIN_LISTEN_PORT<span style=color:#f92672>=</span><span style=color:#ae81ff>7001</span> --env RCUPREFIX<span style=color:#f92672>=</span>OAM1 --env DB_USER<span style=color:#f92672>=</span>sys --env DB_PASSWORD<span style=color:#f92672>=</span>Oradoc_db1 --env DB_SCHEMA_PASSWORD<span style=color:#f92672>=</span>password -v /scratch/user_projects/:/u01/oracle/user_projects container-registry.oracle.com/middleware/oam:12.2.1.4.0
</span></span></code></pre></td></tr></table></div></div><p>可能会连不上，使用以下命令调试，看看错误是什么</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-1>1</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo docker run --rm --network<span style=color:#f92672>=</span>OamNET -p 7001:7001 --name<span style=color:#f92672>=</span>oamadmin --env CONNECTION_STRING<span style=color:#f92672>=</span>127.0.0.1:1521/ORCLCDB.localdomain --env ADMIN_LISTEN_HOST<span style=color:#f92672>=</span>oamadmin --env DOMAIN_NAME<span style=color:#f92672>=</span>access_domain --env ADMIN_USER<span style=color:#f92672>=</span>weblogic --env ADMIN_PASSWORD<span style=color:#f92672>=</span>password --env ADMIN_LISTEN_PORT<span style=color:#f92672>=</span><span style=color:#ae81ff>7001</span> --env RCUPREFIX<span style=color:#f92672>=</span>OAM1 --env DB_USER<span style=color:#f92672>=</span>sys --env DB_PASSWORD<span style=color:#f92672>=</span>Oradoc_db1 --env DB_SCHEMA_PASSWORD<span style=color:#f92672>=</span>password -v /scratch/user_projects/:/u01/oracle/user_projects container-registry.oracle.com/middleware/oam:12.2.1.4.0
</span></span></code></pre></td></tr></table></div></div><h2 id=报错及解决>报错及解决<a hidden class=anchor aria-hidden=true href=#报错及解决>#</a></h2><h3 id=报错一无法连接数据库>报错一：无法连接数据库<a hidden class=anchor aria-hidden=true href=#报错一无法连接数据库>#</a></h3><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-1>1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-2>2</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>Unable to connect to the database using the provided details.
</span></span><span style=display:flex><span>Enter a valid hostname and port or check if the listener is up and running
</span></span></code></pre></td></tr></table></div></div><h3 id=解决一使用正确的ip>解决一：使用正确的IP<a hidden class=anchor aria-hidden=true href=#解决一使用正确的ip>#</a></h3><p>需要注意CONNECTION_STRING是从新建的容器中访问的，所以给的IP应该是容器网卡的网关或者主机的，比如 172.17.0.1，而不是127.0.0.1。</p><h3 id=报错二无法连接cdb>报错二：无法连接CDB<a hidden class=anchor aria-hidden=true href=#报错二无法连接cdb>#</a></h3><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-19-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-19-1>1</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>The selected Oracle database is a multitenant container database (CDB). Connecting to a multitenant container database (CDB) is not supported. Instead, connect to a valid pluggable database (PDB).
</span></span></code></pre></td></tr></table></div></div><h3 id=解决二使用pdb>解决二：使用PDB<a hidden class=anchor aria-hidden=true href=#解决二使用pdb>#</a></h3><blockquote><p>PDB和CDB是Oracle12的新特性，CDB是多租的。Oracle 数据库 12 c 多租户选项允许单个容器数据库 （CDB） 来承载多个单独的可插拔数据库 (PDB)。</p><p>——https://www.cnblogs.com/kerrycode/p/3386917.html</p></blockquote><p>使用以下语句查看自己是否是所租数据库</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-20-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-20-1>1</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>select name, decode(cdb, &#39;YES&#39;, &#39;Multitenant Option enabled&#39;, &#39;Regular 12c Database: &#39;) &#34;Multitenant Option&#34; , open_mode, con_id from v$database;
</span></span></code></pre></td></tr></table></div></div><p>结果</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-21-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-21-1>1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-21-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-21-2>2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-21-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-21-3>3</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>NAME      Multitenant Option         OPEN_MODE              CON_ID
</span></span><span style=display:flex><span>--------- -------------------------- -------------------- ----------
</span></span><span style=display:flex><span>ORCLCDB   Multitenant Option enabled READ WRITE            0
</span></span></code></pre></td></tr></table></div></div><p>或者直接</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-22-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-22-1>1</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>select cdb from v$database
</span></span></code></pre></td></tr></table></div></div><p>YES表示该数据库是CDB,如果是NO表示是NO-CDB(普通数据库)</p><p>或者执行</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-23-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-23-1>1</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>show pdbs;
</span></span></code></pre></td></tr></table></div></div><p>结果</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-24-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-24-1>1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-24-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-24-2>2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-24-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-24-3>3</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>   CON_ID CON_NAME              OPEN MODE  RESTRICTED
</span></span><span style=display:flex><span>---------- ------------------------------ ---------- ----------
</span></span><span style=display:flex><span>     2 PDB$SEED              READ ONLY  NO
</span></span></code></pre></td></tr></table></div></div><p>搜索 &ldquo;how to connect to pdb directly&rdquo; ，参考<a href=https://www.dell.com/support/kbdoc/zh-cn/000146485/%E5%A6%82%E4%BD%95%E8%BF%9E%E6%8E%A5%E5%88%B0-oracle-rac-12cr1-%E4%B8%AD%E7%9A%84%E5%8F%AF%E6%8F%92%E6%8B%94%E6%95%B0%E6%8D%AE%E5%BA%93>此文</a> 想到通过新建服务连接到PDB。然后注意到<code>/u01/app/oracle/product/12.2.0/dbhome_1/admin/ORCLCDB/tnsnames.ora</code> 文件内容如下，其中已经包括两个Service。</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-25-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-25-1>1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-25-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-25-2>2</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>ORCLCDB =   (DESCRIPTION =     (ADDRESS = (PROTOCOL = TCP)(HOST = 0.0.0.0)(PORT = 1521))     (CONNECT_DATA =       (SERVER = DEDICATED)       (SERVICE_NAME = ORCLCDB.localdomain)     )   )
</span></span><span style=display:flex><span>ORCLPDB1 =   (DESCRIPTION =     (ADDRESS = (PROTOCOL = TCP)(HOST = 0.0.0.0)(PORT = 1521))     (CONNECT_DATA =       (SERVER = DEDICATED)       (SERVICE_NAME = ORCLPDB1.localdomain)     )   )
</span></span></code></pre></td></tr></table></div></div><p>所以只要，创建容器时<code>CONNECTION_STRING</code> 使用 <code>172.17.0.1:1521/ORCLPDB1.localdomain</code> 而不是 <code>172.17.0.1:1521/ORCLCDB.localdomain</code> 就能解决这个错误。</p><h3 id=报错三无法执行sql>报错三：无法执行SQL<a hidden class=anchor aria-hidden=true href=#报错三无法执行sql>#</a></h3><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-26-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-26-1>1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-26-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-26-2>2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-26-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-26-3>3</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>ERROR - RCU-6005 Unable to execute sql query.
</span></span><span style=display:flex><span>CAUSE - RCU-6005 Database not in open state.
</span></span><span style=display:flex><span>ACTION - RCU-6005 Make sure that the database is open.
</span></span></code></pre></td></tr></table></div></div><h3 id=解决三打开pdb>解决三：打开PDB<a hidden class=anchor aria-hidden=true href=#解决三打开pdb>#</a></h3><p>为了解决报错二胡乱操作了数据库，其中一个动作关闭了PDB，从而导致了这个错误。打开它就好了。</p><p>SQL> select name,open_mode from v$pdbs;</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-27-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-27-1>1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-27-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-27-2>2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-27-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-27-3>3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-27-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-27-4>4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-27-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-27-5>5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-27-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-27-6>6</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>NAME
</span></span><span style=display:flex><span>--------------------------------------------------------------------------------
</span></span><span style=display:flex><span>OPEN_MODE
</span></span><span style=display:flex><span>----------
</span></span><span style=display:flex><span>ORCLPDB1
</span></span><span style=display:flex><span>MOUNTED
</span></span></code></pre></td></tr></table></div></div><p>SQL> <strong>alter pluggable database ORCLPDB1 open;</strong></p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-28-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-28-1>1</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>Pluggable database altered.
</span></span></code></pre></td></tr></table></div></div><p>SQL> select name,open_mode from v$pdbs;</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-29-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-29-1>1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-29-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-29-2>2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-29-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-29-3>3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-29-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-29-4>4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-29-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-29-5>5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-29-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-29-6>6</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>NAME
</span></span><span style=display:flex><span>--------------------------------------------------------------------------------
</span></span><span style=display:flex><span>OPEN_MODE
</span></span><span style=display:flex><span>----------
</span></span><span style=display:flex><span>ORCLPDB1
</span></span><span style=display:flex><span>READ WRITE
</span></span></code></pre></td></tr></table></div></div><h3 id=报错四创建domain失败>报错四：创建domain失败<a hidden class=anchor aria-hidden=true href=#报错四创建domain失败>#</a></h3><p>日志详情：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-30-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-30-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-30-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-30-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-30-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-30-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-30-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-30-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-30-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-30-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-30-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-30-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-30-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-30-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-30-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-30-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-30-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-30-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-30-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-30-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-30-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-30-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-30-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-30-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-30-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-30-13>13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-30-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-30-14>14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-30-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-30-15>15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-30-16><a style=outline:none;text-decoration:none;color:inherit href=#hl-30-16>16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-30-17><a style=outline:none;text-decoration:none;color:inherit href=#hl-30-17>17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-30-18><a style=outline:none;text-decoration:none;color:inherit href=#hl-30-18>18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-30-19><a style=outline:none;text-decoration:none;color:inherit href=#hl-30-19>19</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-30-20><a style=outline:none;text-decoration:none;color:inherit href=#hl-30-20>20</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-30-21><a style=outline:none;text-decoration:none;color:inherit href=#hl-30-21>21</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-30-22><a style=outline:none;text-decoration:none;color:inherit href=#hl-30-22>22</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-30-23><a style=outline:none;text-decoration:none;color:inherit href=#hl-30-23>23</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-30-24><a style=outline:none;text-decoration:none;color:inherit href=#hl-30-24>24</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-30-25><a style=outline:none;text-decoration:none;color:inherit href=#hl-30-25>25</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-30-26><a style=outline:none;text-decoration:none;color:inherit href=#hl-30-26>26</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-30-27><a style=outline:none;text-decoration:none;color:inherit href=#hl-30-27>27</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-30-28><a style=outline:none;text-decoration:none;color:inherit href=#hl-30-28>28</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-30-29><a style=outline:none;text-decoration:none;color:inherit href=#hl-30-29>29</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-30-30><a style=outline:none;text-decoration:none;color:inherit href=#hl-30-30>30</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-30-31><a style=outline:none;text-decoration:none;color:inherit href=#hl-30-31>31</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-30-32><a style=outline:none;text-decoration:none;color:inherit href=#hl-30-32>32</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-30-33><a style=outline:none;text-decoration:none;color:inherit href=#hl-30-33>33</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-30-34><a style=outline:none;text-decoration:none;color:inherit href=#hl-30-34>34</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-30-35><a style=outline:none;text-decoration:none;color:inherit href=#hl-30-35>35</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-30-36><a style=outline:none;text-decoration:none;color:inherit href=#hl-30-36>36</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-30-37><a style=outline:none;text-decoration:none;color:inherit href=#hl-30-37>37</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-30-38><a style=outline:none;text-decoration:none;color:inherit href=#hl-30-38>38</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-30-39><a style=outline:none;text-decoration:none;color:inherit href=#hl-30-39>39</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-30-40><a style=outline:none;text-decoration:none;color:inherit href=#hl-30-40>40</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-30-41><a style=outline:none;text-decoration:none;color:inherit href=#hl-30-41>41</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-30-42><a style=outline:none;text-decoration:none;color:inherit href=#hl-30-42>42</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-30-43><a style=outline:none;text-decoration:none;color:inherit href=#hl-30-43>43</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-30-44><a style=outline:none;text-decoration:none;color:inherit href=#hl-30-44>44</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-30-45><a style=outline:none;text-decoration:none;color:inherit href=#hl-30-45>45</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-30-46><a style=outline:none;text-decoration:none;color:inherit href=#hl-30-46>46</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-30-47><a style=outline:none;text-decoration:none;color:inherit href=#hl-30-47>47</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-30-48><a style=outline:none;text-decoration:none;color:inherit href=#hl-30-48>48</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-30-49><a style=outline:none;text-decoration:none;color:inherit href=#hl-30-49>49</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-30-50><a style=outline:none;text-decoration:none;color:inherit href=#hl-30-50>50</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-30-51><a style=outline:none;text-decoration:none;color:inherit href=#hl-30-51>51</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-30-52><a style=outline:none;text-decoration:none;color:inherit href=#hl-30-52>52</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-30-53><a style=outline:none;text-decoration:none;color:inherit href=#hl-30-53>53</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-30-54><a style=outline:none;text-decoration:none;color:inherit href=#hl-30-54>54</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-30-55><a style=outline:none;text-decoration:none;color:inherit href=#hl-30-55>55</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-30-56><a style=outline:none;text-decoration:none;color:inherit href=#hl-30-56>56</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-30-57><a style=outline:none;text-decoration:none;color:inherit href=#hl-30-57>57</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-30-58><a style=outline:none;text-decoration:none;color:inherit href=#hl-30-58>58</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-30-59><a style=outline:none;text-decoration:none;color:inherit href=#hl-30-59>59</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-30-60><a style=outline:none;text-decoration:none;color:inherit href=#hl-30-60>60</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-30-61><a style=outline:none;text-decoration:none;color:inherit href=#hl-30-61>61</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-30-62><a style=outline:none;text-decoration:none;color:inherit href=#hl-30-62>62</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-30-63><a style=outline:none;text-decoration:none;color:inherit href=#hl-30-63>63</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-30-64><a style=outline:none;text-decoration:none;color:inherit href=#hl-30-64>64</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-30-65><a style=outline:none;text-decoration:none;color:inherit href=#hl-30-65>65</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-30-66><a style=outline:none;text-decoration:none;color:inherit href=#hl-30-66>66</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-30-67><a style=outline:none;text-decoration:none;color:inherit href=#hl-30-67>67</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>CONNECTION_STRING=172.17.0.1:1521/ORCLPDB1.localdomain
</span></span><span style=display:flex><span>RCUPREFIX=OAM1
</span></span><span style=display:flex><span>DOMAIN_HOME=/u01/oracle/user_projects/domains/access_domain
</span></span><span style=display:flex><span>INFO: Admin Server not configured. Will run RCU and Domain Configuration Phase...
</span></span><span style=display:flex><span>Configuring Domain for first time 
</span></span><span style=display:flex><span>Start the Admin and Managed Servers  
</span></span><span style=display:flex><span>=====================================
</span></span><span style=display:flex><span>Loading RCU Phase
</span></span><span style=display:flex><span>=================
</span></span><span style=display:flex><span>CONNECTION_STRING=172.17.0.1:1521/ORCLPDB1.localdomain
</span></span><span style=display:flex><span>RCUPREFIX=OAM1
</span></span><span style=display:flex><span>jdbc_url=jdbc:oracle:thin:@172.17.0.1:1521/ORCLPDB1.localdomain
</span></span><span style=display:flex><span>Creating Domain 1st execution
</span></span><span style=display:flex><span>Loading RCU into database with RCUPREFIX OAM1
</span></span><span style=display:flex><span>Domain Configuration Phase
</span></span><span style=display:flex><span>==========================
</span></span><span style=display:flex><span>/u01/oracle/oracle_common/common/bin/wlst.sh -skipWLSModuleScanning /u01/oracle/dockertools/create_domain.py -oh /u01/oracle -jh /u01/jdk -parent /u01/oracle/user_projects/domains -name access_domain -user weblogic -password password -rcuDb 172.17.0.1:1521/ORCLPDB1.localdomain -rcuPrefix OAM1 -rcuSchemaPwd password -isSSLEnabled true
</span></span><span style=display:flex><span>Cmd is /u01/oracle/oracle_common/common/bin/wlst.sh -skipWLSModuleScanning /u01/oracle/dockertools/create_domain.py -oh /u01/oracle -jh /u01/jdk -parent /u01/oracle/user_projects/domains -name access_domain -user weblogic -password password -rcuDb 172.17.0.1:1521/ORCLPDB1.localdomain -rcuPrefix OAM1 -rcuSchemaPwd password -isSSLEnabled true
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Initializing WebLogic Scripting Tool (WLST) ...
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Welcome to WebLogic Server Administration Scripting Shell
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Type help() for help on available commands
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>create_domain.py called with the following inputs:
</span></span><span style=display:flex><span>INFO: sys.argv[0] = /u01/oracle/dockertools/create_domain.py
</span></span><span style=display:flex><span>INFO: sys.argv[1] = -oh
</span></span><span style=display:flex><span>INFO: sys.argv[2] = /u01/oracle
</span></span><span style=display:flex><span>INFO: sys.argv[3] = -jh
</span></span><span style=display:flex><span>INFO: sys.argv[4] = /u01/jdk
</span></span><span style=display:flex><span>INFO: sys.argv[5] = -parent
</span></span><span style=display:flex><span>INFO: sys.argv[6] = /u01/oracle/user_projects/domains
</span></span><span style=display:flex><span>INFO: sys.argv[7] = -name
</span></span><span style=display:flex><span>INFO: sys.argv[8] = access_domain
</span></span><span style=display:flex><span>INFO: sys.argv[9] = -user
</span></span><span style=display:flex><span>INFO: sys.argv[10] = weblogic
</span></span><span style=display:flex><span>INFO: sys.argv[11] = -password
</span></span><span style=display:flex><span>INFO: sys.argv[12] = password
</span></span><span style=display:flex><span>INFO: sys.argv[13] = -rcuDb
</span></span><span style=display:flex><span>INFO: sys.argv[14] = 172.17.0.1:1521/ORCLPDB1.localdomain
</span></span><span style=display:flex><span>INFO: sys.argv[15] = -rcuPrefix
</span></span><span style=display:flex><span>INFO: sys.argv[16] = OAM1
</span></span><span style=display:flex><span>INFO: sys.argv[17] = -rcuSchemaPwd
</span></span><span style=display:flex><span>INFO: sys.argv[18] = password
</span></span><span style=display:flex><span>INFO: sys.argv[19] = -isSSLEnabled
</span></span><span style=display:flex><span>INFO: sys.argv[20] = true
</span></span><span style=display:flex><span>INFO: Creating Admin server...
</span></span><span style=display:flex><span>INFO: Enabling SSL PORT for AdminServer...
</span></span><span style=display:flex><span>Error: set() failed. Do dumpStack() to see details.
</span></span><span style=display:flex><span>Error: runCmd() failed. Do dumpStack() to see details.
</span></span><span style=display:flex><span>Problem invoking WLST - Traceback (innermost last):
</span></span><span style=display:flex><span>  File &#34;/u01/oracle/dockertools/create_domain.py&#34;, line 513, in ?
</span></span><span style=display:flex><span>  File &#34;/u01/oracle/dockertools/create_domain.py&#34;, line 123, in createOAMDomain
</span></span><span style=display:flex><span>  File &#34;/u01/oracle/dockertools/create_domain.py&#34;, line 184, in createBaseDomain
</span></span><span style=display:flex><span>  File &#34;/tmp/WLSTOfflineIni5785928536971827845.py&#34;, line 79, in set
</span></span><span style=display:flex><span>  File &#34;/tmp/WLSTOfflineIni5785928536971827845.py&#34;, line 19, in command
</span></span><span style=display:flex><span>	at com.oracle.cie.domain.script.jython.CommandExceptionHandler.handleException(CommandExceptionHandler.java:69)
</span></span><span style=display:flex><span>	at com.oracle.cie.domain.script.jython.WLScriptContext.handleException(WLScriptContext.java:3085)
</span></span><span style=display:flex><span>	at com.oracle.cie.domain.script.jython.WLScriptContext.runCmd(WLScriptContext.java:738)
</span></span><span style=display:flex><span>	at sun.reflect.GeneratedMethodAccessor132.invoke(Unknown Source)
</span></span><span style=display:flex><span>	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
</span></span><span style=display:flex><span>	at java.lang.reflect.Method.invoke(Method.java:498)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>com.oracle.cie.domain.script.jython.WLSTException: com.oracle.cie.domain.script.jython.WLSTException
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Domain Creation Failed.. Please check the Domain Logs
</span></span></code></pre></td></tr></table></div></div><p>可以从48行看到是在 <code>Creating Admin server...</code> 阶段出错的。</p><h3 id=解决四提高admin_password-密码复杂度>解决四：提高<code>ADMIN_PASSWORD</code> 密码复杂度<a hidden class=anchor aria-hidden=true href=#解决四提高admin_password-密码复杂度>#</a></h3><p>需要注意的是每次失败重试之前要先删除之前留下的痕迹。</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-31-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-31-1>1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-31-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-31-2>2</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo docker rm oamadmin
</span></span><span style=display:flex><span>sudo rm -rf /scratch/user_projects/*
</span></span></code></pre></td></tr></table></div></div><p>从这里 <a href=https://github.com/oracle/docker-images/issues/844#issuecomment-389884511>https://github.com/oracle/docker-images/issues/844#issuecomment-389884511</a> 看到可能是密码复杂度不够，导致无法设置密码。</p><p>启动容器的命令改为以下。将其中 <code>ADMIN_PASSWORD</code> 和 <code>DB_SCHEMA_PASSWORD</code> 的复杂度变高。</p><p>其中<code>ADMIN_PASSWORD</code> 应该是weblogic管理台的密码。<code>DB_SCHEMA_PASSWORD</code> 是 <code>password you want to set for the RCU schemas</code> 。</p><p>那么什么是<code>RCU schemas</code> 呢？什么是RCU呢？不太理解，先跳过。</p><blockquote><p>Repository Creation Utility is a graphical and CLI-based tool used to create and manage Oracle Fusion Middleware database schemas.</p></blockquote><p>改进两个密码的复杂度重新创建容器。</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-32-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-32-1>1</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo docker run -d --network<span style=color:#f92672>=</span>OamNET -p 7001:7001 --name<span style=color:#f92672>=</span>oamadmin --env CONNECTION_STRING<span style=color:#f92672>=</span>172.17.0.1:1521/ORCLPDB1.localdomain --env ADMIN_LISTEN_HOST<span style=color:#f92672>=</span>oamadmin --env DOMAIN_NAME<span style=color:#f92672>=</span>access_domain --env ADMIN_USER<span style=color:#f92672>=</span>weblogic --env ADMIN_PASSWORD<span style=color:#f92672>=</span>W3bl@gic --env ADMIN_LISTEN_PORT<span style=color:#f92672>=</span><span style=color:#ae81ff>7001</span> --env RCUPREFIX<span style=color:#f92672>=</span>OAM1 --env DB_USER<span style=color:#f92672>=</span>sys --env DB_PASSWORD<span style=color:#f92672>=</span>Oradoc_db1 --env DB_SCHEMA_PASSWORD<span style=color:#f92672>=</span>Dbsch3m@ -v /scratch/user_projects/:/u01/oracle/user_projects container-registry.oracle.com/middleware/oam:12.2.1.4.0
</span></span></code></pre></td></tr></table></div></div><p>并使用 <code>sudo docker logs -ft oamadmin</code> 查看新建过程打印出来的日志，看到问题得到了解决。</p><h3 id=报错五创建domain失败>报错五：创建domain失败<a hidden class=anchor aria-hidden=true href=#报错五创建domain失败>#</a></h3><p>可以看到前几个步骤都顺利完成了，但也出现了新的问题。</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-33-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-33-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-33-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-33-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-33-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-33-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-33-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-33-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-33-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-33-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-33-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-33-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-33-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-33-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-33-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-33-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-33-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-33-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-33-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-33-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-33-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-33-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-33-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-33-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-33-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-33-13>13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-33-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-33-14>14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-33-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-33-15>15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-33-16><a style=outline:none;text-decoration:none;color:inherit href=#hl-33-16>16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-33-17><a style=outline:none;text-decoration:none;color:inherit href=#hl-33-17>17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-33-18><a style=outline:none;text-decoration:none;color:inherit href=#hl-33-18>18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-33-19><a style=outline:none;text-decoration:none;color:inherit href=#hl-33-19>19</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-33-20><a style=outline:none;text-decoration:none;color:inherit href=#hl-33-20>20</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-33-21><a style=outline:none;text-decoration:none;color:inherit href=#hl-33-21>21</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-33-22><a style=outline:none;text-decoration:none;color:inherit href=#hl-33-22>22</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-33-23><a style=outline:none;text-decoration:none;color:inherit href=#hl-33-23>23</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-33-24><a style=outline:none;text-decoration:none;color:inherit href=#hl-33-24>24</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-33-25><a style=outline:none;text-decoration:none;color:inherit href=#hl-33-25>25</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-33-26><a style=outline:none;text-decoration:none;color:inherit href=#hl-33-26>26</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-33-27><a style=outline:none;text-decoration:none;color:inherit href=#hl-33-27>27</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-33-28><a style=outline:none;text-decoration:none;color:inherit href=#hl-33-28>28</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-33-29><a style=outline:none;text-decoration:none;color:inherit href=#hl-33-29>29</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-33-30><a style=outline:none;text-decoration:none;color:inherit href=#hl-33-30>30</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-33-31><a style=outline:none;text-decoration:none;color:inherit href=#hl-33-31>31</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-33-32><a style=outline:none;text-decoration:none;color:inherit href=#hl-33-32>32</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-33-33><a style=outline:none;text-decoration:none;color:inherit href=#hl-33-33>33</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-33-34><a style=outline:none;text-decoration:none;color:inherit href=#hl-33-34>34</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-33-35><a style=outline:none;text-decoration:none;color:inherit href=#hl-33-35>35</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-33-36><a style=outline:none;text-decoration:none;color:inherit href=#hl-33-36>36</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-33-37><a style=outline:none;text-decoration:none;color:inherit href=#hl-33-37>37</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-33-38><a style=outline:none;text-decoration:none;color:inherit href=#hl-33-38>38</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-33-39><a style=outline:none;text-decoration:none;color:inherit href=#hl-33-39>39</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-33-40><a style=outline:none;text-decoration:none;color:inherit href=#hl-33-40>40</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-33-41><a style=outline:none;text-decoration:none;color:inherit href=#hl-33-41>41</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>类似前文日志
</span></span><span style=display:flex><span>INFO: Creating Admin server...
</span></span><span style=display:flex><span>INFO: Enabling SSL PORT for AdminServer...
</span></span><span style=display:flex><span>Creating Node Managers...
</span></span><span style=display:flex><span>Will create Base domain at /u01/oracle/user_projects/domains/access_domain
</span></span><span style=display:flex><span>Writing base domain...
</span></span><span style=display:flex><span>Base domain created at /u01/oracle/user_projects/domains/access_domain
</span></span><span style=display:flex><span>Extending domain at /u01/oracle/user_projects/domains/access_domain
</span></span><span style=display:flex><span>Database  172.17.0.1:1521/ORCLPDB1.localdomain
</span></span><span style=display:flex><span>Apply Extension templates
</span></span><span style=display:flex><span>Extension Templates added
</span></span><span style=display:flex><span>Extension Templates added
</span></span><span style=display:flex><span>Deleting oam_server1
</span></span><span style=display:flex><span>The default oam_server1 coming from the oam extension template deleted
</span></span><span style=display:flex><span>Deleting oam_policy_mgr1
</span></span><span style=display:flex><span>The default oam_server1 coming from the oam extension template deleted
</span></span><span style=display:flex><span>Configuring JDBC Templates ...
</span></span><span style=display:flex><span>Configuring the Service Table DataSource...
</span></span><span style=display:flex><span>fmwDatabase  jdbc:oracle:thin:@172.17.0.1:1521/ORCLPDB1.localdomain
</span></span><span style=display:flex><span>Getting Database Defaults...
</span></span><span style=display:flex><span>Error: getDatabaseDefaults() failed. Do dumpStack() to see details.
</span></span><span style=display:flex><span>Error: runCmd() failed. Do dumpStack() to see details.
</span></span><span style=display:flex><span>Problem invoking WLST - Traceback (innermost last):
</span></span><span style=display:flex><span>  File &#34;/u01/oracle/dockertools/create_domain.py&#34;, line 513, in ?
</span></span><span style=display:flex><span>  File &#34;/u01/oracle/dockertools/create_domain.py&#34;, line 124, in createOAMDomain
</span></span><span style=display:flex><span>  File &#34;/u01/oracle/dockertools/create_domain.py&#34;, line 328, in extendOamDomain
</span></span><span style=display:flex><span>  File &#34;/u01/oracle/dockertools/create_domain.py&#34;, line 259, in configureJDBCTemplates
</span></span><span style=display:flex><span>  File &#34;/tmp/WLSTOfflineIni7074819690261705056.py&#34;, line 267, in getDatabaseDefaults
</span></span><span style=display:flex><span>  File &#34;/tmp/WLSTOfflineIni7074819690261705056.py&#34;, line 19, in command
</span></span><span style=display:flex><span>Failed to build JDBC Connection object: 
</span></span><span style=display:flex><span>	at com.oracle.cie.domain.script.jython.CommandExceptionHandler.handleException(CommandExceptionHandler.java:69)
</span></span><span style=display:flex><span>	at com.oracle.cie.domain.script.jython.WLScriptContext.handleException(WLScriptContext.java:3085)
</span></span><span style=display:flex><span>	at com.oracle.cie.domain.script.jython.WLScriptContext.runCmd(WLScriptContext.java:738)
</span></span><span style=display:flex><span>	at sun.reflect.GeneratedMethodAccessor132.invoke(Unknown Source)
</span></span><span style=display:flex><span>	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
</span></span><span style=display:flex><span>	at java.lang.reflect.Method.invoke(Method.java:498)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>com.oracle.cie.domain.script.jython.WLSTException: com.oracle.cie.domain.script.jython.WLSTException: Got exception when auto configuring the schema component(s) with data obtained from shadow table: 
</span></span><span style=display:flex><span>Failed to build JDBC Connection object: 
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Domain Creation Failed.. Please check the Domain Logs
</span></span></code></pre></td></tr></table></div></div><h3 id=解决五修改db_schema_password>解决五：修改<code>DB_SCHEMA_PASSWORD</code><a hidden class=anchor aria-hidden=true href=#解决五修改db_schema_password>#</a></h3><p>从日志看到是在 <code>Getting Database Defaults...</code> 阶段出现的问题，搜索 <code>getDatabaseDefaults() failed. Do dumpStack() to see details.</code> 发现<a href=https://github.com/oracle/docker-images/issues/1633>这个github issue</a>有讨论。</p><p>看到<a href=https://github.com/freneticdisc/oracle-fmw-tooling/issues/1#issuecomment-236911279>有人</a>说是 <code>schema password</code> 的问题，于是随便改<code>DB_SCHEMA_PASSWORD</code> ，改成<code>Oradoc_db1</code> 还是不行，改成<code>Oradoc_db2</code>就可以了，我也不知道是什么原因😓</p><p><img loading=lazy src=a4f3fb99f57fa809b.png alt></p><p>总之呢，用这个命令，就可以跑起来三个容器中的第一个了！</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-34-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-34-1>1</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo docker run -d --network<span style=color:#f92672>=</span>OamNET -p 7001:7001 --name<span style=color:#f92672>=</span>oamadmin --env CONNECTION_STRING<span style=color:#f92672>=</span>172.17.0.1:1521/ORCLPDB1.localdomain --env ADMIN_LISTEN_HOST<span style=color:#f92672>=</span>oamadmin --env DOMAIN_NAME<span style=color:#f92672>=</span>access_domain --env ADMIN_USER<span style=color:#f92672>=</span>weblogic --env ADMIN_PASSWORD<span style=color:#f92672>=</span>W3bl@gic --env ADMIN_LISTEN_PORT<span style=color:#f92672>=</span><span style=color:#ae81ff>7001</span> --env RCUPREFIX<span style=color:#f92672>=</span>OAM1 --env DB_USER<span style=color:#f92672>=</span>sys --env DB_PASSWORD<span style=color:#f92672>=</span>Oradoc_db1 --env DB_SCHEMA_PASSWORD<span style=color:#f92672>=</span>Oradoc_db2 -v /scratch/user_projects/:/u01/oracle/user_projects container-registry.oracle.com/middleware/oam:12.2.1.4.0
</span></span></code></pre></td></tr></table></div></div><h2 id=成果>成果<a hidden class=anchor aria-hidden=true href=#成果>#</a></h2><p><img loading=lazy src=bf46138e2220efeff.png alt></p><h1 id=创建容器二>④创建容器二<a hidden class=anchor aria-hidden=true href=#创建容器二>#</a></h1><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-35-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-35-1>1</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>sudo docker run -d -p 14100:14100 --network=OamNET --volumes-from oamadmin --name oamms --env DOMAIN_NAME=access_domain --env ADMIN_USER=weblogic --env ADMIN_PASSWORD=W3bl@gic --env ADMIN_LISTEN_HOST=oamadmin --env ADMIN_LISTEN_PORT=7001 --env MANAGEDSERVER_PORT=14100 --env MANAGED_SERVER_CONTAINER=true --env MS_NAME=oam_server1 --env MS_HOST=oamms container-registry.oracle.com/middleware/oam:12.2.1.4.0 &#34;/u01/oracle/dockertools/startMS.sh&#34;
</span></span></code></pre></td></tr></table></div></div><p><img loading=lazy src=40161adb3f221b783.png alt></p><h1 id=创建容器三>⑤创建容器三<a hidden class=anchor aria-hidden=true href=#创建容器三>#</a></h1><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-1>1</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>sudo docker run -d -p 15100:15100 --network=OamNET --volumes-from oamadmin --name oampolicy --env DOMAIN_NAME=access_domain --env ADMIN_USER=weblogic --env ADMIN_PASSWORD=W3bl@gic --env ADMIN_LISTEN_HOST=oamadmin --env ADMIN_LISTEN_PORT=7001 --env MANAGEDSERVER_PORT=15100 --env MANAGED_SERVER_CONTAINER=true --env MS_NAME=oam_policy_mgr1 --env MS_HOST=oampolicy container-registry.oracle.com/middleware/oam:12.2.1.4.0 &#34;/u01/oracle/dockertools/startMS.sh&#34;
</span></span></code></pre></td></tr></table></div></div><p><img loading=lazy src=544942930ed4fe685.png alt></p><h1 id=验证服务可用性>⑥验证服务可用性<a hidden class=anchor aria-hidden=true href=#验证服务可用性>#</a></h1><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-37-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-37-1>1</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo docker inspect -f <span style=color:#e6db74>&#39;{{.Name}} - {{range .NetworkSettings.Networks}}{{.IPAddress}}{{end}}&#39;</span> oamadmin oamms oampolicy myOracleDB
</span></span></code></pre></td></tr></table></div></div><p><img loading=lazy src=dfd4036a4748021da.png alt></p><table><thead><tr><th><strong>Console or Page</strong></th><th><strong>URL</strong></th></tr></thead><tbody><tr><td>WebLogic Administration Console</td><td><code>http://&lt;oamadmin_ip>:7001/console</code></td></tr><tr><td>Oracle Enterprise Manager Console</td><td><code>http://&lt;oamadmin_ip>:7001/em</code></td></tr><tr><td>Oracle Access Management Console</td><td><code>http://&lt;oamadmin_ip>:7001/oamconsole</code></td></tr><tr><td>OAM Server Logout</td><td><code>http://&lt;oamms_ip>:14100/oam/server/logout</code></td></tr><tr><td>Policy Manager Access</td><td><code>http://&lt;oampolicy_ip>:15100/access</code></td></tr></tbody></table><p>各服务截图</p><p><img loading=lazy src=ba65875790ab559a5.png alt></p><p><img loading=lazy src=41c9c916a30be8852.png alt></p><p><img loading=lazy src=9a44787788c7ea981.png alt></p><p><img loading=lazy src=712933324472facab.png alt></p><p><img loading=lazy src=b0f916a90c2f677ae.png alt></p><p><img loading=lazy src=40cb61407a982cd71.png alt></p><h1 id=启停与删除>⑦启停与删除<a hidden class=anchor aria-hidden=true href=#启停与删除>#</a></h1><p>启停</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-38-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-38-1>1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-38-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-38-2>2</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>sudo docker stop oamadmin oamms oampolicy myOracleDB
</span></span><span style=display:flex><span>sudo docker start oamadmin oamms oampolicy myOracleDB
</span></span></code></pre></td></tr></table></div></div><p>删除</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-39-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-39-1>1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-39-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-39-2>2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-39-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-39-3>3</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>sudo docker stop oamadmin oamms oampolicy myOracleDB
</span></span><span style=display:flex><span>sudo docker rm oamadmin oamms oampolicy myOracleDB
</span></span><span style=display:flex><span>sudo rm -rf /scratch/user_projects
</span></span></code></pre></td></tr></table></div></div><h1 id=参考链接>参考链接<a hidden class=anchor aria-hidden=true href=#参考链接>#</a></h1><ul><li>安装Oracle Access Manager<ul><li><a href=https://docs.oracle.com/en/middleware/idm/access-manager/12.2.1.4/tutorial-oam-docker/>Creating Oracle Access Management Docker Containers</a></li><li><a href=https://www.oracle.com/hk/security/identity-management/technologies/downloads/>https://www.oracle.com/hk/security/identity-management/technologies/downloads/</a></li><li><a href=https://docs.oracle.com/cd/E23104_01/download_readme.htm>https://docs.oracle.com/cd/E23104_01/download_readme.htm</a></li><li><a href=https://github.com/oracle/docker-images/tree/main/OracleAccessManagement>https://github.com/oracle/docker-images/tree/main/OracleAccessManagement</a></li></ul></li><li>CDB与PDB<ul><li><a href=https://www.cnblogs.com/kerrycode/p/3386917.html>ORACLE 12C新特性——CDB与PDB</a></li><li><a href=https://www.dell.com/support/kbdoc/zh-cn/000146485/%E5%A6%82%E4%BD%95%E8%BF%9E%E6%8E%A5%E5%88%B0-oracle-rac-12cr1-%E4%B8%AD%E7%9A%84%E5%8F%AF%E6%8F%92%E6%8B%94%E6%95%B0%E6%8D%AE%E5%BA%93>如何连接到 Oracle RAC 12cR1 中的可插拔数据库？</a></li></ul></li><li>SQLPLus<ul><li><a href=https://askubuntu.com/questions/159939/how-to-install-sqlplus>How to install SqlPlus?</a></li><li><a href=https://www.oracle.com/database/technologies/instant-client/linux-x86-64-downloads.html>Oracle Instant Client Downloads for Linux x86-64 (64-bit)</a></li></ul></li><li>Oracle数据库<ul><li><a href=https://hub.docker.com/u/findneo/content/sub-3762ef81-7448-4275-909b-df7e6b5d4070>Oracle Database Server Docker Image Documentation</a></li></ul></li><li>漏洞分析<ul><li><a href=https://mp.weixin.qq.com/s/nRZWYxUZRKeOX5hebRc7-Q>【最新漏洞预警】CVE-2021–35587 Oracle Access Manager反序列化漏洞分析与命令回显构造</a></li></ul></li></ul></div><footer class=post-footer><ul class=post-tags></ul><nav class=paginav><a class=prev href=https://ret2neo.cn/post/230515-oracle-access-manager-cve-2021-35587/><span class=title>« Prev</span><br><span>CVE-2021-35587：Oracle Access Manager反序列化漏洞</span></a>
<a class=next href=https://ret2neo.cn/post/211031-cve-2021-22205-mitigation/><span class=title>Next »</span><br><span>CVE-2021-22205：GitLab远程代码执行漏洞分析</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://ret2neo.cn/>闲言语</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2303473689051162" crossorigin=anonymous></script><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>